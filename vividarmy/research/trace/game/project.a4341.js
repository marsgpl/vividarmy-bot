window.__require=function e(t,a,o){function n(r,s){if(!a[r]){if(!t[r]){var l=r.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(i)return i(l,!0);throw new Error("Cannot find module '"+r+"'")}}var d=a[r]={exports:{}};t[r][0].call(d.exports,function(e){return n(t[r][1][e]||e)},d,d.exports,e,t,a,o)}return a[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<o.length;r++)n(o[r]);return n}({"use_v2.1.x_cc.Action":[function(e,t,a){"use strict";cc._RF.push(t,"6e1e7FrTC1C3LyQ3LMyzGgr","use_v2.1.x_cc.Action"),cc.macro.ROTATE_ACTION_CCW=!0,cc._RF.pop()},{}],LocalManager:[function(e,t,a){"use strict";cc._RF.push(t,"118727ppO9El6cHLn2/Z18V","LocalManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/utils/LocalStorageUtils"),n=e("../../fws/display/factory/RemoteAssertLoader"),i=e("../../fws/utils/FWSTool"),r=e("../../fws/platforms/PlatformCore"),s=e("../../fws/utils/X"),l=e("../../Game/Data/GlobalData"),c=e("../../Game/Tools/TimeZoneTool"),d=(e("../../fws/utils/ErrorReport"),e("../../Game/controllers/G123IPContentProvider")),p=function(){function e(){this._defaultLang="ja",this._currLang="",this._langArray=["zh_cn","zh_tw","en","ja","jp","ru","de","fr","es","ui","ko","ar","pt","it","id","pl","tr","th"],this._langData=null,this._isLoaded=!1,this._isLoading=!1,this._lastLangVersion=null,this._committed_items=cc.js.createMap(!0),this._not_commit_items=[]}return e.getInst=function(){return e._inst||(e._inst=new e)},e.prototype.getLangData=function(){return this._langData},Object.defineProperty(e.prototype,"IsLoaded",{get:function(){return this._isLoaded},enumerable:!0,configurable:!0}),e.prototype.getLanguage=function(){return this._currLang?this._currLang:this._defaultLang},e.prototype.setLanguage=function(e){var t=this;if((e!=this._currLang||l.GLOBAL.LangVer===this._lastLangVersion)&&(this._lastLangVersion=l.GLOBAL.LangVer,!this._isLoading)){var a=this._defaultLang;for(var i in this._langArray)if(e.indexOf(this._langArray[i])>-1){a=this._langArray[i];break}this._currLang=a,this._isLoaded=!1,this._isLoading=!0,this.loadLocalTask=new n.RemoteTextLoader(a,n.RemoteAssetType.Locale,{target:this,func:function(e,a){try{var n=a.split("^--"),i="";if(1===n.length)i=n[0];else{if(3!==n.length)return s.error("locale file not end."),!1;i=n[1]}var l=o.get("LocalReduce");null===l&&(l=0);var c=i.split(/[\r\n]+|\^\|/);t._langData=cc.js.createMap(!0);for(var d=0;d<c.length;d++){var p=c[d];if(p.indexOf("=")>0){r.instance.replaceGameName("1")&&(p=r.instance.replaceGameName(p));var u=p.substring(0,p.indexOf("=")),h=p.substring(p.indexOf("=")+1,p.length);if(h.length>2&&"D@"==h.substring(0,2)){if(1==l)continue;h=h.substring(2,h.length)}t._langData[u]=h.replace(/\\n/g,"\n")}}return t._isLoaded=!0,t._isLoading=!1,t._currLang=e,t.loadLocalTask=null,o.set("localLanguage",e),!0}catch(e){return!1}}})}},e.prototype.firstSetLanguage=function(e){if(r.instance.canChangeLaunguage()){var t=o.get("localLanguage");t?("en"===t&&(t="ja"),this.setLanguage(t)):this.setLanguage(e)}else this.setLanguage(e)},e.prototype.reSetLanguage=function(e){if(e!=this._currLang){var t=this._defaultLang;for(var a in this._langArray)if(e.indexOf(this._langArray[a])>-1){t=this._langArray[a];break}if(o.set("localLanguage",t),window.ResetGame)try{window.ResetGame.doResetGame(!0)}catch(e){s.error("LocalManager  doResetGame  error"+e)}}},e.prototype.getText=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e=this.getRealKey(e);var o=this.getTextWithParas(e,t);return d.default.Instance.getText(e,o)},e.prototype.getRealKey=function(e){var t={100228:"g123_newguild_1",100061:"g123_newguild_2",101186:"g123_newguild_4",100236:"g123_newguild_5",101187:"g123_newguild_6",100196:"g123_newguild_7",100244:"g123_newguild_8",100249:"g123_newguild_9",100062:"g123_newguild_10",unlock_new_soldier_001:"g123_newguild_11",unlock_new_soldier_002:"g123_newguild_12"};return t[e]?t[e]:e},e.prototype.getTextByArray=function(e,t){return this.getTextWithParas(e,t)},e.prototype.getTextOrEmpty=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return this.getTextWithParas(e,t,"")},e.prototype.getTextWithParas=function(t,a,o){var n;if(e.SHOW_GM_KEY_MODE)return t;var s;if(t=(n=this.getRealkeyAndAddPara(t))[0],s=n[1],a=a.concat(s),null!==o&&void 0!==o||(o=t),!this._isLoaded||!this._langData)return o;var l=this._langData[t];if(i.Str.isEmpty(l))return o;!t||window.OnlineServer&&!r.instance.isWindows()||this.STAT_LOCAL_USED(t),l=this.replaceMoneyParams(l,a)||l,l=c.replaceTSParams(l,this);for(var d=a.length,p=0;p<d;p++)l=l.replace("{"+p+"}",a[p]);return l},e.prototype.STAT_LOCAL_USED=function(e){0},e.prototype.getNetMsgText=function(e){var t=e.split(/[,|]/g);return a.LOCAL.getText.apply(a.LOCAL,t)},Object.defineProperty(e.prototype,"CurrLang",{get:function(){return this._currLang},enumerable:!0,configurable:!0}),e.prototype.getCurrentBitMapPerfixStr=function(){return"zh_cn"===this.CurrLang?"sc":"zh_tw"===this.CurrLang?"tc":"en"===this.CurrLang?"en":"ja"===this.CurrLang||"jp"===this.CurrLang?"ja":"ru"===this.CurrLang?"ru":"de"===this.CurrLang?"de":"es"===this.CurrLang?"es":"fr"===this.CurrLang?"fr":"ar"===this.CurrLang?"ar":"ko"===this.CurrLang?"ko":"pt"===this.CurrLang?"pt":"it"===this.CurrLang?"it":"id"===this.CurrLang?"id":"pl"===this.CurrLang?"pl":"tr"===this.CurrLang?"tr":"th"===this.CurrLang?"th":"sc"},e.prototype.getTranslateLanguage=function(e){var t=e;switch(e){case"tt":t="zh_cn";break;case"jp":t="ja"}return t},Object.defineProperty(e.prototype,"IsCNLang",{get:function(){return"zh_cn"==this._currLang||"zh_tw"==this._currLang||"tt"==this._currLang},enumerable:!0,configurable:!0}),e.prototype.replaceMoneyParams=function(e,t){for(var a=i.Str.matchs(/\{(m|n)\d+\}/gm,e),o=e+"",n=a.length-1;n>=0;n--){var r=a[n],s=r[0]||"",l=r.index,c=s.substr(1,1),d=parseFloat(s.substr(2,s.length-3)),p="";switch(c){case"m":p=t[d]+"";break;case"n":p=d+""}p=this.moneyFormatMethod&&this.moneyFormatMethod(p)||"<"+p+">",o=o.substr(0,l)+p+o.substr(l+s.length)}return o},e.prototype.getRealkeyAndAddPara=function(e){var t={key:"",paras:[]};if(e){var o=e.split("|");if(o.length>0?t.key=o[0]:t.key=e,o.length>1){for(var n=[],i=1;i<o.length;i++)o[i].indexOf("{")>=0&&o[i].indexOf("}")>=0?n.push(o[i].substring(1,o[i].length-1)):n.push(a.LOCAL.getText(o[i]));t.paras=n}}return[t.key,t.paras]},e.prototype.addTestKeys=function(e){void 0===e&&(e=null);var t=e||{tz_week1:"\u5468\u4e00",tz_week2:"\u5468\u4e8c",tz_week3:"\u5468\u4e09",tz_week4:"\u5468\u56db",tz_week5:"\u5468\u4e94",tz_week6:"\u5468\u516d",tz_week7:"\u5468\u65e5",tz_range:"{0}\u81f3{1}",tz_hours:"{0}\u70b9"};for(var a in t)this._langData[a]=t[a]},e.prototype.find=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=!1);var o=[];for(var n in this._langData){var i=this._langData[n],r=!1;if(0!=t&&1!=t||!e.test(n)||(r=!0),0!=t&&2!=t||!e.test(i)||(r=!0),r&&(o.push({key:n,value:i}),a))return}return s.table(o),o},e.SHOW_GM_KEY_MODE=!1,e}();a.default=p,a.LOCAL=p.getInst(),cc._RF.pop()},{"../../Game/Data/GlobalData":"GlobalData","../../Game/Tools/TimeZoneTool":"TimeZoneTool","../../Game/controllers/G123IPContentProvider":"G123IPContentProvider","../../fws/display/factory/RemoteAssertLoader":"RemoteAssertLoader","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X"}],SoundManager:[function(e,t,a){"use strict";cc._RF.push(t,"374c5l7c3ZJKJgzfzTsm43/","SoundManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Game/Common/LoadManager"),n=e("../../fws/utils/X"),i=e("../../Game/Data/DataCenter"),r=e("../../Game/Const/GameDefine"),s=function(){function e(){this.bgIndex=0,this._localBgVolume=.5,this._localEffectVolume=1,this._BgEnable=!0,this._effectEnable=!0,this._playBg=!1}return e.getInst=function(){return e._inst||(e._inst=new e)},e.prototype.setBgVolume=function(e){isNaN(e)||(this._localBgVolume=e,cc.audioEngine.setMusicVolume(this._localBgVolume),i.DATA&&i.DATA.UserData.setLocalData(r.UserSettingKey.MusicVolume,this._localBgVolume))},e.prototype.getBgVolume=function(){return this._localBgVolume},e.prototype.setEffectVolume=function(e){this._localEffectVolume=e,i.DATA&&i.DATA.UserData.setLocalData(r.UserSettingKey.SoundVolume,this._localEffectVolume)},e.prototype.getEffectVolume=function(){return this._localEffectVolume},e.prototype.setBgEnable=function(e){if(this._BgEnable=e,n.log("SOUND.setBgEnable",this._BgEnable),this._BgEnable){if(null!=this._curSoundPath){var t=this._curSoundPath;this._curSoundPath="",this.playBg(t)}}else this.stopBgSound()},e.prototype.getBgEnable=function(){return this._BgEnable},e.prototype.setEffectEnable=function(e){this._effectEnable=e},e.prototype.getEffetEnable=function(){return this._effectEnable},e.prototype.playClip=function(e,t,a){void 0===t&&(t=null),this._effectEnable&&(null!==t&&void 0!==t||(t=this._localEffectVolume),this.GetRes(e,function(e){try{var o=cc.audioEngine.play(e,!1,t);a&&a(o)}catch(e){}}))},e.prototype.forcePlayClip=function(e,t){void 0===t&&(t=null),null!==t&&void 0!==t||(t=this._localEffectVolume),this.GetRes(e,function(e){try{cc.audioEngine.play(e,!1,t)}catch(e){}})},e.prototype.playBg=function(e){var t=this;if(n.log("SOUND.playBg",e),this._curSoundPath!=e&&(this._curSoundPath=e,this._BgEnable)){cc.audioEngine.setFinishCallback(this._bgId,function(){}),this.bgSoundPaths=null,cc.audioEngine.stopMusic();var a=this;this.GetRes(e,function(e){a._BgEnable&&(t._bgId=cc.audioEngine.playMusic(e,!0))}),this._playBg=!0}},e.prototype.stopBgSound=function(){n.log("SOUND.stopBgSound"),cc.audioEngine.stopMusic(),this._playBg=!1},e.prototype.stopAll=function(){cc.audioEngine.stopAll()},e.prototype.stopAllEffects=function(){cc.audioEngine.stopAllEffects()},e.prototype.GetRes=function(e,t){null!==e&&void 0!==e&&""!==e&&o.LoadManager.loadResource("Sound.Get",e,cc.Asset,function(e,a){e?cc.error(e.message||e):t(a)})},e}();a.default=s,a.SOUND=s.getInst(),cc._RF.pop()},{"../../Game/Common/LoadManager":"LoadManager","../../Game/Const/GameDefine":"GameDefine","../../Game/Data/DataCenter":"DataCenter","../../fws/utils/X":"X"}],TableManager:[function(e,t,a){"use strict";cc._RF.push(t,"20d02R97YlO9rn3nMYp+1cL","TableManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/utils/X"),n=e("./LocalManager"),i={reward:"1"},r=function(){function e(){this._rawTableMap=cc.js.createMap(!1),this._tableMap=cc.js.createMap(!1)}return e.getInst=function(){return e._inst||(e._inst=new e)},Object.defineProperty(e.prototype,"tableMap",{get:function(){return this._tableMap},enumerable:!0,configurable:!0}),e.prototype.parseTable=function(e,t,a){return a?(this._tableMap[t]=null,void(this._rawTableMap[t]=e)):this.doParseTable(e,t)},e.prototype.doParseTable=function(e,t){try{var a=0===e.indexOf("^--")?1:0,n=e.lastIndexOf("^--");if(1==(a^(n===e.length-3&&0!==n?1:0)))return o.error(t,":file not end."),!1;var r=e;if(e.indexOf("^|")<0)return o.error(t,":file lack line break."),!1;var s={},l=r.split("^|"),c=l[0].split("`"),d=l[1].split("`");i[t]&&(s.header=c,s.coltype=d);for(var p=2;p<l.length;p++){var u=l[p];if(0!==u.length)if(i[t]){var h=u.split("`");h[0]&&(s[h[0]]=u)}else this.parseRow(s,u,"`",c,d)}this._tableMap[t]=s}catch(e){return o.error(t," parse error:",e),!1}return!0},e.prototype.parseRow=function(e,t,a,o,n){for(var i=t.split(a),r={},s=0;s<i.length;s++)this.parseCell(i[s],r,o[s],n[s]);i[0]&&(e[i[0]]=r)},e.prototype.parseCell=function(e,t,a,o){var n=null;o&&"string"==o?n=e:o&&"int"==o?""===e||"0"===e?n=0:"1"===e?n=1:(n=parseInt(e),isNaN(n)&&(n=0)):!o||"float"!=o&&"double"!=o&&"long"!=o?n=e:""===e||"0"===e?n=0:(n=parseFloat(e),isNaN(n)&&(n=0)),t[a]=n},e.prototype.getTableGroup=function(e,t){void 0===t&&(t=!1);var a=this._tableMap[e];if(!a){var n=this._rawTableMap[e];n&&(this.doParseTable(n,e),this._rawTableMap[e]=null,delete this._rawTableMap[e],a=this._tableMap[e]),a||o.log("\u8868\u8bfb\u53d6\u5931\u8d25\uff1a"+e)}return a},e.prototype.getTableDataById=function(e,t){var a=this.getTableGroup(e,!0);return a&&a[t]?(i[e]&&"string"==typeof a[t]&&this.parseRow(a,a[t],"`",a.header,a.coltype),a[t]):null},e.prototype.getTableIdByKeyValue=function(e,t,a){var o,n=this.getTableGroup(e),i=[];for(var r in n)void 0!==(o=n[r])[t]&&o[t]===a&&i.push(r);return 0===i.length?void 0:i},e.prototype.getTableDataByKeyValue=function(e,t,a){var o,n=this.getTableGroup(e),i=[];for(var r in n)void 0!==(o=n[r])[t]&&o[t]===a&&i.push(o);return 0===i.length?void 0:i},e.prototype.find=function(e,t){if(!t)return null;if(!e)return null;var a=this.getTableGroup(e);if(!a)return null;for(var o in a){var n=a[o];if(t(o,n))return n}return null},e.prototype.getTableByKey=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];var n=t.length;if(n%2==0){var i,r=this.getTableGroup(e),s=[];for(var l in r){i=r[l];for(var c=!0,d=0;d<n;d++)if(i[t[d]]!=t[++d]){c=!1;break}c&&s.push(i)}return s}o.log("table.getTableByKey\u6240\u9700\u53c2\u6570\u4e0d\u662f\u5b8c\u6574\u7684key-value")},e.prototype.getFirstTableByKey=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];var n=t.length;if(n%2==0){var i,r=this.getTableGroup(e);for(var s in r){i=r[s];for(var l=!0,c=0;c<n;c++)if(i[t[c]]!=t[++c]){l=!1;break}if(l)return i}return null}o.log("table.getTableByKey\u6240\u9700\u53c2\u6570\u4e0d\u662f\u5b8c\u6574\u7684key-value")},e.prototype.assign=function(e,t){if(t){var a=this.getTableGroup(e);for(var o in a){var n=a[o];n&&Object.assign(n,t)}}},e.prototype.search=function(e,t){var a=[],o=this.getTableGroup(e);for(var n in o){var i=o[n];t&&t(i)&&a.push(i)}return a},e.prototype.everyone=function(e,t){if(t){var a=this.getTableGroup(e);for(var o in a){t(a[o])}}},e.prototype.dump=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];var n=this.getTableGroup(e),i=[];for(var r in n){var s=n[r],l={};for(var c in l.__DATA__=s,s)("id"==c||t.indexOf(c)>=0)&&(l[c]=s[c]);i.push(l)}o.table(i)},e.prototype.for_i=function(e,t,a,o){for(var n=this.getTableDataById(e,t+""),i=0;i<a;i++){var r={};Object.assign(r,n),o(r,i)}},e.prototype.findName=function(e,t){var a=[],o=this.getTableGroup(e);for(var i in o){var r=o[i];r.name&&n.LOCAL.getText(r.name)==t&&a.push(r)}return a},e}();a.TableManager=r,a.TABLE=r.getInst(),cc._RF.pop()},{"../../fws/utils/X":"X","./LocalManager":"LocalManager"}],UAfingerprintCore:[function(e,t,a){"use strict";cc._RF.push(t,"df281QFCSRJ7JnLU/Si9jeF","UAfingerprintCore"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/platforms/PlatformCore"),n=e("../../Game/Data/GlobalData");function i(e,t){void 0===t&&(t=!0);var a=document.createElement("script");t?a.src=e:a.innerHTML=e,document.body.appendChild(a)}a.initUAFingerprint=function(){o.instance.enableUAFingerprint&&(i("//g.alicdn.com/AWSC/AWSC/awsc.js"),i("//cdn.jsdelivr.net/npm/fingerprintjs2@1.8/dist/fingerprint2.min.js"),i(n.GLOBAL.ResourceUrl+"/DynRes/genfiles/js/uaf.20.828.min.js"))},cc._RF.pop()},{"../../Game/Data/GlobalData":"GlobalData","../../fws/platforms/PlatformCore":"PlatformCore"}],EventCenter:[function(e,t,a){"use strict";cc._RF.push(t,"afcb2wimphGL4WmLLd9uAVf","EventCenter"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("../../System/ErrorUtils"),i=e("../../fws/utils/X"),r=function(e){function t(){var t=e.call(this)||this;return t._eventList={},t}return __extends(t,e),t.getInst=function(){return t._inst||(t._inst=new t)},t.prototype.on=function(e,t,a,r){var l=this._eventList[e];l||(l=this._eventList[e]=new Map);var c=l.get(t);if(c){if(-1!==this.findEvent(c,a))return t}else c=[],l.set(t,c);var d=new s;if(a instanceof o.default){if(!a.isLive()){var p=new n.ErrorInfo;return p.errMsgInfo=new Error("cpn.isLive()=false"),p.customInfo="EVENT.on eventName:"+e,p.errMsgType=n.eErrorTypes.Inner,void n.ErrorUtils.errorMessage(p)}d.name=a.getName()}return d.type=e,d.callback=t,d.target=a,d.useCapture=r,c.push(d),this.add?this.add(e,d.realCallback,d):i.error("\u65b0\u5f15\u64ce\u7248\u672c EventTarget \u6ca1add\u51fd\u6570"),a&&a.__eventTargets&&a.__eventTargets.push(this),t},t.prototype.off=function(t,a,o){if(!a)return delete this._eventList[t],void e.prototype.off.call(this,t,void 0,void 0);var n=this._eventList[t];if(n){var i=n.get(a);if(i){var r=this.findEvent(i,o);if(-1!=r){var s=i[r];e.prototype.off.call(this,t,s.realCallback,s),i.splice(r,1),0==i.length&&n.delete(a)}}}},t.prototype.findEvent=function(e,t){for(var a=e.length,o=0;o<a;){if(e[o].target===t)return o;++o}return-1},t}(cc.EventTarget);a.EventCenter=r;var s=function(){function e(){this.name=""}return e.prototype.realCallback=function(e,t,a){var i=this.target;try{var r=this.callback;if(r&&i)if(i instanceof o.default)i.isLive()&&r.call(i,e,t,a);else r.call(i,e,t,a);else r&&r(e,t,a)}catch(e){var s=null;if(i&&i instanceof o.default)s=i.getError(e,"EVENT.on callback");else(s=new n.ErrorInfo).funcName="EVENT.on callback",s.errMsgInfo=e;s.customInfo="EVENT.on name:+"+this.name+" eventName:"+this.type,n.ErrorUtils.errorMessage(s)}},e}();a.EVENT=r.getInst(),cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase","../../System/ErrorUtils":"ErrorUtils","../../fws/utils/X":"X"}],NetChatClient:[function(e,t,a){"use strict";cc._RF.push(t,"36b6b8gf+5BZIhp/O85tTah","NetChatClient"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Event/EventCenter"),n=e("../../fws/utils/X"),i=e("../../fws/utils/ErrorReport"),r=e("../../Game/Data/DataCenter"),s=e("../../System/JSWrap"),l=e("../../Game/Tools/GameTools"),c=e("../../Game/Const/GameDefine"),d=function(){function e(){}return e.createProxyPack=function(e,t,a){void 0===a&&(a="");var o={};return o.url=e,o.query=t,o.body=a,o},e.sendProxy=function(t,a,o,i,r,s){if(void 0===a&&(a=null),void 0===o&&(o=null),void 0===i&&(i=""),void 0===r&&(r=null),void 0===s&&(s=null),e.IsValid()){var l=function(e){var t=null;try{t=JSON.parse(e)}catch(e){return void n.error("sendProxy: parse error",e)}try{t.code&&1===t.code?a&&a(t):r&&r(t)}catch(e){n.error("sendProxy:error",e)}},c=e.createProxyPack(t,o,i);e._socket.emit("proxy",c,function(e){s&&s(),l(e)})}},e.logTime=function(e){window&&window.logTime&&window.logTime instanceof Function&&window.logTime(e)},e.addRoom=function(e){-1==this._rooms.indexOf(e)&&(this._rooms.push(e),this.joinRoom(e))},e.delRoom=function(e){var t=this._rooms.indexOf(e);-1!=t&&(this._rooms.splice(t,1),this.leaveRoom(e))},e.joinRoom=function(t){e._netIsValid&&e._socket.emit("join",t,function(e){0})},e.leaveRoom=function(t){e._netIsValid&&e._socket.emit("leave",t,function(e){0})},e.connectSocket=function(t,a,d,p,u){e._reconnectTimeoutHint&&(s.default.clearTimeout(e._reconnectTimeoutHint),e._reconnectTimeoutHint=null);var h=(a=a||[]).indexOf(t);if(h<0)a.unshift(t);else if(0!==h){var m=a[0];a[0]=t,a[h]=m}if(p&&(e._path=p),e.logTime("connect Chat begin"),e._io=window.io,e._io){var f=1===l.default.GlobalSwitchIntVal(c.SwitchType.disableChatMultipleLine),_=function(t){var l=a[~~(t/2)%a.length],c=e._io(l,{timeout:1e4,transports:["websocket"],path:e._path});i.trace({resp:"create socket.io",uri:l,path:e._path}),c.on("connect",function(){for(var t in i.trace({resp:"connect socket.io success"}),e.logTime("connect Chat end loginBegin"),e._netIsValid=!0,e._rooms)e.joinRoom(e._rooms[t]);e._socket.emit("bind",String(r.DATA.UserData.UID),function(e){0});try{u&&u(null)}catch(e){n.error("connectSocket callback"+e),i.trace({resp:"connect socket.io callback error",data:e})}}),c.on("chatpush",function(e){o.EVENT.emit("newChatPush",e)}),c.on("chatpushpm",function(e){o.EVENT.emit("chatpushpm",e)}),c.on("chatdel",function(e){o.EVENT.emit("chatMsgDelete",e)}),c.on("connect_failed",function(){e._netIsValid=!1,i.trace({resp:"connect socket.io failed"})}),c.on("disconnect",function(){e._netIsValid=!1}),c.on("reconnect",function(){o.EVENT.emit("NETCHATCLIENT_RECONNECT")}),c.on("reconnect_failed",function(){e._netIsValid=!1}),c.on("reconnecting",function(){e._netIsValid=!1}),c.on("error",function(e){i.trace({resp:"socket.io error",data:e+(e?": "+e.description:"")})}),c.on("open",function(){0}),c.on("close",function(){0}),c.on("connect_error",function(e){i.trace({resp:"connect socket.io error",data:e+(e?": "+e.description:"")})}),c.on("connect_timeout",function(a){i.trace({resp:"socket.io timeout",data:a}),f||(c.disconnect(),c.removeAllListeners(),null!=e._reconnectTimeoutHint&&(s.default.clearTimeout(e._reconnectTimeoutHint),e._reconnectTimeoutHint=null),e._reconnectTimeoutHint=s.default.setTimeout(function(){e._reconnectTimeoutHint=null,_(t+1)},1e3))}),e._socket=c};_(0)}else i.trace({resp:"can't find socket.io"})},e.sendEventToStopUpdate=function(e){var t=new cc.Event.EventCustom("stopUpdatePlayerInfo",!0);t.setUserData({key:e});try{cc.director.dispatchEvent(t)}catch(e){n.error("sendEventToStopUpdate:"+e)}},e.sendEventToResetUpdate=function(e){var t=new cc.Event.EventCustom("resetUpdatePlayerInfo",!0);t.setUserData({key:e});try{cc.director.dispatchEvent(t)}catch(e){n.error("sendEventToResetUpdate:"+e)}},e.IsValid=function(){return!!e._socket&&!!e._netIsValid},e.socket=function(){return e._socket},e.io=function(){return e._io},e.Disconnect=function(){e._reconnectTimeoutHint&&(s.default.clearTimeout(e._reconnectTimeoutHint),e._reconnectTimeoutHint=null),e._socket&&e._socket.disconnect(),e._socket=null,e._netIsValid=!1,e._rooms=[],e._io=null},e._reconnectTimeoutHint=null,e._path="",e._rooms=[],e._io=null,e._socket=null,e._netIsValid=!1,e}();a.default=d,cc._RF.pop()},{"../../Game/Const/GameDefine":"GameDefine","../../Game/Data/DataCenter":"DataCenter","../../Game/Tools/GameTools":"GameTools","../../System/JSWrap":"JSWrap","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/X":"X","../Event/EventCenter":"EventCenter"}],NetMgr:[function(e,t,a){"use strict";cc._RF.push(t,"540f4AZQGhDb4FN9hEJlUWE","NetMgr"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./SocketCore"),n=e("./Socket"),i=e("../../Game/msgs/MvcMsgs"),r=e("../../Game/Const/ResponseId"),s=e("./NetReciver"),l=e("../../fws/utils/X"),c=e("../../Game/Const/RequestId"),d=e("../Common/LocalManager"),p=e("../../Game/Tools/GameTools"),u=e("../../Game/Data/DataCenter"),h=e("../../Game/Const/MsgIdSettings"),m=e("../../Game/Start/LoginFlowOptions"),f=e("../../Game/Start/LoginTasks"),_=e("../../Game/Const/GameDefine"),y=e("../../fws/utils/ErrorReport"),g=e("../../System/JSWrap"),C=e("../../fws/task/FWSTask"),v=e("../../Game/Data/GlobalData"),I=e("../../Game/Start/GameServerRacingTask"),T=function(){function e(){this._cachePacks=[],this._requestPacks={},this._nextGid=0,this._disableOnMessage=!1,this._cacheMessages=[],this._heartbeatCode=0,this._autoConnectTimeoutHandler=null,this._currentOpenMsgBoxId=-1,this._totalPingCount=0,this._totalPingAccTime=0,this._totalDataPingCount=0,this._totalDataPingAccTime=0,this.lastReceiveTime=0,this.lastSendTime=0,this.waitHearbeatResult=!1,this.heartbeatMode=1,this.checkHeartPackIds=[c.RequestId.BUILD_BUILDING,c.RequestId.BUILD_ORDER,c.RequestId.GET_ORDER,c.RequestId.BUILD_MOVE,c.RequestId.ARMY_MOVE,c.RequestId.BUILDING_BATCH_MERGE,c.RequestId.ARMY_SPEED_ALL,c.RequestId.ARMY_BATCH_MERGE,c.RequestId.Science_LevelUp,c.RequestId.PostChatMsg],this._startTraceTime=0}return Object.defineProperty(e.prototype,"currentPing",{get:function(){return this._totalPingCount>0?this._totalPingAccTime/this._totalPingCount:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentDataPing",{get:function(){return this._totalDataPingCount>0?this._totalDataPingAccTime/this._totalDataPingCount:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disableOnMessage",{get:function(){return this._disableOnMessage},set:function(e){if(e!=this._disableOnMessage&&(this._disableOnMessage=e,l.info("(Socket) set disableOnMessage = "+this._disableOnMessage),!this._disableOnMessage)){for(var t=0;t<this._cacheMessages.length;t++){var a=this._cacheMessages[t];this.onMessage(a,0)}this._cacheMessages.length=0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectHost",{get:function(){return this._connectHost},enumerable:!0,configurable:!0}),e.prototype.getAccAddress=function(e){return this._socket?this._socket.getAccAddress(e):null},e.prototype.setAccAddress=function(e,t){this._socket&&this._socket.setAccAddress(e,t)},e.prototype.setOnConnectCallback=function(e){this._onConnectCallback=e},e.prototype.connectWithOption=function(e){var t=e.host;t&&this.connect(t,e.fallbackHost,e.accLineMap)},e.prototype.connect=function(e,t,a){void 0===t&&(t=null),void 0===a&&(a=null),this._host=e,this._socket||(this._socket=new n.default(this)),this.states===o.SocketStates.CLOSED?(this.removeAutoConnectTimeout(),this.clearSniffingHeartbeatRequest(),this._heartbeatCode=c.RequestId.NO_QUEUE_HEART,this.setWaitStatus(!0),l.log("\u4e1a\u52a1\u903b\u8f91\u8bf7\u6c42\u8fde\u63a5\u670d\u52a1\u5668",e),this.initSocketTaskList(a),this._connectHost=null,this._totalPingCount=this._totalPingAccTime=0,this._totalDataPingCount=this._totalDataPingAccTime=0,this._socket.connect(e,t,this._heartbeatCode)):l.warn("(Socket) \u5c1d\u8bd5\u5728\u4e00\u4e2a\u6d3b\u8dc3\u7684\u8fde\u63a5\u4e0a\u53d1\u8d77\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42")},e.prototype.resetSocketTaskList=function(){this._socket.taskListBeforeConnectRequest.tasks.length>0&&this._socket.taskListBeforeConnectRequest.clear()},e.prototype.initSocketTaskList=function(e){this._socket&&(this.resetSocketTaskList(),i.send(i.Names.CHANGE_TO_PRESERVER,this._socket.taskListBeforeConnectRequest),e&&this._socket.taskListBeforeConnectRequest.add(new I.default(this._host,e)),!(m.loginFlowOptionsData&&m.loginFlowOptionsData.deviceId)&&this._socket.taskListBeforeConnectRequest.add(new f.PlatformLoginTask("\u767b\u5f55\u5e73\u53f0",2)))},e.prototype.close=function(){this.removeAutoConnectTimeout(),this.stopHeartbeat(),this.resetSocketTaskList(),this._cacheMessages.length=0,this._socket&&this._socket.close()},e.prototype.setAutoReconnectOnClose=function(e){this._socket&&(this._socket.reconnectOnCloseEnabled=e)},e.prototype.traceCachePacks=function(e){},e.prototype.send=function(e,t,a,n,i){void 0===t&&(t=null),void 0===a&&(a=null),void 0===n&&(n=null),void 0===i&&(i=!1),this.traceCachePacks("verifyIdBySetting \u524d");var r=h.verifyIdBySetting(e,this._cachePacks);if(this.traceCachePacks("verifyIdBySetting \u540e"),r!==h.MsgIdSettingsVerifyResult.None){var s={pack:{c:e,o:this.getNextGid()+"",p:t||{}},target:a,success:n,reqTime:(new Date).getTime(),sendTime:(new Date).getTime(),ensureServerResponse:i,sendNum:1};this._cachePacks.push(s),this.traceCachePacks("push"),this._requestPacks[s.pack.o]=s,this.doSend(s.pack),s.sendTime=(new Date).getTime(),s.sendFrame=cc.director.getTotalFrames()}else o.LOG_ENABLED&&l.warn("(Socket) \u6d88\u606f#"+e+"\u7684\u8bf7\u6c42\u53d7MsgIDSettings\u9650\u5236")},e.prototype.doSend=function(e){this._socket&&this._socket.send(e),this.lastSendTime=(new Date).getTime()},e.prototype.getNextGid=function(){var e=this._nextGid;return this._nextGid++,this._nextGid=this._nextGid%1e8,e},e.prototype.addAutoConnectTimeout=function(){if(!this._autoConnectTimeoutHandler){var e=this;this._autoConnectTimeoutHandler=g.default.setTimeout(function(){e.onTimeOut()},1e3*o.AUTO_CONNECT_TIMEOUT)}},e.prototype.removeAutoConnectTimeout=function(){this._autoConnectTimeoutHandler&&(g.default.clearTimeout(this._autoConnectTimeoutHandler),this._autoConnectTimeoutHandler=null)},e.prototype.onClose=function(e){l.log("(Net) onClose"),this.stopHeartbeat(),e?(this.setWaitStatus(!0),this.addAutoConnectTimeout()):(this.removeAutoConnectTimeout(),this.resetSocketTaskList(),this._socket&&this._socket.close(),this.showPanel(3))},e.prototype.onError=function(e){l.log("(Net) onError"),this.stopHeartbeat(),e?(this.setWaitStatus(!0),this.addAutoConnectTimeout()):(this.removeAutoConnectTimeout(),this.resetSocketTaskList(),this._socket&&this._socket.close(),this.showPanel(1))},e.prototype.onTimeOut=function(){l.log("(Net) onTimeOut"),this.removeAutoConnectTimeout(),this.stopHeartbeat(),this.resetSocketTaskList(),this._socket&&this._socket.close(),this.showPanel(2)},e.prototype.onRequestConnect=function(){this.removeAutoConnectTimeout()},e.prototype.onConnect=function(){this._connectHost=this._socket?this._socket.connectHost:null,this.removeAutoConnectTimeout(),this.clearSniffingHeartbeatRequest(),l.log("(Net) onConnect"),this.setWaitStatus(!1),this.startHeartbeat(),i.send(i.Names.START_LOGIN,null),this._onConnectCallback&&this._onConnectCallback()},e.prototype.onReceive=function(e,t,a){if(e&&e.o&&e.c!=this._heartbeatCode){var o=this._requestPacks[e.o];if(o){var n=o.sendTime||0,i=a-n;if(n>0){var r=o.sendFrame||0,s=cc.director.getTotalFrames()-r;_.NetReqReport&&_.NetReqReport(e.c,i,this._connectHost,r,s,this.currentPing,v.GLOBAL.serverRegion)}}}},e.prototype.onMessage=function(e,t){if(this.lastReceiveTime=(new Date).getTime(),l.log("(\u5fc3\u8df3\u903b\u8f91) \u66f4\u65b0\u65f6\u95f4"),e.c!=this._heartbeatCode&&this._disableOnMessage)this._cacheMessages.push(e);else if(3==e.s&&i.send(i.Names.MVC_NET_TIPS,{type:i.MvcUIType.ShowTips,data:d.LOCAL.getNetMsgText(e.d)}),e.c!=r.ResponseId.ERROR_ID){var a=null;null!==e.o&&void 0!==e.o&&(a=this._requestPacks[e.o]);try{3==e.s&&y.trace({resp:e.d,id:e.c},"NetMsg")}catch(e){}if(s.getInstance().onMessage(e),o.TEST_SAVE_REQUEST_ID&&a&&this.checkHeartPackIds.indexOf(e.c)<0&&(o.TEST_SAVE_REQUEST_ID_TABLE[e.c]=1),a){a.sendTime&&(e.c===this._heartbeatCode&&(++this._totalPingCount,this._totalPingAccTime+=t>a.sendTime?t-a.sendTime:0),++this._totalDataPingCount,this._totalDataPingAccTime+=t>a.sendTime?t-a.sendTime:0);var n=this._cachePacks.indexOf(a);if(n>=0){if(this.traceCachePacks("splice \u524d"),this.waitHearbeatResult&&e.c==this._heartbeatCode){this.waitHearbeatResult=!1;for(var c=0,p=n;c<p;++c){var u=this._cachePacks[c];u.ensureServerResponse&&u.sendNum<=o.SEND_LIMIT_COUNT&&(this.doSend(u.pack),u.sendTime=(new Date).getTime(),u.sendFrame=cc.director.getTotalFrames(),++u.sendNum,this._cachePacks.push(u))}this._cachePacks.splice(0,n+1)}else this._cachePacks.splice(n,1);this.traceCachePacks("splice \u540e"),this._requestPacks[e.o]=void 0}}if(a&&a.success){this.startTimer(e,!0);try{a.success.call(a.target,e)}catch(e){l.error(e),y.error(e,"req",String(a.pack.c))}this.stopTimer(e,!0)}}},Object.defineProperty(e.prototype,"target",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"states",{get:function(){return this._socket?this._socket.states:o.SocketStates.CLOSED},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.setAutoReconnectOnClose(!1),this.close(),this._disableOnMessage=!1},e.prototype.enbaleNewHeartbeatMode=function(){this.heartbeatMode=2},e.prototype.disableNewHeartbeatMode=function(){this.heartbeatMode=1},e.prototype.startHeartbeat=function(){var e=this;this.stopHeartbeat(),this.lastReceiveTime=(new Date).getTime(),l.log("(\u5fc3\u8df3\u903b\u8f91) \u66f4\u65b0\u65f6\u95f4");for(var t=(new Date).getTime(),a=cc.director.getTotalFrames(),o=0;o<this._cachePacks.length;o++){var n=this._cachePacks[o];n.sendTime=t,n.sendFrame=a}this._host&&(this.heartbeatTimerHandler=setInterval(function(){e.sendHeartPack()},1e3))},e.prototype.clearSniffingHeartbeatRequest=function(){this.waitHearbeatResult=!1;for(var e=this._cachePacks.length-1;e>=0;e--){var t=this._cachePacks[e];t.pack.c==this._heartbeatCode&&(this._cachePacks.splice(e,1),this._requestPacks[t.pack.o]=void 0)}},e.prototype.setWaitStatus=function(e){i.send(i.Names.MVC_NET_TIPS,{type:i.MvcUIType.SetWaitStatus,data:e})},e.prototype.sendHeartPack=function(){if(this._socket&&this._socket.states==o.SocketStates.CONNECTED){var e=(new Date).getTime(),t=!1,a=!1,n="",i=0;if(1==this.heartbeatMode){e-this.lastReceiveTime>=2*o.IDLE_INTERVAL*1e3&&(t=!0);for(var r=0;r<this._cachePacks.length;r++){if(c=this._cachePacks[r]){var s=e-c.sendTime;n=String(c.pack.c),i=s;break}}a=e-this.lastSendTime>=1e3*o.IDLE_INTERVAL}if(2==this.heartbeatMode){for(r=0;r<this._cachePacks.length;r++){var c;if(c=this._cachePacks[r])if(this.waitHearbeatResult){if(c.pack.c==this._heartbeatCode)if((s=e-c.sendTime)>=1e3*o.IDLE_OVER){t=!0;break}}else if(this.checkHeartPackIds.indexOf(c.pack.c)>=0){if((s=e-c.sendTime)>=1e3*o.LOGIC_IDLE_OVER){a=!0;break}}}a||this.waitHearbeatResult||(a=e-this.lastSendTime>1e3*o.IDLE_INTERVAL)}if(t)return l.warn("(\u5fc3\u8df3\u903b\u8f91) \u8d85\u65f6, \u6d88\u606f\u53f7%s, \u65f6\u95f4%d ms",n,i),y.trace({resp:"\u5fc3\u8df3\u8d85\u65f6",custom:n,time:i},"close_socket"),this.close(),void this.connect(this._host);a&&(this.waitHearbeatResult=!0,this.send(this._heartbeatCode,null,this,function(e){if(e){var t=p.default.JSON_PARSE(e.d);if(t){var a=Math.floor(t.t/1e3);u.DATA.UpdateServerTime(a)}}}),l.log("(\u5fc3\u8df3\u903b\u8f91) \u53d1\u9001"))}},e.prototype.stopHeartbeat=function(){clearInterval(this.heartbeatTimerHandler)},e.prototype.enterBackground=function(){this.setAutoReconnectOnClose(!1)},e.prototype.enterFrontground=function(){this.setAutoReconnectOnClose(!0),this.startHeartbeat(),this.sendHeartPack(),this.clearOpenedMsgBox()&&this.doClosePannelReconnect()},e.prototype.checkHistoryPacksAfterLogin=function(e){l.log("(NET) checkHistoryPacksAfterLogin preUid=%s, nextUid=%s, cachePacks=%d",this.cacheUserId,e,this._cachePacks.length),e!=this.cacheUserId&&(l.log("(NET) \u6e05\u7a7a\u5386\u53f2\u6d88\u606f"),this.traceCachePacks("\u6e05\u7a7a\u4e4b\u524d"),this.cacheUserId=e,this._cachePacks.length=0,this._requestPacks={},this.traceCachePacks("\u6e05\u7a7a\u4e4b\u540e")),this.trySendHistoryPacks()},e.prototype.findRequest=function(e,t){void 0===t&&(t=!0);var a=0;if(!e)return a;for(var o=0;o<this._cachePacks.length;o++){if(e(this._cachePacks[o])&&(a++,t))break}return a},e.prototype.trySendHistoryPacks=function(){if(this.traceCachePacks("\u91cd\u53d1\u4e4b\u524d"),this.clearHistoryPacks(),!(this._cachePacks.length<1)){for(var e=0;e<this._cachePacks.length;e++){var t=this._cachePacks[e];0,this.doSend(t.pack),++t.sendNum,t.sendTime=(new Date).getTime(),t.sendFrame=cc.director.getTotalFrames()}l.log("(Net) \u91cd\u53d1"+this._cachePacks.length+"\u6761\u5386\u53f2\u6570\u636e"),this.traceCachePacks("\u91cd\u53d1\u4e4b\u540e")}},e.prototype.clearHistoryPacks=function(){this.traceCachePacks("clearHistoryPacks\u4e4b\u524d");for(var e=this._cachePacks.length-1;e>=0;e--){var t=this._cachePacks[e],a=h.getSetting(t.pack.c);a&&a.limitCount<=0&&(0,this._cachePacks.splice(e,1),this._requestPacks[t.pack.o]=void 0)}this.traceCachePacks("clearHistoryPacks\u4e4b\u540e")},e.prototype.startTimer=function(e,t){void 0===t&&(t=!0),o.TIMER_TRACE&&e&&e.c!=this._heartbeatCode&&(this._startTraceTime=Date.now())},e.prototype.stopTimer=function(e,t){if(void 0===t&&(t=!0),o.TIMER_TRACE&&e&&e.c!=this._heartbeatCode){var a=Date.now()-this._startTraceTime;_.packHandlerTimer(e.c,a,t)}},e.prototype.reconnectUseServerList=function(e){var t=this,a=new C.TaskList;a.add(new f.PlatformLoginTask("reconnectUseServerListTaskList",1)),a.add(new f.ServerListTask("reconnectUseServerListTaskList",e>5)),a.onError={target:this,handler:function(o,n){if(e>10)t.showPanel(1);else{if(n instanceof f.ServerListTask)return a.cancel(),a.onCompleted=a.onError=null,void g.default.setTimeout(function(){t.reconnectUseServerList(e+1)},1e3+1e3*Math.max(0,e-3));n.reset(),g.default.setTimeout(function(){n.begin()},1e3)}}},a.onCompleted={target:this,handler:function(){t.connectWithOption(p.default.getGameWsConnectOption(v.GLOBAL.game_ip,v.GLOBAL.GameFallbackDomain))}},a.begin()},e.prototype.doClosePannelReconnect=function(){!m.alreadyUseDevLoginPanel?this.reconnectUseServerList(0):this.connect(this._host)},e.prototype.clearOpenedMsgBox=function(){return this._currentOpenMsgBoxId>0&&(i.send(i.Names.MVC_NET_TIPS,this._currentOpenMsgBoxId),this._currentOpenMsgBoxId=-1,!0)},e.prototype.showPanel=function(e){var t=this;this.clearOpenedMsgBox();var a=d.LOCAL.getText("101001"),o=d.LOCAL.getText("100001");o+=" ("+e+")";var n=this;i.send(i.Names.MVC_NET_TIPS,{type:i.MvcUIType.MsgBoxAlert,data:{desc:o,title:a,target:this,callback:function(){t._currentOpenMsgBoxId=-1,n.doClosePannelReconnect()}}})},e}();a.NET=new T,cc._RF.pop()},{"../../Game/Const/GameDefine":"GameDefine","../../Game/Const/MsgIdSettings":"MsgIdSettings","../../Game/Const/RequestId":"RequestId","../../Game/Const/ResponseId":"ResponseId","../../Game/Data/DataCenter":"DataCenter","../../Game/Data/GlobalData":"GlobalData","../../Game/Start/GameServerRacingTask":"GameServerRacingTask","../../Game/Start/LoginFlowOptions":"LoginFlowOptions","../../Game/Start/LoginTasks":"LoginTasks","../../Game/Tools/GameTools":"GameTools","../../Game/msgs/MvcMsgs":"MvcMsgs","../../System/JSWrap":"JSWrap","../../fws/task/FWSTask":"FWSTask","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/X":"X","../Common/LocalManager":"LocalManager","./NetReciver":"NetReciver","./Socket":"Socket","./SocketCore":"SocketCore"}],NetReciver:[function(e,t,a){"use strict";cc._RF.push(t,"14a23faogRMipUuAgtAGAzA","NetReciver");var o,n=e("../../fws/utils/X"),i=e("../../fws/utils/ErrorReport"),r=e("./SocketCore");(function(e){var t,a=function(){function e(){this.ignnoreMsgCode=0}return e.prototype.init=function(e){this._reciver=e,this._reciver.Regist()},e.prototype.onMessage=function(e){var t=this._reciver.Get(e.c),a=!1;if(t){var o=Date.now();try{t.ResponseHandle({status:e.s,data:e.d})}catch(t){n.error(t),i.error(t,"res",String(e.c))}var s=Date.now()-o;try{i.packHandlerTimer(e.c,s,!1)}catch(e){}a=!0}if(r.LOG_ENABLED&&e.c!=this.ignnoreMsgCode){var l=JSON.stringify(e);n.log("%c(Socket,"+(a?"res":"ack")+") \u63a5\u6536\u6d88\u606f"+l,"color:green")}},e}();e.getInstance=function(){return t||(t=new a),t}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/X":"X","./SocketCore":"SocketCore"}],ReciverBase:[function(e,t,a){"use strict";cc._RF.push(t,"78212tcUzRGwr0BegvQnMiX","ReciverBase"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(){this._map={}}return e.prototype.Regist=function(){},e.prototype.Add=function(e,t){this._map[e]=t},e.prototype.Get=function(e){return this._map[e]},e}();a.ReciverBase=o,cc._RF.pop()},{}],ResponseBase:[function(e,t,a){"use strict";cc._RF.push(t,"4b01a5AqBpELb6+JKXajKVu","ResponseBase"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ErrorUtils"),n=function(){function e(){}return e.prototype.ResponseHandle=function(e){try{this.Handler(e)}catch(a){var t=new o.ErrorInfo;t.funcName="ResponseHandle::Handle ",t.errMsgInfo=a,e&&(t.customInfo=JSON.stringify(e)),o.ErrorUtils.errorMessage(t)}},e.prototype.Handler=function(e){},e}();a.default=n,cc._RF.pop()},{"../../System/ErrorUtils":"ErrorUtils"}],Socket:[function(e,t,a){"use strict";cc._RF.push(t,"b2f37nSN+BLY6rAzdGuLK3t","Socket"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("./SocketCore"),i=e("../../fws/utils/X"),r=e("../../fws/task/FWSTask"),s=e("../../System/JSWrap"),l=e("../../Game/Const/GameDefine"),c=e("../../fws/platforms/PlatformCore"),d=e("../../Game/Common/BIManager"),p=e("./NetReciver");(function(e){e[e.NORMAL=0]="NORMAL",e[e.ON_ERROR_REQ=1]="ON_ERROR_REQ",e[e.ON_CLOSE_REQ=2]="ON_CLOSE_REQ"})(o||(o={}));var u=function(){function e(e){this._states=n.SocketStates.CLOSED,this._connectReqStatus=o.NORMAL,this._ignoreMsgCode=0,this._hostIpAccLineMap={},this.reconnectOnCloseEnabled=!0,this._startConnectTime=0,this._delegate=e,this._taskListBeforeConnectRequest=new r.TaskList,this._taskListBeforeConnectRequest.onCompleted={target:this,handler:this.onTaskCompleted},this._taskListBeforeConnectRequest.onError={target:this,handler:this.onTaskError},this._taskListBeforeConnectRequest.onProgress={target:this,handler:function(){}}}return Object.defineProperty(e.prototype,"connectHost",{get:function(){return this._connectHost},enumerable:!0,configurable:!0}),e.prototype.onTaskCompleted=function(e,t){i.log("(Socket) onTaskCompleted this = ",this),i.log("(Socket) onTaskCompleted this.doConnect = ",this.doConnect),d.default.Instance.PostAction("SocketConnect"),this.doConnect(this._connectReqStatus),i.log("(Socket) \u524d\u7f6e\u4efb\u52a1\u5168\u90e8\u5b8c\u6210")},e.prototype.onTaskError=function(e,t){i.log("(Socket) \u524d\u7f6e\u4efb\u52a1\u5931\u8d25");var a=!1;this._reconnectTimes<n.CONNECT_RETRY_TIMES&&(a=!0,this._reconnectTimes++,i.log("(Socket) \u7b2c%d\u6b21\u91cd\u8fde",this._reconnectTimes),t.reset(),s.default.setTimeout(function(){t.begin()},1e3));try{this._delegate&&this._delegate.onError&&this._delegate.onError.call(this._delegate.target,a)}catch(e){i.error(e)}},Object.defineProperty(e.prototype,"taskListBeforeConnectRequest",{get:function(){return this._taskListBeforeConnectRequest},enumerable:!0,configurable:!0}),e.prototype.getAccAddress=function(e){return this._hostIpAccLineMap[e]},e.prototype.setAccAddress=function(e,t){this._hostIpAccLineMap[e]=t},e.prototype.onOpen=function(){this._reconnectTimes=0,s.default.clearTimeout(this._timeOutHandler),n.LOG_ENABLED&&i.log("%c(Socket) \u8fde\u63a5\u6210\u529f","color:green"),l.TraceReport({resp:"socket\u8fde\u63a5\u8bf7\u6c42\u6210\u529f",host:this._connectHost,time:this._webSocket.connectTime||Date.now()-this._startConnectTime}),this._states=n.SocketStates.CONNECTED;try{this._delegate&&this._delegate.onConnect&&this._delegate.onConnect.call(this._delegate.target)}catch(e){i.error(e)}},e.prototype.onError=function(){s.default.clearTimeout(this._timeOutHandler),l.TraceReport({resp:"socket\u8fde\u63a5\u8bf7\u6c42\u5931\u8d25",host:this._connectHost}),n.LOG_ENABLED&&i.log("%c(Socket) \u8fde\u63a5\u5931\u8d25","color:red"),this.close(),this._connectReqStatus=o.ON_ERROR_REQ;var e=this.reConnect();try{this._delegate&&this._delegate.onError&&this._delegate.onError.call(this._delegate.target,e)}catch(e){i.error(e)}},e.prototype.onClose=function(){s.default.clearTimeout(this._timeOutHandler),n.LOG_ENABLED&&i.trace("%c(Socket) \u8fde\u63a5\u88ab\u65ad\u5f00","color:red"),l.TraceReport({resp:"socket\u8fde\u63a5\u5df2\u65ad\u5f00",host:this._connectHost}),this.close();var e=!1;this.reconnectOnCloseEnabled&&(this._reconnectTimes=0,this._connectReqStatus=o.ON_CLOSE_REQ,this.reConnect()&&(e=!0));try{this._delegate&&this._delegate.onClose&&this._delegate.onClose.call(this._delegate.target,e)}catch(e){i.error(e)}},e.prototype.onMessage=function(e){if(!n.TEST_BLOCK_RECEIVE){var t=e.data,a=null;try{var o=e.receiveTime||(new Date).getTime();(a=JSON.parse(t)).c!=this._ignoreMsgCode&&this._delegate&&this._delegate.onReceive&&this._delegate.onReceive(a,t.length,o),this._delegate&&this._delegate.onMessage&&this._delegate.onMessage.call(this._delegate.target,a,o)}catch(e){i.error(e)}}},e.prototype.connect=function(e,t,a){this._states===n.SocketStates.CLOSED&&(n.LOG_ENABLED&&i.trace("(Socket) \u51c6\u5907\u8bf7\u6c42\u8fde\u63a5 "+e),this._reconnectTimes=0,this._host=e,this._fallbackHost=t,this._ignoreMsgCode=a,p.getInstance().ignnoreMsgCode=this._ignoreMsgCode,this.beginTasks(o.NORMAL))},e.prototype.reConnect=function(){var e=this;return this.close(),!(this._reconnectTimes>=n.CONNECT_RETRY_TIMES)&&(this._reconnectTimes++,i.log("(Socket) \u7b2c%d\u6b21\u91cd\u8fde",this._reconnectTimes),s.default.clearTimeout(this._reconnectHandler),this._reconnectHandler=s.default.setTimeout(function(){e.beginTasks(e._connectReqStatus)},1e3),!0)},e.prototype.beginTasks=function(e){void 0===e&&(e=o.NORMAL),this._connectReqStatus=e,this._taskListBeforeConnectRequest.reset(),this._taskListBeforeConnectRequest.begin()},e.prototype.doConnect=function(e){var t=this;void 0===e&&(e=o.NORMAL);try{this._timeOutHandler&&s.default.clearTimeout(this._timeOutHandler)}catch(e){i.warn("(Socket) clearTimeout")}try{this._timeOutHandler=s.default.setTimeout(function(){t.onConnectTimeout(t)},this.getTimeout())}catch(e){i.warn("(Socket) setTimeout")}try{this._delegate&&this._delegate.onRequestConnect&&this._delegate.onRequestConnect.call(this._delegate.target)}catch(e){i.warn("(Socket) onRequestConnect")}i.log("(Socket) \u771f\u7684\u5f00\u59cb\u8bf7\u6c42\u8fde\u63a5");var a=!1;if(e===o.ON_ERROR_REQ&&this._reconnectTimes>n.CONNECT_RETRY_TIMES/2&&this._fallbackHost)this._connectHost=this._fallbackHost,a=!0,i.log("\u4f7f\u7528fallback host: "+this._fallbackHost+" \u539f\u59cbhost: "+this._host);else{var r=this.getAccAddress(this._host);this._connectHost=r||this._host,r&&i.log("\u4f7f\u7528\u52a0\u901fhost: "+r+" \u539f\u59cbhost: "+this._host)}l.TraceReport({resp:"\u8bf7\u6c42socket\u8fde\u63a5",host:this._connectHost,custom:a?"fallback":"normal"}),this._webSocket=new WebSocket(this._connectHost),this._webSocket.onopen=this.onOpen.bind(this),this._webSocket.onclose=this.onClose.bind(this),this._webSocket.onmessage=this.onMessage.bind(this),this._webSocket.onerror=this.onError.bind(this),this._states=n.SocketStates.CONNECTING,this._startConnectTime=Date.now()},e.prototype.getTimeout=function(){return 1e3*(n.CONNECT_TIMEOUT+this._reconnectTimes*n.CONNECT_TIMEOUT_ADD)},e.prototype.onConnectTimeout=function(e){if(!e.reConnect())try{e._delegate&&e._delegate.onTimeOut&&e._delegate.onTimeOut.call(e._delegate.target)}catch(e){i.error(e)}},e.prototype.send=function(e){if(this._states===n.SocketStates.CONNECTED)try{var t=JSON.stringify(e);this._webSocket.send(t),n.LOG_ENABLED&&!c.instance.socketPackEncrypt&&e.c!=this._ignoreMsgCode&&i.log("%c(Socket,req) \u53d1\u9001\u6d88\u606f: "+t,"color:blue")}catch(e){i.error(e)}},e.prototype.close=function(){if(this._states===n.SocketStates.CONNECTED||this._states===n.SocketStates.CONNECTING){if(s.default.clearTimeout(this._reconnectHandler),s.default.clearTimeout(this._timeOutHandler),this._webSocket){n.LOG_ENABLED&&i.trace("(Socket) \u91ca\u653e\u8fde\u63a5"),l.TraceReport({resp:"socket\u91ca\u653e\u8fde\u63a5",host:this._connectHost});try{this._webSocket.onclose=this._webSocket.onerror=this._webSocket.onmessage=this._webSocket.onopen=null}catch(e){i.error(e)}this._webSocket.close(),this._webSocket=null}this._states=n.SocketStates.CLOSED}},Object.defineProperty(e.prototype,"states",{get:function(){return this._states},enumerable:!0,configurable:!0}),e}();a.default=u,cc._RF.pop()},{"../../Game/Common/BIManager":"BIManager","../../Game/Const/GameDefine":"GameDefine","../../System/JSWrap":"JSWrap","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/task/FWSTask":"FWSTask","../../fws/utils/X":"X","./NetReciver":"NetReciver","./SocketCore":"SocketCore"}],SocketCore:[function(e,t,a){"use strict";var o;cc._RF.push(t,"9ad6frzwxVDL72gYPpI81BS","SocketCore"),function(e){e.IDLE_INTERVAL=10,e.IDLE_OVER=5,e.LOGIC_IDLE_OVER=5,e.CONNECT_TIMEOUT=3,e.CONNECT_TIMEOUT_ADD=1,e.CONNECT_RETRY_TIMES=5,e.AUTO_CONNECT_TIMEOUT=15,e.SEND_LIMIT_COUNT=5,e.LOG_ENABLED=!1,e.TIMER_TRACE=!0,e.TEST_BLOCK_RECEIVE=!1,e.TEST_SAVE_REQUEST_ID=!1,e.TEST_SAVE_REQUEST_ID_TABLE={},function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.CLOSED=2]="CLOSED"}(e.SocketStates||(e.SocketStates={})),function(e){e[e.NONE=0]="NONE",e[e.EASY=1]="EASY"}(e.SocketPackCryptoMode||(e.SocketPackCryptoMode={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],WebClient:[function(e,t,a){"use strict";cc._RF.push(t,"0b0b6Fgw5pC1Yq9dZMocn7a","WebClient");var o,n=e("../../fws/utils/HttpUtils"),i=e("../../System/ErrorUtils"),r=e("../../fws/platforms/PlatformCore"),s=e("../../fws/utils/X"),l=e("../../fws/utils/ErrorReport");(function(e){function t(t,a,o,n){if(e.WEB_REQUEST_TIMER_TRACE)try{var i=(new Date).getTime();0;var r=t.indexOf("?"),s=r>=0?t.substring(0,r):t,c=r>=0?t.substr(r):"";l.trace({uri:s,data:c,resp:a,time:i-o,status:n},"http")}catch(e){}}function a(e,t,a,o){for(var n=[],r=4;r<arguments.length;r++)n[r-4]=arguments[r];try{if(!o)return;o.apply(a,n)}catch(a){s.error(a);var l=new i.ErrorInfo;l.errMsgInfo=a,l.funcName=e,l.customInfo=t,i.ErrorUtils.errorMessage(l)}}e.WEB_REQUEST_TIMER_TRACE=!0,e.GET_OVERTIME=3e4,e.POST_OVERTIME=3e4,e.uriChecker=function(e,t){if(!t)return e;var a=e+"",o=Object.keys(t);if(0===o.length)return a;a.indexOf("?")<0&&(a+="?");for(var n=0;n<o.length;n++){var i=o[n],r=t[i];a+="&"+i+"="+(r=encodeURIComponent(r))}return a},e.postChecker=function(e){if("object"!=typeof e)return"";var t=new Array,a=0;for(var o in e)t[a]=o+"="+encodeURIComponent(e[o]),a++;return t.join("&")},e.get=function(o,i,l,c,d,p,u){if(void 0===p&&(p=!0),void 0===u&&(u=0),!n.URL.isUrl(o))return s.error("\u65e0\u6548\u7684URL\u5730\u5740",o),null;var h=function(e){e.onerror=null,e.ontimeout=null,e.onreadystatechange=null},m=(new Date).getTime(),f=new XMLHttpRequest,_=e.uriChecker?e.uriChecker(o,i):o;return f.open("GET",_),f.timeout=u||r.instance.requestTimeout||e.GET_OVERTIME,f.setRequestHeader("content-type","text/plain;charset=UTF-8"),p||f.setRequestHeader("Cache-Control","no-store"),f.onerror=function(){4!=f.readyState&&(h(f),t(_,"GET",m,f.status),a("WebClient.get=>onerror",_,l,d,f,!1),f.abort())},f.ontimeout=function(){h(f),t(_,"GET",m,-99999),a("WebClient.get=>ontimeout",_,l,d,f,!0),f.abort()},f.onreadystatechange=function(){4===f.readyState&&(f.status>=200&&f.status<300||304==f.status?(h(f),t(_,"GET",m,0),a("WebClient.get=>onsuccess",_,l,c,f)):f.status>=0&&(h(f),t(_,"GET",m,f.status||-1),a("WebClient.get=>onerror",_,l,d,f,!1),f.abort()))},f.send(),f},e.post=function(o,i,l,c,d,p){if(!n.URL.isUrl(o))return s.error("\u65e0\u6548\u7684URL\u5730\u5740",o),null;var u=(new Date).getTime(),h=new XMLHttpRequest,m=e.uriChecker?e.uriChecker(o,i):o;return h.open("POST",m,!0),h.timeout=r.instance.requestTimeout||e.POST_OVERTIME,h.setRequestHeader("content-type","application/x-www-form-urlencoded"),h.onerror=function(){4!=h.readyState&&(t(m,"POST",u,h.status),a("WebClient.post=>onerror",m,c,p,h,!1),h.abort())},h.ontimeout=function(){t(m,"POST",u,-99999),a("WebClient.post=>ontimeout",m,c,p,h,!0),h.abort()},h.onreadystatechange=function(){4==h.readyState&&(h.status>=200&&h.status<300||304==h.status?(t(m,"POST",u,0),a("WebClient.post=>onsuccess",m,c,d,h)):h.status>=0&&(t(m,"POST",u,h.status),a("WebClient.post=>onerror",m,c,p,h,!1),h.abort()))},e.postChecker&&(l=e.postChecker(l)),h.send(l),h}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../System/ErrorUtils":"ErrorUtils","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/HttpUtils":"HttpUtils","../../fws/utils/X":"X"}],CDNSwitcher:[function(e,t,a){"use strict";cc._RF.push(t,"d2a1aWB/xRBE63oyVp1df+C","CDNSwitcher");var o,n=e("../../fws/platforms/PlatformCore");(function(e){var t=!0;e.notify=function(e,a){t&&n.instance.switchCDN()}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../fws/platforms/PlatformCore":"PlatformCore"}],GetCompentToAdd:[function(e,t,a){"use strict";cc._RF.push(t,"e2eadNA63hB7bokaGwa2g5a","GetCompentToAdd"),Object.defineProperty(a,"__esModule",{value:!0});cc.Node;a.GetCompentToAdd=function(e,t){if(null!=e){var a=e.getComponent(t);return a||e.addComponent(t)}},cc._RF.pop()},{}],NumUtil:[function(e,t,a){"use strict";cc._RF.push(t,"82fc0VriIJNtZB0ObUPMrr1","NumUtil"),Object.defineProperty(a,"__esModule",{value:!0}),a.default={toInt:function(e,t){if(void 0===t&&(t=0),void 0===e)return t;if(e==1/0)return t;var a=parseInt(e,0);return!0===isNaN(a)?t:a},toFloat:function(e,t){if(void 0===t&&(t=0),void 0==e)return t;if(e==1/0)return t;var a=parseFloat(e);return!0===isNaN(a)?t:a}},cc._RF.pop()},{}],Random:[function(e,t,a){"use strict";cc._RF.push(t,"6fe5akW0bJOqroEYpaH+PQb","Random"),Object.defineProperty(a,"__esModule",{value:!0}),a.GetRandomNum=function(e,t){var a=t-e,o=Math.random();return e+Math.round(o*a)},a.GetRandomFloat=function(e,t){var a=t-e;return e+Math.random()*a},a.GetUniqueRandomNum=function(e,t,a){if(e==t)return e;var o=Math.floor(e+Math.random()*(t-e));return o>=a&&o++,o},cc._RF.pop()},{}],SetPosition:[function(e,t,a){"use strict";cc._RF.push(t,"a46a9kSz+dLOKsQqoGBjdkD","SetPosition"),Object.defineProperty(a,"__esModule",{value:!0}),a.SetPosition=function(e,t,a){if(void 0===a&&(a=cc.Vec2.ZERO),e&&t&&e.parent&&t.parent){var o=e.parent.convertToWorldSpaceAR(e.position),n=t.parent.convertToNodeSpaceAR(o);n=n.add(a),t.setPosition(n)}},a.SetPositionByWorldPos=function(e,t,a){if(void 0===a&&(a=cc.Vec2.ZERO),t&&t.parent){var o=t.parent.convertToNodeSpaceAR(e);o=o.add(a),t.setPosition(o)}},a.GetPosition=function(e,t){if(e&&t&&e.parent&&t.parent){var a=e.parent.convertToWorldSpaceAR(e.position);return t.parent.convertToNodeSpaceAR(a)}return cc.Vec2.ZERO},a.GetWorldPosPosition=function(e){return e&&e.parent?e.parent.convertToWorldSpaceAR(e.position):cc.Vec2.ZERO},cc._RF.pop()},{}],StringUtil:[function(e,t,a){"use strict";cc._RF.push(t,"e057bO9e0RAR7ySqwVCp9J/","StringUtil"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Common/LocalManager"),n=e("./NumUtil"),i=function(){function e(){}return e.getFileName=function(e){return e.substring(e.lastIndexOf("/")+1)},e.getShortFileName=function(t){var a=e.getFileName(t);return a.substring(0,a.lastIndexOf("."))},e.getFileExt=function(t){var a=e.getFileName(t);return a.substring(a.lastIndexOf(".")+1,a.length)},e.formatPercent=function(e){var t=String(100*e),a=t.split(".");if(2==a.length){t=a[0];var o=Math.floor(Number(a[1].substr(0,1)));Math.floor(Number(a[1].substr(1,1)))>4&&(o+=1),t+="."+o}else t=a[0];return t+"%"},e.formatNumber=function(e){var t=String(e);if(e<1e3)return t;var a="",o=t.indexOf("."),n=0,i=0,r=0;if(o>=0){for((i=(n=o)%3)>0&&(a+=t.slice(0,i)+","),r=i;r<n;)a+=t.slice(r,r+3),(r+=3)<n&&(a+=",");a+=t.slice(o,-1)}else for((i=(n=t.length)%3)>0&&(a+=t.slice(0,i)+","),r=i;r<n;)a+=t.slice(r,r+3),(r+=3)<n&&(a+=",");return a},e.formatTimeSecondsToSimplify=function(e){var t,a,n,i,r,s=0,l=0,c=0;(c=Math.floor(e%60),t=Math.floor((e-c)/60),l=Math.floor(t%60),a=Math.floor((t-l)/60),s=Math.floor(a/24),c<10)?n="0"+c.toString():n=c.toString();l<10?i="0"+l.toString():i=l.toString();a%24<10?r="0"+(a%24).toString():r=(a%24).toString();return a>=24?s.toString()+o.LOCAL.getText("100004")+(0!=a?r+o.LOCAL.getText("100005"):"")+(0!=l?i+o.LOCAL.getText("100006"):"")+(0!=c?n+o.LOCAL.getText("100007"):""):a>0?r+o.LOCAL.getText("100005")+(0!=l?i+o.LOCAL.getText("100006"):"")+(0!=c?n+o.LOCAL.getText("100007"):""):i+o.LOCAL.getText("100006")+(0!=c?n+o.LOCAL.getText("100007"):"")},e.formatTimers=function(t,a){void 0===a&&(a=3);var o="",n=0,i=n=Math.floor(t/3600),r=0;n>=24&&(n-=24*(r=Math.floor(Math.floor(n/24))));var s;s=Math.floor((t-3600*i)/60);var l=Number(t-3600*i-60*s);return r>0?o+=r+"d ":a>3&&(o+="0d:"),n>0?o+=e.padNumber(n)+":":a>2&&(o+="00:"),s>0?o+=e.padNumber(s)+":":a>1&&(o+="00:"),o+=e.padNumber(l)},e.formatTimersNew=function(e){var t="",a=Math.floor(e/3600),n=Math.floor(e%3600/60),i=e%60,r=Math.floor(a/24);return a%=24,r>0&&(t+=r+o.LOCAL.getText("100004")+"  "),t+=a>=10?a+":":"0"+a+":",t+=n>=10?n+":":"0"+n+":",t+=i>=10?i:"0"+i},e.padNumber=function(t,a){return void 0===a&&(a=2),e.leftPad(String(t),a,"0")},e.leftPad=function(e,t,a){if(void 0===a&&(a=" "),e.length<t){for(var o="";o.length+e.length<t;)o+=a;return o+e}return e},e.getTimeStr=function(e){if((e=n.default.toInt(e))<=0)return"0s";var t=e/1e3;return t>=0?t.toFixed(1)+"s":String(e)},e.cutStr=function(e,t){for(var a="",o=e.length,n=(e.replace(/[^\x00-\xff]/g,"aa").length,0),i=0;i<o;i++){var r=e.charAt(i);if(/[^\x00-\xff]/g.test(r)?n+=2:n++,n>t)break;a+=r}return a},e.getStrShowCount=function(e){var t=e;t=t.replace(/\s+/g," ");for(var a=0,o=0;o<t.length;o++)t.charCodeAt(o)>255?a+=1:a+=.6;return a},e}();a.default=i,cc._RF.pop()},{"../Common/LocalManager":"LocalManager","./NumUtil":"NumUtil"}],UpdateSpriteFrame:[function(e,t,a){"use strict";cc._RF.push(t,"b8a37f5gG5JtbtJA4T+eToD","UpdateSpriteFrame"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Game/Data/GlobalData"),n=e("../../Game/Common/LoadManager"),i=e("../../Game/Tools/GameTools"),r=e("../../fws/utils/X"),s=e("../../fws/display/factory/FWSAssertCaches"),l=e("../../fws/utils/HttpUtils"),c=e("../../Game/components/ImageLoader"),d=e("../../Game/controllers/G123IPContentProvider");function p(e,t,a,o){if(void 0===a&&(a=null),void 0===o&&(o=!1),e){e=d.default.Instance.getImagePath(e);var i=t;if(i&&i.isValid){var s=/^\s*res:/i;if(s.test(e))u(e=e.replace(s,""),t,a);else if(o){var l=t.getComponent(c.default);l||(l=t.addComponent(c.default)),l.loadWithCallback(e,a)}else n.LoadManager.loadSpriteFrame(e,function(t,o){if(!t&&i)try{i.node&&(i.spriteFrame=o),a&&a()}catch(t){r.log("UpdateSpriteFrame "+e+" catch:"+t)}else r.log("UpdateSpriteFrame "+e+" error:"+t)},null)}else r.log("UpdateSpriteFrame sprite is nul "+e)}}function u(e,t,a,i){if(void 0===a&&(a=null),void 0===i&&(i=!1),e&&t&&t.isValid){var r=function(e){t.isValid&&(t.spriteFrame=e);try{a&&a()}catch(e){}},d=e;if(l.isUrl(d)||(d=o.GLOBAL.ResourceUrl+"/DynRes/images/"+e),i){var p=t.getComponent(c.default);p||(p=t.addComponent(c.default)),p.loadWithCallback(d,a)}else{var u=s.getSpriteFrame(d);if(u)return void r(u);n.LoadManager.load(d,function(e,t){if(!e&&t){var a=new cc.SpriteFrame(t);s.SpriteFrameCaches.set(d,a),r(a)}})}}}function h(e){return e=(e=(e="http"!=e.substr(0,4)?i.default.GetIconURL(e):i.default.fixIconUrl(e)).replace(/^https:\/+/,"https://")).replace(/^http:\/+/,"http://")}a.UpdateSpriteFrame=p,a.UpdateSpriteFrameByRemoteUrl=u,a.getAvatarImageUrl=h,a.UpdateSpriteFrameByWXUrl=function(e,t,a){void 0===a&&(a=""),o.GLOBAL.UserIconDic[e]?t.spriteFrame=o.GLOBAL.UserIconDic[e]:e?(e=h(e),r.log("UpdateSpriteFrameByWXUrl:",e),f(e,t,a)):p(a,t)};var m={};function f(e,t,a){void 0===a&&(a="");var s=t,l=a,c=e=(e=e.replace(/^https:\/+/,"https://")).replace(/^http:\/+/,"http://");if(i.default.verifyComponent(s)&&e.length>0){m[t.node.uuid]=e;var d=e+"?t="+(new Date).getDate().toString()+".jpg";n.LoadManager.load(d,function(t,a){if(t||r.info("UpdateSpriteFrameByUrl fail: ",e),i.default.verifyComponent(s)&&m[s.node.uuid]===c){if(t)p(l,s),r.log(t);else{var n=new cc.SpriteFrame(a);try{s.spriteFrame=n,o.GLOBAL.UserIconDic[c]=n}catch(t){r.warn("UpdateSpriteFrameByUrl "+e+" catch:"+t),p(l,s)}}m[s.node.uuid]=null}})}else p(l,s),r.log("updateSprite sprite is nul::"+e)}a.UpdateSpriteFrameByUrl=f,a.UpdatePrefabNode=function(e,t){if(e){var a=t;a?n.LoadManager.loadPrefab(e,function(t,o){if(!t&&a)try{var n=cc.instantiate(o);n&&(n.parent=a)}catch(e){r.log(e)}else r.log("UpdatePrefabNode "+e+" error:"+t)}):r.log("UpdatePrefabNode perfab is nul::"+e)}},cc._RF.pop()},{"../../Game/Common/LoadManager":"LoadManager","../../Game/Data/GlobalData":"GlobalData","../../Game/Tools/GameTools":"GameTools","../../Game/components/ImageLoader":"ImageLoader","../../Game/controllers/G123IPContentProvider":"G123IPContentProvider","../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../fws/utils/HttpUtils":"HttpUtils","../../fws/utils/X":"X"}],BIManager:[function(e,t,a){"use strict";cc._RF.push(t,"6b3d0zC3zJD4otEdfVq9cAT","BIManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Data/DataCenter"),n=e("./PFOpenData"),i=e("../../fws/utils/X");var r=window.RiverBI;var s=function(){function e(){this._AppVersion="",this.stepTime=[];var e="",t="";o.DATA.UserData&&(0!=o.DATA.UserData.UID&&(e=o.DATA.UserData.UID.toString()),null!=o.DATA.UserData.OpenId&&(t=o.DATA.UserData.OpenId)),this.BIupdate(e,t,this.AppVersion,"",n.default.Instance.UnionId||"")}return Object.defineProperty(e,"Instance",{get:function(){return null==e._Instance&&(e._Instance=new e),e._Instance},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._Instance=null},Object.defineProperty(e.prototype,"AppVersion",{get:function(){return""!=this._AppVersion?this._AppVersion:(this._AppVersion=window.GameVersion,""!=this._AppVersion&&void 0!=this._AppVersion||(this._AppVersion="1.0.0"),this._AppVersion)},enumerable:!0,configurable:!0}),e.prototype.PostAction=function(e,t){window.logTime&&window.logTime(e);var a=this.getExtraData();if(t)for(var o in a.customData={},t)a.customData[o]=t[o];this.BIsend(e,a)},e.prototype.PostActionWithTime=function(e,t,a){if(void 0===a&&(a={}),!(t<0||t>100)){this.stepTime[t]||(this.stepTime[t]=(new Date).getTime());var o=(new Date).getTime();(o<this.stepTime[t]||o-this.stepTime[t]>12e4)&&(this.stepTime[t]=o),a.steptime=o-this.stepTime[t],this.PostExtraAction(e,a),this.stepTime[t]=o}},e.prototype.PostUserGuide=function(e){if(!window.OnlineServer&&e&&console.log("postUSerGuide ==== "+e.guideid),null!=e){var t=this.getExtraData();t.guideid=e.guideid,this.BIsend("NewUserGuide",t)}},e.prototype.PostOpenUI=function(e){var t=this.getExtraData();t.uiName=e,t.UIID=this.getTempUuid(),this.BIsend("OpenUI",t)},e.prototype.PostPayAction=function(e,t){if(window.OnlineServer&&void 0!=t){var a=this.getExtraData();a.productid=t.productid,a.num=t.num,a.money=t.money,a.orderid=t.orderid,null!=t.ret&&(a.ret=t.ret),this.BIsend(e,a)}},e.prototype.PostShareData=function(e,t,a,o,n){void 0===n&&(n=0);var i=this.getExtraData();i.type=o,i.ShareID=a,"WXShareAppMessageRet"==e&&(i.ret=0),i.sharePointId=t,i.shareWriterId=0,i.shareImageId=n,i.shareNodeId=o,i.shareto=0,i.sharefrom=o,this.BIsend(e,i)},e.prototype.PostChatData=function(e,t,a,o,n,i,r){var s=this.getExtraData();s.type=e,s.contents=t,s.fromname=a,null!==o&&void 0!==o&&(s.touid=o),null!==o&&void 0!==o&&(s.toname=n),null!==o&&void 0!==o&&(s.allianceid=i),null!==o&&void 0!==o&&(s.alliance=r),this.BIsend("SendMessage",s)},e.prototype.getShareLogId=function(){return this.getTempUuid()},e.prototype.getTempId=function(){var e=window.BIUtils;if(e&&e.tempId)return e.tempId},e.prototype.getTempUuid=function(){var e=(new Date).getTime();return 0!=o.DATA.UserData.UID?o.DATA.UserData.UID.toString()+e.toString():"900999999"+e.toString()},e.prototype.PostResponseTime=function(e,t){var a=this.getExtraData();t&&(a.respTime=t),e&&(a.reqId=e),this.BIsend("ResponseTime",a)},e.prototype.PostExtraAction=function(e,t){var a=this.getExtraData();if(null!==t&&void 0!==t)for(var o in t)null!==t[o]&&void 0!==t[o]&&(a[o]=t[o]);this.BIsend(e,a)},e.prototype.getExtraData=function(){var e=0;return null!=o.DATA.UserData&&(e=o.DATA.UserData.Level),{admaterail:n.default.Instance.Admaterail,ShareID:n.default.Instance.ShareId,InviterID:n.default.Instance.InviterID,InviteType:n.default.Instance.InviteType,From:n.default.Instance.From,adid:n.default.Instance.Adid,adtype:n.default.Instance.AdType,level:e,systeminfo:window.systemInfo}},e.prototype.BIupdate=function(e,t,a,o,n){var r=window.ELEX_BI;null!=r?r.updateGameBiInfo(e,t,a,o,n):i.log("BI send error:",r)},e.prototype.BIsend=function(e,t){var a=window.ELEX_BI;null!=a?a.toBI(e,t):i.log("BI send error:",a)},e.prototype.BIgotoOther=function(e,t,a,o){var n=window.ELEX_AD;if(null!=n){var r={uid:e,success:t,fail:a,complete:o};n.gotoOther(r)}else i.log("AD send error:",n)},e.prototype.BIgetADInfo=function(){var e=window.ELEX_AD;if(null!=e)return e.getADInfo();i.log("AD send error:",e)},e.prototype.PostAllianceScienceDonate=function(e,t,a){var o=this.getExtraData();o.allianceSid=e,o.allianceScienceId=t,o.UIID=this.getTempUuid(),this.BIsend("AllianceScienceDonate",a)},e.postBI=function(e,t){void 0===t&&(t={}),o.DATA.ServerTime&&(t.server_time=o.DATA.ServerTime),r&&r.sendToBI(e,t)},e.updateBIInfo=function(e){r&&r.updateInfo(e)},e._Instance=null,e}();a.default=s,cc._RF.pop()},{"../../Platform/river_bi":"river_bi","../../fws/utils/X":"X","../Data/DataCenter":"DataCenter","./PFOpenData":"PFOpenData"}],BaseUI:[function(e,t,a){"use strict";cc._RF.push(t,"092b6kXiA1EOZu9s+nbCiVR","BaseUI"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("./UIManager"),i=e("../../Core/Utils/GetCompentToAdd"),r=e("../../Core/Event/EventCenter"),s=e("../Const/EventId"),l=e("../../fws/utils/X"),c=e("../Tools/GameTools"),d=e("../Data/DataCenter"),p=e("../Const/RequestId"),u=e("../../fws/platforms/PlatformCore"),h=cc._decorator,m=h.ccclass,f=h.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.UIName="",t._para=null,t.UIPushId=0,t._LastPushTime=0,t.UseAni=!1,t}return __extends(t,e),t.prototype.cpnLoad=function(){l.time("ComponentBase::cpnLoad"),i.GetCompentToAdd(this.node,"cc.BlockInputEvents"),this._closeBtn=cc.find("closeBtn",this.node),null==this._closeBtn&&(this._closeBtn=cc.find("btn_close",this.node)),this.AddBtnSound(),l.timeEnd("ComponentBase::cpnLoad")},t.prototype.AddBtnSound=function(){var e=this.node.getComponentsInChildren(cc.Button);if(null!==e&&void 0!==e&&e.length>0)for(var t=0;t<e.length;t++)i.GetCompentToAdd(e[t].node,"ButtonPlaySound")},t.prototype.PlaySound=function(){},t.prototype.cpnStart=function(){},t.prototype.cpnEnable=function(){0},t.prototype.cpnDisable=function(){this.UnRegistSystemPush()},t.prototype.onKeyDown=function(e){var t=n.default.Instance().CurrentUIDataInfo;e&&e.keyCode===cc.macro.KEY.back&&this.dataInfo&&t&&this.dataInfo.name===t.name&&this.close()},t.prototype.reuse=function(){},t.prototype.unuse=function(){},t.prototype.onClose=function(e){if(e.target){var t=e.target.parent;if(t){var a=t.getComponent("BaseUI");a&&n.default.Instance().Close(a.UIName)}}},t.prototype.onShow_Init=function(e){var t=this;this.onShow(e);var a=1;if(u.instance.isPad()&&!this.dataInfo.ignorePadAdaptor&&(a=c.default.getPadRatio()),this.dataInfo.openAnime>0){var o=this.node.getComponent(cc.Animation);if(null!=o)o.play();else if(1==this.dataInfo.openAnime||3==this.dataInfo.openAnime){this.node.opacity=0,this.node.scale=.5;var n=cc.spawn(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.05,a)),cc.fadeIn(.1)),i=this.cpnCallFunc(function(a){t.onScaleShowFinished(e)},this.node,this),r=cc.sequence(n,i);this.node.runAction(r)}else if(2==this.dataInfo.openAnime);else if(4==this.dataInfo.openAnime){this.node.opacity=0,this.node.scale=.5;n=cc.spawn(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.05,a)),cc.fadeIn(.13)),i=this.cpnCallFunc(function(a){t.onScaleShowFinished(e)},this.node,this),r=cc.sequence(n,i);this.node.runAction(r)}else 5==this.dataInfo.openAnime&&(this.node.scale=a)}else this.node.scale=a},t.prototype.afterClose=function(){},t.prototype.playBefCloseAni=function(){var e=this;if(1==this.dataInfo.openAnime||5==this.dataInfo.openAnime){l.log("close-play_ani_fubin: ",this.dataInfo.name);var t=cc.spawn(cc.scaleTo(.2,.1).easing(cc.easeBackIn()),cc.fadeOut(.2)),a=this.cpnCallFunc(function(t){n.default.Instance().LastCloseUI(e.dataInfo)},this.node,this),o=cc.sequence(t,cc.delayTime(.05),a);return this.node.runAction(o),!0}if(2==this.dataInfo.openAnime)return r.EVENT.emit(s.EventId.BuildingListHide),!0;if(3==this.dataInfo.openAnime)return!1;if(4==this.dataInfo.openAnime){t=cc.spawn(cc.scaleTo(.1,.1).easing(cc.easeBackIn()),cc.fadeOut(.1)),a=this.cpnCallFunc(function(t){n.default.Instance().LastCloseUI(e.dataInfo)},this.node,this),o=cc.sequence(t,cc.delayTime(.05),a);return this.node.runAction(o),!0}return!1},t.prototype.close=function(){n.default.Instance().CloseUI(this.dataInfo)},t.prototype.onShow=function(e){var t=this.getComponent(cc.Widget);if(null!=t&&0==t.top&&0==t.bottom){var a=cc.view.getVisibleSize();a.height/a.width>2&&(t.top=65280/1125,t.bottom=0)}r.EVENT.emit(s.EventId.GuideNodeOnUI,this.node),this.RegistSystemPush()},t.prototype.onScaleShowFinished=function(e){},t.prototype.onScaleShowMax=function(e){},t.prototype.cpnUpdate1000MS=function(t){e.prototype.cpnUpdate1000MS.call(this,t),this._LastPushTime>0&&d.DATA.ServerTime-this._LastPushTime>50&&(this._LastPushTime=d.DATA.ServerTime,this.RegistSystemPush())},t.prototype.RegistSystemPush=function(){0!=this.UIPushId&&this.RegistOrUnRegist(p.RequestId.RegisterSystemPush)},t.prototype.UnRegistSystemPush=function(){0!=this.UIPushId&&this.RegistOrUnRegist(p.RequestId.UnregisterSystemPush)},t.prototype.RegistOrUnRegist=function(e){var t={id:this.UIPushId};c.default.SendMessageToServer(e,t)},__decorate([f],t.prototype,"UseAni",void 0),t=__decorate([m],t)}(o.default);a.default=_,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Utils/GetCompentToAdd":"GetCompentToAdd","../../System/ComponentBase":"ComponentBase","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/X":"X","../Const/EventId":"EventId","../Const/RequestId":"RequestId","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools","./UIManager":"UIManager"}],ChatChangeTip:[function(e,t,a){"use strict";cc._RF.push(t,"1bc11GkWINOPpylGupphsBE","ChatChangeTip"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("../Tools/GameTools"),i=cc._decorator,r=i.ccclass,s=i.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nameLabel=null,t}return __extends(t,e),t.prototype.showChatChangeTip=function(e,t,a){var o=this;this.node.stopAllActions(),this.node.active=!0;var i=cc.v2(0,0),r=e;if(n.default.verifyNode(r)&&n.default.verifyNode(r.parent)){var s=r.parent.convertToWorldSpaceAR(r.position);i=this.node.parent.convertToNodeSpaceAR(s)}this.nameLabel.string=t,i.x+=a,i.y+=97.825,this.node.setPosition(i),this.node.scale=0,this.node.opacity=255,this.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.delayTime(1),cc.fadeOut(.2),cc.callFunc(function(){o.node.active=!1},this)))},__decorate([s(cc.Label)],t.prototype,"nameLabel",void 0),t=__decorate([r],t)}(o.default);a.default=l,cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase","../Tools/GameTools":"GameTools"}],CommonIconTips:[function(e,t,a){"use strict";cc._RF.push(t,"b871cmswPNNmLdo8TB9pjV3","CommonIconTips"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("../../Core/Utils/UpdateSpriteFrame"),i=e("../Tools/GameTools"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BaseNode=null,t.Content=null,t.Icon=null,t._Playing=!1,t}return __extends(t,e),t.prototype.ShowTips=function(e,t){this._Playing||(this.BaseNode.active=!0,this.Content.string=i.default.CutStringInMaxLength(e,17),n.UpdateSpriteFrame(t,this.Icon),this.StartAnime())},t.prototype.StartAnime=function(){this.BaseNode.stopAllActions(),this.BaseNode.setPosition(new cc.Vec2(0,600)),this.BaseNode.opacity=1;var e=cc.moveTo(.5,new cc.Vec2(0,300));e.easing(cc.easeBackInOut());var t=cc.spawn(e,cc.fadeIn(.4)),a=cc.moveTo(.4,new cc.Vec2(0,250));a.easing(cc.easeBackInOut());var o=cc.spawn(a,cc.fadeOut(.3)),n=cc.callFunc(this.AnimeFinish,this),i=cc.sequence(t,cc.delayTime(1),o,n);this.BaseNode.runAction(i)},t.prototype.AnimeFinish=function(){this._Playing=!1,this.BaseNode.opacity=0},__decorate([l(cc.Node)],t.prototype,"BaseNode",void 0),__decorate([l(cc.Label)],t.prototype,"Content",void 0),__decorate([l(cc.Sprite)],t.prototype,"Icon",void 0),t=__decorate([s],t)}(o.default);a.default=c,cc._RF.pop()},{"../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../System/ComponentBase":"ComponentBase","../Tools/GameTools":"GameTools"}],ConfigCommon:[function(e,t,a){"use strict";var o;cc._RF.push(t,"ea6bdR1gK1Aw6TtetyxU7nW","ConfigCommon"),function(e){(function(e){e[e.ground=101]="ground",e[e.sea=201]="sea",e[e.air=301]="air"})(e.ArmyTypes||(e.ArmyTypes={})),function(e){e[e.Biz=0]="Biz",e[e.Image=1]="Image",e[e.Icon=2]="Icon",e[e.Prefab=3]="Prefab"}(e.IconSourceType||(e.IconSourceType={})),function(e){e[e.None=0]="None",e[e.PlayerLevel=1]="PlayerLevel",e[e.TechLevel=2]="TechLevel",e[e.AdventureLevel=3]="AdventureLevel",e[e.Power=4]="Power"}(e.AreaUnlockConditionTypes||(e.AreaUnlockConditionTypes={})),function(e){e[e.None=0]="None",e[e.Coin=1]="Coin",e[e.Soil=2]="Soil",e[e.Oil=3]="Oil",e[e.Gold=4]="Gold",e[e.Item=5]="Item"}(e.AreaUnlockCostTypes||(e.AreaUnlockCostTypes={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],ConfirmPanel:[function(e,t,a){"use strict";cc._RF.push(t,"94d74CjvYpI0Z9dxvtSAxJv","ConfirmPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./UIManager"),n=e("../Const/UIDataInfo"),i=e("./BaseUI"),r=e("../../System/ErrorUtils"),s=e("../../fws/utils/FWSTool"),l=e("../../Core/Common/LocalManager"),c=e("../Module/Item/PropItem"),d=e("../../Core/Utils/StringUtil"),p=cc._decorator,u=p.ccclass,h=p.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabTitle=null,t.LabContent=null,t.richTextContent=null,t.LabBtnSure=null,t.LabBtnCancle=null,t.BtnCancle=null,t.BtnSure=null,t.BtnClose=null,t.MarkToggle=null,t.sureBtnResIcon=null,t.sureBtnResCnt=null,t.rewardNode=null,t.propItem=null,t.blackNode=null,t._closeWithCancelCallback=!0,t._closeViewByCallBack=!1,t}return __extends(t,e),t.ShowView=function(e,t,a,i,r,s,l,c,d,p,u,h,m,f,_){void 0===a&&(a=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=""),void 0===l&&(l=""),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===p&&(p=0),void 0===u&&(u=!0),void 0===h&&(h=!1),void 0===m&&(m=0),void 0===f&&(f=!1),void 0===_&&(_=!1);var y={content:e,title:t,delegate:a,sureCallBack:i,cancelCallBack:r,btnSureString:s,btnCancleString:l,showMark:c,forceConfirm:f,useRichText:!1,swapBtnPos:d,gold:p,closeWithCancelCallback:u,closeViewByCallback:h,itemId:m,showBlackBack:_};o.default.Instance().OpenUI(n.UIDataInfo.ConfirmPanel,y)},t.ShowForceConfirm=function(e,t,a,i,r){void 0===r&&(r="");var s={content:e,title:t,delegate:a,sureCallBack:i,cancelCallBack:null,btnSureString:r,btnCancleString:"",showMark:!1,forceConfirm:!0,useRichText:!1,swapBtnPos:!1,gold:0,closeWithCancelCallback:!1,closeViewByCallback:!1};o.default.Instance().OpenUI(n.UIDataInfo.ConfirmPanel,s)},t.ShowViewByRichText=function(e,t,a,i,r,s,l,c,d){void 0===a&&(a=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=""),void 0===l&&(l=""),void 0===c&&(c=!1),void 0===d&&(d=!0);var p={content:e,title:t,delegate:a,sureCallBack:i,cancelCallBack:r,btnSureString:s,btnCancleString:l,showMark:c,forceConfirm:!1,useRichText:!0,swapBtnPos:!1,gold:0,closeWithCancelCallback:d,closeViewByCallback:!1};o.default.Instance().OpenUI(n.UIDataInfo.ConfirmPanel,p)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t);var a=t[0];if(a){var o=a.useRichText;this.blackNode.active=!0,s.Obj.isEmpty(o)&&(o=!1),o?(this.richTextContent.string=a.content,this.LabContent.node.active=!1,this.richTextContent.node.active=!0):(this.LabContent.node.active=!0,this.richTextContent.node.active=!1,d.default.getStrShowCount(a.content)>30?this.LabContent.horizontalAlign=cc.Label.HorizontalAlign.LEFT:this.LabContent.horizontalAlign=cc.Label.HorizontalAlign.CENTER,this.LabContent.string=a.content),""!=a.title?this.LabTitle.string=a.title:this.LabTitle.string=l.LOCAL.getText("100127"),this._Delegate=a.delegate,this._SureCallBack=a.sureCallBack,this._CancelCallBack=a.cancelCallBack,this._closeViewByCallBack=a.closeViewByCallback;var n=a.btnSureString;!s.Obj.isEmpty(n)&&n.length>0&&(this.LabBtnSure.string=n);var i=a.btnCancleString;!s.Obj.isEmpty(i)&&i.length>0&&(this.LabBtnCancle.string=i),this.BtnCancle.active=!s.Obj.isEmpty(this._CancelCallBack);var r=a.showMark;s.Obj.isEmpty(r)?this.MarkToggle.node.active=!1:this.MarkToggle.node.active=r;var p=a.forceConfirm;if(s.Obj.isEmpty(p)?this.BtnClose.active=!0:this.BtnClose.active=!p,a.swapBtnPos&&(this.BtnSure.setSiblingIndex(1),this.BtnCancle.setSiblingIndex(2)),a.gold>0?(this.sureBtnResIcon.active=!0,this.sureBtnResCnt.active=!0,this.sureBtnResCnt.getComponent(cc.Label).string=a.gold.toString(),this.LabBtnSure.node.width=100):(this.sureBtnResIcon.active=!1,this.sureBtnResCnt.active=!1,this.LabBtnSure.node.width=210),a.closeWithCancelCallback||(this._closeWithCancelCallback=!1),a.itemId){this.LabContent.node.y=70,this.rewardNode.active=!0,this.rewardNode.safetyDestroyAllChildren();var u=cc.instantiate(this.propItem);u.getComponent(c.default).UpdateItem(a.itemId),u.parent=this.rewardNode}else this.LabContent.node.y=39,this.rewardNode.active=!1}},t.prototype.OnCancelClick=function(){var e=!1;if(0==this._closeViewByCallBack&&o.default.Instance().CloseUI(n.UIDataInfo.ConfirmPanel),null!=this._Delegate&&null!=this._CancelCallBack)try{e=this._CancelCallBack.call(this._Delegate)}catch(e){var t=this.getError(e,"OnCloseClick");t.customInfo=this.LabContent.string+":"+this.LabTitle.string,r.ErrorUtils.errorMessage(t)}this._closeViewByCallBack&&(e||o.default.Instance().CloseUI(n.UIDataInfo.ConfirmPanel))},t.prototype.OnSureClick=function(){var e=!1;0==this._closeViewByCallBack&&o.default.Instance().CloseUI(n.UIDataInfo.ConfirmPanel);var t=!1;if(1==this.MarkToggle.node.active&&(t=this.MarkToggle.isChecked),null!=this._Delegate&&null!=this._SureCallBack)try{e=this._SureCallBack.call(this._Delegate,t)}catch(e){var a=this.getError(e,"OnSureClick");a.customInfo=this.LabContent.string+":"+this.LabTitle.string,r.ErrorUtils.errorMessage(a)}this._closeViewByCallBack&&(e||o.default.Instance().CloseUI(n.UIDataInfo.ConfirmPanel))},t.prototype.OnCloseClick=function(){var e=!1;if(0==this._closeViewByCallBack&&o.default.Instance().CloseUI(n.UIDataInfo.ConfirmPanel),this._Delegate&&this._CancelCallBack&&this._closeWithCancelCallback)try{e=this._CancelCallBack.call(this._Delegate)}catch(e){var t=this.getError(e,"OnCloseClick");t.customInfo=this.LabContent.string+":"+this.LabTitle.string,r.ErrorUtils.errorMessage(t)}this._closeViewByCallBack&&(e||o.default.Instance().CloseUI(n.UIDataInfo.ConfirmPanel))},t.HeroTalentExchangePopCloseConfirm=!0,__decorate([h(cc.Label)],t.prototype,"LabTitle",void 0),__decorate([h(cc.Label)],t.prototype,"LabContent",void 0),__decorate([h(cc.RichText)],t.prototype,"richTextContent",void 0),__decorate([h(cc.Label)],t.prototype,"LabBtnSure",void 0),__decorate([h(cc.Label)],t.prototype,"LabBtnCancle",void 0),__decorate([h(cc.Node)],t.prototype,"BtnCancle",void 0),__decorate([h(cc.Node)],t.prototype,"BtnSure",void 0),__decorate([h(cc.Node)],t.prototype,"BtnClose",void 0),__decorate([h(cc.Toggle)],t.prototype,"MarkToggle",void 0),__decorate([h(cc.Node)],t.prototype,"sureBtnResIcon",void 0),__decorate([h(cc.Node)],t.prototype,"sureBtnResCnt",void 0),__decorate([h(cc.Node)],t.prototype,"rewardNode",void 0),__decorate([h(cc.Prefab)],t.prototype,"propItem",void 0),__decorate([h(cc.Node)],t.prototype,"blackNode",void 0),t=__decorate([u],t)}(i.default);a.default=m,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Utils/StringUtil":"StringUtil","../../System/ErrorUtils":"ErrorUtils","../../fws/utils/FWSTool":"FWSTool","../Const/UIDataInfo":"UIDataInfo","../Module/Item/PropItem":"PropItem","./BaseUI":"BaseUI","./UIManager":"UIManager"}],ErrorMsgPanel:[function(e,t,a){"use strict";cc._RF.push(t,"00e159HvJJL3pGx6BUYLg32","ErrorMsgPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./UIManager"),n=e("../Const/UIDataInfo"),i=e("./BaseUI"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabContent=null,t.BtnClose=null,t._clickNum=0,t}return __extends(t,e),t.ShowView=function(e){o.default.Instance().OpenUI(n.UIDataInfo.ErrorMsgPanel,e)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),this.LabContent.string=t[0]},t.prototype.OnCloseClick=function(){this._clickNum<2?this._clickNum+=1:o.default.Instance().CloseUI(n.UIDataInfo.ErrorMsgPanel)},__decorate([l(cc.Label)],t.prototype,"LabContent",void 0),__decorate([l(cc.Node)],t.prototype,"BtnClose",void 0),t=__decorate([s],t)}(i.default);a.default=c,cc._RF.pop()},{"../Const/UIDataInfo":"UIDataInfo","./BaseUI":"BaseUI","./UIManager":"UIManager"}],G123PayModel:[function(e,t,a){"use strict";cc._RF.push(t,"249ebzeus5A85+biEpB+7QO","G123PayModel");var o=e("../../fws/utils/X"),n=e("../../fws/utils/FWSTool"),i=e("../../fws/mvc/FWSMvc"),r=e("../../fws/utils/LocalStorageUtils"),s=e("../../Core/Net/NetMgr"),l=e("../Const/RequestId"),c=e("./BIManager"),d=e("../Tools/GameTools"),p=e("../controllers/ExchangeController"),u=e("../../Core/Common/LocalManager"),h=e("../Data/DataCenter"),m=e("../Profession/ProfessionController"),f=e("../../fws/platforms/PlatformCore"),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.tryLocalOrder=function(){return!1},t.prototype.onFMessage_LOGIN_SUCCESS=function(e){return this.tryLocalOrder()&&console.info("(\u5e10\u5355) \u767b\u5f55\u540e\u8865\u53d1\u5e10\u5355"),!0},t.prototype.onFMessage_PayMsgsRequest=function(e){if(this.tryLocalOrder())return console.info("(\u5e10\u5355) \u8865\u53d1\u4e0a\u6b21\u5e10\u5355"),!0;var t=null;if(n.Obj.isEmpty(e.data))return!0;if(e.data.id){var a=p.ExchangeController.Instance.getCanPayExchangeConfigById(e.data.id);a&&(e.data.name=u.LOCAL.getText(n.Obj.getPropertyStringByNames(a,"","name")))}var i=(t={guid:n.Str.guid(),id:e.data.id,product_id:e.data.product_id,price:e.data.price,buyQuantity:10*e.data.price,time:(new Date).getTime()},e.data.id,e.data.name);i={mode:"game",env:0,offerId:"",currentType:"JPY",platform:"G123",zoneId:"1",buyQuantity:t.buyQuantity,exchangeId:e.data.id,name:e.data.name},this.saveOrder(t),console.info("(\u5e10\u5355) \u51c6\u5907 \u53d1\u8d77 \u652f\u4ed8\u8bf7\u6c42",i);var r=window.OnlineServer?0:1;return this.getTokenAndOrderNo({exchangeId:i.exchangeId,name:i.name,isTest:r,pf:window.SubPlatform},function(e){window.CpSdk?(o.log('window["CpSdk"].SendPayment(data) start!!!!!!'),o.log(e),window.CpSdk.SendPayment(e)):o.log("CpSdk is null\uff01\uff01\uff01")}),!0},t.prototype.saveOrder=function(e){r.set("CurrentPayOrder",e),c.default.Instance.PostPayAction("PayBuy",{productid:e.id.toString(),num:1,money:e.price,orderid:e.guid})},t.prototype.loadOrder=function(){try{var e=r.get("CurrentPayOrder");return n.Obj.isEmpty(e)?null:(new Date).getTime()-e.time>2592e6?null:e}catch(e){return null}},t.prototype.removeOrder=function(){r.del("CurrentPayOrder")},t.prototype.sendToServer=function(e){console.info("(\u5e10\u5355) \u63d0\u4ea4\u670d\u52a1\u5668",e);var t={exchangeId:e.id,product_id:e.product_id,price:e.price,buyQuantity:e.buyQuantity,guid:e.guid,time:e.time,errMsg:e.errMsg,errCode:e.errCode};s.NET.send(l.RequestId.SendPayToServer,t,this,function(e){})},t.prototype.getTokenAndOrderNo=function(e,t){console.info("\u83b7\u53d6G123\u652f\u4ed8\u8ba2\u5355token\u548corderid",e),s.NET.send(l.RequestId.GetG123PayInfo,e,this,function(e){var a=d.default.JSON_PARSE(e.d);t(a)})},t.prototype.onFMessage_PayToServerPush=function(e){var t=e.data;return!!n.Obj.isEmpty(t)||(this.parseServerPayInfo(t),d.default.playG123SoundPathByName("pay_finished"),!0)},t.prototype.parseServerPayInfo=function(e){var t=1,a="",i=-1;o.log("(\u5e10\u5355) \u670d\u52a1\u5668\u8fd4\u56de",e);do{if(null===e)break;1===n.Obj.getPropertyNumberByNames(e,0,"result")&&(t=0),a=n.Obj.getPropertyStringByNames(e,"","orderId"),i=n.Obj.getPropertyNumberByNames(e,-1,"exchangeId"),n.Obj.getPropertyStringByNames(e,"","productId")}while(0);this.biPayBuyRet(t,a,i),r.set("G123_Pay_VIP","1"),this.removeOrder()},t.prototype.biPayBuyRet=function(e,t,a){var i=!1;do{var r=t,s=this.loadOrder();if(r.length<=0){if(null===s)break;r=s.guid}var l=null;if(a<0){if(null===s)break;l=s.id.toString()}else l=a.toString();var d=null,_=p.ExchangeController.Instance.getExchangeConfigById(a);if(_&&(d=n.Obj.getPropertyNumberByNames(_,null,"product_id")),null===d){if(null===s)break;d=s.price}i=!0,c.default.Instance.PostPayAction("PayBuyRet",{productid:l,num:1,money:d,orderid:r,ret:e});var y=f.instance.getCurrentCountry();if(window.rg_fbq&&"US"===y&&window.OnlineServer){var g=f.instance.getPayPriceShow(a);window.rg_fbq("track","Purchase",{value:g,currency:"JPY"})}else o.log("rg_fbq is null or US != "+y);var C="Unknown";_&&_.name&&(C=u.LOCAL.getText(_.name)),window.OnlineServer&&window.top.postMessage(JSON.stringify({action:"g_obtain",data:{game_server_id:h.DATA.UserData.ServerId+"",game_user_id:h.DATA.UserData.UID+"",role_id:h.DATA.UserData.UID+"",role_level:h.DATA.UserData.Level,role_vip_level:h.DATA.UserData.VipLevel,virtual_balance1:h.DATA.UserData.Resource.Gold,role_exp:h.DATA.UserData.Exp,role_vip_exp:h.DATA.UserData.VipExp,role_power:Number(h.DATA.UserData.Power),item_type:"gift",item_count:1,item_id:a,item_name:C,role_custom:JSON.stringify({talent:m.default.Instance.getLatestTalentId(),reg_server_id:h.DATA.UserData.RegisterServerId+""})}}),"*");var v=n.Str.format("(\u5e10\u5355) BI PayBuyRet \u53d1\u9001\u6210\u529f ret = {0}, bi_productid = {1},  bi_orderId = {2}, bi_money = {3}",e,l,r,d);o.log(v)}while(0);if(i);else{v=n.Str.format("(\u5e10\u5355) BI PayBuyRet \u53d1\u9001\u5931\u8d25 ret = {0}, server_orderId = {1},  server_exchangeId = {2}",e,t,a);o.log(v)}},t.prototype.onFMessage_Dev_PayMsgsRequest=function(e){if(e&&e.data&&e.data.id){var t=p.ExchangeController.Instance.getCanPayExchangeConfigById(e.data.id);t&&(e.data.name=u.LOCAL.getText(n.Obj.getPropertyStringByNames(t,"","name")))}return this.onFMessage_PayMsgsRequest(e)},t}(i.FMessageConnectionAbstract);t.exports=_,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Const/RequestId":"RequestId","../Data/DataCenter":"DataCenter","../Profession/ProfessionController":"ProfessionController","../Tools/GameTools":"GameTools","../controllers/ExchangeController":"ExchangeController","./BIManager":"BIManager"}],GM:[function(e,t,a){"use strict";cc._RF.push(t,"33828Sp8+5LUZrzfAhHItf+","GM");var o,n=e("../../fws/platforms/PlatformCore");(function(e){var t=!1,a=!1,o="";e.update=function(e){t=!(!e||!e.isGM),a=!(!e||!e.isMod),o=e&&e.modFlag?e.modFlag:""},e.updateMod=function(e){a=!(!e||!e.isMod),o=e&&void 0!=e.modFlag?e.modFlag:""},e.isMod=function(){return a},e.isMessageMod=function(){return"tmod"==o||"mod"==o},e.isProhibitMod=function(){return"smod"==o||"mod"==o},e.modFlag=function(){return o},e.is=function(){return!!n.instance.needDevOptions()||t},e.commands=[]})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../fws/platforms/PlatformCore":"PlatformCore"}],FrameTaskManager:[function(e,t,a){"use strict";cc._RF.push(t,"40fb4TB7fpCI6DCL34KcGtK","FrameTaskManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ErrorUtils"),n=function(){return function(e,t){this.name="",this.taskFun=null,this.forceInOneFrame=!1,this.name=t,this.taskFun=e}}();a.FrameTask=n;var i=function(){function e(){this.taskQueue=null,this.taskQueue=new Array}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),e._instance},e.prototype.purge=function(){e._instance=null},e.prototype.addTask=function(e){this.taskQueue.push(e)},e.prototype.removeTask=function(e){for(var t=[],a=0;a<this.taskQueue.length;a++){(o=this.taskQueue[a]).name===e&&t.push(a)}for(a=t.length-1;a>=0;a--){var o=t[a];this.taskQueue.splice(o,1)}},e.prototype.working=function(e){for(var t=Date.now();;){if(this.taskQueue.length<=0)break;var a=this.taskQueue.shift();try{a.taskFun&&a.taskFun()}catch(e){var n=new o.ErrorInfo;n.errMsgInfo=e,n.funcName=a.name,n.customInfo="FrameTask Error",o.ErrorUtils.errorMessage(n)}var i=Date.now()-t;if(i>=15||a.forceInOneFrame)break}},e._instance=null,e}();a.FrameTaskManager=i,cc._RF.pop()},{"../../../System/ErrorUtils":"ErrorUtils"}],LoadManager:[function(e,t,a){"use strict";cc._RF.push(t,"271c0Y8ldFNxpSR+MgOqX8k","LoadManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("../../System/ErrorUtils"),i=e("../../fws/utils/X"),r=e("../controllers/G123IPContentProvider"),s=function(){function e(){}return Object.defineProperty(e,"loadCostTime",{get:function(){return e._loadCostTime},enumerable:!0,configurable:!0}),e.loadPrefabSync=function(t,a,o){void 0===a&&(a=null),void 0===o&&(o=null),t?null===e.loadSyncCache[t]||void 0===e.loadSyncCache[t]?(e.loadSyncCache[t]=!0,e.loadResource("loadPrefab",t,cc.Prefab,a,o)):i.log("loadPrefabSync is loading"):i.error("loadPrefab url=null")},e.loadPrefab=function(t,a,o){if(void 0===a&&(a=null),void 0===o&&(o=null),t){var n=r.default.Instance.getPrefabPath(t);e.loadResource("loadPrefab",n,cc.Prefab,a,o)}else i.error("loadPrefab url=null")},e.loadSpriteFrame=function(t,a,o){if(void 0===a&&(a=null),t){var n=t.replace(/^resources\//,"").replace(/(.*)\.[^/]+$/,"$1");0!=n.indexOf("UI/")&&0!=n.indexOf("image/alliance/alliance_union_gift_")&&0!=n.indexOf("image/large/scratch_icon_")&&0!=n.indexOf("image/mainui/Capsule_Easter")||(n=e.fixPicPath(n)),e.loadResource("loadSpriteFrame",n,cc.SpriteFrame,a,o)}else i.error("loadSpriteFrame url=null")},e.fixPicPath=function(e){return 0==e.indexOf("UI/hero_icon")?e.replace("UI/hero_icon","image/hero_icon"):0==e.indexOf("UI/hero_skill")?e.replace("UI/hero_skill","image/hero_skill"):0==e.indexOf("UI/ea_icon_army")?e.replace("UI/ea_icon_army","image/icon_army"):0==e.indexOf("UI/icon_army_small")?e.replace("UI/icon_army_small","image/icon_army_small"):0==e.indexOf("UI/ea_icon_production")?e.replace("UI/ea_icon_production","image/icon_production"):0==e.indexOf("UI/professionTalent")?e.replace("UI/professionTalent","image/professionTalent"):0==e.indexOf("UI/talent")?e.replace("UI/talent","image/talent"):0==e.indexOf("UI/ea_common/item_")?e.replace("UI/ea_common/item_","image/item/item_"):0==e.indexOf("UI/ea_common/Item_")?e.replace("UI/ea_common/Item_","image/item/Item_"):0==e.indexOf("UI/ea_common/enhance_")?e.replace("UI/ea_common/enhance_","image/enhance/enhance_"):0==e.indexOf("UI/ea_common/alliance_science_")?e.replace("UI/ea_common/alliance_science_","image/alliance_science/alliance_science_"):0==e.indexOf("image/alliance/alliance_union_gift_")?e.replace("image/alliance/alliance_union_gift_","image/large/alliance/alliance_union_gift_"):0==e.indexOf("image/large/scratch_icon_")?e.replace("image/large/scratch_icon_","image/scratch_icon/scratch_icon_"):0==e.indexOf("image/mainui/Capsule_Easter")?e.replace("image/mainui/Capsule_Easter","image/Capsule_Easter/Capsule_Easter"):e},e.doCallbackResource=function(t,a,o,n,r,s){if(delete e.loadSyncCache[t],e.loadSyncCache[t]=null,r)i.error("failed to load "+t+": "+r.message);else if(a&&!a.isLive());else if(o)try{var l=performance.now();o(null,s);var c=performance.now();c>l&&(e._loadCostTime+=c-l)}catch(o){e.errorFunction(n+"->loadResource()",o,"res:"+t,a)}},e.loadResource=function(t,a,o,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),!a)return!1;if(cc.loader.loadResSync){var r=cc.loader.loadResSync(a,o);if(r)return cc.assetReleaseChecker.lockAsset(r),void cc.director.once(cc.Director.EVENT_BEFORE_UPDATE,function(){cc.assetReleaseChecker.unlockAsset(r),e.doCallbackResource(a,i,n,t,null,r)})}return cc.loader.loadRes(a,o,function(o,r){e.doCallbackResource(a,i,n,t,o,r)}),!0},e.load=function(t,a,o){if(void 0===o&&(o=null),t){cc.loader.load(t,function(n,i){try{a&&a(n,i)}catch(a){e.errorFunction("LoadManager->load->callback",a,"res:"+t,o)}})}else e.errorFunction("LoadManager->load",new Error("path not exist"),"param error",o)},e.loadResourceDir=function(t,a,o,n){if(t){var i=function(a,o,i){try{n&&n(a,o,i)}catch(a){e.errorFunction("loadResourceDir->completeCallback",a,"res:"+t,null)}};o?cc.loader.loadResDir(t,a,function(a,n,i){try{o&&o(a,n,i)}catch(a){e.errorFunction("loadResourceDir->progressCallback",a,"res:"+t,null)}},i):cc.loader.loadResDir(t,a,i)}else e.errorFunction("loadResourceDir",new Error("path not exist"),"param error",null)},e.loadResourceArray=function(t,a,o){if(t&&0!=t.length){var n=t[0],i=function(t,a){try{o&&o(t,a)}catch(t){e.errorFunction("loadResourceArray->completeCallback",t,"res:"+n,null)}};a?cc.loader.loadResArray(t,function(t,o,i){try{a&&a(t,o,i)}catch(t){e.errorFunction("loadResourceArray->progressCallback",t,"res:"+n,null)}},i):cc.loader.loadResArray(t,i)}else e.errorFunction("loadResourceArray",new Error("urlList not exist"),"param error",null)},e.errorFunction=function(e,t,a,i){t=t||new Error("unknow error");var r=null;i&&i.isLive()&&(i instanceof o.default&&(r=i.getError(t,e)));r||((r=new n.ErrorInfo).errMsgInfo=t,r.funcName=e),r.customInfo=a,n.ErrorUtils.errorMessage(r)},e._loadCostTime=0,e.loadSyncCache={},e}();a.LoadManager=s,cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase","../../System/ErrorUtils":"ErrorUtils","../../fws/utils/X":"X","../controllers/G123IPContentProvider":"G123IPContentProvider"}],MessageInfoPanel:[function(e,t,a){"use strict";cc._RF.push(t,"f1befG54ERLdqRyn8Ux7v3/","MessageInfoPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./BaseUI"),n=e("./UIManager"),i=e("../Const/UIDataInfo"),r=e("../Tools/GameTools"),s=e("../../Core/Common/SoundManager"),l=e("../Const/SoundPath"),c=cc._decorator,d=c.ccclass,p=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabTitle=null,t.LabContent=null,t.TextNode=null,t.RewardNode=null,t.RewardContent=null,t.mixNode=null,t.mixLabContent=null,t.mixRewardContent=null,t}return __extends(t,e),t.prototype.cpnLoad=function(){s.SOUND.playClip(l.SoundPath.Click_Tip)},t.ShowView=function(e,t){n.default.Instance().OpenUI(i.UIDataInfo.MessageInfoPanel,1,e,t)},t.ShowViewRewardType=function(e,t){n.default.Instance().OpenUI(i.UIDataInfo.MessageInfoPanel,2,e,t)},t.ShowViewRewardAndText=function(e,t,a){n.default.Instance().OpenUI(i.UIDataInfo.MessageInfoPanel,3,e,t,a)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t);var a=t[0];if(this.TextNode.active=1==a,this.RewardNode.active=2==a,this.mixNode.active=3==a,1==a){var o=t[1].toString(),n=t[2].toString();this.LabTitle.string=n,this.LabContent.string=o}else if(2==a){this.LabTitle.string=t[2].toString(),this.RewardContent.safetyDestroyAllChildren();var i=parseInt(t[1].toString());r.default.AddRewardToNode(this.RewardContent,i,0,!0,!0)}else if(3==a){this.LabTitle.string=t[2].toString();i=parseInt(t[1].toString());r.default.AddRewardToNode(this.mixRewardContent,i,0,!0,!0),this.mixLabContent.string=t[3]}},t.prototype.onCloseClick=function(){n.default.Instance().CloseUI(i.UIDataInfo.MessageInfoPanel)},__decorate([p(cc.Label)],t.prototype,"LabTitle",void 0),__decorate([p(cc.Label)],t.prototype,"LabContent",void 0),__decorate([p(cc.Node)],t.prototype,"TextNode",void 0),__decorate([p(cc.Node)],t.prototype,"RewardNode",void 0),__decorate([p(cc.Node)],t.prototype,"RewardContent",void 0),__decorate([p(cc.Node)],t.prototype,"mixNode",void 0),__decorate([p(cc.Label)],t.prototype,"mixLabContent",void 0),__decorate([p(cc.Node)],t.prototype,"mixRewardContent",void 0),t=__decorate([d],t)}(o.default);a.default=u,cc._RF.pop()},{"../../Core/Common/SoundManager":"SoundManager","../Const/SoundPath":"SoundPath","../Const/UIDataInfo":"UIDataInfo","../Tools/GameTools":"GameTools","./BaseUI":"BaseUI","./UIManager":"UIManager"}],PFOpenData:[function(e,t,a){"use strict";cc._RF.push(t,"1d663AZfrBDsou+kT7WcIcT","PFOpenData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../Data/DataCenter"),i=e("../../Core/Net/NetMgr"),r=e("../Const/RequestId"),s=e("./UIManager"),l=e("../../System/ErrorUtils"),c=e("../Tools/GameTools"),d=e("../../fws/utils/LocalStorageUtils"),p=e("../../fws/platforms/PlatformCore"),u=e("../../Core/Event/EventCenter"),h=e("../Const/EventId"),m=e("../Const/UIDataInfo"),f=e("../components/worldmap/WorldMapCommon"),_=e("../../fws/utils/X"),y=e("../Const/GameDefine"),g=e("../ShareSDK/RGShareInterface"),C=function(){function e(){this._ShareServerId=-1,this._channel="",this._scene="",this._admaterail="",this._unionId="",this._inviterID="",this._shareId="",this._inviteType="",this._from="",this._adid="",this._gdt_vid="",this._adType=0,this._gaid="",this._cardId="",this._fbRequestId="",this._ShareTableId="",this._itemId="",this._activity=""}return Object.defineProperty(e,"Instance",{get:function(){return null==e._Instance&&(e._Instance=new e),e._Instance},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._Instance=null},e.prototype.InitPFOpenData=function(){var e=p.instance.getLaunchOptionsSync();try{y.TraceReport({resp:"InitPFOpenData",data:JSON.stringify(e)})}catch(e){}if(e.query.hasOwnProperty("shareOpenid")?this._inviterID=e.query.shareOpenid:this._inviterID="",e.query.hasOwnProperty("shareid")?this._shareId=e.query.shareid:this._shareId="",e.query.hasOwnProperty("unionid")?(this._unionId=e.query.unionid,_.log("\u5e7f\u544a\u8ffd\u8e2aid:"+e.query.unionid)):this._unionId="",e.query.hasOwnProperty("channel")&&void 0!==e.query.channel&&null!==e.query.channel&&""!==e.query.channel&&(_.log("\u6765\u81ea\u6e20\u9053:"+e.query.channel),this._channel=e.query.channel),e.query.hasOwnProperty("scene")){var t=decodeURIComponent(e.query.scene);if(t&&t.length>0&&0===t.indexOf("channel=")){var a=t.split("channel=")[1];void 0!==a&&null!==a&&a.length>0&&(_.log("\u6765\u81ea\u6e20\u9053:"+a),this._channel=a)}}if(_.log("InitPFOpenData-cardId:"+this._cardId+"  shareId:"+this._shareId),e.query.hasOwnProperty("shareboxid")?this._cardId=e.query.shareboxid+"":this._cardId="",e.query.hasOwnProperty("fbRequestId")?this._fbRequestId=e.query.fbRequestId:this._fbRequestId="",e.query.hasOwnProperty("sharetype")?this._inviteType=e.query.sharetype:this._inviteType="",e.query.hasOwnProperty("shareserverid")?this._ShareServerId=parseInt(e.query.shareserverid.toString()):this._ShareServerId=-1,e.query.hasOwnProperty("itemId")?this._itemId=e.query.itemId:this._itemId="",this._ShareTableId=this._inviteType,this._from=e.scene+"","1104"!=this._from&&"1023"!=this._from||d.set("IsFavWx","1"),e.hasOwnProperty("referrerInfo")&&(this._admaterail=e.referrerInfo.appId),this._adid=e.scene+"",e.hasOwnProperty("query")){var o=e.query;if(this._adType=0,o.hasOwnProperty("scene")){var n=String(o.scene).split("_");this._adid=n[0],n.length>1&&(this._admaterail=n[1]),this._adType=2}if(o.hasOwnProperty("type")&&("14"==o.type?this._adid="quntui":"21"==o.type&&(this._adid="tuiguang"),this._adType=3),o.hasOwnProperty("pid")&&(this._adid=o.pid,this._adType=4),o.hasOwnProperty("gdt_vid")&&(this._gdt_vid=o.gdt_vid),o.hasOwnProperty("qz_gdt")&&(this._gdt_vid=o.qz_gdt),o.hasOwnProperty("gd")&&(this._gdt_vid=(this._gdt_vid||"NULL")+","+o.gd),o.hasOwnProperty("weixinadinfo")){var i=o.weixinadinfo;if(i){var r=i.split(".");this._adid=r[0],r.length>1&&(this._admaterail=r[1]),this._adType=1}}o.hasOwnProperty("uid")&&(this._gaid=o.uid)}var s=p.instance.getSystemInfoSync();this._platform=null!=s?s.platform:"",void 0==this._shareId&&(this._shareId=""),void 0==this._inviterID&&(this._inviterID=""),void 0==this._inviteType&&(this._inviteType=""),void 0==this._admaterail&&(this._admaterail=""),void 0==this._adid&&(this._adid=""),void 0==this._gdt_vid&&(this._gdt_vid=""),void 0==this._from&&(this._from=""),void 0==this._gaid&&(this._gaid=""),void 0==this._adType&&(this._adType=0),void 0==this._cardId&&(this._cardId=""),void 0==this._fbRequestId&&(this._fbRequestId=""),void 0==this._ShareServerId&&(this._ShareServerId=-1),void 0==this._itemId&&(this._itemId="")},e.prototype.wxOnShow=function(e){try{this._wxOnShow(e)}catch(e){var t=new l.ErrorInfo;t.errMsgInfo=e,t.funcName="wxOnShow",t.customInfo="onShow",l.ErrorUtils.errorMessage(t)}},e.prototype._wxOnShow=function(t){var a=this;if(_.log("wx-onShowwwwwww-\u5fae\u4fe1\u8fd4\u56de\u5566-\u5f88\u5173\u952e:~~~~:",t),0!=n.DATA.UserData.UID){var l=e.LastTime;if(e.LastTime=n.DATA.ServerTime,!(n.DATA.ServerTime-l<3)){if(null==t&&(t=p.instance.getLaunchOptionsSync()),null!=t.scene&&(e.Instance._from=t.scene.toString(),1104!=t.scene&&1023!=t.scene||d.set("IsFavWx","1")),p.instance.enableFBAppRequest&&t.hasOwnProperty("query")&&t.query.hasOwnProperty("fbRequestId")){var y=t.query.fbRequestId;y&&i.NET.send(r.RequestId.GetFBAppRequestReward,{requestId:y})}var C=0,v="",I={};t.hasOwnProperty("shareTicket")&&(v=t.shareTicket),t.hasOwnProperty("query")&&(t.query.hasOwnProperty("sharetype")&&(C=t.query.sharetype),I=t.query,_.log("sharedata"+t.query),void 0!==I.channel&&null!==I.channel&&""!=I.channel&&(this._channel=I.channel),I.activity&&(this._activity=I.activity,n.DATA.UserData.UID>0&&i.NET.send(r.RequestId.PlatformActivityState,{activity:this._activity},this,function(e){if(null!=e.d&&""!=e.d&&0==e.s){var t=c.default.JSON_PARSE(e.d);a._activity=t&&t.activity?t.activity:"",_.log("PFOpenData.Instance.Activity:",a._activity)}}),_.log("activity:"+this._activity))),_.log("openType:"+C);var T=g.default.RGShareSDK_GetShareCfgById(C);if(null!=T){var S=T.share_type;if(_.log("openType-openType-openType-openType:"+S),5==S){var A={uid:D=t.query.uid};i.NET.send(r.RequestId.TENURE,A,this,function(e){e.d&&3!=e.s&&e.d.state&&null!=s.default.Instance()&&s.default.Instance().ShowTips(o.LOCAL.getNetMsgText(e.d.state))})}if(6==S){A={uid:D=t.query.uid};i.NET.send(r.RequestId.AddFriend,A,this,function(e){e.d&&3!=e.s&&e.d.state&&null!=s.default.Instance()&&s.default.Instance().ShowTips(o.LOCAL.getNetMsgText(e.d.state))})}if(13==S){A={uid:D=t.query.uid};i.NET.send(r.RequestId.RENDUOLILIANGDA,A,this,function(e){e.d&&3!=e.s&&e.d.state&&s.default.Instance().ShowTips(o.LOCAL.getNetMsgText(e.d.state))})}if(14==S){var D=t.query.uid;A={id:parseInt(t.query.daytaskid.toString()),uid:D};i.NET.send(r.RequestId.SpeedDailyTask,A,this,function(e){e.d&&3!=e.s&&e.d.state&&s.default.Instance().ShowTips(o.LOCAL.getNetMsgText(e.d.state))})}if(28==S&&null!=t.query.marchId&&null!=t.query.allianceId){var N=t.query.marchId.toString(),b=parseInt(t.query.allianceId.toString());_.warn("sharedata",t.query);var L=function(e){for(var t in n.DATA.UserData.AllianceAssemlbyDatas)if(n.DATA.UserData.AllianceAssemlbyDatas[t]&&n.DATA.UserData.AllianceAssemlbyDatas[t].marchId==e&&(n.DATA.UserData.AllianceAssemlbyDatas[t].marchState==f.MarchState.RALLY_ASSEMBLED||n.DATA.UserData.AllianceAssemlbyDatas[t].marchState==f.MarchState.INIT))return void s.default.Instance().OpenUI(m.UIDataInfo.AllianceAssemlbyDetailPanel,n.DATA.UserData.AllianceAssemlbyDatas[t]);s.default.Instance().ShowTips(o.LOCAL.getNetMsgText("share10010"))};n.DATA.UserData.Alliance.isInAlliance()&&n.DATA.UserData.Alliance.Aid==b?0==n.DATA.UserData.AllianceAssemlbyDatas.length?u.EVENT.once(h.EventId.AssemblysUpdate,function(){L(N)},this):L(N):s.default.Instance().ShowTips(o.LOCAL.getNetMsgText("share10009"))}if(0!=T.share_box_id){D=t.query.uid;var E=T.share_box_id;if(""!=v&&void 0!=v){A={id:T.share_box_id,uid:D,encryptedData:"encryptedData",iv:"iv",query:I};i.NET.send(r.RequestId.ClickSharebox,A)}else i.NET.send(r.RequestId.ClickSharebox,{id:E,uid:D,query:I},this,function(e){var t=c.default.JSON_PARSE(e.d);if(0==e.s&&702==E)null!=s.default.Instance()&&s.default.Instance().ShowTips(o.LOCAL.getText("100494"));else if(1201==E)if(_.log("804data",t),0==t.state)s.default.Instance().ShowTips(o.LOCAL.getText("110147"));else if(-1==t.state)s.default.Instance().ShowTips(o.LOCAL.getText("110148"));else if(t.armyid&&n.DATA.UserData.Level>=2){var a={serverReward:{resource:{gold:0,oil:0,voucher:0,honor:0,metal:0,coal:0,wood:0,soil:0,military:0,expedition_coin:0,jungong:0,coin:0},build:[],armys:[{itemId:t.armyid,itemCount:1}],hero:[],exp:0,giftExp:0,items:[],herosplit:[],giftKey:0,energy:0},isPay:!1,detail:o.LOCAL.getText("sharing_new_unit01")};s.default.Instance().OpenUI(m.UIDataInfo.CommonRewardPanel,a)}});if(702==E){if(null!=s.default.Instance()){var P="";if(t.query.hasOwnProperty("nickname")&&(P=t.query.nickname),P){var w=o.LOCAL.getText("100495",P);s.default.Instance().ShowTips(w)}else s.default.Instance().ShowTips(o.LOCAL.getText("100496"))}}else 901==E&&null!=s.default.Instance()&&s.default.Instance().ShowTips(o.LOCAL.getText("100497"))}}else _.log("\u5fae\u4fe1\u8fd4\u56de\u5566-shareData is nulllllll:"+C)}}else _.log("error-uid is 0")},Object.defineProperty(e.prototype,"NickName",{get:function(){return this._nickName||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Country",{get:function(){return this._country||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnionId",{get:function(){return this._unionId||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InviterID",{get:function(){return this._inviterID||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InviteType",{get:function(){return this._inviteType||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShareId",{get:function(){return this._shareId||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Admaterail",{get:function(){return this._admaterail||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"From",{get:function(){return this._from||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Platform",{get:function(){return this._platform||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Adid",{get:function(){return this._adid||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Gdt_vid",{get:function(){return this._gdt_vid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AdType",{get:function(){return this._adType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Gaid",{get:function(){return this._gaid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CardId",{get:function(){return this._cardId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FBRequestId",{get:function(){return this._fbRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShareServerId",{get:function(){return this._ShareServerId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemId",{get:function(){return this._itemId||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Channel",{get:function(){return this._channel||p.instance.platformSID+"_"+p.instance.platformNormalChannel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Activity",{get:function(){return this._activity||""},set:function(e){this._activity=e||""},enumerable:!0,configurable:!0}),e._Instance=null,e.LastTime=0,e}();a.default=C,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../System/ErrorUtils":"ErrorUtils","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../ShareSDK/RGShareInterface":"RGShareInterface","../Tools/GameTools":"GameTools","../components/worldmap/WorldMapCommon":"WorldMapCommon","./UIManager":"UIManager"}],SystemNotice:[function(e,t,a){"use strict";cc._RF.push(t,"95a8bAEpj1NdJa1hmHmBtWJ","SystemNotice"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("../Const/GameDefine"),i=e("../Const/EventId"),r=e("../../Core/Event/EventCenter"),s=e("../Tools/GameTools"),l=e("../../Core/Common/LocalManager"),c=cc._decorator,d=c.ccclass,p=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabText=null,t.BaseNode=null,t.NoticeRunning=!1,t.NoticeList=[],t}return __extends(t,e),t.prototype.NoticeByNoticeData=function(e){e.Text.length>400||(this.NoticeList.push(e),1!=this.NoticeRunning&&this.StartOneNotice())},t.prototype.cpnLoad=function(){this.BaseNode&&(this.BaseNode.opacity=0)},t.prototype.StartOneNotice=function(){if(0!=this.NoticeList.length){this.NoticeRunning=!0,this.BaseNode.opacity=255,this.BaseNode.active||(this.BaseNode.active=!0);var e=this.NoticeList[0];this.LabText.string=e.Text,this.LabText.node.setAnchorPoint(s.default.isRTLLanguage()?1:0,.5),this.ResetPosition(),this.cpnScheduleOnce(this,this.StartAnime,.5),e.Text===l.LOCAL.getText("public304")&&s.default.playG123SoundPathByName("mantanice"),e.NoticeType!==n.SystemNoticeType.ACTIVITY_VALENTIVE_FLOWER&&e.NoticeType!==n.SystemNoticeType.ACTIVITY_VALENTIVE_Microphone||r.EVENT.emit(i.EventId.PlayValentineAnim,e)}else this.BaseNode.opacity=0},t.prototype.StartAnime=function(){this.cpnUnschedule(this.StartAnime);var e=1;this.NoticeList.length>0&&this.NoticeList[0].Times>=1&&(e=this.NoticeList[0].Times);var t=(400+this.LabText.node.width)/115,a=s.default.isRTLLanguage()?400+this.LabText.node.width:-400-this.LabText.node.width,o=cc.moveBy(t,a,0),n=this.cpnCallFunc(this.ResetPosition,this),i=cc.repeat(cc.sequence(o,n),e),r=this.cpnCallFunc(this.NoticeAnimeFinish,this),l=cc.sequence(i,r,null);this.LabText.node.runAction(l)},t.prototype.ResetPosition=function(){var e=s.default.isRTLLanguage()?-200:200;this.LabText.node.position=new cc.Vec2(e,this.LabText.node.position.y)},t.prototype.NoticeAnimeFinish=function(){this.NoticeRunning=!1,this.NoticeList.length>0&&this.NoticeList.splice(0,1),this.StartOneNotice()},__decorate([p(cc.Label)],t.prototype,"LabText",void 0),__decorate([p(cc.Node)],t.prototype,"BaseNode",void 0),t=__decorate([d],t)}(o.default);a.default=u,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Event/EventCenter":"EventCenter","../../System/ComponentBase":"ComponentBase","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Tools/GameTools":"GameTools"}],TaskGuide:[function(e,t,a){"use strict";cc._RF.push(t,"a90d9p0qqlPh6VaHy/uSiCl","TaskGuide"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./../Const/TableName"),n=e("../../Core/Common/LocalManager"),i=e("../../System/ComponentBase"),r=e("../../Core/Common/TableManager"),s=e("./UIManager"),l=e("../Scene/SceneManager"),c=e("../Data/DataCenter"),d=e("../../Core/Event/EventCenter"),p=e("../Const/EventId"),u=e("../controllers/ItemMergeController"),h=e("../Tools/GameTools"),m=e("../Const/GameDefine"),f=e("../../fws/utils/X"),_=e("../Profession/ProfessionController"),y=e("../Const/UIDataInfo"),g=e("../../Core/Net/NetMgr"),C=e("../controllers/ScienceController"),v=cc._decorator,I=v.ccclass,T=v.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BaseNode=null,t.Hand=null,t.Hand2=null,t.arrowNode=null,t.HandAni=null,t.circelNode=null,t.FrameNode=null,t.FrameButton=null,t.DialogNode=null,t.LabDialog=null,t.DialogBg=null,t.DialogFrames=[],t.CurrGuide=null,t.Checking=!1,t.TaskData=null,t.Target=null,t._TaskPara=-1,t._FunctionBtnItem=null,t._SpecialGuide=!1,t._TempPara="",t._StrPara="",t._DialogKey="",t._bHomeMapObj=!1,t._arrowPlay=!1,t}var a;return __extends(t,e),a=t,Object.defineProperty(t.prototype,"Guiding",{get:function(){return null!=this.CurrGuide},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrGuideData",{get:function(){return this.CurrGuide},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TaskPara",{get:function(){var e=this._TaskPara;return null==this.CurrGuide&&(e=-1),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GuideTaskData",{get:function(){return this.TaskData},enumerable:!0,configurable:!0}),t.prototype.cpnLoad=function(){a.Instance=this},t.prototype.cpnStart=function(){},t.prototype.cpnEnable=function(){d.EVENT.on(p.EventId.GuideNodeOnUI,this.AddGuideNodeOnUI,this),d.EVENT.on(p.EventId.TutorialDialogComplete,this.TutorialDialogComplete,this)},t.prototype.cpnDisable=function(){d.EVENT.off(p.EventId.GuideNodeOnUI,this.AddGuideNodeOnUI,this),d.EVENT.off(p.EventId.TutorialDialogComplete,this.TutorialDialogComplete,this)},t.prototype.GuideComplete=function(){1==this.BaseNode.activeInHierarchy&&(this.BaseNode.active=!1)},t.prototype.TutorialDialogComplete=function(){this.CurrGuide&&100==this.CurrGuide.type&&this.GoToNextGuide()},t.prototype.cpnUpdate100MS=function(e){if(0!=this.Checking&&null!=this.CurrGuide)if(null!=this.TaskData||0!=this._SpecialGuide)if(null==this.Target){if(null!=s.default.Instance()){this._bHomeMapObj=!1;var t=this.CurrGuide.type,a=this.CurrGuide.button_name,i=this.CurrGuide.ui_name,l=!1;if(1==t||22==t){var c=null;if("MainUI"==i)c=s.default.Instance().MainUINode;else if("WorldMainUI"==i)c=s.default.Instance().WorldMainUINode;else{null!=(g=s.default.Instance().getUIByName(i))&&(c=g)}if(null!=c){if(null==(D=cc.find(a,c))){var u="CONTENT/"+i+"/"+a;(D=cc.find(u,c))||(u="BG/CONTENT/"+i+"/"+a,D=cc.find(u,c))}null!=D&&1==D.activeInHierarchy&&(this.Target=D)}}else if(2==t||24==t){var g;c=null;if(null!=(g=s.default.Instance().getUIByName(i))&&(c=g),null!=c){var C=cc.find(a,c);if(null==C){u="CONTENT/"+i+"/"+a;(C=cc.find(u,c))||(u="BG/CONTENT/"+i+"/"+a,C=cc.find(u,c))}if(null!=C){var v=null;if(24==t&&(v=c.getComponentInChildren(cc.ScrollView)),null==(c=C.getChildByName(this._TaskPara.toString()))&&C.childrenCount>0&&"-1"!=this.CurrGuide.para&&(c=C.children[0]),24==t&&v&&v.node.height>Math.abs(Math.abs(c.y)-c.height)){var I=v.getScrollOffset();I.y=Math.abs(c.y)-c.height,v.scrollToOffset(I,.1)}}}if(null!=c){var T=this.CurrGuide.item_button;this.Target=""!=T?cc.find(T,c):c}}else if(3==t){if(this.checkHomeMapComplete()&&null!=s.default.Instance().HomeMap.AddingItem&&s.default.Instance().HomeMap.AddingItem.ItemId-1==this._TaskPara){c=s.default.Instance().HomeMap.AddingItem.node;this.Target=cc.find(a,c),null!=c&&(s.default.Instance().HomeMap.MoveMapToItemCenter(c),this._bHomeMapObj=!0)}}else if(4==t){if(this.checkHomeMapComplete()){var S=r.TABLE.getTableDataById("production",this._TaskPara.toString());if(null!=S)null!=(F=s.default.Instance().HomeMap.getBuildingItemByBuildingId(S.contract_building,!0))&&(this._FunctionBtnItem=F.node,this.Target=F.node,null!=F.node&&(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0))}}else if(5==t)s.default.Instance().StagePanel;else if(6==t){if(this.checkHomeMapComplete()){var A=0;this._TaskPara>0&&(A=this._TaskPara);var D=s.default.Instance().HomeMap.getUnLockArea(!0,A);this.Target=D,null!=this.Target&&(s.default.Instance().HomeMap.MoveMapToItemCenter(D),this._bHomeMapObj=!0)}}else if(7==t){if(h.default.verifyNode(this._FunctionBtnItem)){var N=this._FunctionBtnItem.getComponent("BuildingItem");if(null!=N){var b=N.getTaskGuideButton(this._TempPara);null!=b&&(this.Target=b,this._bHomeMapObj=!0)}}}else if(8==t){if(this.checkHomeMapComplete()){var L=1800;null==(F=s.default.Instance().HomeMap.getBuildingItemByBuildingGroup(L))?(s.default.Instance().ShowTips(n.LOCAL.getText("100500")),this.ResetGuide()):(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this.Target=F.node)}}else if(9==t){if(this.checkHomeMapComplete()){var E=this.findDoubleBuildById(this._TaskPara);if(E.length>=2){var P=s.default.Instance().HomeMap.getBuildItemByPosIdx(E[0]),w=s.default.Instance().HomeMap.getBuildItemByPosIdx(E[1]);if(null!=s.default.Instance().HomeMap.AddingItem)s.default.Instance().ShowTips(n.LOCAL.getText("101163")),this.ResetGuide();else if(P&&w){s.default.Instance().HomeMap.MoveMapToItemCenter(P.node),this.Target=P.node;var B=P.node,M=w.node;P.ItemNode&&w.ItemNode&&(B=P.ItemNode,M=w.ItemNode),d.EVENT.emit(p.EventId.ShowGuideMoveTips,{sNode:B,eNode:M}),s.default.Instance().ShowTips(n.LOCAL.getText("100501")),l=!0}else f.log("\u5efa\u7b51\u663e\u793a\u5f02\u5e38\uff0c\u6570\u636e\u4e0e\u663e\u793a\u4e0d\u4e00\u81f4"),this.ResetGuide()}else{var U=r.TABLE.getTableDataById(o.TableName.BUILDING,(this._TaskPara-1).toString());this.ResetGuide(),null!=U&&this.StartSpecialGuide(m.TaskGuideId.BuildBuilding,U.group)}}}else if(10==t){if(this.checkHomeMapComplete()){var R=this.findDoubleArmyById(this._TaskPara);if(R.length>=2){P=s.default.Instance().HomeMap.getArmyItemByPosIdx(R[0]),w=s.default.Instance().HomeMap.getArmyItemByPosIdx(R[1]);P&&w?(s.default.Instance().HomeMap.MoveMapToItemCenter(P.node),this.Target=P.node,d.EVENT.emit(p.EventId.ShowGuideMoveTips,{sNode:P.node,eNode:w.node}),s.default.Instance().ShowTips(n.LOCAL.getText("100502")),l=!0):(f.log("\u5175\u663e\u793a\u5f02\u5e38\uff0c\u6570\u636e\u4e0e\u663e\u793a\u4e0d\u4e00\u81f4"),this.ResetGuide())}else{var G=r.TABLE.getTableDataById(o.TableName.ARMY,(this._TaskPara-1).toString());this.ResetGuide(),null!=G&&this.StartSpecialGuide(m.TaskGuideId.ArmyTrain,G.type)}}}else if(11==t){if(this.checkHomeMapComplete())if(null==(F=s.default.Instance().HomeMap.getBuildingItemByArmyGroup(this._TaskPara))){var O=s.default.Instance().HomeMap.getBuildingGroupIdByArmyGroup(this._TaskPara);this.ResetGuide(),0!=O?this.StartSpecialGuide(m.TaskGuideId.BuildBuilding,O):s.default.Instance().ShowTips(n.LOCAL.getText("100503"))}else this._TempPara="Army",this._FunctionBtnItem=F.node,this.TaskData&&106==this.TaskData.condition?(F.HoldingUp(),null!=F.ProductingNode&&(s.default.Instance().HomeMap.MoveMapToItemCenter(F.ProductingNode),this._bHomeMapObj=!0,this.Target=F.ProductingNode)):(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this.Target=F.node)}else if(12==t){if(this.checkHomeMapComplete())null==(F=s.default.Instance().HomeMap.getBuildingItemByArmyId(this._TaskPara))?(s.default.Instance().ShowTips(n.LOCAL.getText("100503")),this.ResetGuide()):(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this.Target=F.node,this._TempPara="Army",this._FunctionBtnItem=F.node)}else if(13==t){if(this.checkHomeMapComplete())null==(F=s.default.Instance().HomeMap.getBuildingItemByBuildingGroup(m.BuildingGroup.SCIENCE))?(this.ResetGuide(),this.StartSpecialGuide(m.TaskGuideId.BuildBuilding,1900)):(this._bHomeMapObj=!0,this._TempPara="Science",this._FunctionBtnItem=F.node,s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this.Target=F.node,null!=F.BtnScience&&1==F.BtnScience.active&&this.GoToNextGuide())}else if(14==t){if(this.checkHomeMapComplete()){L=2200;null==(F=s.default.Instance().HomeMap.getBuildingItemByBuildingGroup(L))?(s.default.Instance().ShowTips(n.LOCAL.getText("public100")),this.ResetGuide()):(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this.Target=F.node)}}else if(16==t){if(this.checkHomeMapComplete())null==(F=s.default.Instance().HomeMap.getBuildingItemByBuildingGroup(this._TaskPara))?(s.default.Instance().ShowTips(n.LOCAL.getText("public100")),this.ResetGuide()):(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this.Target=F.node)}else if(17==t){if(this.checkHomeMapComplete()){O=0;if(_.default.Instance.ProfessionId&&_.default.Instance.MyProfessionData&&_.default.Instance.MyProfessionData.building){var k=r.TABLE.getTableDataById(o.TableName.BUILDING,_.default.Instance.MyProfessionData.building);k&&(O=k.group)}if(this._TempPara="ProfessionTalentBtn",0==O)this.ResetGuide();else null==(F=s.default.Instance().HomeMap.getBuildingItemByBuildingGroup(O))?(this.ResetGuide(),this._TaskPara=O,this.StartSpecialGuide(m.TaskGuideId.BuildBuilding,1900)):(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this._FunctionBtnItem=F.node,this.Target=F.node,this.GoToNextGuide())}}else if(18==t){var x=void 0;x="GiftShopPanel"==i?{tabType:parseInt(this.CurrGuide.para.toString())}:this.CurrGuide.para,s.default.Instance().OpenUI(y.UIDataInfo[i],x),this.GoToNextGuide()}else{if(19==t)return;if(20==t)this.checkHomeMapComplete()&&(null!=(F=s.default.Instance().HomeMap.getBuildingItemById(this._StrPara))?(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this.Target=F.node,this._FunctionBtnItem=F.node,this._TempPara="SpeedUp"):this.ResetGuide());else if(21==t){if(this.checkHomeMapComplete()){D=s.default.Instance().HomeMap.getUnLockArea(!0,this.CurrGuide.para);this.Target=D,null!=this.Target&&(s.default.Instance().HomeMap.MoveMapToItemCenter(D),this._bHomeMapObj=!0)}}else if(23==t){if(this.checkHomeMapComplete()){var F,V=this.CurrGuide.para;null==(F=s.default.Instance().HomeMap.getBuildingItemByBuildingGroup(V))?(this.ResetGuide(),this.StartSpecialGuide(m.TaskGuideId.BuildBuilding,V)):(s.default.Instance().HomeMap.MoveMapToItemCenter(F.node),this._bHomeMapObj=!0,this.Target=F.node,this._TempPara=a,this._FunctionBtnItem=F.node,this.GoToNextGuide())}}else if(25==t&&this.checkHomeMapComplete()){var H=s.default.Instance().HomeMap.getMarinePatrolCurrentTile();D=s.default.Instance().HomeMap.getUnLockArea(!0,H);this.Target=D,null!=this.Target&&(s.default.Instance().HomeMap.MoveMapToItemCenter(D),this._bHomeMapObj=!0)}}null!=this.Target&&(this.BaseNode.active=!0,this.Hand.active=22!=t,22==t?(this.FrameButton.active=!0,this.FrameNode.active=!0):this.Hand.active=!0,this.CurrGuide.des&&(this.DialogNode.active=!0),this._arrowPlay&&this.HandAni.resume(),this.UpdateHands(),1==t||2==t||5==t||7==t||24==t?this.showArrowAni():6==t&&d.EVENT.emit(p.EventId.UnLockTileTips,this.Target),l&&(this.Hand.active=!1),this.TaskData&&106==this.TaskData.condition&&(this.Hand.active=!1,this.Hand2.active=!0,this.cpnScheduleOnce(this,this.ResetGuide,5)),this._bHomeMapObj?(this.Hand.active=!1,this.Hand2.active=!1,d.EVENT.emit(p.EventId.ShowGuideTips,this.Target)):0==l&&d.EVENT.emit(p.EventId.HideGuideTips))}}else this.UpdateHands();else this.GuideComplete();else this.GuideComplete()},t.prototype.UpdateFrame=function(){if(this.FrameButton.active){var e=cc.v2(),t=cc.v2();this._bHomeMapObj||(e=this.Target.parent.convertToWorldSpaceAR(this.Target.position),t=this.FrameButton.convertToNodeSpaceAR(e)),this.FrameNode.position=this.getNodeCenterPos(this.Target,t),this.FrameNode.width=this.Target.width+20,this.FrameNode.height=this.Target.height+20}},t.prototype.UpdateDialogContent=function(){if(this.DialogNode.active)if(this.CurrGuide){var e=cc.v2(),t=cc.v2();this._bHomeMapObj||(e=this.Target.parent.convertToWorldSpaceAR(this.Target.position),t=this.FrameButton.convertToNodeSpaceAR(e));var a=this.getNodeCenterPos(this.Target,t),o=this.CurrGuide.direction,i=cc.Vec2.ZERO,r=cc.Vec2.ZERO,s=cc.Vec2.ZERO,l=0,c=0,d=10,p=10,u=10,h=5;if(1==o?(i=new cc.Vec2(.5,0),r=new cc.Vec2(.5,1),i=e.x<320?new cc.Vec2(0,0):new cc.Vec2(1,0),h=28):2==o?(i=new cc.Vec2(.5,1),r=new cc.Vec2(.5,0),i=e.x<320?new cc.Vec2(0,1):new cc.Vec2(1,1),u=28):3==o?(i=new cc.Vec2(0,.5),r=new cc.Vec2(1,.5),p=30):4==o&&(i=new cc.Vec2(1,.5),r=new cc.Vec2(0,.5),d=30),o<=2&&(e.x<320?(s=new cc.Vec2(-30,0),l=65,c=10):(s=new cc.Vec2(30,0),l=10,c=65)),""==this._DialogKey){this._DialogKey=this.CurrGuide.des,this.LabDialog.string=n.LOCAL.getText(this._DialogKey),this.DialogBg.spriteFrame=this.DialogFrames[o-1],o<=2&&(this.DialogBg.spriteFrame.insetLeft=l,this.DialogBg.spriteFrame.insetRight=c);var m=this.DialogBg.getComponent(cc.Layout);m.paddingLeft=d,m.paddingRight=p,m.paddingTop=u,m.paddingBottom=h,m.updateLayout()}var f=this.changeNodePosFromAnchorToAnchor(this.Target,new cc.Vec2(.5,.5),r,a),_=this.changeNodePosFromAnchorToAnchor(this.DialogNode,i,new cc.Vec2(0,1),f);_=new cc.Vec2(_.x+s.x,_.y+s.y),this.DialogNode.position=this.adjustDialogNodePos(_)}else this.DialogNode.active=!1},t.prototype.adjustDialogNodePos=function(e){var t=this.DialogNode.parent.convertToWorldSpaceAR(e),a=620-this.DialogNode.width;return t.x<20?t.x=20:t.x>a&&(t.x=a),this.DialogNode.parent.convertToNodeSpaceAR(t)},t.prototype.getNodeCenterPos=function(e,t){var a=e.getAnchorPoint();return new cc.Vec2(t.x-(a.x-.5)*e.width,t.y-(a.y-.5)*e.height)},t.prototype.changeNodePosFromAnchorToAnchor=function(e,t,a,o){return new cc.Vec2(o.x-(t.x-a.x)*e.width,o.y-(t.y-a.y)*e.height)},t.prototype.checkCustomGuideEvent=function(e){this.CurrGuide&&19==this.CurrGuide.type&&this.CurrGuide.para==e&&this.GoToNextGuide()},t.prototype.checkHomeMapComplete=function(){return null!=s.default.Instance().HomeMap&&(1!=this.CurrGuide.home_complete||s.default.Instance().HomeMap.HomeOpenComplete)},t.prototype.UpdateHands=function(){if(null!=this.Target&&null!=this.Target.parent){if(this.UpdateFrame(),this.UpdateDialogContent(),this.Hand.active||this.Hand2.active){var e=cc.v2(),t=cc.v2();this._bHomeMapObj||(e=this.Target.parent.convertToWorldSpaceAR(this.Target.position),t=this.BaseNode.convertToNodeSpaceAR(e));var a=0;null!=this.CurrGuide&&(a=this.CurrGuide.offset_y),this.Hand.position=new cc.Vec2(t.x,t.y+a),this.Hand2.position=new cc.Vec2(t.x,t.y+a)}}else this.ResetGuide()},t.prototype.findDoubleBuildById=function(e){var t=r.TABLE.getTableDataById(o.TableName.BUILDING,e.toString()),a=0,n=0;if(t&&(a=t.group,n=t.level),n-=1,0==a||n<=0)return[];var i=0,s=r.TABLE.getTableGroup(o.TableName.BUILDING);if(s)for(var l in s){var c=s[l];if(c.group==a&&c.level==n){i=c.id;break}}if(i>0){var d=u.ItemMergeController.Instance.getMinDisDoubleItem(i,1);return d.length>=2?d:this.findDoubleBuildById(i)}return[]},t.prototype.findDoubleArmyById=function(e){var t=r.TABLE.getTableDataById(o.TableName.ARMY,e.toString()),a=0,n=0;if(t&&(a=t.type,n=t.level),n-=1,0==a||n<=0)return[];var i=0,s=r.TABLE.getTableGroup(o.TableName.ARMY);if(s)for(var l in s){var c=s[l];if(c.type==a&&c.level==n){i=c.id;break}}if(i>0){var d=u.ItemMergeController.Instance.getMinDisDoubleItem(i,0);return d.length>=2?d:this.findDoubleArmyById(i)}return[]},t.prototype.findDoubleArmyByMaxLvId=function(e){if(c.DATA.UserData.getAllArmyByArmyId(e).length>=2)return e;var t=r.TABLE.getTableDataById(o.TableName.ARMY,e.toString()),a=0,n=0;if(t&&(a=t.type,n=t.level),n-=1,0==a||n<=0)return 0;var i=0,s=r.TABLE.getTableGroup(o.TableName.ARMY);if(s)for(var l in s){var d=s[l];if(d.type==a&&d.level==n){i=d.id;break}}return i>0?this.findDoubleArmyByMaxLvId(i):0},t.prototype.ResetGuide=function(){this.CurrGuide=null,this.Checking=!1,this.TaskData=null,this.Target=null,this.Hand.active=!1,this.Hand2.active=!1,this.BaseNode.active=!1,this.FrameButton.active=!1,this.DialogNode.active=!1,this._TaskPara=-1,this._TempPara="",this._StrPara="",this._DialogKey="",this.FrameButton.active=!1,1==this._bHomeMapObj&&d.EVENT.emit(p.EventId.HideGuideTips)},t.prototype.StartDailyTaskGuide=function(e){if(this.Checking)this.GuideComplete();else{var t=r.TABLE.getTableDataById(o.TableName.DAILYTASK,e.toString());null!=t&&this._startTaskGuide(t)}},t.prototype.StartTaskGuide=function(e){if(this.Checking)this.GuideComplete();else{var t=r.TABLE.getTableDataById(o.TableName.TASK,e.toString());null!=t&&this._startTaskGuide(t)}},t.prototype._startTaskGuide=function(e){this.CurrGuide=null,this._SpecialGuide=!1,this._FunctionBtnItem=null,this.TaskData=e,this._TaskPara=this.TaskData.condition_id;var t=e.guide_group;if(11==t){var a=r.TABLE.getTableDataById(o.TableName.BUILDING,this._TaskPara.toString());null!=a&&(this._TaskPara=a.group)}else if(13==t){var n=r.TABLE.getTableDataById(c.DATA.UserData.scienceTableName,this._TaskPara.toString());if(n){var i=this.getGuideScienceGroupId(this._TaskPara),s=n.group_id;s>0&&(this._TaskPara=s),s!=i&&(this.CurrGuide=r.TABLE.getTableDataById(o.TableName.GUIDE_FREE,"2299"))}}else 17==t&&(this._TaskPara=101);if(null==this.CurrGuide){var d=r.TABLE.getTableGroup(o.TableName.GUIDE_FREE);for(var p in d){var u=d[p];u.group>0&&u.group==t&&(this.CurrGuide=u)}}null!=this.CurrGuide&&(l.default.Instance().CurSceneName==this.CurrGuide.current_scene&&(this.CurrGuide=r.TABLE.getTableDataById(o.TableName.GUIDE_FREE,this.CurrGuide.next_id)),this.cpnScheduleOnce(this,this.DelayStartCheck,.1))},t.prototype.getGuideScienceGroupId=function(e){var t=r.TABLE.getTableDataById(c.DATA.UserData.scienceTableName,e.toString());if(null==t)return 0;var a=t.group_id,o=C.default.GuideLearnScience(a);if(null==o)return a;for(var n=-1;o;){var i=o.conditions;if(n=o.id,0==i.length)break;o=i[0]}return n>0&&(t=r.TABLE.getTableDataById(c.DATA.UserData.scienceTableName,n.toString()))&&(a=t.group_id),a},t.prototype.DelayStartCheck=function(){this.CurrGuide&&(100==this.CurrGuide.type&&s.default.Instance().OpenUI(y.UIDataInfo.TutorialDialogPanel,this.CurrGuide.para),this.Checking=!0,this.SendGuideNetMsg())},t.prototype.GoToNextGuide=function(){if(null!=this.CurrGuide){this._DialogKey="",this.Checking=!1,this.Target=null,this.BaseNode.active=!1,this.DialogNode.active=!1,this.FrameButton.active=!1;var e=r.TABLE.getTableDataById(o.TableName.GUIDE_FREE,this.CurrGuide.next_id);null==e?this.ResetGuide():(this.CurrGuide=e,this.cpnScheduleOnce(this,this.DelayStartCheck,.1))}else this.ResetGuide()},t.prototype.SendGuideNetMsg=function(){this.CurrGuide&&null!=this.CurrGuide.ask&&this.CurrGuide.ask>0&&g.NET.send(this.CurrGuide.ask,{},this,function(){})},t.prototype.AddGuideNodeOnUI=function(e){h.default.verifyNode(e)&&this.AddGuideDelegate(e)},t.prototype.AddGuideDelegate=function(e){for(var t=e.getComponentsInChildren(cc.Button),a=0;a<t.length;a++)t[a].node.on("click",this.ButtonActionCall,this)},t.prototype.ButtonActionCall=function(e){this.CheckClickTarget(e.node)},t.prototype.BuildingItemCall=function(e){this.CheckClickTarget(e)},t.prototype.CheckClickTarget=function(e){0!=this.Checking&&(!this.CurrGuide||100!=this.CurrGuide.type&&19!=this.CurrGuide.type)&&(null!=e&&e==this.Target?this.GoToNextGuide():this.ResetGuide())},t.prototype.onFrameButtonClick=function(){this.GoToNextGuide()},t.prototype.StartSpecialGuide=function(e,t,a){void 0===t&&(t=-1),void 0===a&&(a=""),this.ResetGuide(),this._SpecialGuide=!0,this._TaskPara=t,this._StrPara=a;var n=r.TABLE.getTableDataById(o.TableName.GUIDE_FREE,e.toString());null!=n&&(this.CurrGuide=n),null!=this.CurrGuide&&(l.default.Instance().CurSceneName==this.CurrGuide.current_scene&&(this.CurrGuide=r.TABLE.getTableDataById(o.TableName.GUIDE_FREE,this.CurrGuide.next_id)),this.cpnScheduleOnce(this,this.DelayStartCheck,.1))},t.prototype.showArrowAni=function(){var e=this;if(!this._arrowPlay){this._arrowPlay=!0,this.circelNode.active=!1,this.HandAni&&this.HandAni.pause();var t=cc.winSize,a=cc.v2(t.width/2,t.height/2),o=this.arrowNode.parent.convertToNodeSpaceAR(a);this.arrowNode.angle=0,this.arrowNode.position=o,this.arrowNode.scale=.1;var n=cc.bezierTo(1,[o,o,cc.v2(0,0)]),i=this.cpnCallFunc(function(){e.arrowNode.angle=0,e.circelNode.active=!0,e.HandAni.resume(),e._arrowPlay=!1}),r=cc.scaleTo(.2,1).easing(cc.easeBackOut());this.arrowNode.runAction(cc.sequence(r,n,i))}},t.Instance=null,__decorate([T(cc.Node)],t.prototype,"BaseNode",void 0),__decorate([T(cc.Node)],t.prototype,"Hand",void 0),__decorate([T(cc.Node)],t.prototype,"Hand2",void 0),__decorate([T(cc.Node)],t.prototype,"arrowNode",void 0),__decorate([T(cc.Animation)],t.prototype,"HandAni",void 0),__decorate([T(cc.Node)],t.prototype,"circelNode",void 0),__decorate([T(cc.Node)],t.prototype,"FrameNode",void 0),__decorate([T(cc.Node)],t.prototype,"FrameButton",void 0),__decorate([T(cc.Node)],t.prototype,"DialogNode",void 0),__decorate([T(cc.Label)],t.prototype,"LabDialog",void 0),__decorate([T(cc.Sprite)],t.prototype,"DialogBg",void 0),__decorate([T(cc.SpriteFrame)],t.prototype,"DialogFrames",void 0),t=a=__decorate([I],t)}(i.default);a.default=S,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../System/ComponentBase":"ComponentBase","../../fws/utils/X":"X","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Profession/ProfessionController":"ProfessionController","../Scene/SceneManager":"SceneManager","../Tools/GameTools":"GameTools","../controllers/ItemMergeController":"ItemMergeController","../controllers/ScienceController":"ScienceController","./../Const/TableName":"TableName","./UIManager":"UIManager"}],Tutorial:[function(e,t,a){"use strict";cc._RF.push(t,"6c297cB6tZBUppsvE15lZkS","Tutorial"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("../../Core/Event/EventCenter"),i=e("../Const/EventId"),r=e("../Tools/GameTools"),s=e("../../Core/Common/TableManager"),l=e("./UIManager"),c=e("../Const/UIDataInfo"),d=e("../../Core/Common/LocalManager"),p=e("../Const/GameDefine"),u=e("../Module/Home/Worker"),h=e("../Const/TableName"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BaseNode=null,t.TutorialMask=null,t.Hand=null,t.NpcNode=null,t.NpcName=null,t.NpcContent=null,t.Target=null,t.CurrGuide=null,t._bHomeMapObj=!1,t._FunctionBtnItem=null,t._CloseCount=0,t.Checking=!1,t}var a;return __extends(t,e),a=t,t.prototype.cpnLoad=function(){a.Instance=this},t.prototype.cpnEnable=function(){n.EVENT.on(i.EventId.GuideNodeOnUI,this.AddGuideNodeOnUI,this),n.EVENT.on(i.EventId.TutorialDialogComplete,this.TutorialDialogComplete,this)},t.prototype.cpnDisable=function(){n.EVENT.off(i.EventId.GuideNodeOnUI,this.AddGuideNodeOnUI,this),n.EVENT.off(i.EventId.TutorialDialogComplete,this.TutorialDialogComplete,this)},t.prototype.AddGuideNodeOnUI=function(e){r.default.verifyNode(e)&&this.AddGuideDelegate(e)},t.prototype.TutorialDialogComplete=function(){this.CurrGuide&&100==this.CurrGuide.type&&this.GoToNextGuide()},t.prototype.AddGuideDelegate=function(e){for(var t=e.getComponentsInChildren(cc.Button),a=0;a<t.length;a++)t[a].node.on("click",this.ButtonActionCall,this)},t.prototype.ButtonActionCall=function(e){this.CheckClickTarget(e.node)},t.prototype.BuildingItemCall=function(e){this.CheckClickTarget(e)},t.prototype.CheckClickTarget=function(e){0!=this.Checking&&null!=e&&e==this.Target&&this.GoToNextGuide()},t.prototype.GoToNextGuide=function(){if(null!=this.CurrGuide){this._CloseCount=0,this.Checking=!1,this.Target=null,this.BaseNode.active=!1;var e=s.TABLE.getTableDataById(h.TableName.TUTORIAL,this.CurrGuide.next_id);null==e?this.ResetGuide():(this.CurrGuide=e,this.cpnScheduleOnce(this,this.DelayStartCheck,.1))}else this.ResetGuide()},t.prototype.DelayStartCheck=function(){this.CurrGuide&&(100==this.CurrGuide.type&&l.default.Instance().OpenUI(c.UIDataInfo.TutorialDialogPanel,this.CurrGuide.para),this.Checking=!0)},t.prototype.ResetGuide=function(){this._CloseCount=0,this.CurrGuide=null,this.Checking=!1,this.Target=null,this.Hand.active=!1,this.BaseNode.active=!1},t.prototype.GuideComplete=function(){1==this.BaseNode.activeInHierarchy&&(this.BaseNode.active=!1)},t.prototype.cpnUpdate100MS=function(t){if(e.prototype.cpnUpdate100MS.call(this,t),0!=this.Checking&&null!=this.CurrGuide)if(null==this.Target){if(null!=l.default.Instance()){this._bHomeMapObj=!1;var a=this.CurrGuide.type,o=this.CurrGuide.button_name,n=this.CurrGuide.para;if(1==a){var i=null;if("MainUI"==n)i=l.default.Instance().MainUINode;else if("WorldMainUI"==n)i=l.default.Instance().WorldMainUINode;else{var s=l.default.Instance().getUIByName(n);null!=s&&(i=s)}if(null!=i){var c=cc.find(o,i);if(null==c){var d="CONTENT/"+n+"/"+o;c=cc.find(d,i)}null!=c&&1==c.activeInHierarchy&&(this.Target=c)}}else if(7==a){if(r.default.verifyNode(this._FunctionBtnItem)){var h=this._FunctionBtnItem.getComponent("BuildingItem");if(null!=h)null!=(_=h.getTaskGuideButton(n))&&(this.Target=_,this._bHomeMapObj=!0)}}else if(16==a){if(this.checkHomeMapComplete()){var m=parseInt(n),f=l.default.Instance().HomeMap.getBuildingItemByBuildingGroup(m);null==f?this.ResetGuide():(l.default.Instance().HomeMap.MoveMapToItemCenter(f.node),this._bHomeMapObj=!0,this.Target=f.node,this._FunctionBtnItem=f.node)}}else if(17==a){var _;if(null==(_=l.default.Instance().HomeMap.getGuideNode(p.GuideState.Help)))this.ResetGuide();else{l.default.Instance().HomeMap.MoveMapToItemCenter(_),this._bHomeMapObj=!0;var y=_.getComponent(u.default);this.Target=y.GuideNode,this._FunctionBtnItem=_}}if(null!=this.Target){if(1==this.CurrGuide.skip)return void this.GoToNextGuide();this.BaseNode.active=!0,this.Hand.active=!0,this.UpdateHands()}}}else this.UpdateHands();else this.GuideComplete()},t.prototype.checkHomeMapComplete=function(){return null!=l.default.Instance().HomeMap&&(1!=this.CurrGuide.home_complete||l.default.Instance().HomeMap.HomeOpenComplete)},t.prototype.UpdateHands=function(){if(null!=this.Target&&null!=this.Target.parent){this.UpdateNpcNode();var e=cc.v2(),t=cc.v2();if(this._bHomeMapObj&&null!=this._FunctionBtnItem){var a=this._FunctionBtnItem.position;if(this._FunctionBtnItem!=this.Target){var o=this.Target.parent.convertToWorldSpaceAR(this.Target.position);a=this._FunctionBtnItem.parent.convertToNodeSpaceAR(o)}e=l.default.Instance().HomeMap.convertContainerToWorldPos(a),t=this.BaseNode.convertToNodeSpaceAR(e)}else e=this.Target.parent.convertToWorldSpaceAR(this.Target.position),t=this.BaseNode.convertToNodeSpaceAR(e);var n=0;this.CurrGuide.offset_y&&(n=this.CurrGuide.offset_y);var i=new cc.Vec2(t.x,t.y+n);this.Hand.position=i,this.TutorialMask.position=i,1==this.CurrGuide.m_type?this.TutorialMask.getComponent(cc.Mask).type=cc.Mask.Type.ELLIPSE:this.TutorialMask.getComponent(cc.Mask).type=cc.Mask.Type.RECT,this.CurrGuide.m_width?this.TutorialMask.setContentSize(this.CurrGuide.m_width,this.CurrGuide.m_height):this.TutorialMask.setContentSize(this.Target.width,this.Target.height),this.CurrGuide.hideMask?this.TutorialMask.opacity=0:this.TutorialMask.opacity=255}else this.ResetGuide()},t.prototype.UpdateNpcNode=function(){null!=this.CurrGuide&&""!=this.CurrGuide.npcName?(this.NpcNode.active=!0,this.NpcName.string=d.LOCAL.getText(this.CurrGuide.npcName),this.NpcContent.string=d.LOCAL.getText(this.CurrGuide.npcContent),this.NpcNode.position=new cc.Vec2(this.NpcNode.position.x,this.CurrGuide.npcPosY)):this.NpcNode.active=!1},t.prototype.StartTutorial=function(e){this._CloseCount=0;var t=s.TABLE.getTableDataById(h.TableName.TUTORIAL,e.toString());null!=t&&(this.CurrGuide=t),null!=this.CurrGuide&&this.cpnScheduleOnce(this,this.DelayStartCheck,.1)},t.prototype.CloseTutorialClick=function(){this._CloseCount++,this._CloseCount>=10&&this.ResetGuide()},t.Instance=null,__decorate([_(cc.Node)],t.prototype,"BaseNode",void 0),__decorate([_(cc.Node)],t.prototype,"TutorialMask",void 0),__decorate([_(cc.Node)],t.prototype,"Hand",void 0),__decorate([_(cc.Node)],t.prototype,"NpcNode",void 0),__decorate([_(cc.Label)],t.prototype,"NpcName",void 0),__decorate([_(cc.Label)],t.prototype,"NpcContent",void 0),t=a=__decorate([f],t)}(o.default);a.default=y,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../System/ComponentBase":"ComponentBase","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Module/Home/Worker":"Worker","../Tools/GameTools":"GameTools","./UIManager":"UIManager"}],UIManager:[function(e,t,a){"use strict";cc._RF.push(t,"f9e4dHVrx9Fcr0mmfyWDbEj","UIManager"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../../Core/Common/LocalManager"),i=e("../../System/ComponentBase"),r=e("../Const/UIDataInfo"),s=e("../Const/GameDefine"),l=e("../Scene/SceneManager"),c=e("../Const/SceneName"),d=e("../../fws/utils/FWSTool"),p=e("../../Core/Event/EventCenter"),u=e("../Const/EventId"),h=e("../Data/DataCenter"),m=e("./SystemNotice"),f=e("../Tools/GameTools"),_=e("../../Core/Common/TableManager"),y=e("../../System/ErrorUtils"),g=e("./BaseUI"),C=e("../components/activity/ActivityValentineAnimComponent"),v=e("./UIManagerLoaders"),I=e("../../fws/utils/X"),T=e("../../Core/Common/SoundManager"),S=e("../Const/SoundPath"),A=e("../battleReport/NBattleReportCommon"),D=e("../../fws/display/dialogs/DialogFrameComponent"),N=e("../../Game/Const/GameDefine"),b=e("../../fws/platforms/PlatformCore"),L=e("./ChatChangeTip"),E=e("./CommonIconTips"),P=e("../components/RadialBlurTransition"),w=e("../Const/TableName"),B=e("../controllers/G123IPContentProvider"),M=e("../../fws/display/MsgBox"),U=cc._decorator,R=U.ccclass,G=U.property,O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sceneTransition=null,t.netStatusLayer=null,t.netStatusAnimNode=null,t.uiLayer=null,t.popLayer=null,t.tipsLayer=null,t.topLayer=null,t.tipsNode=null,t.iconTipsNode=null,t.flyLayer=null,t.battleLayer=null,t.waiteNode=null,t.waitMask=null,t.maskNode=null,t.noticeNode=null,t.chatChangeNode=null,t.DataPool={},t.ContextPool={},t.LoadingPanel={},t.MainUI=null,t.MainUINode=null,t.WorldMainUINode=null,t.HomeMap=null,t.StagePanel=null,t.UICanvasNode=null,t.SceneNode=null,t.CurrentUIDataInfo=null,t.RelativelyUIs=new Array,t._prefabPools={},t._tipCommon=null,t._iconTips=null,t._isBrowser=!1,t._allLayers=[],t.lastKTime=0,t.lasyBTime=0,t.lastJTime=0,t.UIPOPDATAS=new Array,t.UPLEVELDATAS=new Array,t.mask1=null,t.mask2=null,t}var a;return __extends(t,e),a=t,t.Instance=function(){return null!=a._Instance?a._Instance:null},t.prototype.tryWarningSlowLoader=function(e,t){e>200?I.error(d.Str.format("%c(\u4f18\u5316\u5efa\u8bae) {0} \u52a0\u8f7d\u65f6\u95f4\u592a\u957f ({1} ms)\uff0c\u5fc5\u987b\u4f18\u5316!",t,e),"color:#ff0000;"):e>100&&I.warn(d.Str.format("%c(\u4f18\u5316\u5efa\u8bae) {0} \u52a0\u8f7d\u65f6\u95f4\u6709\u70b9\u957f ({1} ms)\uff0c\u5efa\u8bae\u4f18\u5316",t,e),"color:#993300;")},t.prototype.tryWarningSlowConstruct=function(e,t){e>40?I.error(d.Str.format("%c(\u4f18\u5316\u5efa\u8bae) {0} \u5b9e\u4f8b\u5316\u65f6\u95f4\u592a\u957f ({1} ms)\uff0c\u5fc5\u987b\u4f18\u5316!",t,e),"color:#ff0000;"):e>10&&I.warn(d.Str.format("%c(\u4f18\u5316\u5efa\u8bae) {0} \u5b9e\u4f8b\u5316\u65f6\u95f4\u6709\u70b9\u957f ({1} ms)\uff0c\u5efa\u8bae\u4f18\u5316",t,e),"color:#993300;")},t.prototype.cpnLoad=function(){this._isBrowser=cc.sys.isBrowser,this.node.zIndex=1e3,a._Instance=this,window._UIManager=this,N.UIMANAGER=a.Instance(),this.UICanvasNode=this.node,cc.game.addPersistRootNode(this.node),this.netStatusLayer.active=!1,this._allLayers=[],this._allLayers.push(this.battleLayer),this._allLayers.push(this.topLayer),this._allLayers.push(this.popLayer),this._allLayers.push(this.uiLayer);var e=B.default.Instance.getPCBg();this.showLandscapeMask(!0,e)},t.prototype.OpenUI=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(e){if(d.Obj.isEmpty(this.DataPool[e.name])&&d.Obj.isEmpty(this.LoadingPanel[e.name])){if(e.uiType==r.UIType.TYPE_RELATIVELY){for(var n=0;n<this.RelativelyUIs.length;n++){if(this.RelativelyUIs[n].datainfo.name==e.name)return}if(this.RelativelyUIs.push({datainfo:e,paras:t[0]}),this.RelativelyUIs.length>1)return}null!=this.HomeMap&&this.HomeMap.RemoveAddingItem();var i=e.fullPath;if(this.isCachePanel(e)){var s=this.getPrefabFromPool(e.name);if(s)I.time("(Cache) UIManager::OpenUI "+i),this.newShowUI(s,e,t),I.timeEnd("(Cache) UIManager::OpenUI "+i);else{this.showWaitAnim(),this.LoadingPanel[e.name]="1";var l=this;I.log("(UIManager) OpenUI::loadRes",i),I.time("(Load) UIManager::OpenUI::loadRes "+i),v.load(i,function(o,n){if(l.tryWarningSlowLoader(I.timeEnd("(Load) UIManager::OpenUI::loadRes "+i),i),o)I.log(i+o),l.DataPool[e.name]=null;else if("1"===l.LoadingPanel[e.name]){I.time("UIManager instantiate "+i);var r=cc.instantiate(n);if(e.frameOptions){var s=r.getComponent(D.default);s?s.onFrameLoad(e):I.warn("\u53d1\u73b0\u4e00\u4e2a\u914d\u7f6e\u6709\u95ee\u9898\u7684UIDataInfo",e)}a.Instance().newShowUI(r,e,t),l.tryWarningSlowConstruct(I.timeEnd("UIManager instantiate "+i),i)}l.hideWaitAnim(),delete l.LoadingPanel[e.name]},this)}}else{var c=v.getFromCache(e.name,cc.Prefab);if(void 0!==c&&null!==c)this.ShowUI(c,e,t);else{this.showWaitAnim(),this.LoadingPanel[e.name]="1";var p=this;I.log("(UIManager) OpenUI::loadRes",i),I.time("(Load) UIManager::OpenUI::loadRes2 "+i),v.load(i,function(o,n){p.tryWarningSlowLoader(I.timeEnd("(Load) UIManager::OpenUI::loadRes2 "+i),i),o?(I.log(i+o),p.DataPool[e.name]=null):"1"===p.LoadingPanel[e.name]&&(I.time("UIManager instantiate2 "+i),a.Instance().ShowUI(n,e,t),p.tryWarningSlowConstruct(I.timeEnd("UIManager instantiate2 "+i),i)),p.hideWaitAnim(),delete p.LoadingPanel[e.name]},this,12e3,!0)}}}}else I.warn("UIManager.openUI dataInfo is null or undefined")},t.prototype.ShowUI=function(e,t,a){try{this.realShowUI(e,t,a)}catch(a){I.error(a);var o=new y.ErrorInfo;o.funcName="ShowUI "+(e?e.name:"null"),o.errMsgInfo=new Error("'"+a.toString()+"'"),t&&(o.customInfo="'"+JSON.stringify(t)+"'"),y.ErrorUtils.errorMessage(o)}},t.prototype.CheckFullScreenHideBack=function(e,t,a){if(!this._isBrowser&&t.uiType===r.UIType.TYPE_POP&&t.hideBack){var o=this.ContextPool,n=o[t.name];if(n||(n=o[t.name]={hidedBack:!1}),!1===n.hidedBack){var i=cc.director.getScene().getChildByName("Canvas");i&&(i.opacity=0);for(var s=0,l=a;s<l;++s){var c=e.children[s];(c?c.getComponent("BaseUI"):null)&&(c.opacity=0)}n.hidedBack=!0}}},t.prototype.RestoreFullScreenHideBack=function(e,t){if(!this._isBrowser&&e&&t){var a=this.ContextPool[e.name];if(a&&a.hidedBack){a.hidedBack=!1;for(var o=t.parent,n=t.getSiblingIndex(),i=!1,r=o.children,s=n-1;s>=0;--s){var l=r[s],c=l.getComponent("BaseUI");if(c&&(l.opacity=255,c.dataInfo&&c.dataInfo.hideBack)){i=!0;break}}if(!i){var d=cc.director.getScene().getChildByName("Canvas");d&&(d.opacity=255)}}}},t.prototype.checkBaseUIClasss=function(e){if(e&&e.constructor&&e.constructor.name&&a.OldBaseUIFiles&&a.OldBaseUIFiles.length>0){var t=e.constructor.name;if(!(e instanceof D.default)&&a.OldBaseUIFiles.indexOf(t)<0){var o="(\u6b64\u8b66\u544a\u4ec5\u5f00\u53d1\u8c03\u8bd5\u7248\u53ef\u89c1)\n\u53d1\u73b0\u53c8\u6709\u57fa\u4e8e\u8001\u5bf9\u8bdd\u6846\u5b9e\u73b0\u7684\u754c\u9762"+t;throw M.alert(o,"BaseUI\u8b66\u544a"),new Error(o)}}},t.prototype.realShowUI=function(e,t,o){var n=cc.instantiate(e),i=this.GetLayer(t.uiType),r=i.childrenCount;i.addChild(n);var s=n.getComponent("BaseUI");this.checkBaseUIClasss(s),null!=s&&(n.opacity=255,s.UIName=t.name,s._para=o,s.dataInfo=t,s.onShow_Init(o)),this.CheckFullScreenHideBack(i,t,r),a.Instance().DataPool[t.name]=n,this.CurrentUIDataInfo=t},t.prototype.newShowUI=function(e,t,o){var n=this.GetLayer(t.uiType),i=n.childrenCount;n.addChild(e);var r=e.getComponent("BaseUI");this.checkBaseUIClasss(r),null!=r&&(this.node.opacity=255,r.UIName=t.name,r._para=o,r.dataInfo=t,r.onShow_Init(o)),this.CheckFullScreenHideBack(n,t,i),a.Instance().DataPool[t.name]=e,this.CurrentUIDataInfo=t},t.prototype.CloseUI=function(e,t){void 0===t&&(t=!0);var a=!1;if(!e)return a;p.EVENT.emit(u.EventId.CLOSEUI,e);var o=this.DataPool[e.name];if(this.RestoreFullScreenHideBack(e,o),t&&void 0!==o&&null!==o){var n=o.getComponent("BaseUI");null!=n&&(delete this.LoadingPanel[e.name],a=n.playBefCloseAni())}return this.CurrentUIDataInfo=this.getTopUIDataInfo(e),0==a?a=this.LastCloseUI(e):this.CurrentUIDataInfo=this.getTopUIDataInfo(e),a},t.prototype.getTopUIDataInfo=function(e){return null},t.prototype.LastCloseUI=function(e){delete this.LoadingPanel[e.name];var t=this.DataPool[e.name];if(this.RestoreFullScreenHideBack(e,t),this.CurrentUIDataInfo=this.getTopUIDataInfo(e),void 0!==t&&null!==t){var a=t.getComponent("BaseUI");if(null!=a&&a.afterClose(),I.log(e.name+" destroyed!"),e.uiType==r.UIType.TYPE_RELATIVELY&&(this.RelativelyUIs.shift(),this.RelativelyUIs.length>0)){var o=this.RelativelyUIs.pop();this.OpenUI(o.datainfo,o.paras)}return this.putPrefabToPool(t)||t.destroy(),this.DataPool[e.name]=null,I.time("\u5173\u95ed\u7a97\u53e3:GC"),b.instance.periodTriggerGC(),I.timeEnd("\u5173\u95ed\u7a97\u53e3:GC"),!0}return I.time("\u5173\u95ed\u7a97\u53e3:GC"),b.instance.periodTriggerGC(),I.timeEnd("\u5173\u95ed\u7a97\u53e3:GC"),!1},t.prototype.getUIByName=function(e){return this.DataPool[e]},t.prototype.getUIByUIData=function(e){var t=e.name;return this.DataPool[t]},t.prototype.Close=function(e){delete this.LoadingPanel[e];var t=this.DataPool[e];if(void 0!==t&&null!==t){var a=!1,o=t.getComponent("BaseUI");this.RestoreFullScreenHideBack(o?o.dataInfo:null,t),o&&o.dataInfo&&(this.CurrentUIDataInfo=this.getTopUIDataInfo(o.dataInfo)),null!=o&&(a=o.playBefCloseAni()),0==a&&(o&&o.afterClose(),this.putPrefabToPool(t)||t.destroy(),this.DataPool[e]=null)}},t.prototype.CloseByType=function(e){var t=this,a=this.GetLayer(e);a&&a.children.forEach(function(e){if(e){var a=e.getComponent("BaseUI");if(null!=a){var o=a.UIName;t.Close(o)}else e.destroy()}})},t.prototype.CloseAllUI=function(){this.ContextPool={},f.default.verifyComponent(this.MainUI)&&this.MainUI.questUpDown(!1);var e=cc.director.getScene().getChildByName("Canvas");for(var t in e&&(e.opacity=255),this.DataPool)if(this.DataPool.hasOwnProperty(t)){var a=this.DataPool[t];if(null!=a){var o=a.getComponent("BaseUI");o&&o.afterClose(),I.log(t+" destroyed!"),this.putPrefabToPool(a)||a.destroy()}}this.GetLayer(r.UIType.TYPE_POP).destroyAllChildren(),this.DataPool={},this.LoadingPanel={},this.CurrentUIDataInfo=null},t.prototype.GetPopViewNum=function(){return this.GetLayer(r.UIType.TYPE_POP).childrenCount},t.prototype.ShowTips=function(e){if(e){if(!this._tipCommon){var t=cc.instantiate(this.tipsNode).getComponent("CommonTips");t&&(t.node.parent=this.topLayer,this._tipCommon=t)}this._tipCommon.ShowTips(e)}},t.prototype.ShowIconTips=function(e,t){if(e){if(!this._iconTips){var a=cc.instantiate(this.iconTipsNode).getComponent(E.default);a&&(a.node.parent=this.topLayer,this._iconTips=a)}this._iconTips.ShowTips(e,t)}},t.prototype.ShowMarchPanel=function(){A.enabled()?a.Instance().OpenUI(r.UIDataInfo.NBattleReportArmySelector):a.Instance().OpenUI(r.UIDataInfo.BattleMainPanel)},t.prototype.ShowRewardTips=function(e){var t="";if(!f.default.ObjIsEmpty(e)){if(!f.default.ObjIsEmpty(e.items))for(var a=0;a<e.items.length;a++){var o=_.TABLE.getTableDataById(w.TableName.ITEM,e.items[a].itemId);o&&(t+=n.LOCAL.getText(o.name)+"x"+e.items[a].itemCount+"  ")}f.default.ObjIsEmpty(e.resource)||(e.resource.coin>0&&(t+=n.LOCAL.getText("100020")+"x"+e.resource.coin+"  "),e.resource.gold>0&&(t+=n.LOCAL.getText("100017")+"x"+e.resource.gold+"  ")),f.default.ObjIsEmpty(e.energy)||e.energy>0&&(t+=n.LOCAL.getText("101035")+e.energy+"  "),f.default.ObjIsEmpty(e.exp)||e.exp>0&&(t+=n.LOCAL.getText("100492")+"x"+e.exp+"  ")}""!==t&&this.ShowTips(t)},t.prototype.GetLayer=function(e){return e==r.UIType.TYPE_UI?this.uiLayer:e==r.UIType.TYPE_POP?this.popLayer:e==r.UIType.TYPE_TIPS?this.tipsLayer:e==r.UIType.TYPE_TOP?this.topLayer:e==r.UIType.TYPE_BATTLE?this.battleLayer:this.popLayer},t.prototype.cpnEnable=function(){p.EVENT.on(u.EventId.PlayerLevelUp,this.PlayerUp,this),p.EVENT.on(u.EventId.PlayerLevelUpPanelClose,this.PlayerUpPanelClose,this),p.EVENT.on(u.EventId.PlayValentineAnim,this.showValentineAnim,this),p.EVENT.on(u.EventId.AttackMonsterResult,this.showAttackMonsterResult,this)},t.prototype.cpnDisable=function(){p.EVENT.off(u.EventId.PlayerLevelUp,this.PlayerUp,this),p.EVENT.off(u.EventId.PlayerLevelUpPanelClose,this.PlayerUpPanelClose,this),p.EVENT.off(u.EventId.PlayValentineAnim,this.showValentineAnim,this),p.EVENT.off(u.EventId.AttackMonsterResult,this.showAttackMonsterResult,this)},t.prototype.PlayerUp=function(e){h.DATA.UserData.isLevelUpPanelCanOpen(e)?this.OpenUI(r.UIDataInfo.LevelUpPanel,e):this.PlayerUpPanelClose(e)},t.prototype.PlayerUpPanelClose=function(e){8==e&&h.DATA.UserData.FunctionOn(s.FunctionKey.BatchMerge)&&(l.default.Instance().CurSceneName==c.SceneName.HOME?this.OpenUI(r.UIDataInfo.UnLockPanelComponent,{type:3,id:0}):this.UIPOPDATAS.push({type:o.UNLOCKITEM,data:{type:3,id:0}}))},t.prototype.ShowPOPUI=function(e){e.type==o.UNLOCKITEM&&l.default.Instance().CurSceneName==c.SceneName.HOME&&this.OpenUI(r.UIDataInfo.UnLockPanelComponent,e)},t.prototype.CanPopUI=function(){return a.Instance().UIPOPDATAS.length>0},t.prototype.showWaitAnim=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=15),this.waiteNode.active=!0,this.waitMask.active=!0,this.waitMask.opacity=e?30:0,this.cpnScheduleOnce(this,this.hideWaitAnim,t)},t.prototype.hideWaitAnim=function(){this.cpnUnschedule(this.hideWaitAnim),this.waiteNode.active=!1,this.waitMask.active=!1},t.prototype.AddSystemNotice=function(e){if(f.default.verifyNode(this.noticeNode)){var t=this.noticeNode.getComponent(m.default);null!=t&&t.NoticeByNoticeData(e)}},t.prototype.showValentineAnim=function(e){if(0!=C.default.CheckShowAnime()){var t="ea_prefab/activity/ValentineFlowerEffect";e.NoticeType==N.SystemNoticeType.ACTIVITY_VALENTIVE_Microphone&&(t="ea_prefab/activity/ValentineMicrophoneEffect",2);var a=this;I.time("(Load) UIManager::showValentineAnim::loadRes "+t),v.load(t,function(o,n){if(a.tryWarningSlowLoader(I.timeEnd("(Load) UIManager::showValentineAnim::loadRes "+t),t),n){var i=cc.instantiate(n);if(i){if(a.flyLayer.getChildByName("valentine"))return;a.flyLayer.addChild(i);var r=i.getComponent(C.default);r&&!d.Obj.isEmpty(e)&&r.setPlayer(e.fromPlayerInfo,e.toPlayerInfo),i.name="valentine"}}},this)}},t.prototype.showChatChangeTip=function(e,t,a){if(f.default.verifyNode(this.chatChangeNode)){var o=this.chatChangeNode.getComponent(L.default);null!=o&&o.showChatChangeTip(e,a,t)}},t.prototype.showAttackMonsterResult=function(e){if(!(this.GetPopViewNum()>0)){var t="effect/prefab/Effect_defeat_shijie",a=S.SoundPath.Battle_Lose;1===e&&(a=S.SoundPath.Battle_Win,t="effect/prefab/Effect_victory_shijie");var o=this.node.height,n=this;I.time("(Load) UIManager::showValentineAnim::loadRes "+t),v.load(t,function(e,i){if(n.tryWarningSlowLoader(I.timeEnd("(Load) UIManager::showValentineAnim::loadRes "+t),t),i){var r=cc.instantiate(i);r&&(T.SOUND.playClip(a,.5),n.flyLayer.addChild(r),r.y=o/2-300,r.name="attackMonsterResult",n.cpnScheduleOnce(n,function(){var e=n.flyLayer.getChildByName("attackMonsterResult");f.default.verifyNode(e)&&(n.flyLayer.removeChild(e,!0),e.destroy())},6))}},this,12e3,!0)}},t.prototype.CanShowPopUI=function(){return!0},t.prototype.EnableShowMask=function(e){this.maskNode.active=e},t.prototype.getPrefabFromPool=function(e){var t=this._prefabPools[e];if(null==t||0==t.size())return null;var a=t.get();if(f.default.verifyNode(a)){a.opacity=255;var o=a.getComponent(g.default);return f.default.verifyComponent(o)&&o.reuse(),a}return null},t.prototype.putPrefabToPool=function(e){var t=e.getComponent(g.default);if(t){if(!this.isCachePanel(t.dataInfo))return!1;var a=this._prefabPools[t.dataInfo.name];return null==a&&(a=new cc.NodePool,this._prefabPools[t.dataInfo.name]=a),t.unuse(),a.put(e),!0}return!1},t.prototype.isCachePanel=function(e){return h.DATA.UserData.FunctionOn(s.FunctionKey.ui_optimize)&&e&&1==e.initType},t.prototype.clearPool=function(e){if(e){if(null==(a=this._prefabPools[e])||0==a.size())return;a.clear()}else if(this._prefabPools)for(var t in this._prefabPools){var a;(a=this._prefabPools[t])&&a.size()>0&&a.clear()}},t.prototype.showLandscapeMask=function(e,t){if(void 0===t&&(t=null),b.instance.isLandscape()){if(e&&t){var a=this.mask1.getComponent(cc.Sprite);a&&f.default.setSpriteFrame(t,a);var o=this.mask2.getComponent(cc.Sprite);o&&f.default.setSpriteFrame(t,o)}this.mask1&&(this.mask1.active=e),this.mask2&&(this.mask2.active=e)}},t.prototype.setWaitStatus=function(e){if(f.default.verifyNode(this.netStatusLayer)){this.netStatusLayer.active=e;var t=this.netStatusAnimNode;f.default.verifyNode(t)&&e&&(t.stopAllActions(),t.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(1.2,255),cc.fadeTo(1.2,64)))))}},t.OldBaseUIFiles=[],t._Instance=null,__decorate([G(P.default)],t.prototype,"sceneTransition",void 0),__decorate([G(cc.Node)],t.prototype,"netStatusLayer",void 0),__decorate([G(cc.Node)],t.prototype,"netStatusAnimNode",void 0),__decorate([G(cc.Node)],t.prototype,"uiLayer",void 0),__decorate([G(cc.Node)],t.prototype,"popLayer",void 0),__decorate([G(cc.Node)],t.prototype,"tipsLayer",void 0),__decorate([G(cc.Node)],t.prototype,"topLayer",void 0),__decorate([G(cc.Node)],t.prototype,"tipsNode",void 0),__decorate([G(cc.Node)],t.prototype,"iconTipsNode",void 0),__decorate([G(cc.Node)],t.prototype,"flyLayer",void 0),__decorate([G(cc.Node)],t.prototype,"battleLayer",void 0),__decorate([G(cc.Node)],t.prototype,"waiteNode",void 0),__decorate([G(cc.Node)],t.prototype,"waitMask",void 0),__decorate([G(cc.Node)],t.prototype,"maskNode",void 0),__decorate([G(cc.Node)],t.prototype,"noticeNode",void 0),__decorate([G(cc.Node)],t.prototype,"chatChangeNode",void 0),__decorate([G(cc.Node)],t.prototype,"mask1",void 0),__decorate([G(cc.Node)],t.prototype,"mask2",void 0),t=a=__decorate([R],t)}(i.default);a.default=O,function(e){e[e.QUEST=0]="QUEST",e[e.LEVELUP=1]="LEVELUP",e[e.UNLOCKITEM=2]="UNLOCKITEM",e[e.REWARDITEM=3]="REWARDITEM"}(o||(o={})),a.UITYPEPOP=o,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/SoundManager":"SoundManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Game/Const/GameDefine":"GameDefine","../../System/ComponentBase":"ComponentBase","../../System/ErrorUtils":"ErrorUtils","../../fws/display/MsgBox":"MsgBox","../../fws/display/dialogs/DialogFrameComponent":"DialogFrameComponent","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/SceneName":"SceneName","../Const/SoundPath":"SoundPath","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Scene/SceneManager":"SceneManager","../Tools/GameTools":"GameTools","../battleReport/NBattleReportCommon":"NBattleReportCommon","../components/RadialBlurTransition":"RadialBlurTransition","../components/activity/ActivityValentineAnimComponent":"ActivityValentineAnimComponent","../controllers/G123IPContentProvider":"G123IPContentProvider","./BaseUI":"BaseUI","./ChatChangeTip":"ChatChangeTip","./CommonIconTips":"CommonIconTips","./SystemNotice":"SystemNotice","./UIManagerLoaders":"UIManagerLoaders"}],UIManagerLoaders:[function(e,t,a){"use strict";cc._RF.push(t,"28ce5WJK3tC/bT8wz8bDq7r","UIManagerLoaders");var o,n=e("../../fws/utils/X"),i=e("../../fws/display/factory/LocalAssertLoader"),r=e("../../fws/display/factory/FWSAssertCaches"),s=e("../../System/ErrorUtils"),l=e("../../System/JSWrap");(function(e){var t=[];function a(e){if(e){n.info("UIManagerLoaders::remove",e.url),e.loader.onError=e.loader.onCompleted=null,e.callback=null,e.callbackTarget=null,e.loader=null,e.url=null;var a=t.indexOf(e);a>=0&&t.splice(a,1)}}e.clear=function(){if(t){n.info("UIManagerLoaders::clear",t.length);for(var e=0;e<t.length;e++)try{var a=t[e];a.loader.onError=a.loader.onCompleted=null,a.callback=null,a.callbackTarget=null,a.loader=null,a.url=null}catch(e){}t.splice(0,t.length)}},e.getFromCache=function(e,t){return i.LocalAssertLoader.getFromCache(e,t)},e.load=function(e,o,c,d,p){void 0===c&&(c=null),void 0===d&&(d=12e3),void 0===p&&(p=!1);var u={url:e,callback:o,callbackTarget:c,loader:new i.LocalAssertLoader(e,cc.Prefab,p)};n.info("UIManagerLoaders::load",e),u.loader.customOverTime=d,u.loader.onError={handler:function(){u.loader.reset(),l.default.setTimeout(function(){u&&u.loader&&u.loader.begin()},1e3)},target:null,data:u.loader},u.loader.onCompleted={handler:function(){try{var t=r.getPrefab(e);u&&u.callback&&u.callback.call(u.callbackTarget,null,t)}catch(t){var o=new s.ErrorInfo;o.errMsgInfo=t,o.funcName="UIManagerLoaders::load::onCompleted",o.customInfo="\u52a0\u8f7d\u5b8c\u6210\u7684\u56de\u8c03\u5f02\u5e38"+e,s.ErrorUtils.errorMessage(o)}a(u)},target:null,data:u.loader},t.push(u),u.loader.begin()}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../System/ErrorUtils":"ErrorUtils","../../System/JSWrap":"JSWrap","../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../fws/display/factory/LocalAssertLoader":"LocalAssertLoader","../../fws/utils/X":"X"}],UnitColours:[function(e,t,a){"use strict";cc._RF.push(t,"b87d2WR8z5C5qPPn2HICsih","UnitColours"),Object.defineProperty(a,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,i=o.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colours=[],t}return __extends(t,e),__decorate([i({type:[cc.Sprite],tooltip:"\u8bbe\u7f6e\u9700\u8981\u53d8\u8272\u7684\u56fe\u7247\u5bf9\u8c61",displayName:"\u8272\u5757\u56fe"})],t.prototype,"colours",void 0),t=__decorate([n],t)}(cc.Component);a.default=r,cc._RF.pop()},{}],WXPayModel:[function(e,t,a){"use strict";cc._RF.push(t,"f4494afzjlMgZUlV/aWcGD1","WXPayModel");var o=e("../../fws/utils/X"),n=e("../../fws/utils/FWSTool"),i=e("../../fws/mvc/FWSMvc"),r=e("../../fws/utils/LocalStorageUtils"),s=e("../../Core/Net/NetMgr"),l=e("../Const/RequestId"),c=e("./BIManager"),d=e("../controllers/ExchangeController"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.tryLocalOrder=function(){var e=this.loadOrder();return!!e&&(o.log("(\u5e10\u5355) \u53d1\u73b0\u4e00\u4e2a\u672a\u53d1\u8d27\u7684\u5e10\u5355",e),this.sendToServer(e),!0)},t.prototype.onFMessage_LOGIN_SUCCESS=function(e){return this.tryLocalOrder()&&o.info("(\u5e10\u5355) \u767b\u5f55\u540e\u8865\u53d1\u5e10\u5355"),!0},t.prototype.onFMessage_PayMsgsRequest=function(e){if(this.tryLocalOrder())return o.info("(\u5e10\u5355) \u8865\u53d1\u4e0a\u6b21\u5e10\u5355"),!0;var t=this,a=null;if(n.Obj.isEmpty(e.data))return!0;var i={mode:"game",env:0,offerId:"1450018389",currentType:"CNY",platform:"android",zoneId:"1",buyQuantity:(a={guid:n.Str.guid(),id:e.data.id,product_id:e.data.product_id,price:e.data.price,buyQuantity:10*e.data.price,time:(new Date).getTime()}).buyQuantity,exchangeId:e.data.id,name:e.data.name,success:function(e){o.log("requestMidasPayment::success",e),c.default.Instance.PostPayAction("PayMidasRet",{productid:a.id.toString(),num:1,money:a.price,orderid:a.guid,ret:0}),t.saveOrder(a),t.sendToServer(a)},fail:function(e){o.log("requestMidasPayment::fail",e),c.default.Instance.PostPayAction("PayMidasRet",{productid:a.id.toString(),num:1,money:a.price,orderid:a.guid})}};return o.trace("(\u5e10\u5355) \u51c6\u5907 \u53d1\u8d77 \u652f\u4ed8\u8bf7\u6c42",i),!window.wx||(!window.wx.requestMidasPayment||(window.wx.requestMidasPayment(i),!0))},t.prototype.saveOrder=function(e){r.set("CurrentPayOrder",e),c.default.Instance.PostPayAction("PayBuy",{productid:e.id.toString(),num:1,money:e.price,orderid:e.guid})},t.prototype.loadOrder=function(){try{var e=r.get("CurrentPayOrder");return n.Obj.isEmpty(e)?null:(new Date).getTime()-e.time>2592e6?null:e}catch(e){return null}},t.prototype.removeOrder=function(){r.del("CurrentPayOrder")},t.prototype.sendToServer=function(e){o.info("(\u5e10\u5355) \u63d0\u4ea4\u670d\u52a1\u5668",e);var t={exchangeId:e.id,product_id:e.product_id,price:e.price,buyQuantity:e.buyQuantity,guid:e.guid,time:e.time,errMsg:e.errMsg,errCode:e.errCode};s.NET.send(l.RequestId.SendPayToServer,t,this,function(e){})},t.prototype.onFMessage_PayToServerPush=function(e){var t=e.data;return!!n.Obj.isEmpty(t)||(this.parseServerPayInfo(t),!0)},t.prototype.parseServerPayInfo=function(e){var t=1,a="",i=-1;o.log("(\u5e10\u5355) \u670d\u52a1\u5668\u8fd4\u56de",e);do{if(null===e)break;1===n.Obj.getPropertyNumberByNames(e,0,"result")&&(t=0),a=n.Obj.getPropertyStringByNames(e,"","orderId"),i=n.Obj.getPropertyNumberByNames(e,-1,"exchangeId"),n.Obj.getPropertyStringByNames(e,"","productId")}while(0);this.biPayBuyRet(t,a,i),this.removeOrder()},t.prototype.biPayBuyRet=function(e,t,a){var i=!1;do{var r=t,s=this.loadOrder();if(r.length<=0){if(null===s)break;r=s.guid}var l=null;if(a<0){if(null===s)break;l=s.id.toString()}else l=a.toString();var p=null,u=d.ExchangeController.Instance.getExchangeConfigById(a);if(u&&(p=n.Obj.getPropertyNumberByNames(u,null,"product_id")),null===p){if(null===s)break;p=s.price}i=!0,c.default.Instance.PostPayAction("PayBuyRet",{productid:l,num:1,money:p,orderid:r,ret:e});var h=n.Str.format("(\u5e10\u5355) BI PayBuyRet \u53d1\u9001\u6210\u529f ret = {0}, bi_productid = {1},  bi_orderId = {2}, bi_money = {3}",e,l,r,p);o.log(h)}while(0);if(i);else{h=n.Str.format("(\u5e10\u5355) BI PayBuyRet \u53d1\u9001\u5931\u8d25 ret = {0}, server_orderId = {1},  server_exchangeId = {2}",e,t,a);o.log(h)}},t.prototype.onFMessage_Dev_PayMsgsRequest=function(e){if(n.Obj.isEmpty(e.data))return!0;var t=e.data.id;return s.NET.send(l.RequestId.DEV_SendPayToServer,{exchangeId:t},this,function(e){}),!0},t}(i.FMessageConnectionAbstract);t.exports=p,cc._RF.pop()},{"../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Const/RequestId":"RequestId","../controllers/ExchangeController":"ExchangeController","./BIManager":"BIManager"}],DiffBizCommon:[function(e,t,a){"use strict";var o;cc._RF.push(t,"c4ea1Nk/xJBxp+95zN6oOR/","DiffBizCommon"),function(e){e.DiffBizLanguages={}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],DiffBizTool:[function(e,t,a){"use strict";cc._RF.push(t,"d706dpcR9VGZL1fxlr2SFit","DiffBizTool"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../fws/platforms/PlatformCore"),n=e("./DiffBizCommon"),i=e("../../../Core/Common/LocalManager"),r=e("../../../Core/Common/TableManager"),s=e("../../Const/TableName"),l=e("../ConfigCommon"),c=e("../../Data/DataCenter"),d=function(){function e(){}return e.prototype.testAreaUnlockTable=function(){var e=r.TABLE.getTableGroup(s.TableName.AREA_UNLOCK);for(var t in e){var a=e[t];delete a.cost_coin,delete a.cost_gold,delete a.item_amount,delete a.item_id,delete a.min_level,delete a.cond_desc;var o="\u65e0\u6761\u4ef6",n=r.TABLE.getTableGroup(c.DATA.UserData.scienceTableName);switch(a.cond_type){case l.AreaUnlockConditionTypes.PlayerLevel:o="\u73a9\u5bb6\u7b49\u7ea7\u8fbe\u5230"+a.cond_amount;break;case l.AreaUnlockConditionTypes.TechLevel:var d=function(e){for(var t in n){var a=n[t];if(a.group_id==e)return a}return null}(a.cond_target),p="";d&&(p=i.LOCAL.getText(d.name)||p),o="\u79d1\u6280<"+p+">\u7b49\u7ea7\u8fbe\u5230"+a.cond_amount;break;case l.AreaUnlockConditionTypes.AdventureLevel:o="\u6302\u673a\u5192\u9669\u8fc7\u7b2c"+a.cond_amount+"\u5173";break;case l.AreaUnlockConditionTypes.Power:o="\u6218\u529b\u8fbe"+a.cond_amount}var u="\u65e0\u6d88\u8017";switch(a.cost_type){case l.AreaUnlockCostTypes.Coin:u=a.cost_amount+"\u91d1\u5e01";break;case l.AreaUnlockCostTypes.Soil:u=a.cost_amount+"\u7cae\u98df";break;case l.AreaUnlockCostTypes.Oil:u=a.cost_amount+"\u77f3\u6cb9";break;case l.AreaUnlockCostTypes.Gold:u=a.cost_amount+"\u94bb\u77f3";break;case l.AreaUnlockCostTypes.Item:u=a.cost_amount+"\u9053\u5177"+a.cost_target}a._cond_=o,a._cost_=u}},e.prototype.testArmyTable=function(){var e=r.TABLE.getTableGroup(s.TableName.ARMY);for(var t in e){var a=e[t];delete a.new_app_model,delete a.new_model,delete a.new_name,delete a.model_id,delete a.model_id_app,delete a.fighting_power}},e.prototype.testModelTable=function(){var e=r.TABLE.getTableGroup(s.TableName.MODEL);for(var t in e){var a=e[t];delete a.new_fight_down,delete a.new_fight_up,delete a.new_icon,delete a.new_image_path,delete a.new_model,delete a.new_model_down,delete a.new_model_up}},e.prototype.modifyConfig=function(){this.callMethod("modifyConfig",!0)},e.prototype.callMethod=function(e,t){for(var a=[],r=2;r<arguments.length;r++)a[r-2]=arguments[r];try{var s=o.instance[e],l=n.DiffBizLanguages[i.LOCAL.CurrLang];return t?(l&&l[e]&&l[e].apply(l,a),void s[e].apply(s,a)):(l&&l[e]?l[e].apply(l,a):null)||s[e].apply(s,a)}catch(e){return}},e.prototype.getUnlockAreaWater=function(){return this.callMethod("getUnlockAreaWater",!1)},e.prototype.getUnlockAreaTrees=function(){return this.callMethod("getUnlockAreaTrees",!1)},e.prototype.getUnlockAreaTree=function(){return this.callMethod("getUnlockAreaTree",!1)},e.prototype.getDefaultCity=function(e){return this.callMethod("getDefaultCity",!1,e)},e.prototype.getDefaultCity_Big=function(e){return this.callMethod("getDefaultCity_Big",!1,e)},e.prototype.getWorldMapBinLayer=function(e){return this.callMethod("getWorldMapBinLayer",!1,e)},e.prototype.getWorldMapUnit=function(e,t){return this.callMethod("getWorldMapUnit",!1,e,t)},e.prototype.getMarchPrefabPath=function(e){return this.callMethod("getMarchPrefabPath",!1,e)||e},e.prototype.getHomemapTerrainPrefab=function(){return this.callMethod("getHomemapTerrainPrefab",!1)},e.prototype.getFirstChargeGiftBg=function(){return this.callMethod("getFirstChargeGiftBg",!1)},e.prototype.getWorldMapDefaultCitySkin=function(e,t){switch(t){case"ar":return 2==e?"alb_face_2":"alb_face_1";default:return 2==e?"castle_face_2":"castle_face_1"}},e.prototype.getWorldMapDefaultMarchSkin=function(e){switch(e){case"ar":return"ea_prefab/world/march/prefabWorldMarch_alb_default";default:return"ea_prefab/world/march/prefabWorldMarch"}},e}();a.DIFF_BIZ_TOOL=new d,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../fws/platforms/PlatformCore":"PlatformCore","../../Const/TableName":"TableName","../../Data/DataCenter":"DataCenter","../ConfigCommon":"ConfigCommon","./DiffBizCommon":"DiffBizCommon"}],IconComponent:[function(e,t,a){"use strict";cc._RF.push(t,"89f997XXlpL6JFu2c1Ko1uu","IconComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=cc._decorator,i=n.ccclass,r=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.colour=null,t}return __extends(t,e),__decorate([r(cc.Sprite)],t.prototype,"icon",void 0),__decorate([r(cc.Sprite)],t.prototype,"colour",void 0),t=__decorate([i],t)}(o.default);a.default=s,cc._RF.pop()},{"../../../System/ComponentBase":"ComponentBase"}],IconSystemCommon:[function(e,t,a){"use strict";var o;cc._RF.push(t,"590b2FSJYNB4J8f0qpJAj+p","IconSystemCommon"),function(e){(function(e){e[e.SMALL=50]="SMALL",e[e.MEDIUM=160]="MEDIUM",e[e.LARGE=400]="LARGE"})(e.IconSize||(e.IconSize={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],IconTool:[function(e,t,a){"use strict";cc._RF.push(t,"6bd3e6HbQhOm4l+UnmjVTBz","IconTool");var o,n=e("./IconSystemCommon"),i=e("../ConfigCommon"),r=e("../../Tools/GameTools"),s=e("../utils/UnitColoursTool"),l=e("../../../Core/Common/TableManager"),c=e("./IconComponent"),d=e("../LoadManager");(function(e){function t(){var e=(new cc.Node).addComponent(cc.Sprite);return e.trim=!1,e.sizeMode=cc.Sprite.SizeMode.RAW,e}function a(e,t,a,o){var n=a||"";t=t||"",n&&"/"!=n.substr(n.length-1,1)?n+="/"+t:n+=t,t&&(/^\w+:/.test(n)?cc.loader.load(n,function(t,a){try{if(!t&&r.default.verifyComponent(e)){var n=new cc.SpriteFrame(a);e.spriteFrame=n,o&&o()}}catch(e){}}):d.LoadManager.loadSpriteFrame(n,function(t,a){try{!t&&r.default.verifyComponent(e)&&(e.spriteFrame=a,o&&o())}catch(e){}},null))}function o(e,o,n,i,r,l){var c=Number(i)||1,d=Number(r)||0,p=Number(l)||0,u=t();if(a(u,e,o),n){var h=t();u.node.addChild(h.node),s.setColour(h,n,!0),a(h,e+"_colour",o)}return u.node.scale=c,u.node.x=d,u.node.y=p,u.node}function l(e,o,n){void 0===o&&(o="");var i=t();return a(i,e,o,function(){if(n){var e=n/i.node.width,t=n/i.node.height;i.node.scale=Math.min(e,t)}}),i.node}function p(e,t,a){var o=new cc.Node,n=e||"";return n?(n="ea_prefab/icon/"+n,cc.loader.loadRes(n,cc.Prefab,function(e,n){try{if(!e&&r.default.verifyNode(o)&&n){var i=cc.instantiate(n);if(i){if(a){var l=i.width,d=i.height;l=a/l,d=a/d,i.scale=Math.min(l,d)}var p=i.getComponent(c.default);p&&p.colour&&s.setColour(p.colour,t,!0),o.addChild(i)}}}catch(e){}}),o):null}function u(e,t){var a=new cc.Node,o=t||"";return e&&("/"!=t.substr(t.length-1,1)?o+="/"+e:o+=e,cc.loader.loadRes(o,cc.Prefab,function(e,t){if(r.default.verifyNode(a)&&t){var o=cc.instantiate(t);a.addChild(o)}})),a}function h(e){if(r.default.verifyNode(e)){var t=e.getComponent(cc.Sprite);t&&(t.spriteFrame=null),e.safetyDestroyAllChildren()}}function m(e,t,a,n,r,s,c,d){var h=null;if(e.iconSrc&&e.iconType>0){switch(e.iconType){case i.IconSourceType.Image:h=l(e.iconSrc,a,d);break;case i.IconSourceType.Icon:h=p(e.iconSrc,n,d);break;case i.IconSourceType.Prefab:h=u(e.iconSrc,a)}if(h&&d){var m=h.width,f=h.height;if(m>0&&f>0){m=d/m,f=d/f;var _=Math.min(m,f);h.scale=_}}}else h=o(t,a,n,r,s,c);return h}e.updateModelIcon=function(e,t,a){void 0===a&&(a=n.IconSize.MEDIUM),h(e);var o=m(t,t.image_path+"/"+t.icon,"",t.color,t.scale_para,t.x_para,t.y_para,a);o&&e.addChild(o)},e.updateBuildingIcon=function(e,t,a){void 0===a&&(a=n.IconSize.MEDIUM),h(e);var o="image/building";t.iconType==i.IconSourceType.Image&&t.iconSrc.indexOf("/")>=0&&(o="");var r=m(t,t.model||t.prefab,o,t.color,t.scale_para,t.x_para,t.y_para,a);r&&e.addChild(r)},e.updateResourceBuildingIcon=function(e,t){h(e);var a=m(t,t.model,"image/world_unit","",t.scale_para,t.x_para,t.y_para,104);a&&e.addChild(a)},e.updateTowerBuildingIcon=function(e,t){h(e);var a=m(t,t.prefab,"image/Profession","",t.scale_para,t.x_para,t.y_para,104);a&&e.addChild(a)}})(o||(o={})),window.TestIcon=function(){l.TABLE.assign("building",{iconSrc:"building/barracks/IconBarracksGround1",iconType:2})},t.exports=o,cc._RF.pop()},{"../../../Core/Common/TableManager":"TableManager","../../Tools/GameTools":"GameTools","../ConfigCommon":"ConfigCommon","../LoadManager":"LoadManager","../utils/UnitColoursTool":"UnitColoursTool","./IconComponent":"IconComponent","./IconSystemCommon":"IconSystemCommon"}],UnitColoursTool:[function(e,t,a){"use strict";cc._RF.push(t,"f3ff7AU5S1OjKk1exDtHPSR","UnitColoursTool");var o,n=e("../UnitColours");(function(e){function t(e,t,a,o){return e.getR()==t&&e.getG()==a&&e.getB()==o}function a(e,a,o){if(void 0===o&&(o=!1),e&&e.isValid&&e.node&&e.node.isValid)if(a){var n;if("string"==typeof a?(n=new cc.Color).fromHEX(a):n=a,o){var i=96;t(n,255,0,0)?i=100:t(n,255,101,0)&&(i=110),e.node.opacity=i}e.node.color=n}else e.node.opacity=0}e.setNode=function(e,t,o){if(void 0===o&&(o=null),e&&e.isValid){var i=e.getComponent(n.default);if(i&&i.colours&&!(i.colours.length<1)){var r=null;t&&(r=new cc.Color).fromHEX(t);for(var s=0;s<i.colours.length;s++)a(i.colours[s],r,!0)}}},e.checkColor=t,e.setColour=a})(o||(o={})),t.exports=o,cc._RF.pop()},{"../UnitColours":"UnitColours"}],EventId:[function(e,t,a){"use strict";cc._RF.push(t,"bdc3bRy0AZHjaZ4iFCD8aYg","EventId"),Object.defineProperty(a,"__esModule",{value:!0}),a.EventId={CHANGE_SCENE:"CHANGE_SCENE",CURRENCY_UPDATE:"CURRENCY_UPDATE",Power_UPDATE:"STAR_UPDATE",ENERGY_UPDATE:"ENERGY_UPDATE",Energy_AllianceCoinDonateRemainNum:"Energe_AlianceCoinDonateRemainNum",Exchange_Update:"Exchange_Update",Exp_Update:"Exp_Update",Exp_Lock:"Exp_Lock",Exp_UnLock:"Exp_UnLock",PlayerInfo_Update:"PlayerInfo_Update",UploadHeadIconSuccess:"UploadHeadIconSuccess",ResetUploadbtns:"ResetUploadbtns",Area_Update:"Area_Update",Occupations_Update:"Occupations_Update",MapPoint_Update:"MapPoint_Update",People_Update:"People_Update",Board_Update:"Board_Update",ArmyBox_Update:"ArmyBox_Update",ArmyBox_ADD:"ArmyBox_ADD",ArmyBoxUpdateClient:"ArmyBoxUpdateClient",BuildBox_Update:"BuildBox_Update",BuildBox_ADD:"BuildBox_ADD",Buff_Update:"Buff_Update",Quest_Update:"Quest_Update",Friend_Update:"Friend_Update",Friend_Del:"Friend_Del",Friending_Update:"Friending_Update",Friending_Del:"Friending_Del",RemoveHomeObstacle:"RemoveHomeObstacle",UserData_Update:"UserData_Update",Building_Update:"Building_Update",Buildings_Update:"Buildings_Update",Auto_Collect:"Auto_Collect",Buildings_Collect:"Buildings_Collect",Building_Update_Pos:"Building_Update_Pos",Resource_Update:"Resource_Update",Army_Update:"Army_Update",Armys_Update:"Armys_Update",Army_Update_Pos:"Army_Update_Pos",Army_Move:"Army_Move",Army_Drop:"Army_Drop",Items_Update:"Items_Update",WorldSite_Update:"WorldSite_Update",WorldPointMarch_Update:"WorldPointMarch_Update",Item_Update:"Item_Update",Item_ADD:"Item_ADD",Item_Update_Bag:"Item_Update_Bag",Item_Buy_CallBack:"Item_Buy_CallBack",Building_Merge_Suc:"Building_Merge_Suc",Building_Batch_Merge_Suc:"Building_Batch_Merge_Suc",Army_Merge_Suc:"Army_Merge_Suc",Army_Batch_Merge_Suc:"Army_Batch_Merge_Suc",Building_Drop:"Building_Drop",Building_Delete:"Building_Delete",COIN_ADD:"COIN_ADD",COIN_SUM:"COIN_SUM",WOOD_ADD:"WOOD_ADD",WOOD_SUM:"WOOD_SUM",OIL_ADD:"OIL_ADD",OIL_SUM:"OIL_SUM",OILA_ADD:"OILA_ADD",OILA_SUM:"OILA_SUM",METAL_ADD:"METAL_ADD",METAL_SUM:"METAL_SUM",SOIL_ADD:"SOIL_ADD",SOIL_SUM:"SOIL_SUM",COAL_ADD:"COAL_ADD",COAL_SUM:"COAL_SUM",GOLD_ADD:"GOLD_ADD",GOLD_SUM:"GOLD_SUM",HONOR_ADD:"HONOR_ADD",HONOR_SUM:"HONOR_SUM",MILITARY_ADD:"MILITARY_ADD",MILITARY_SUM:"MILITARY_SUM",RES_CHANGE:"RES_CHANGE",HONOR_UPDATE:"HONOR_UPDATE",VOUCHER_ADD:"VOUCHER_ADD",VOUCHER_SUM:"VOUCHER_SUM",STARTADVENTURE:"STARTADVENTURE",ADVENTURECLICK:"ADVENTURECLICK",Building_LevelUp:"Building_LevelUp",GetOrderResponse:"GetOrderResponse",BuildingShopItemClick:"BuildingShopItemClick",LimitedShopUpdate:"LimitedShopUpdate",PlayerLevelUp:"PlayerLevelUp",PlayerLevelUpUpdate:"PlayerLevelUpUpdate",PlayerLevelUpPanelClose:"PlayerLevelUpPanelClose",MonthlyCardRewardUpdate:"MonthlyCardRewardUpdate",UpdateShareBox:"UpdateShareBox",HideProductionIcon:"HideProductionIcon",HideSpeedBtn:"HideSpeedBtn",ShowProductionIcon:"ShowProductionIcon",BaseItemHoldDown:"BaseItemHoldDown",BaseItemSameGroundShow:"BaseItemSameGroundShow",BaseItemSameGroundHide:"BaseItemSameGoundHide",UpdateTimeDowns:"UpdateTimeDowns",UnlockHaitun:"UnlockHaitun",UnlockTileEnd:"UnlockTileEnd",TilePVEPush:"TilePVEPush",AreaBattleComplete:"AreaBattleComplete",UnlockTileOff:"UnlockTileOff",UnlockTileOn:"UnlockTileOn",HideBuildingList:"HideBuildingList",ShowBuildingList:"ShowBuildingList",GuideStepChange:"GuideStepChange",HideGuideTips:"HideGuideTips",ShowGuideTips:"ShowGuideTips",ShowGuideMoveTips:"ShowGuideMoveTips",GuideShowArmy:"GuideShowArmy",GuideShowArmy2:"GuideShowArmy2",UnLockTileTips:"UnLockTileTips",ShowGuideUITips:"ShowGuideUITips",HideGuideUITips:"HideGuideUITips",ShowGuideUIMoveTips:"ShowGuideUIMoveTips",AttackingMarchUpdate:"AttackingMarchUpdate",ShowShougeji:"ShowShougeji",Science_Update:"Science_Update",BuildingListHide:"BuildingListHide",BuildingListItemComplete:"BuildingListItemComplete",UpdateMailList:"UpdateMailList",UpdateMailDetailPanel:"UpdateMailDetailPanel",UpdateSingleMail:"UpdateSingleMail",UpdateMailData:"UpdateMailData",UpdateUnReadMailNum:"UpdateUnReadMailNum",InitChatHistory:"initChatHistory",UpdateChatPanel:"UpdateChatPanel",ChatDataDeleted:"ChatDataDeleted",RequestPrivateChatPanel:"RequestPrivateChatPanel",RemoveChatUser:"RemoveChatUser",ChatSettingChange:"ChatSettingChange",ChatGroupListRefresh:"ChatGroupListRefresh",ChatUpdateAllianceHelpRedNode:"ChatUpdateAllianceHelpRedNode",ShowRedPoint:"ShowRedPoint",CheckShowRedPoint:"CheckShowRedPoint",ReloadWelcomeRewardBuilding:"ReloadWelcomeRewardBuilding",FreeCoinUpdate:"FreeCoinUpdate",PresetMarchUpdate:"PresetMarchUpdate",PresetMarchSaveSuccess:"PresetMarchSaveSuccess",UpdateUnlockOcean:"UpdateUnlockOcean",UpdateProviceTimes:"UpdateProviceTimes",LocalDataUpdate:"LocalDataUpdate",AutoAssemlbyDataUpdate:"AutoAssemlbyDataUpdate",StopMergeAni:"StopMergeAni",ActivityDataUpdate:"ActivityDataUpdate",MainUI_Update:"MainUI_Update",UpdateFreeCoin:"UpdateFreeCoin",checkMainUIPopups:"checkMainUIPopups",HospitalUpdateOrderQueue:"UpdateOrderQueue",HospitalOrderQueueAdd:"HospitalOrderQueueAdd",UpdateScienceItem:"UpdateScienceItem",AllianceHelpUpdate:"AllianceHelpUpdate",WorldIdUpdate:"WorldIdUpdate",ScienceShareGetNewUser:"ScienceShareGetNewUser",ScienceExpFly:"ScienceExpFly",LastScienceGuide:"LastScienceGuide",UpdateSharkMoneyTreeData:"UpdateSharkMoneyTreeData",RemoveBlockPlayer:"RemoveBlock",AllianceDataUpdate:"AllianceDataUpdate",AllianceScienceInitData:"AllianceScienceInitData",AllianceUpLevelScience:"AllianceUpLevelScience",AllianceScienceDonate:"AllianceScienceDonate",AllianceScienceRecommend:"AllianceScienceRecommend",AllianceScienceDone:"AllianceScienceDone",AllianceShopData:"AllianceShopData",AllianceBuyShopItem:"AllianceBuyShopItem",AllianceShopItemDataUpdate:"AllianceShopItemDataUpdate",AllianceScore:"AllianceScore",AllianceShopDataUpdate:"AllianceShopDataUpdate",AllianceShopStatus:"AllianceShopStatus",AllianceScienceClick:"AllianceScienceClick",AllianceFakeGiftUpdate:"AllianceFakeGiftUpdate",AllianceMemberStatus:"AllianceMemberStatus",AllianceMemberDynamicUpdate:"AllianceMemberDynamicUpdate",AllianceTerritoryDataUpdate:"AllianceTerritoryDataUpdate",AllianceMoveInviteUpdate:"AllianceMoveInviteUpdate",AllianceBossDonateUptate:"AllianceBossDonateUptate",AllianceSettingPanelClose:"AllianceSettingPanelClose",ACTIVITY_ICON_UPDATE:"ACTIVITY_ICON_UPDATE",ACTIVITY_ONE_UPDATE:"ACTIVITY_ONE_UPDATE",ACTIVITY_EXTRA_UPDATE:"ACTIVITY_EXTRA_UPDATE",TreasureBoxUpdate:"TreasureBoxUpdate",TreasurePieceUnlockAnimeCheck:"TreasurePieceUnlockAnimeCheck",TreasureBookCacheItemUpdate:"TreasureBookCacheItemUpdate",TreasurePieceLogUpdate:"TreasurePieceLogUpdate",CountryBossDataUpdate:"CountryBossDataUpdate",WorldTreasureDataUpdate:"WorldTreasureDataUpdate",ProductItemClick:"ProductItemClick",ProductingDataUpdate:"ProductingDataUpdate",UpdateEnhance:"UpdateEnhance",AllianceGiftUpdate:"AllianceGiftUpdate",PveTowerUpdate:"PveTowerUpdate",PveTowerItemClick:"PveTowerItemClick",GuideNodeOnUI:"GuideNodeOnUI",VoteTimeDataUpdate:"VoteTimeDataUpdate",TutorialDialogComplete:"TutorialDialogComplete",PlayValentineAnim:"PlayValentineAnim",UpdateTimeReward:"UpdateTimeReward",ActivityShareBoxRefresh:"ActivityShareBoxRefresh",BlockVeinAction:"BlockVeinAction",HideBuildingGuideHand:"HideBuildingGuideHand",ShowTerritoryName:"ShowTerritoryName",HideTerritoryName:"HideTerritoryName",RefreshUserInfo:"RefreshUserInfo",ChatEmotionClose:"ChatEmotionClose",ChatEmotionChangeStr:"ChatEmotionChangeStr",AssemblyCreate:"AssemblyCreate",AssemblyUpdate:"AssemblyUpdate",AssemblysUpdate:"AssemblysUpdate",AssemblyDel:"AssemblyDel",DubblingPackUpdate:"DubblingPackUpdate",AssistanceUpdate:"AssistanceData",AssistanceRecordUpdate:"AssistanceRecordUpdate",AssemblyBattleRecordUpdate:"AssemblyBattleRecordUpdate",AttackMonsterResult:"AttackMonsterSuc",ClearAllianceChatMsg:"ClearAllianceChatMsg",CharacterListUpdate:"CharacterListUpdate",WorldSiteUpdate:"WorldSiteUpdate",updateScienceBtn:"updateScienceBtn",MiniMapViewToWorldSite:"MiniMapViewToWorldSite",MiniMapViewToThrone:"MiniMapViewToThrone",ChangeWorldSiteName:"ChangeWorldSiteName",ChangeThroneName:"ChangeThroneName",ThroneDataUpdate:"ThroneDataUpdate",ThroneGiftDataUpdate:"ThroneGiftDataUpdate",ThroneKingGiftUpdate:"ThroneKingGiftUpdate",AllianceChatRewardUpdate:"AllianceChatRewardUpdate",TowerDetailUpdate:"TowerDetailUpdate",TowerDetailRequestUpdate:"TowerDetailRequestUpdate",ThroneTowerAttack:"ThroneTowerAttack",ThroneBattleTimeUpdate:"ThroneBattleTimeUpdate",ScoutMailItemClick:"ScoutMailItemClick",WorldAirDropUpdate:"WorldAirDropUpdate",WorldAirPlaneUpdate:"WorldAirPlaneUpdate",WorldAirPlaneLockCamera:"WorldAirPlaneLockCamera",DarkPortalUpdate:"DarkPortalUpdate",HeroChipExchange:"HeroChipExchange",AdventureBattleStart:"AdventureBattleStart",AdventureSweepStart:"AdventureSweepStart",AdventureDataUpdate:"AdventureDataUpdate",AdventureHeroSelect:"AdventureHeroSelect",AdventureScoutFindEnemy:"AdventureScoutFindEnemy",CrossServerEventLogUpdate:"CrossServerEventLogUpdate",Refresh_IslandData:"Refresh_IslandData",NextFloor_IslandData:"NextFloor_IslandData",ShopRefresh_IslandData:"ShopRefresh_IslandData",CSPointRewardItemClick:"CSPointRewardItemClick",DisableBattleMailReplay:"DisableBattleMailReplay",BattleReportComparisonShow:"BattleReportComparisonShow",ActivityShop_Refesh:"ActivityShop_Refesh",UPDATE_HAMMER_BOSS_REWARD:"UPDATE_HAMMER_BOSS_REWARD",UPDATE_HAMMER_BOSS_PA_CHANGED:"UPDATE_HAMMER_BOSS_PA_CHANGED",HIGH_PUT_HERO_MARCH:"HIGH_PUT_HERO_MARCH",HIGH_PUT_OFF_HERO:"HIGH_PUT_OFF_HERO",RechargeScoreShop_Refesh:"RechargeScoreShop_Refesh",RechargeScoreSpin_Refesh:"RechargeScoreSpin_Refesh",PushLuckyDraw:"PushLuckyDraw",OpenHeroSkin:"OpenHeroSkin",PROFESSION_LEARN_DATA_CHANGED:"PROFESSION_LEARN_DATA_CHANGED",PROFESSION_STATE_CHANGE:"PROFESSION_STATE_CHANGE",PROFESSION_LEARNED_FOCUS_TALENT:"PROFESSION_LEARNED_FOCUS_TALENT",PROFESSION_CLEAR_TALENT:"PROFESSION_CLEAR_TALENT",PROFESSION_TOWERLIST_REFRESH:"PROFESSION_TOWERLIST_REFRESH",UPDATE_USER_MONSTER_SIEGE:"UPDATE_USER_MONSTER_SIEGE",UPDATE_ALLIANCE_MONSTER_SIEGE:"UPDATE_ALLIANCE_MONSTER_SIEGE",REFRESH_THANKGIVING:"Refresh_ThanksGiving",CommonMailTipsShow:"CommonMailTipsShow",CommonRewardPanelClose:"CommonRewardPanelClose",CheckShowModRedPoint:"CheckShowModRedPoint",AllianceMemberInviteUpdate:"AllianceMemberInviteUpdate",AtiIndulgedUpdate:"AtiIndulgedUpdate",WareHouseCellChooseStateChange:"WareHouseCellChooseStateChange",ChatGroupMemberChange:"ChatGroupMemberChange",ChatGroupNameChange:"ChatGroupNameChange",CONSIGN_SLAE_BUY_NUM_CHANGE:"CONSIGN_SLAE_BUY_NUM_CHANGE",FORMULA_MAKE_COMPLETE:"FORMULA_MAKE_COMPLETE",DEF_TRAPS_SLOTS_INFO:"DEF_TRAPS_SLOTS_INFO",POTION_USE_EFFECT:"POTION_USE_EFFECT",EIGHT_COUNTRY_STATUS_PUSH:"EIGHT_COUNTRY_STATUS_PUSH",EIGHT_COUNTRY_STATUS_PUSH_CHANGE:"EIGHT_COUNTRY_STATUS_PUSH_CHANGE",KVK_ALLIANCE_BUILDING_STATUS_CHANGE:"_KVK_ALLIANCE_BUILDING_STATUS_CHANGE",KVK_INFO_CHANGE:"KVK_INFO_CHANGE",KVK_COUNTRY_INFO_CHANGE:"KVK_COUNTRY_INFO_CHANGE",KVK_ALLIANCE_INFO_CHANGE:"KVK_ALLIANCE_INFO_CHANGE",Push_KVK_ACHEVEMENT_CHANGE:"Push_KVK_ACHEVEMENT_CHANGE",Push_KVK_ACHEVEMENT_CELL_CHANGE:"Push_KVK_ACHEVEMENT_CELL_CHANGE",Push_KVK_PROGRESS_CHANGE:"Push_KVK_PROGRESS_CHANGE",KVK_ALLIANCE_COLOR_CHANGE:"KVK_ALLIANCE_COLOR_CHANGE",Push_KVK_FINISH_CHANGE:"Push_KVK_FINISH_CHANGE",Push_KVK_FINISH_DATA_CHANGE:"Push_KVK_FINISH_DATA_CHANGE",KVK_ACHEVEMENT_DATA_REFRESH:"KVK_ACHEVEMENT_DATA_REFRESH",KVK_PROGRESS_DATA_REFRESH:"KVK_PROGRESS_DATA_REFRESH",Push_KVK_EXPEDITION_FINISH_CHANGE:"Push_KVK_EXPEDITION_FINISH_CHANGE",Push_KVK_EXPEDITION_FINISH_DATA_CHANGE:"Push_KVK_EXPEDITION_FINISH_DATA_CHANGE",DECORATE_STOREHOUSE_CHANGE:"DECORATE_STOREHOUSE_CHANGE",DECORATE_STOREHOUSE_CELL_TOUCHSTART:"DECORATE_STOREHOUSE_CELL_TOUCHSTART",DECORATE_STOREHOUSE_CELL_TOUCHMOVE:"DECORATE_STOREHOUSE_CELL_TOUCHMOVE",DECORATE_STOREHOUSE_CELL_TOUCHOVER:"DECORATE_STOREHOUSE_CELL_TOUCHOVER",DECORATE_STOREHOUSE_PUTIN:"DECORATE_STOREHOUSE_PUTIN",GUN_FIGHT_INFO_CHANGE:"GUN_FIGHT_INFO_CHANGE",CLOSEUI:"closeUI",GameNoticeDataUpdate:"GameNoticeDataUpdate",IsleFlagClick:"IsleFlagClick",IsleDataUpdate:"IsleDataUpdate",IsleEmbattleCall:"IsleEmbattleCall",IsleFlagHideSelectEffect:"IsleFlagHideSelectEffect",IsleViewReset:"IsleViewReset",IsleViewNextChapter:"IsleViewNextChapter",ChapterTaskDataUpdate:"ChapterTaskDataUpdate",ChangeFlagShowDetail:"ChangeFlagShowDetail",HomeSceneEnded:"HomeSceneEnded",TREASURE_MAP_DATA_REMOVE:"TREASURE_MAP_DATA_REMOVE",TREASURE_MAP_DATA_ADD:"TREASURE_MAP_DATA_ADD",TREASURE_MAP_DATA_UPDATE:"TREASURE_MAP_DATA_UPDATE",TreasureMapMsgCheckTime:"TreasureMapMsgCheckTime",TREASURE_MAP_TASKS_UPDATE:"TREASURE_MAP_TASKS_UPDATE",TreasureThemeDataUpdate:"TreasureThemeDataUpdate",EXPLORE_SEA_LEGEND_BOX_NOTICE:"EXPLORE_SEA_LEGEND_BOX_NOTICE",DecorationSuitUpdate:"DecorationSuitUpdate",UPDATE_COLLECTION_MACHINE_INFO:"UPDATE_COLLECTION_MACHINE_INFO",UPDATE_COLLECTION_MACHINE_COIN_CACHE:"UPDATE_COLLECTION_MACHINE_COIN_CACHE"},cc._RF.pop()},{}],GameDefine:[function(e,t,a){"use strict";var o;cc._RF.push(t,"301dbvi5OhJuZREuEVxs0t2","GameDefine"),function(e){e.Building_Prefab_Name="model",e.EnergyType={Action:1,CITY_DEF:2,BUY_COIN:3,ALLIANCE_DONATE_NUM:4,ALLIANCE_BUILDING_DONATE_NUM:5,ALLIANCE_BUILDING_DONATE_GOLD_NUM:6},e.ResourceType={Coin:1,Wood:2,Oil:3,Oila:5,Metal:6,Soil:7,Coal:8,Gold:10,Energy:11,Exp:12,Honor:13,Military:14,Voucher:15,BountyCount:16,SpItem:66668,AdventureCoin:17,kvk_res:18,kvk_honor:19,Item:23,Power:99,Army:101,Building:1001,islandPoint:9999,sharkMoneyTreeBox:99999,AGExp:201,AGKey:202,FreeGold:401,PaidGold:402,ArmyEquip:99998,AdventureRewardBox:100001},e.ResourceNameConst={1:"110116",2:"110117",3:"110118",4:"110119",5:"110118",6:"110120",7:"110121",8:"110122",10:"110123",11:"110124",12:"110125",14:"110126",15:"public953"},e.BaseItemType={Building:1,Army:2,Pet:3},e.ProductionType={Resource:1,Army:2},e.ArmyType={Land:101,Sea:201,Air:301},e.ArmyGroupType={Player:0,Monster:1,Boss:2},e.MainUIType={Home:1,World:2},e.PVEFirstID=101;var t,a=function(){return function(e,t,a,o,n,i,r){this.moneyTreeJackpotNum=a,this.moneyTreeUseBuyTime=t,this.moneyTreeUseFreeTime=e,this.totalNum=o,this.currentClickNum=n,this.mutipleBaseValue=i,this.moneyTreeCritPoint=r}}();e.SharkMoneyTreeData=a,e.FunctionKey={Share:"share",ShareReward:"share_reward",Treasure:"treasure",Guide:"guide",Task:"task",Science:"science",ScienceCostNew:"science_cost_tuning",Pay:"pay",Rank:"rank",Mail:"mail",Chat:"chat",ChatUpdate:"chat_update",NpcTip:"npc_tip",new_pay_gift:"new_pay_gift",AdvanceGift:"advance_gift",LuxuryGift:"luxury_gift",AreaRound:"area_round",TileLine:"tile_line",weekly_card:"weekly_card",monthly_card:"monthly_card",growth_fund:"growth_fund",InviteFriend:"invite_friend",FreeCoin:"share_gold",PVP:"pvp",newbie_reward:"newbie_reward",pvp_in_nation:"pvp_in_nation",ad_test:"ad_test",Second_area_unlock:"2nd_area_unlock",Job:"job",buy_prop:"buy_prop",promotion:"promotion",Speed_army:"speed_army",Army_Speed_New:"army_speed_new",Buy_Energy:"buy_energy",move_city:"move_city",shield:"shield",Seven_Day:"seven_day",Alliance:"league",AllianceScience:"alliance_science_donation",AllianceShop:"alliance_shop",CastleFace:"skin",BatchMerge:"batch_merge",Watch_ad:"watch_ad",Hospital:"hospital",ShareScience:"share_science",AllianceHelp:"league_help",AllianceNotice:"alliance_notice",AllianceHelpNew:"alliancehelp_system",AlliacneAssemlby:"reinforcement",AlliacneAssemblyBoss:"reinforcement_monster",Favorite:"favorite",ChatNewSocket:"chatnewsocket",battle_rank:"battle_rank",share_newreward:"share_newreward",lucky_tree:"lucky_tree",Gather:"gather",Enhance_Basic:"enhance_basic",share_moneytree_level:"share_moneytree_level",Bag:"bag",share_science_level:"share_science_level",share_new_level:"share_new_level",world_boss:"world_boss",world_throne:"world_throne",CONFIG_FORCE_UPDATE:"client_updata_tips",externalActivity:"qqmini_icon",externalActivity2:"qqmini_icon2",externalActivity3:"qqmini_icon3",externalActivity4:"qqmini_icon4",externalActivity5:"qqmini_icon5",externalActivity6:"qqmini_icon6",FixClientVersion:"FixClientVersion",rank_shop:"rank_shop",share_box:"share_box",activity:"activity",share_SDK:"share_on_off",ui_optimize:"ui_optimize",cumulative_invite:"cumulative_invite",AllianceFakeGift:"alliance_new_player",scout:"scout",customer_service_out:"customer_service_out",chat_tran:"chat_tran",BattleReportStrong:"battle_report_strong",chapter_battle_replace:"chapter_battle_replace",monster_battle_replace:"monster_battle_replace",boss_battle_replace:"boss_battle_replace",rank_battle_replace:"rank_battle_replace",AllianceTerritory:"alliance_ligeance",Change_Server:"change_server",march_speedup:"march_speedup",ad_pve_win:"ad_pve_win",ad_cure_free:"ad_cure_free",ad_gold_free:"ad_gold_free",unlimited_league_donate:"unlimited_league_donate",DeleteServer:"delete_server",ChatReport:"banned_report",HeadIconReport:"head_icon_report",WorldSite:"domain",crystal:"crystal",crystal_use:"crystal_use",crystal_vip_unlock:"crystal_vip_unlock",LeagueMove:"league_move",Migrate_Account:"migrate_account",Hero_Guide:"hero_guide",Limited_Shop:"shop_limit",InjuredSoldiers:"injured_soldiers",Download_Appios:"download_appios",show_foreign_server:"show_foreign_server",daily_gift:"daily_gift",delete_item:"delete_item",rally_march_avatar:"rally_march_avatar",AirDrop:"deploy",AirDropVote:"airdrop_vote",extract:"extract",refugee:"refugee",march_skin_change:"march_skin_change",headframe_change:"headframe_change",hero_gift_icon_show:"hero_gift_icon_show",hero_gift_pop:"hero_gift_pop",grow_road:"grow_road",Alliance_Star_Task:"alliance_star_task_show",hero_skill:"hero_skill",hero_talent:"hero_talent",hero_skin:"hero_skin",new_skin_ui:"new_skin_ui",first_purchase_level_pop:"first_purchase_level_pop",WorldRank:"world_rank",new_player_icon_show:"new_player_icon_show",new_player_icon_show_new:"new_player_icon_show_new",island:"island",CrossServerBattle:"cross_server_battle",new_battle_level:"new_battle_level",dailyQuest:"daily_quest",money_scroe_exchange:"money_scroe_exchange",money_scroe_shop:"money_scroe_shop",wheel_chest_multiple_use:"wheel_chest_multiple_use",daily_exchange_armey:"daily_exchange_armey",CustomerService:"customer_service",AllianceGift:"alliance_gift",advanced_defense_setting:"advanced_defense_setting",special_flag_display:"special_flag_display",World_Chat_Close:"world_channel_shutdown",hyperlink_menu:"hyperlink_menu",talent_exchange:"talent_exchange",one_key_merge:"one_key_merge",Time_Gift_Show_Bug_Fix:"exchange_time_revise",Googleplay_rateme:"Googleplay_rateme",GP_rateme_building:"google_play_rating_trigger_building",GP_rateme_soldier:"google_play_rating_trigger_soldier",GP_rateme_LV:"google_play_rating_trigger_level",facebookShare20:"fb_share_20",new_share_treasure:"new_share_treasure",AutoAssemlby:"auto_join",Pve_Tower:"island_battle",warhammer_daily_limitation:"warhammer_daily_limitation",ScrathRank:"scratch_rank",ChangeInfoSwitch:"nane_icon",RandomName:"name_random",AttackWarningBlock:"attack_notification_block",G123VolumeAdjustment:"g123_volume_adjustment",AIGiftOrder:"ai_gift_order",WorldTreasure:"treasure_map1",treasure_map_s2:"treasure_map_s2",G123NewGuide:"g123_newguild",MonthlyCardRewardPop:"monthly_weekly_card_auto_pop",system_bgm:"system_bgm",g123_newtutorial_200310:"g123_newtutorial_200310",Foreign_Binding_SNS:"foreign_new_binding",UploadHeadImage:"release_avatar",endowment_select_open:"endowment_select_open",skill_effect:"skill_effect",IDcard:"IDcard",search_hammer:"search_hammer",Idcard_setup:"Idcard_setup",MonthCardAvatar:"monthcard_avatar",hero_combination:"hero_combination",mod_system:"mod_system",DiscordInvite:"discord_entrance",system_voice_pack:"system_voice_pack",BattleEventLog:"cross_server_battle_replay",skin_collect:"skin_collect",RewardTaskOn:"reward_task_on",PrivateChat_level_limit:"privateChat_level_limit",AtiIndulged:"anti-addiction-phase-1",AtiIndulged2:"anti-addiction-phase-2",AtiIndulged3:"anti-addiction-phase-3",CountryBoss:"countryBoss",AvatarBlock:"avatar_block",RechargeScore:"recharge_score",cdkey:"cdkey",Contact_function:"Contact_function",intensify_merge:"intensify_merge",LevelUp_Box:"LevelUp_Box",WorldSiteMaxNum:"domain_count_default_new",emotion_new:"emotion_new",HeroSkillGroup:"hero_skill_change",MarchQueuePresets:"march_queue_presets",Multi_Binding_SNS:"multiple_sns_bind",Minus_Diamond:"minus_diamond",Community_link:"Community_link",SpecialCastleSkin:"cityskin_change",BuildingExchange:"building_change",Coordinate_link:"Coordinate_link",ThroneBattle_Vote:"wonder_vote",EquipItemSource:"upgrade_component_source",WorldTreasureExchange:"treasure_map_convert",consignment_function:"consignment_function",group_chat:"group_chat",crystal_give:"crystal_give",Decoration_merge:"Decoration_merge",WarFever_Throne:"kingdom_war_fever",WarFever_CrossServer:"worldbattle_war_fever",PlayerExpNew:"player_level_new",Quick_troop_storage:"quick_troop_storage",new_report_rule:"new_report_rule",BattleReportComparison:"battle_report_comparison",trap_potion_switch:"trap_potion_switch",new_vip_level:"new_vip_level",billboard_display:"billboard_display",ProductFactory:"manufacture_system",new_activity_entrance:"new_activity_entrance",pop_star_vip_limitation:"pop_star_vip_limitation",chat_time_display:"chat_time_display",eight_countries_teaser:"eight_countries_teaser",monthly_card_video_diamond:"monthly_card_video_diamond",decoration_compose:"decoration_compose",Adventure:"adventure_function",main_ui_activity_icon_change:"main_ui_activity_icon_change",consignment_function_buy:"consignment_function_buy",consignment_function_buy_list:"consignment_function_buy_list",consignment_function_sale:"consignment_function_sale",autogather_cost_gold:"autogather_cost_gold",alliance_fort_expire:"alliance_fort_expire",login_request_opt:"login_request_opt",GameNotice:"activity_board",IsleBattle:"new_islandbattle_quick",careericon_display:"careericon_display",alliance_help_preview:"alliance_help_preview",server_list_backend_filter:"server_list_backend_filter",mail_pagination_new:"mail_pagination_new",new_newspaper_guide:"new_newspaper_guide",alliancehelp_inchaticon:"alliancehelp_inchaticon",water_effect_switch:"water_effect_switch",chatroom_rule_display:"chatroom_rule_display",new_area_unlock:"new_area_unlock",vip_videoplay_freereward:"vip_videoplay_freereward",vip_freevideo_charge:"vip_freevideo_charge",item_merge_all:"item_merge_all",g123_newguild_200616:"g123_newguild_200616",g123_newguild_200622:"g123_newguild_200622",g123_record_click_view:"g123_record_click_view",attributechange_heroexpe:"attributechange_heroexpe",decoration_animals:"decoration_animals",freevideo_timeschange:"freevideo_timeschange",LCJD:"LCJD",reco_hero:"reco_hero",hammer_tips_icon:"hammer_tips_icon",pve_arena_function:"pve_arena_function",pvp_arena_function:"pvp_arena_function",cross_server_pvp_arena_function:"cross_server_pvp_arena_function",ChapterTask:"newbie_guidemission",TreasureBuilding:"treasure_achievements",AutoChooseArea:"skip_flagandarea",transfercode_total:"transfercode_total",transfercode_generate:"transfercode_generate",transfercode_input:"transfercode_input",transfercode_notification:"transfercode_notification",transfercode_pack:"transfercode_pack",activity_button_order:"activity_button_order",accessories_paging:"accessories_paging",ext_customer_service:"overseas_customer_service",arena_activity_function:"arena_activity_function",degenerator_building:"degenerator_building",game_progress:"game_progress",armyEquip_switch:"armyEquip_switch",city_extra:"city_extra",Illustratedbook_inpacl:"Illustratedbook_inpacl",pvp_arena_get_item:"pvp_arena_get_item",king_castle_effect_display:"king_castle_effect_display",king_castle_effect_list_display:"king_castle_effect_list_display",king_mark_switch:"king_mark_switch",king_mark_bubble_display:"king_mark_bubble_display",king_buff_effective:"king_buff_effective",worldserver_display:"worldserver_display",mail_pagination_main_read_all:"mail_pagination_main_read_all",HomeMap_Improve:"map_improve",Adventure_Reward_Up:"adventure_reward_up",king_mark_switch_cross:"king_mark_switch_cross",key_novice_adjustments:"key_novice_adjustments",WorldMap_Music:"worldmap_music",guide_amass_movement:"guide_amass_movement",gmp_num_show:"gmp_num_show",buff_building_attack:"buff_building_attack",buff_building_shield:"buff_building_shield",buff_building_anima:"buff_building_anima",island_newserver_display:"island_newserver_display",Hero_Exclude_New:"g123_hero_mutex_condition",pve_marine_patrol:"pve_marine_patrol",likeness_survey:"likeness_survey",kingdom_battle_record:"kingdom_battle_record",kvk_full_armament:"kvk_full_armament",monthcard_new:"monthcard_new",vip2_show_gift:"vip2_show_gift"},e.MapPointType={Building:1,Army:20181001,Obstacle:3,Decorations:4,Board:5,Pet:6,Harvester:7,Treasure:26,Headquarters:8},e.WorkerDir={Up:"up",LeftUp:"leftUp",RightUp:"rightUp",Left:"left",Right:"right",LeftDown:"leftDown",RightDown:"rightDown",Down:"down"},function(e){e[e.Normal=0]="Normal",e[e.ToBeCleanedUp=1]="ToBeCleanedUp",e[e.CleaningUp=2]="CleaningUp",e[e.WaitingResponse=3]="WaitingResponse"}(e.ObstacleItemState||(e.ObstacleItemState={})),function(e){e[e.NoWorker=0]="NoWorker",e[e.Idle=1]="Idle",e[e.Working=2]="Working"}(e.WorkerState||(e.WorkerState={})),function(e){e[e.ClearObstacle=0]="ClearObstacle",e[e.Building=1]="Building",e[e.Repair=2]="Repair"}(e.WorkType||(e.WorkType={})),e.ScienceType={BuildBuilding:1,MergeBuilding:2,MergeArmy:3,ArmyBoost:4,Buff:5,Headquarters:7},e.AIDir={LeftUp:0,RightUp:1,RightDown:2,LeftDown:3},e.ShareBoxState={Default:0,Reward:1,Received:2},e.AdventureState={Waiting:-1,Search:0,Refresh:1,HeroSkill:2,Fighting:3},e.PlayerAction={BuildingMerge:"BuildingMerge",ArmyMerge:"ArmyMerge",CoinCollect:"CoinCollect",ScienceResearch:"ScienceResearch"},e.UserAction={EquipGiftShow:101},e.LocalDataKey={LoginDay:"LoginDay",ShareRewardBox:"ShareRewardBox",ShareRewardBoxCD:"ShareRewardBoxCD",ShareRewardBoxTimes:"ShareRewardBoxTimes",PopupGiftShowDay:"PopupGiftShowDay",PopupGiftShowTime:"PopupGiftShowTime",ExtraArmyRewardTime:"ExtraArmyRewardTime",ExtraArmyRewardId:"ExtraArmyRewardId",ChatBlockList:"ChatBlockList",AutoFixBuilding:"AutoFixBuilding",AutoFixArmy:"AutoFixArmy",ClickAllianceScienceDay:"ClickAllianceScienceDay",ArmyItemVideo:"ArmyItemVideo",ChatReportCD:"ChatReportCD",SearchMonsterLevelWin:"SearchMonsterLevelWin",ValentineAnimeShowDay:"ValentineAnimeShowDay",ValentineAnimeShowState:"ValentineAnimeShowState",ChatEmotion:"ChatEmotion",AttackWarnLevel:"AttackWarnLevel",AllianceBlock:"AllianceBlock",HeadIconReport:"HeadIconReport",TreasureQuestOpenDay:"TreasureQuestOpenDay",TreasureQuestOpened:"TreasureQuestOpened",EquipGiftEndTime:"EquipGiftEndTime",AdventureStage:"AdventureStage",GameNoticeTime:"GameNoticeTime",IsleEventLogNum:"IsleEventLogNum",IsleGuideStep:"IsleGuideStep",FirstOpenChatTip:"FirstOpenChatTip",AllianceTerritoryNotCick:"AllianceTerritoryNotCick",NewAreaGuide:"NewAreaGuide",SpeedUpGuidePassed:"SpeedUpGuidePassed",ThemeItemCache:"ThemeItemCache",AllianceJoinGuideShow:"AllianceJoinGuideShow",ProtectCastleGuide:"ProtectCastleGuide",TreasureSystemGuide:"TreasureSystemGuide",CollectionMachineGuide:"CollectionMachineGuide",HeadquarterGuide:"HeadquarterGuide",DimMineGuide:"DimMineGuide",AllianceTerritoryGuide:"AllianceTerritoryGuide"},e.UserSettingKey={Music:"USK_Music",MusicVolume:"USK_Music_Volume",Sound:"USK_Sound",SoundVolume:"USK_Sound_Volume",EasyMove:"USK_EasyMove",VipLock:"VIP_LOCK",NewUnlockStyle:"NewUnlockStyle",ChatMainUIShowAlliance:"CHAT_SHOW_TYPE",DubbingPack:"DubbingPack",WorldMapBGMusic:"BGMPack",SecondClickArmyLine:"SecondClickArmyLine",MoveGuideAvailableTile:"MoveGuideAvailableTile"},e.BuffType={PeaceShield:101,MarchSize:102,MarchSpeed:103,BuildingMergeMaxLevel:104,ArmyMergeMaxLevel:105,BuildingBaseLevel:106,PlayerMaxLevel:107,TrainSpeed:108,CoinProduction:109,ArmyPowerAdd:111,ArmyAttackAdd:112,PlayerScienceReduceGold:135,AllianceMaterial:136,AllianceMaxNumberCount:137,RallyAddCount:138,AllianceAssemlby:139,MarchArmyMax:141,ShopBuyGold:142,WorldGatherSpeed:143,BattleArmyAddNum:153,WorldSiteNum:155,ArmyGatherLoad:159,CustomAvatar:176,LearningTalentNum:195,BuildCollectTower:200,BuildStrengthenTower:201,BuildWeakenTower:202,BattleHeroAddNum:203,MonsterMoreReward:210,CollectMoreReward:211,BuildTowerSpeedUp:212,ReplaceArmy:215,HeroPropertyUp:214,CoinTreeAddFreeTimes:221,AddWareHouseBuild:300,HospitalQueue:301,WarFever:310,LearnTalentSpeedUp:303,HammerBossRewardAdd:402,CoinTreeAdd:405,DecorationActiveInBag:406},e.BuffParaType={MarchType:"MarchType"},e.SwitchType={dynOpen:0,memOptim:1,lazyTableParse:2,protocolCustomCompress:3,readConfigFromCache:4,ignoreFirstHotUpdate:5,ignoreFirstConfigDownload:6,forceDisableSceneTransition:7,appNewHeartbeatCheck:8,appNewHeartbeatTimeout:9,disableHomeScenePredestroy:10,gameServerAcc:11,g123NewHeartbeatCheck:12,g123NewHeartbeatTimeout:13,disableAndroidChatWss:14,disabledPrivacyCheck:15,disableChatMultipleLine:16,disableIOSEditBoxSetText:17,enableIntervalRelease:18,cdnDownloadTestParam:19,tablePatchMode:20,iOSUseReviewServer:21,iOSReviewBlockGiftPack:22},e.TaskGuideId={BuildBuilding:799,BuildBuildingNew:3801,ArmyTrain:901,FindAutoCollect:501},e.VideoRewardType={ACCharge:1,Captive:2,ArmyReward:3,ScienceItem:4,ObstacleRemove:5,BattleLosePass:6,TreatSoldier:7,NewGetDiamond:8},e.FakeActivityId={PublicAddress:2019002001,FavWx:2019002019,SevenDayReward:2019041917,ThroneBattle:2019042818,ADVANCE_ACTIVITY:20190628,ACTIVITY_SOCIAL:20191216,ADVANCE_CROSS_ACTIVITY:20200326,LAUNCH_TOWER_ACTIVITY:20200407,ACTIVITY_LIMIT_GIFG:20200408,ARENA_ACTIVITY:20200624},function(e){e[e.NONE=-1]="NONE",e[e.ACTIVITY_VALENTIVE_FLOWER=1]="ACTIVITY_VALENTIVE_FLOWER",e[e.ACTIVITY_VALENTIVE_Microphone=2]="ACTIVITY_VALENTIVE_Microphone"}(t=e.SystemNoticeType||(e.SystemNoticeType={}));var o=function(){return function(e,a,o,n,i){void 0===o&&(o=t.NONE),void 0===n&&(n=""),void 0===i&&(i=""),this.Text="",this.Times=1,this.NoticeType=t.NONE,this.fromPlayerInfo="",this.toPlayerInfo="",this.Text=e,this.Times=a,this.NoticeType=o,this.fromPlayerInfo=n,this.toPlayerInfo=i}}();e.SystemNoticeData=o;var n=function(){return function(e,t,a){this.Type=0,this.Count=0,this.ItemId=0,this.Type=e,this.Count=t,this.ItemId=a}}();e.RewardItemData=n;var i=function(){function e(){}return e.ArmyRotaion=-15,e}();e.AdventureConfig=i,function(e){e[e.Skill=1]="Skill",e[e.Equip=2]="Equip",e[e.Talent=3]="Talent"}(e.HeroElementType||(e.HeroElementType={})),function(e){e[e.None=0]="None",e[e.Hello=1]="Hello",e[e.ProductArmy=2]="ProductArmy",e[e.Enemy=3]="Enemy",e[e.PVE=4]="PVE",e[e.Help=5]="Help",e[e.Repair=6]="Repair",e[e.End=99]="End"}(e.GuideState||(e.GuideState={})),function(e){e[e.GROW_ROAD_PREFAB=-2]="GROW_ROAD_PREFAB",e[e.NONE=-1]="NONE",e[e.BASE=0]="BASE",e[e.REWARD_GIFT=1]="REWARD_GIFT",e[e.WEEKLY_CARD=2]="WEEKLY_CARD",e[e.FIRST=3]="FIRST",e[e.GROWTH_FUND=4]="GROWTH_FUND",e[e.MONTHLY_CARD=5]="MONTHLY_CARD",e[e.AdvanceGift=6]="AdvanceGift",e[e.LuxuryGift=7]="LuxuryGift",e[e.PREFERENTIAL_GIFT=8]="PREFERENTIAL_GIFT",e[e.ACTIVITY_GIFT=9]="ACTIVITY_GIFT",e[e.HERO_GIFT=10]="HERO_GIFT",e[e.HERO_FRAG_GIFT=12]="HERO_FRAG_GIFT",e[e.CRYSTAL_GIFT=13]="CRYSTAL_GIFT",e[e.AUTOCOLLECT=11]="AUTOCOLLECT",e[e.ADVANCE_MONTH=14]="ADVANCE_MONTH",e[e.VIP_GIFT=15]="VIP_GIFT",e[e.LIMIT_GIFT=16]="LIMIT_GIFT",e[e.SKINPATCH_GIFT=17]="SKINPATCH_GIFT",e[e.DAILY_BAG=18]="DAILY_BAG",e[e.GROW_ROAD=19]="GROW_ROAD",e[e.HERO_SKIN_GIFT=20]="HERO_SKIN_GIFT",e[e.POINT_GIFT=21]="POINT_GIFT",e[e.RECHARGESCORESHOP_GIFT=22]="RECHARGESCORESHOP_GIFT",e[e.RECHARGESCORESPIN_GIFT=24]="RECHARGESCORESPIN_GIFT",e[e.BLACK_FRIDAY=26]="BLACK_FRIDAY",e[e.MONDAY_GIFT=25]="MONDAY_GIFT",e[e.EQUIP_GIFT=27]="EQUIP_GIFT",e[e.DUBBING_GIFT=28]="DUBBING_GIFT",e[e.GIFTBOX_GIFT=30]="GIFTBOX_GIFT",e[e.EMOTION_GIFT=31]="EMOTION_GIFT",e[e.ADVENTURE_GIFT=33]="ADVENTURE_GIFT",e[e.NEEDITEM_GIFT=32]="NEEDITEM_GIFT",e[e.RETURN_GIFT=35]="RETURN_GIFT",e[e.WORLD_BG_MUSIC_GIFT=36]="WORLD_BG_MUSIC_GIFT",e[e.EASTER_GIFT=37]="EASTER_GIFT",e[e.FIRST_PAGE_GIFT=38]="FIRST_PAGE_GIFT",e[e.LEGEND_GIFT=40]="LEGEND_GIFT",e[e.WORKAWARD_GIFT=41]="WORKAWARD_GIFT",e[e.RED_BLUE_GIFT=43]="RED_BLUE_GIFT",e[e.SHOW_HAND_GIFT=44]="SHOW_HAND_GIFT",e[e.FOREVER_CARD=45]="FOREVER_CARD"}(e.GiftType||(e.GiftType={})),function(e){e[e.GROW_ROAD_PREFAB=-2]="GROW_ROAD_PREFAB",e[e.NONE=-1]="NONE",e[e.FIRST_GIFT=0]="FIRST_GIFT",e[e.SECOND_GIFT=1]="SECOND_GIFT",e[e.WEEKLY_CARD_GIFT=2]="WEEKLY_CARD_GIFT",e[e.PREFERENTIAL_GIFT=3]="PREFERENTIAL_GIFT",e[e.GROWTH_FUND_GIFT=4]="GROWTH_FUND_GIFT",e[e.BASE_GIFT=5]="BASE_GIFT",e[e.ITEM_SHOP=6]="ITEM_SHOP",e[e.MILITARY_ITEM_SHOP=7]="MILITARY_ITEM_SHOP",e[e.ACTIVITY_GIFT=8]="ACTIVITY_GIFT",e[e.HERO_GIFT=9]="HERO_GIFT",e[e.CRYSTAL_GIFT=10]="CRYSTAL_GIFT",e[e.SUPPLY_GIFT=11]="SUPPLY_GIFT",e[e.VIP_SHOP=12]="VIP_SHOP",e[e.LIMITED_SHOP=13]="LIMITED_SHOP",e[e.DAILY_BAG=14]="DAILY_BAG",e[e.HEROSKIN_GIFT=15]="HEROSKIN_GIFT",e[e.LEGION_SHOP=16]="LEGION_SHOP",e[e.DUBBING_PACK=17]="DUBBING_PACK",e[e.DECORATEBOX_SHOP=18]="DECORATEBOX_SHOP"}(e.GiftShopTabType||(e.GiftShopTabType={})),function(e){e[e.TREASURE_MAP=1]="TREASURE_MAP"}(e.ConfigBuyType||(e.ConfigBuyType={})),function(e){e[e.NONE=-1]="NONE",e[e.CHARGE=1]="CHARGE",e[e.POWER_UP=2]="POWER_UP",e[e.ARMY=3]="ARMY",e[e.BUILDING=4]="BUILDING",e[e.SCIENE=5]="SCIENE",e[e.PVE=6]="PVE",e[e.LOGIN=7]="LOGIN"}(e.ActivityTarget||(e.ActivityTarget={})),function(e){e[e.NONE=-1]="NONE",e[e.UNFINISHED=0]="UNFINISHED",e[e.FINISHED=1]="FINISHED",e[e.REWARDED=2]="REWARDED",e[e.OVERDUE=3]="OVERDUE"}(e.ActivityTargetState||(e.ActivityTargetState={})),e.ActivityShowUIType={ActivityDailyPurchace:"ActivityDailyPurchace",ActivityDailyRank:"ActivityDailyRank",ActivitySevenPurchace:"ActivitySevenPurchace",ActivityValentine:"ActivityValentine",ActivityWatchVideo:"ActivityWatchVideo",PublicAddress:"PublicAddress",FavWx:"FavWx",SevenDayReward:"SevenDayReward",ActivityFriendIncite:"ActivityFriendIncite",ActivityShareBox:"ActivityShareBox",RechargeDouble:"RechargeDouble",ActivityShow:"ActivityShow",ActivityExchange:"ActivityExchange",ActivityRecallTask:"ActivityRecallTask",ActivityRecallExchange:"ActivityRecallExchange",ActivityLuckySpin:"ActivityLuckySpin",ThroneBattle:"ThroneBattle",ActivitySuperHero:"ActivitySuperHero",ActivityChildrenDay:"ActivityChildrenDay",ActivityCrystle:"ActivityCrystle",ActivityAirDrop:"ActivityAirDrop",ActivityReverseCard:"ActivityReverseCard",ActivityRefugee:"ActivityRefugee",ActivityDrawcard:"ActivityDrawcard",ActivitySummerDailyPurchace:"ActivitySummerDailyPurchace",ActivitySummerExchange:"ActivitySummerExchange",ACTIVITYADVANCE:"ACTIVITYADVANCE",ActivitySummerBoss:"ActivitySummerBoss",SummerLottery:"SummerLottery",ActivityHammerBoss:"ActivityHammerBoss",ActivityMoneyScore:"ActivityMoneyScore",ActivityLottery:"ActivityLottery",RechargeScoreShop:"rechargeScoreShop",ActivityNobackLottery:"ActivityNobackLottery",RechargeScoreSpin:"rechargeScoreSpin",ActivityScratchCards:"ActivityScratchCards",ActivityPreview:"ActivityPreview",ActivityWorldTreasure:"ActivityWorldTreasure",ActivityDefenderMonster:"ActivityDefenderMonster",ActivityVersionLow:"ActivityVersionLow",ActivityTaskGroup:"ActivityTaskGroup",ActivityFestivalExchange:"ActivityFestivalExchange",ActivityMonday:"ActivityMonday",ActivityWorldPurchace:"ActivityWorldPurchace",ActivityRndTask:"ActivityRndTask",newActivityKingTask:"newActivityKingTask",Activitygiftbox:"Activitygiftbox",Activitygiftboxtask:"Activitygiftboxtask",ActivityJanuaryGift:"ActivityJanuaryGift",ActivityNewYear:"ActivityNewYear",ActivityItemUse:"ActivityItemUse",ActivityEmotionTask:"ActivityEmotionTask",ActivityLuckyBag:"ActivityLuckyBag",ActivitySocial:"ActivitySocial",ActivityHunt:"ActivityHunt",ActivityHuntNew:"ActivityHuntNew",ActivityDice:"ActivityDice",ActivityEaster:"ActivityEaster",ACTIVITYCROSSSEVER:"ACTIVITYCROSSSEVER",ActivityDoubleDiamond:"ActivityDoubleDiamond",newserverBP:"newserverBP",ActivityAllianceBP:"ActivityAllianceBP",LAUNCHTOWER:"LAUNCHTOWER",ActivityGiftNode:"ActivityGiftNode",ActivityServerRank:"ActivityServerRank",pioneerBP:"pioneerBP",ActivityBeachLanding:"ActivityBeachLanding",ACTIVITY_ARENA:"ACTIVITY_ARENA",ActivityGameProgress:"ActivityGameProgress",ActivityHeroReturn:"ActivityHeroReturn",ActivityOneDayReward:"ActivityOneDayReward",ActivityKingdomLegend:"ActivityKingdomLegend",ActivityCorbanHappyTable:"ActivityCorbanHappyTable",ActivityRedBlueLucky:"ActivityRedBlueLucky",ActivityLuckyDiscount:"ActivityLuckyDiscount",ActivityWorkAward:"ActivityWorkAward",ActivityShowHandLucky:"ActivityShowHandLucky",ActivityDeepSeaTreasure:"ActivityDeepSeaTreasure"},function(e){e[e.None=0]="None",e[e.Science=4]="Science",e[e.Speed=5]="Speed",e[e.Energy=6]="Energy",e[e.Energy2=7]="Energy2",e[e.QianCheng=10]="QianCheng",e[e.HuDun=11]="HuDun",e[e.HospitalSpeedItem=12]="HospitalSpeedItem",e[e.Hospital=8]="Hospital",e[e.Coin=15]="Coin",e[e.Gold=16]="Gold",e[e.Box=17]="Box",e[e.Building=18]="Building",e[e.TreasureBox=19]="TreasureBox",e[e.PowerItem=20]="PowerItem",e[e.Oil=25]="Oil",e[e.Food=27]="Food",e[e.MarchSpeedUp=28]="MarchSpeedUp",e[e.CastleFace=29]="CastleFace",e[e.HeroRecruit=30]="HeroRecruit",e[e.HeroPatch=31]="HeroPatch",e[e.HeroCommonPatch=32]="HeroCommonPatch",e[e.HeroExpItem=34]="HeroExpItem",e[e.ExchangeItem=33]="ExchangeItem",e[e.CRYSTAL_BUY=36]="CRYSTAL_BUY",e[e.CRYSTAL_BESEND=37]="CRYSTAL_BESEND",e[e.TutorialTransfer=38]="TutorialTransfer",e[e.CastleFacePatch=41]="CastleFacePatch",e[e.HERO_SKILL_FRAGMENT=46]="HERO_SKILL_FRAGMENT",e[e.HERO_SKILL=42]="HERO_SKILL",e[e.HERO_SKILL_CHIP=44]="HERO_SKILL_CHIP",e[e.HelpLetter=48]="HelpLetter",e[e.LotteryBox=49]="LotteryBox",e[e.BuffItem=50]="BuffItem",e[e.SecretIntelligence=1600]="SecretIntelligence",e[e.MarchSkinItem=2901]="MarchSkinItem",e[e.NamePlateItem=2902]="NamePlateItem",e[e.HeadFrameItem=2903]="HeadFrameItem",e[e.HeroSkinItem=3101]="HeroSkinItem",e[e.ItemGetMonster=54]="ItemGetMonster",e[e.ItemChooseArmy=56]="ItemChooseArmy",e[e.ArmyLineSkinPatch=57]="ArmyLineSkinPatch",e[e.WorldTreasure=66]="WorldTreasure",e[e.ProfessionSpeed=65]="ProfessionSpeed",e[e.CastleEffect=60]="CastleEffect",e[e.CastleEffectPatch=61]="CastleEffectPatch",e[e.ComposeItem=67]="ComposeItem",e[e.SpecialCastleSkin=68]="SpecialCastleSkin",e[e.MakeOnceBuffItem=72]="MakeOnceBuffItem",e[e.MakeEnemyItem=73]="MakeEnemyItem",e[e.MakeCastleSettingItem=74]="MakeCastleSettingItem",e[e.MakeBattleTrapItem=75]="MakeBattleTrapItem",e[e.DecorationCompose=76]="DecorationCompose",e[e.WorldBGMItem=77]="WorldBGMItem",e[e.EmotionPack=3103]="EmotionPack",e[e.HeanIconItem=3102]="HeanIconItem",e[e.TreasurePatch=78]="TreasurePatch",e[e.ActivityUseItem=80]="ActivityUseItem",e[e.NewWorldTreasurePatch=81]="NewWorldTreasurePatch",e[e.ArmyMaterial=85]="ArmyMaterial",e[e.ArmyPaper=86]="ArmyPaper",e[e.ArmyPaperChip=87]="ArmyPaperChip",e[e.ArmyEquipBuffItem=88]="ArmyEquipBuffItem",e[e.MakeEnemyBuffTowerItem=91]="MakeEnemyBuffTowerItem",e[e.DeepSeaTreasureHuntSpeed=89]="DeepSeaTreasureHuntSpeed",e[e.DeepSeaTreasure=90]="DeepSeaTreasure",e[e.ItemChooseItem=100]="ItemChooseItem",e[e.ItemChooseCastleSkin=101]="ItemChooseCastleSkin",e[e.ItemChooseArmyLineSkin=102]="ItemChooseArmyLineSkin",e[e.ItemChooseCityEffect=103]="ItemChooseCityEffect",e[e.ItemKvkHonor=92]="ItemKvkHonor"}(e.ItemType||(e.ItemType={})),function(e){e[e.None=0]="None",e[e.Ornament=4]="Ornament",e[e.OrnamentFloor=5]="OrnamentFloor",e[e.Treasure=26]="Treasure"}(e.BuildingType||(e.BuildingType={})),e.PropertyKey={EffectNode:"EffectNode",ItemGround:"ItemGround",GroundRedItem:"GroundRedItem",ArrowNode:"ArrowNode",ItemFunctionTile:"ItemFunctionTile",ItemFunctionTileMove:"ItemFunctionTileMove",ItemNameNode:"ItemNameNode",AutoCollectNode:"AutoCollectNode",LongTouchNode:"LongTouchNode",ItemMergeNode:"ItemMergeNode",StateUpProgress:"StateUpProgress",ArmyInjuredNode:"ArmyInjuredNode",ArmyHospitalNode:"ArmyHospitalNode",ArmyStateNode:"ArmyStateNode",BorderNode:"BorderNode",BrokenNode:"BrokenNode",CollectTargetNode:"CollectTargetNode",BuildingFreeNode:"BuildingFreeNode",CoinCollectNode:"CoinCollectNode",BtnDelete:"BtnDelete",BtnSpeedUpArmy:"BtnSpeedUpArmy",BtnSpeedUpBuild:"BtnSpeedUpBuild",BtnCancle:"BtnCancle",BtnTreasureBox:"BtnTreasureBox",BtnRecycle:"BtnRecycle",BtnArmyEnhance:"BtnArmyEnhance",BtnHero:"BtnHero",BtnMoneyTree:"BtnMoneyTree",BtnGrowthNode:"BtnGrowthNode",BtnHospital:"BtnHospital",BtnScience:"BtnScience",BtnHeadquarters:"BtnHeadquarters",ProductComplete:"ProductComplete",ProductResNode:"ProductResNode",ProductingNode:"ProductingNode",BtnAllianceAssistance:"BtnAllianceAssistance",BtnWareHorse:"BtnWareHorse",BtnStrengthen:"BtnStrengthen",BtnIsland:"BtnIsland",ProfessionTalentBtn:"ProfessionTalentBtn",BtnMarge:"BtnMarge",BtnCityEffect:"BtnCityEffect",BtnCalendar:"BtnCalendar",BtnActivityEntrance:"BtnActivityEntrance",BtnDecorateCompose:"BtnDecorateCompose",BtnAdventureEntrance:"BtnAdventureEntrance",tankTimeNode:"tankTimeNode",TankFinishBtn:"TankFinishBtn",tankFireNode:"tankFireNode",BtnArmyEquipNew:"BtnArmyEquipNew",BtnDimNode:"BtnDimNode"},e.EventDelegateAction={BaseItemTileSure:"BaseItemTileSure",BaseItemTileCancle:"BaseItemTileCancle",BaseItemDelete:"BaseItemDelete",BaseItemSpeedUp:"BaseItemSpeedUp",BaseItemCancle:"BaseItemCancle",AutoCollectTile:"AutoCollectTile",BuildingRepair:"BuildingRepair",TreasureBoxClick:"TreasureBoxClick",BuildingRecycleClick:"BuildingRecycleClick",BuildingInfoClick:"BuildingInfoClick",ArmyEnhanceClick:"ArmyEnhanceClick",ArmyMargeAllClick:"ArmyMargeAllClick",HeroClick:"HeroClick",MoneyTreeClick:"MoneyTreeClick",GrowthFundClick:"GrowthFundClick",HospitalClick:"HospitalClick",ScienceClick:"ScienceClick",HeadquartersClick:"HeadquartersClick",CoinCollectClick:"CoinCollectClick",ProductCompleteClick:"ProductCompleteClick",ProductArmyClick:"ProductArmyClick",AllianceAssistanceClick:"AllianceAssistanceClick",BtnWareHorseClick:"BtnWareHorseClick",BtnStrengthenClick:"BtnStrengthenClick",BtnIslandClick:"BtnIslandClick",ProfessionTalentClick:"ProfessionTalentClick",BtnCityEffectClick:"BtnCityEffectClick",BtnCalendarClick:"BtnCalendarClick",BtnActivityEntrance:"BtnActivityEntrance",BtnDecorateCompose:"BtnDecorateCompose",BtnAdventureEntrance:"BtnAdventureEntrance",TankFinishBtnClick:"TankFinishBtnClick"},function(e){e[e.TREASURE_BOX=2001]="TREASURE_BOX",e[e.INVITE_ASSEMBLY=2002]="INVITE_ASSEMBLY",e[e.TREASURE_BOX_AVATAR=2003]="TREASURE_BOX_AVATAR"}(e.FBAppRequestCardID||(e.FBAppRequestCardID={}));var r=function(){function e(e,t,a){this._Type=e,this._ItemId=t,this._Num=a}return Object.defineProperty(e.prototype,"Type",{get:function(){return this._Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Num",{get:function(){return this._Num},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemId",{get:function(){return this._ItemId},enumerable:!0,configurable:!0}),e}();e.TreasureData=r,function(e){e[e.MoneyTree=1]="MoneyTree",e[e.WatchVideo=2]="WatchVideo",e[e.Activity=3]="Activity",e[e.Alliance=4]="Alliance",e[e.Chat=5]="Chat",e[e.ChangeName=6]="ChangeName",e[e.World=7]="World",e[e.Mail=8]="Mail"}(e.GameOperation||(e.GameOperation={})),function(e){e[e.AUTO_COLLECT=1800]="AUTO_COLLECT",e[e.SCIENCE=1900]="SCIENCE",e[e.FINANCIAL=2e3]="FINANCIAL",e[e.HOSPITAL=2100]="HOSPITAL",e[e.HEADQUARTORS=3900]="HEADQUARTORS"}(e.BuildingGroup||(e.BuildingGroup={})),function(e){e[e.MAIN=0]="MAIN",e[e.DAILY=1]="DAILY",e[e.WORLD_TREASURE=2]="WORLD_TREASURE",e[e.BOUNTY=3]="BOUNTY",e[e.BOUNTYGET=4]="BOUNTYGET"}(e.QuestType||(e.QuestType={})),function(e){e[e.UN_FINISHED=0]="UN_FINISHED",e[e.CAN_REWARD=1]="CAN_REWARD",e[e.FINISHED=2]="FINISHED",e[e.RECEIVED=3]="RECEIVED"}(e.QuestState||(e.QuestState={})),function(e){e[e.UN_FINISHED=0]="UN_FINISHED",e[e.CAN_REWARD=1]="CAN_REWARD",e[e.FINISHED=2]="FINISHED"}(e.DailyQuestBoxState||(e.DailyQuestBoxState={})),function(e){e[e.CLOSE=0]="CLOSE",e[e.FIGHT=1]="FIGHT",e[e.PEACE=2]="PEACE"}(e.WorldSiteState||(e.WorldSiteState={})),function(e){e[e.NONE=-1]="NONE",e[e.ING=0]="ING",e[e.UN_BEGIN=1]="UN_BEGIN",e[e.UN_IDLE=2]="UN_IDLE",e[e.UN_OPEN=3]="UN_OPEN",e[e.ADD=4]="ADD"}(e.HospitalCellState||(e.HospitalCellState={})),function(e){e[e.NICKNAME=0]="NICKNAME",e[e.WORLD_SITE=1]="WORLD_SITE",e[e.THRONE=2]="THRONE"}(e.ChangeNameType||(e.ChangeNameType={})),function(e){e[e.POSITION=0]="POSITION",e[e.BATTLE=1]="BATTLE",e[e.IMAGE=2]="IMAGE"}(e.ChatShareLinkType||(e.ChatShareLinkType={})),function(e){e[e.RES=0]="RES",e[e.BOSS=1]="BOSS",e[e.ASSEMBLE_BOSS=2]="ASSEMBLE_BOSS",e[e.MONSTER=3]="MONSTER",e[e.PLAYER=4]="PLAYER",e[e.WORLDSITE=5]="WORLDSITE",e[e.BATTLE=6]="BATTLE",e[e.TOWER=7]="TOWER"}(e.ChatShareLinkSubType||(e.ChatShareLinkSubType={})),function(e){e[e.WorldItemMarch=1]="WorldItemMarch",e[e.TreasureMapDetailList=2]="TreasureMapDetailList",e[e.TreasureMapShop=3]="TreasureMapShop"}(e.SystemPushId||(e.SystemPushId={})),function(e){e[e.Normal=0]="Normal",e[e.Donate=1]="Donate",e[e.Ready=2]="Ready",e[e.Fight=3]="Fight",e[e.Reward=4]="Reward",e[e.Matching=5]="Matching"}(e.ServerState||(e.ServerState={})),function(e){e[e.Normal=0]="Normal",e[e.Liberated=-1]="Liberated",e[e.Colony=-2]="Colony"}(e.WorldSiteServerType||(e.WorldSiteServerType={})),function(e){e[e.Blue=0]="Blue",e[e.Red=1]="Red"}(e.ServerColor||(e.ServerColor={})),function(e){e[e.Mail=0]="Mail",e[e.War=1]="War",e[e.Shop=2]="Shop",e[e.Science=3]="Science",e[e.Rank=4]="Rank",e[e.Help=5]="Help",e[e.Territory=6]="Territory",e[e.AllianceGift=7]="AllianceGift",e[e.AllianceBoss=8]="AllianceBoss",e[e.PublicMsg=9]="PublicMsg",e[e.ChangeInfo=10]="ChangeInfo",e[e.GiveUpLeader=11]="GiveUpLeader",e[e.ReplaceLeader=12]="ReplaceLeader",e[e.InviteFriend=13]="InviteFriend",e[e.Jurisdiction=14]="Jurisdiction",e[e.Dissolution=15]="Dissolution",e[e.Leave=16]="Leave"}(e.AllianceFunction||(e.AllianceFunction={})),function(e){e[e.Unknow=0]="Unknow",e[e.Male=1]="Male",e[e.Female=2]="Female"}(e.TPlayerGender||(e.TPlayerGender={})),function(e){e[e.refugeeLetter=1700039]="refugeeLetter"}(e.ActivityItem||(e.ActivityItem={})),function(e){e[e.HERO=1]="HERO",e[e.Lottery=2]="Lottery",e[e.Item=3]="Item",e[e.Mine=4]="Mine",e[e.ScratchCard=5]="ScratchCard",e[e.Easter=6]="Easter",e[e.ScoreSpin=7]="ScoreSpin",e[e.ActivityHuntNew=8]="ActivityHuntNew",e[e.HeroReturn=9]="HeroReturn"}(e.ProbabilityType||(e.ProbabilityType={})),e.HomeMap_LOGIN_OVER=!1,e.MessagePulled=!1,e.ServerListResponseStatus={OK:0,SERVER_STOP:1,TOKEN_SSL_FAILED:2,TOKEN_IS_NULL:3,FILTER_SERVER_FAILED:4,CLIENT_SEND_PLATFORM_NOT_FOUND:5,SERVER_INFO_TOKEN_TIME_OUT:6,SERVER_INFO_TOKEN_CHECK_FAILED:7,SERVER_CHECK_HAS_EXCEPTION:8},e.LoginResponseStatus={SERVER_MAINTAIN:100,USER_BANNED:103,DEVICE_BANNED:104,SHUTDOWN_KICK:111,GM_KICK:113,CLIENT_VERSION_ERROR:126,SIMULATOR_LOGIN_AUTO_FAIL:127,USER_NOT_BELONG_SERVER:128,IDC_IP_NOT_LOGIN:129,VERSION_TOO_OLD:131,INVALID_LOGIN_INFO:101,USER_NOT_LOGIN:108,LOGIN_FAIL:109,IDLE_KICK:112,UNKNOW_KICK:114,LOGIN_KICK:110,USER_ALREADY_LOGIN:121,TOKEN_TIME_OVERDUE:116},function(e){e[e.LOCK=0]="LOCK",e[e.UNLOCK=1]="UNLOCK",e[e.BUILDING=2]="BUILDING",e[e.COMPLETE=3]="COMPLETE"}(e.TowerState||(e.TowerState={})),e.ModFlag={GM:"gm",TMod:"tmod",Mod:"mod",SMod:"smod"},e.smallNum=["","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"],e.units=["","\u5341","\u767e","\u5343","\u4e07"],e.GameServerRegion={China:"cn-beijing",America:"us-west-1"}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],HomeMapCommon:[function(e,t,a){"use strict";cc._RF.push(t,"c7870OgfK1IO5rCCe1OARvT","HomeMapCommon"),Object.defineProperty(a,"__esModule",{value:!0}),function(e){e[e.Invalid=0]="Invalid",e[e.Land=1]="Land",e[e.Sea=2]="Sea",e[e.Beach=3]="Beach"}(a.HomeMapTileType||(a.HomeMapTileType={})),function(e){e[e.Land=1]="Land",e[e.Sea=2]="Sea",e[e.Beach=4]="Beach",e[e.Air=7]="Air"}(a.HomeMapAnimalsType||(a.HomeMapAnimalsType={})),function(e){e.WidthCount=57,e.HeightCount=100,e.EdgePadingH=136,e.EdgePadingV=196,e.MIN_ZOOM_LEVEL=.62,e.MAX_ZOOM_LEVEL=1.4,e.REBOUND_ZOOM_LEVEL=.3}(a.HomeMapCommon||(a.HomeMapCommon={})),a.HomeMapAllTileTable={},a.HomeMapLandTileTable={},a.HomeMapSeaTileTable={},a.HomeMapBeachTileTable={},function(e){e[e.None=0]="None",e[e.LimitBuildingAndAllArmy=1]="LimitBuildingAndAllArmy"}(a.HomeMapTileBlockType||(a.HomeMapTileBlockType={})),a.HomeMapTileBlockTypeTable={},a.HomeMapTileBlockType1_BuildingTypes=[],a.CharacterDirType=[{min:-180,max:-157.5,ani_name:"up"},{min:-157.5,max:-112.5,ani_name:"rightup"},{min:-112.5,max:-67.5,ani_name:"right"},{min:-67.5,max:-22.5,ani_name:"rightbottom"},{min:-22.5,max:22.5,ani_name:"bottom"},{min:22.5,max:67.5,ani_name:"leftbottom"},{min:67.5,max:112.5,ani_name:"left"},{min:112.5,max:157.5,ani_name:"leftup"},{min:157.5,max:180,ani_name:"up"}],cc._RF.pop()},{}],MsgIdSettings:[function(e,t,a){"use strict";var o;cc._RF.push(t,"1fb960TJW1BSbRks5uRB47H","MsgIdSettings"),function(e){(function(e){e[e.None=0]="None",e[e.Send=1]="Send",e[e.SendAndSave=2]="SendAndSave"})(e.MsgIdSettingsVerifyResult||(e.MsgIdSettingsVerifyResult={})),e.MSG_QUEUE_MAX=50;var t={limitCount:e.MSG_QUEUE_MAX};function a(e){var a=t,n=o[e];return n&&(a=n),a}e.getSetting=a,e.verifyIdBySetting=function(t,o){var n=a(t);if(n){for(var i=0,r=-1,s=o.length-1;s>=0;s--)o[s].id===t&&(r<0&&(r=s),i++);return n.limitCount<=0||null===n.limitCount||void 0===n.limitCount?e.MsgIdSettingsVerifyResult.Send:n.limitCount>i?e.MsgIdSettingsVerifyResult.SendAndSave:n.keepLast?(r>=0&&o.splice(r,1),e.MsgIdSettingsVerifyResult.SendAndSave):e.MsgIdSettingsVerifyResult.None}return e.MsgIdSettingsVerifyResult.SendAndSave};var o={0:{limitCount:0},1:{limitCount:0},921:{limitCount:0},856:{limitCount:0},841:{limitCount:0},700:{limitCount:0},82:{limitCount:1,keepLast:!0},98:{limitCount:0},835:{limitCount:0},854:{limitCount:0,keepLast:!0},955:{limitCount:0},802:{limitCount:0},1007:{limitCount:0},1110:{limitCount:0},1102:{limitCount:0},1103:{limitCount:0},1104:{limitCount:0},1100:{limitCount:0},1111:{limitCount:0},1109:{limitCount:0},670:{limitCount:0},701:{limitCount:1,keepLast:!0},801:{limitCount:0},804:{limitCount:1,keepLast:!0},837:{limitCount:0},901:{limitCount:1,keepLast:!0},916:{limitCount:0,keepLast:!0}}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],RequestId:[function(e,t,a){"use strict";cc._RF.push(t,"99522GPTJRFW4A+jvN8l5Rx","RequestId"),Object.defineProperty(a,"__esModule",{value:!0}),a.RequestId={NO_QUEUE_HEART:0,LOGIN:1,LOGIN_OVER:82,User_Action_Time_Mark:83,HEART:98,BUILD_BUILDING:100,BUILD_ORDER:101,GET_ORDER:102,BUILD_STATE_UP:103,BUILD_MOVE:104,CHANGE_POSITION:120,BUY_COIN_FROM_MACHINE:121,UNLOCK_AREA_WAR:117,PRODUCT_SPEEDUP:106,TENURE:107,VISIT:108,ARMY_MOVE:110,DELETE_BUILDING:111,DELETE_ARMY:112,BUILD_REPAIR:113,SPEED_ARMY:118,AUTO_COLLECT_GOLD_LEVEL_UP:126,ORDER_QUEUE_SPEED_UP:124,ARMY_SPEED_ALL:125,ARMY_SPEED_SELECT:143,ORDER_QUEUE_ADD:122,ORDER_QUEUE_ALL_DONE:123,NewBuilding_ByItem:127,Get_BuildBoxesData:128,Build_ByBox:129,Build_Box_MERGE:130,Build_In_Box:131,Builds_In_Box:132,ErrorBuilds_In_Box:133,GOLD_ORDER_QUEUE_ADD:134,USE_PROP_SPEED_ARMY:135,Build_Box_Resolve:136,ARMY_MERGE:203,ARMY_HEAL:206,ARMY_CANCEL_PRODUCE:207,ARMY_CANCEL_PRODUCE_ALL:144,Treasure_Repair:145,Explode_Vein:146,Treasure_Piece_Repair:147,Treasure_Piece_Log_Get:148,Treasure_Piece_Log_Delete:149,INSTALL_ARMY_EQUIP:209,TAKEOFF_ARMY_EQUIP:210,COMPOSE_ARMY_EQUIP:211,UNLOCK_ARMY_EQUIP_POS:213,CHANGE_ARMY_EQUIP_GROUP:227,GET_ARMY_EQUIP_GROUP:228,LEVEL_UP_INIT_ARMY_EQUIP:214,IMM_LEVEL_UP_INIT_ARMY_EQUIP:215,ARMY_FIX_INBOX:216,BUILDING_MERGE:116,ARMY_BATCH_MERGE:205,BUILDING_BATCH_MERGE:119,QUEST_COMPLETE:301,DAILY_QUEST_REFRESH:302,GET_DAILY_QUEST_REWARD:303,GET_DAILY_QUEST_BOX_REWARD:304,FAST_FINISH_DAILY_QUEST:305,GET_WORLD_TREASURE_QUEST:306,REFRESH_WORLD_TREASURE_QUEST:307,RECEIVE_WORLD_TREASURE_QUEST:308,Chapter_Task_Complete:309,Chapter_Task_Donate:310,Chapter_Complete:311,GET_QUEST_DATA:312,ShareId:601,PublicAddressReweard:602,FavWxReweard:603,SendPayToServer:701,DEV_SendPayToServer:702,CRYSTAL_SendPayToServer:705,GetG123PayInfo:703,SendPayToServer_toutiao:706,CashCouponPay:707,RequestPayServer_wanba:708,SendPayToServer_ios:711,SendPayToServer_google:712,RequestPayServer_oppo:713,RequestPayServer_vivo:714,RequestPayServer_huawei:718,SendPayToServer_ios_v1:715,SendPayToServer_googleplay_v1:716,Fix_GP_Account:1512,VideoRewardCommon:800,BuyEnergry:801,UpdatePlayerInfo:802,GetSignReward:803,ITEM_USE:815,ITEM_DELETE:812,Item_Compose:817,Science_LevelUp:816,ARMY_HELP:204,ARMY_HELP_ALL:221,Get_Assistance_Data:222,BindUserAccount:869,UnBindUserSNS:1510,BindUserSNS:1511,BindSNSInfo:1513,SwitchAccountSNS:1514,UnBindSNSNEW:1515,GET_DOWNLOAD_GIFT:1651,LimitedShopRefresh:870,Limit_Shop_Buy:871,BindAccountReward:872,G123BindAccountReward:9999,G123CanBindAccountReward:9999,PlatformActivityState:1394,FreeCoinShare:819,FreeCoinReward:820,ShareDoubleArmy:823,ShareRewardBoxReceive:824,GetTimeReward:825,SetMaxItem:828,ShareScience:831,PromotionOP:840,VideoRewardGet:834,ClickSharebox:804,GetShareBoxReward:805,ShareBoxs:806,RENDUOLILIANGDA:807,DailyQuests:808,RefreshDailyQuests:809,GetDailyTaskReward:810,SpeedDailyTask:811,GetDailyTaskBoxReward:812,DelFriendPowerItem:813,AddFriend:501,DelFriend:502,ReplayAllFriending:506,SendCrystalToFriend:507,AddFriending:503,ReplyFriending:505,GoldBuyItem:818,GoldGetWelcomeReward:821,VIDEO_GET_GOLD:822,GROWTH_FUND_GET_REWARD:751,RemoveHomeObstaclePoint:109,ARMY_UNLOCK:200,ARMY_LEVELUP:201,ARMY_PUT:202,STARTADVENTURE:400,ADVENTURECLICK:401,STARTA_PVE_OBSTACLE:414,STARTA_PVE_OBSTACLE_ATTACK:415,NBATTLE_START_PVE_OBSTACLE:420,WORLDMAP_SCOUT:416,WORLDMAP_SUPER_SCOUT:417,BattleReward:405,ADVENTURE:300,SaveGuideStep:814,PostChatMsg:670,RequestPrivateChat:675,RequestPrivateUsers:676,DeletePrivateUser:677,ReadChatInfo:678,ChatReport:679,ChatGroupCreat:940,ChatGroupExit:941,ChatGroupSettingChange:942,ChatGroupInvite:943,ChatGroupGetList:944,ChatGroupRead:945,ChatGroupGetInviteList:946,ChatReportNew:1395,HeadIconReport:696,SyncAppPushToken:691,SyncPushSwitch:693,SyncNotifySwitch:1392,GetEmotionList:1607,GetServerAvatar:1611,GET_WORLD_INFO:901,MARCH_WORLD_POINT:902,CHOOSE_WORLD_AREA:903,RECALL_MARCH:904,LEAVE_WORLDMAP:1e3,GET_TERRITORY_INFO:1001,GET_OWNER_TERRITORY_INFO:1002,GET_MARCH_TIME:905,WORLD_SEARCH_MONSTER:906,WORLD_DESSTORYED_CONFIRM:907,WORLD_GETPLAYER_INFO:908,GET_PLAYER_POINT:909,PeaceShieldHandler:910,MOVE_CITY_POSITION:911,GET_MARCH_INFO:912,GET_MYWORLDCITY_SHIELD:916,GET_JION_ALL_RCTIME:1026,POWER_RANK:650,ALLIANCE_POWER_RANK:651,GET_WORLD_RANK:652,PLAYER_INFO:630,SendFBAppRequestId:640,GetFBAppRequestReward:641,GET_SERVER_EXCHANGE:700,GET_SERVER_ORDERED_EXCHANGE:709,GET_TIMECARD_REWARD:750,SET_SHARE_TIMES:829,GET_SHARE_TIMES:830,CHANGE_PROVINCE:832,CHANGE_NICK_NAME:835,CHANGE_USER_GENDER:851,CHANGE_AVATAR:1304,NOTICE_REGIST:838,GET_ACTIVITY_DATA:841,GET_ACTIVITY_REWARD:842,GET_ACTIVITY_RANK:843,GET_ACTIVITY_ALLSEVER_RANK:839,GET_ACTIVITY_REWARD_RANK:844,ACTIVITY_VALENTINE_GIVE:845,GET_SHAREBOX_ACTIVITY_REWARD:846,GET_CONVERT_REWARD:860,GET_USER_SERVERLIST:847,CHANGE_SERVER:848,RECALL_ACT_REWARD:849,ACTIVITY_KING_BOX_REWARD:850,GET_MY_CASTLE_FACE:854,USE_CASTLE_FACE:855,GET_ALL_MY_MARCH_INFO:856,CHARACTER_DELETE:857,CASTLE_COLLECT_REWARD:1343,CHANGE_NATIONAL_FLAG:1344,GET_ShakeMoneyTreeData:836,ShakeMoneyTreeData:837,FAVORITE_ADD:913,FAVORITE_DELETE:914,FAVORITE_GET_LIST:915,getBossInfo:917,GET_WORLD_BOSS_RANK:918,GET_BOSS_ATTACK_INFO:919,MARCH_SPEED_UP:920,MAIL_GET_LIST:921,MAIL_DROP:922,MAIL_FAVORITE:923,MAIL_READ:924,MAIL_SEND:925,MAIL_GETREWARD:926,MAIL_GETREPORT:927,MAIL_UNREAD:928,MAIL_QUERY:929,MAIL_nGetGroupList:933,MAIL_nUnreadCount:934,MAIL_nGetNewMails:935,Mail_nReadedAllMails:936,Mail_nDeleteShowTypeAll:937,GET_GAME_NOTICE:930,VOTE_GAME_NOTICE:931,QUERY_RANK_CHALLENGE_INFO:960,QUERY_ARMY_RANK_LIST:961,ARMY_RANK_FLUSH:962,ARMY_RANK_CHALLENGE:963,ARMY_RANK_PRIZE:964,ARMY_RANK_BUY_CHALLENGE_NUM:965,MILITARY_BATTLE_HISTORY:966,ALLIANCE_GET_STATES:950,ALLIANCE_GET_DETAIL:951,ALLIANCE_GET_ROLES:952,ALLIANCE_PVP:953,ALLIANCE_CHANGE_COLOR:954,ALLIANCE_CHANGE_NOTICE:955,ALLIANCE_BUF_GET_GOLD:956,ALLIANCE_GET_PLAYERINFO:957,ALLIANCE_GET_ALL_COORDS:1003,GET_WORLD_SITE_DATA:1004,GET_WORLD_POINT_MARCH:1005,WORLD_SITE_GIVEUP:1006,WORLD_SITE_CHANGENAME:1007,THRONE_GET_INFO:1008,THRONE_GET_OFFICIAL_LIST:1009,THRONE_CHANGE_PLAYER_OFFICIAL:1010,THRONE_GET_MANAGE_INFO:1011,THRONE_CHANGE_SERVER_NAME:1012,THRONE_CHANGE_NOTICE:1013,THRONE_BUY_BUFF:1014,THRONE_RECRUIT_BUFF:1015,THRONE_GIVE_GIFT:1016,THRONE_POWER_RANK:1017,THRONE_GIFT_DATA:1018,THRONE_HISTORY_DATA:1019,THRONE_KING_GIFT:1020,THRONE_REPORT_DATA:1064,GET_AIRDROP_INFO:1024,INTERCEPT_AIRDROP_MARCH:1022,PRE_INTERCEPT_AIRDROP_MARCH:1023,WORLD_SEARCH_RALLYBOSS:1025,ALLIANCE_CREATE:1100,ALLIANCE_DISSOLUTION:1101,ALLIANCE_CHECK_NAME_CANUSE:1102,ALLIANCE_CHECK_TAG_CANUSE:1103,ALLIANCE_CHANGE_INFO:1104,ALLIANCE_REVISE_NOTICE:1110,ALLIANCE_CHANGE_MANIFESTO:1111,ALLIANCE_GET_APPLYLIST:1112,ALLIANCE_APPLY:1114,ALLIANCE_CANCEL_APPLY:1115,ALLIANCE_AGREE_APPLY:1116,ALLIANCE_REFUSE_APPLY:1117,ALLIANCE_GET_INVITE_LIST:1118,ALLIANCE_GET_MEMBER_RANK_LIST:1123,ALLIANCE_GET_MEMBER_POS:1125,ALLIANCE_CHANGE_MEMBER_RANK:1126,ALLIANCE_KICK_MEMBER:1127,ALLIANCE_EXIT:1128,ALLIANCE_CHANGE_LEADER:1129,ALLIANCE_RECALL_LEADER:1130,ALLIANCE_GET_INFO:1131,ALLIANCE_GET_MEMBER_LIST:1132,ALLIANCE_SEARCH:1133,ALLIANCE_GET_RECOMMEND_LIST:1134,ALLIANCE_GET_RECOMMEND:1137,ALLIANCE_GET_SCIENCE:1143,ALLIANCE_DOANTE_SCIENCE:1144,ALLIANCE_UPLEVEL_SCIENCE:1145,ALLIANCE_UPLEVEL_DONE:1146,ALLIANCE_RECOMMEND:1147,ALLIANCE_SCIENCE_INFO:1148,ALLIANCE_SHOP:1149,ALLIANCE_BUYSHOP:1150,ALLIANCE_SHOP_STATUE:1151,ALLIANCE_RECEIVE_FAKE_GIFT:1152,ALLIANCE_SEND_TO_ALL_MAIL:1153,ALLIANCE_GET_TERRITORY:1154,ALLIANCE_CREATE_TERRITORY:1155,ALLIANCE_GET_A_BUILDING_INFO:1156,ALLIANCE_REMOVE_A_BUILDING:1157,ALLIANCE_GET_A_BUILDING_INFO_SIMPLE:1158,ALLIANCE_BUILDING_DONATE:1159,ALLIANCE_GET_HELPLIST:1138,ALLIANCE_HELP_APPLY:1139,ALLIANCE_HELP_MEMBER:1140,ALLIANCE_HELP_RECEIVE:1141,ALLIANCE_MOVE_INVITE:1164,ALLIANCE_MOVE_INVITEALL:1179,ALLIANCE_MOVE_ACCEPT:1165,ALLIANCE_MOVE_REFUSE:1180,ALLIANCE_AUTO_ASSEMLBY_SET:1181,ALLIANCE_AUTO_ASSEMLBY_GET:1182,ALLIANCE_HELP_CANCLE:1183,ALLIANCE_MEMBER_DYNAMIC:1142,CHAT_CONNECT:671,ALLIANCE_Assemblys:1200,ALLIANCE_Assembly_Create:1201,ALLIANCE_Assembly_Cancel:1202,ALLIANCE_Assembly_Repatriation:1203,ALLIANCE_Assembly_Join:1204,ALLIANCE_Defend:1205,ALLIANCE_Assistances:1207,ALLIANCE_BACKAssistance:1208,ALLIANCE_AssistanceRecored:1209,ALLIANCE_AssemblyBattleRecored:1210,ALLIANCE_BOSS_GET_INFO:1160,ALLIANCE_BOSS_DONATE:1161,ALLIANCE_BOSS_SET:1162,ALLIANCE_BOSS_CD:1163,SHOP_GET_DATA:853,HERO_GET_DATA:861,HERO_RECRUIT:862,HERO_USE_EXP_ITEMS:863,HERO_COMPOSE:864,HERO_STAR_RISE:865,HERO_CONVERT_PATCH:866,HERO_USE_SKILL:1341,HERO_CANCEL_SKILL:1342,EVERYDAYREWARD_GET_DATA:611,EVERYDAYREWARD_GET_REWARD:613,CASINO_QUERY:867,CASINO_GET_REWARD:868,FIRST_CHARGE_GET:752,GET_WAREHOUSE_INFO:137,ADD_WAREHOUSE_LATTICE:138,WAREHOUSE_DELETE_ARMYS:139,WAREHOUSE_MOVE_ARMYS_OUT:140,Building_Exchange:141,ARMY_STORE:217,ARMY_WAREHOUSE_MERGE:218,ARMY_WAREHOUSE_BATCH_MERGE:219,ARMY_HEAL_LIST:220,ARMY_OUT_WAREHOUSE_BATCH_MERGE:224,POWERITEM_COMPOSE_ALL:225,DECORATION_COMPOSE_ALL:142,ARMY_STORE_SINGLE:226,START_MINE:875,AWARD_MINE:876,BUILD_IN_MINE:877,CancelAllianceExchangeHandler:1169,HelpAllianceExchangeHandler:1168,TransferToTerritory:1166,RequestAllianceExchangeHandler:1167,GetAllianceExchangesByTypeHandlerNew:1170,Get_Alliance_Chat_Reward_List:1171,Receive_Alliance_Chat_Reward:1172,Get_Alliance_Star_Task:1173,Get_Alliance_Star_Task_Reward:1174,GET_ALLIANCE_GIFTS:1175,Receive_Alliance_Gift_Small:1176,Receive_Alliance_Gift_Small_All:1177,Receive_Alliance_Gift_Big:1178,GetShareActId:694,PatchSynthesisSkin:878,PatchSynthesisArmyLineSkin:1408,GetRefugee:1021,PUZZLE_ACTIVITY_REWARD:879,GET_MY_CASTLE_NAMEPLATE:881,USE_CASTLE_NAMEPLATE:882,Activity_FRIEND_DETAIL:614,CONVERT_HERO_SKILL_BOX:896,GET_ISLAND_DATA:431,GET_ISLAND_BLOCK_DATA:432,GET_ISLAND_BLOCK_FIGHT:433,GET_ISLAND_BLOCK_MOVE:434,GET_ISLAND_NEXTFLOOR:435,GET_ISLAND_BUY_RESET:436,GET_ISLAND_BUY_ITEM:437,GET_ISLAND_SELECT_DIFFICULTY:438,GET_PVE_TOWER_DATA:440,STARTA_PVE_TOWER:441,GET_ISLE_DATA:446,ISLE_EMBATTLE:447,ISLE_CHANLLEGE:448,ISLE_RESET:449,ISLE_BATTLE_LOG_GET:450,DEGENERATOR_INFO:451,DEGENERATOR_SEARCH:452,DEGENERATOR_FIGHT:453,DEGENERATOR_GET_MAIL:454,DEGENERATOR_REWARD:455,DEGENERATOR_REFRESH:456,DEGENERATOR_DELETE_MAILS:457,STUDY_HERO_SKILL:897,FORGET_HERO_SKILL:898,LEVEL_UP_INSTALLED_HERO_SKILL:885,DECOMPOSE_HERO_SKILL:886,UNLOCK_HERO_TALENT_SLOT:887,UNDERSTAND_HERO_TALENT:888,RANDOM_HERO_TALENT:889,REPLACE_HERO_TALENT:894,LEVEL_UP_UNINSTALLED_HERO_SKILL:895,HERO_SKIN_CHANGE:899,ACTIVITY_REVERSECARD:755,ACTIVITY_REVERSECARD_RESET:753,ACTIVITY_REVERSECARD_BUY:754,ACTIVITY_REVERSECARD_DATA:756,GET_MY_ARMYLINE_FACE:858,USE_ARMYLINE_FACE:859,GET_MY_HEADFRAMES:883,USE_MY_HEADFRAME:884,SUMMER_ACT_AWARD:1300,AWARD_GROW_ROAD_TASK:1301,AWARD_GROW_ROAD_STAGE:1302,AWARD_GROW_ROAD_ALL_STAGES:1303,WANBA_REWARD:1503,CROSS_SERVER:1400,GET_WORLD_CROSS_TELEPORTERS:1401,GET_ONE_DARK_PORTAL_DATA:1402,FORSE_BACK_SERVER:1404,GET_CROSS_SERVER_POINT_REWARD:1405,Receive_CROSS_SERVER_POINT_REWARD:1406,GET_CROSS_SERVER_KILL_RANK:1407,SET_CHAT_BLOCK:874,SAVE_DEFENSE_TROOPS:880,GET_APP_BIND_STATS:873,MOVE_ARMY_OUT_WAREHOUSE:223,ASK_DEFEND_ARMY:1403,SEARCH_HAMMER_BOSS:1027,MARCH_ARMY_DETAIL:1028,SEARCH_HAMMER_BOSS_MAXLEVEL:1029,GET_COUNTRY_BOSS_TASK_DATA:1040,GET_COUNTRY_BOSS_TASK_LINE_REWARD:1041,GET_COUNTRY_BOSS_TASK_REWARD:1042,GET_COUNTRY_BOSS_RANK:1043,GET_COUNTRY_BOSS_DAMAGE_REWARD:1044,COUNTTRY_BOSS_SUMMON:1045,GET_VOTE_TIME_DATA:1050,USER_VOTE_TIME:1051,KING_VOTE_TIME:1052,ACTIVITY_DRAW_CARD:1308,ACTIVITY_DRAW_CARD_RANK:1309,GET_ACTIVITY_SUMMER_LOTTERY_INFO:1305,GET_ACTIVITY_SUMMER_LOTTERY_REWARD:1306,SEND_REAL_NAME_INFO:1307,DIRECT_REPLACE_HERO_TALENT:1310,ACTIVITY_KILL_RALLYBOSS_INFO:1311,AllianceMemberInviteGetData:1118,AllianceMemberInviteAction:1119,AllianceMemberInviteAgree:1121,AllianceMemberInviteDelete:1122,CHOICE_PROFESSION:1319,GET_LEARN_TALENT_DATA:1318,PROFESSION_LEARN_TALENT:1314,PROFESSION_SPEED_LEARN:1316,RESET_PROFESSION_TALENT:1315,CHANGE_PROFESSION:1317,ACTIVITY_BUY_SCORE_SHOP_ITEM:1312,ACTIVITY_BUY_SCORE_GIFT_CHECK:699,ACTIVITY_BUY_SCORE_GIFT_INFO:1313,ACTIVITY_LUCKY_DRAW_CARD_INFO:1323,ACTIVITY_LUCKY_DRAW_CARD_ACT:1324,ACTIVITY_RECHARGE_SCORE_SHOP_INFO:1409,ACTIVITY_RECHARGE_SCORE_SHOP_GET_REWARD:1410,GET_CROSS_SERVER_BATTLE_RECORD:1411,GET_SERVER_SCORE_RANK_DATA:1412,GET_CROSS_SERVER_EVENT_LOG:1413,GET_CROSS_SERVER_OPPONENT_ID:1414,ACTIVITY_RECHARGE_SCORE_SPIN_INFO:1327,ACTIVITY_RECHARGE_SCORE_SPIN_LOTTER:1328,ACTIVITY_RECHARGE_SCORE_SPIN_GET_REWARD:1329,SAVE_DEFENSE_HIGH_SET:1321,AWARD_ONCE:1322,SWAP_HERO_TALENT:1325,GET_SHIELD_LOG:1330,PAY_PRE_FLOW:790,GET_TOWER_LIST:1031,TOWER_REMOVE:1032,MARCH_WORLD_Build:1033,GET_TOWERINFO:1034,TOWER_COLLECT:1035,GET_THRONE_BATTLE_VOTE_DATA:1036,TRHONE_BATTLE_TIME_VOTE:1037,TRHONE_BATTLE_TIME_SELECT:1038,RegisterSystemPush:1061,UnregisterSystemPush:1062,superReward:852,OCTOBER_RECORD:900,NOBACK_LOTTERY:1326,FLOWER_LOG:1331,GET_WORLD_TREASURE:1336,UploadUserHeadImage:1335,PERSONAL_MONSTER_SIEGE_START:1320,GET_CASTLE_EFFECT_ITEM:1332,GET_MY_CASTLE_EFFECT:1333,USE_CASTLE_EFFECT:1334,SIGNUP_AL_MONSTER_SIEGE:1350,REPAIR_ALLIANCE_FORTRESS:1351,WEAK_AL_SIEGE_MONSTER:1352,THANKSGIVING_GETREWARD:1338,COMPOSE_ITEM:1337,MILITARY_UP:1361,QUEST_GET:1362,QUEST_WorldPoint_get:1363,FIND_MOD:1339,GET_SIXTEEN_FIGHT:1415,GET_SIXTEEN_BET_INFO:1416,BET_SIXTEEN:1417,WORLDBATTLE_SHOP_BUY_ITEM:1360,CANCEL_BET_SIXTEEN:1418,BOUNTY_SHOP_BUY_ITEM:1364,RealNameReward:1340,ChangeHeroSkillsIndex:1345,SavePreMarch:1346,USE_CDK_CODE:695,GIFTBOX_DRAW:1373,GIFTBOX_NEXT:1374,GIFTBOX_GETPACKAGE:1375,ACTIVITY_MINE_DIG:1370,ACTIVITY_MINE_RESOLEVE:1371,ACTIVITY_MINE_CONVERT:1372,ACTIVITY_HUNT_DIG:1393,ACTIVITY_DICE_ROLL:1376,ACTIVITY_GET_DICE_REWARD:1377,ACTIVITY_DICE_RECORD:1378,Get_Treasure_Theme_Data:1379,RndTaskRefresh:1419,NEWYEAR_GETREWARD:1365,CrossServerFightKillRank:1420,LuckBagRequest:1368,ActivityJanuaryGiftSign:1369,ActivityCalendarGetData:1347,CrossServerBattleResult:1421,ActivitySocialReweard:1366,Evaluate_MOD:1367,getConsignList:1380,getSingleItemConsignList:1381,getSingleItemConsignBuyList:1621,consignmentSomeItem:1382,consignmentBuySomeItem:1622,consignmentBuy:1383,consignmenSell:1623,consignmentMyGoods:1384,consignmentRecord:1385,consignmentSoldOut:1386,consignmentBuySoldOut:1624,getStrengthenMakingData:1387,MAKE_FORMULA:1388,SPEED_UP_FORMULA:1389,CANCEL_FORMULA:1390,EQUIP_OR_REMOVE_DEF_TRAPS:1391,ProductionListGet:1398,ProductionStart:1399,ProductionComplete:1600,ProductionCancle:1396,ProductionReward:1397,ActivityEaster_GetBall:1608,ActivityEaster_GetReward:1609,Get_Adventure_Data:1630,Adventure_Start:1631,Adventure_Hero_Save:1632,Adventure_Reward:1633,Adventure_Sweep_Reward:1634,Adventure_Boss_Attack:1635,Adventure_Total_Rank:1636,Adventure_Last_Win_Team:1637,Adventure_Activity_Info_By_Type:1638,Adventure_Shop_Item_Buy:1639,Adventure_GET_HALL_TASKS:1640,Adventure_AWARD_HALL_TASK:1641,chatMuted:680,GET_KVK_INFOS:1450,GS_TO_KVK:1451,KVK_TO_GS:1452,KVK_ALLIANCE_BUILDING:1453,KVK_ALLIANCE_BUILDING_CREATE:1454,KVK_ALLIANCE_BUILDING_DETAIL:1455,KVK_ALLIANCE_BUILDING_REMOVE:1456,KVK_ALLIANCE_BUILDING_FIX:1457,KVK_ALLIANCE_REBUILD_BASE:1458,KVK_ALLIANCE_REBUILD_BASE_DONATE:1459,KVK_ALLIANCE_CHOICE_COLOR:1460,EC_PREPARE_INFO:1471,EC_PREPARE_SYNTHESIS:1472,EC_PREPARE_DONATE:1473,EC_PREPARE_REWARD:1474,EC_PREPARE_RANK:1475,EC_PREPARE_DONATE_NEW:1476,KVK_GET_RANK:1478,KVK_GET_ACHEVEMENT:1479,KVK_GET_ACHEVEMENT_REWARD:1480,KVK_GET_PROGRESS_REWARD:1481,KVK_SMALL_MAP_INFO:1461,KVK_JUDGE_IS_CONNECT:1462,KVK_JUDGE_CITY_IS_CONNECT:1463,KVK_MARK_WORLD_POINT:1482,KVK_UNMARK_WORLD_POINT:1483,DecorateStorehouse_GetData:1601,DecorateStorehouse_PutIn:1602,DecorateStorehouse_PutInPos:1610,DecorateStorehouse_PutOut:1603,DecorateStorehouse_MovePos:1604,DecorateStorehouse_Compose:1605,DecorateStorehouse_PutOutAll:1606,GET_GUN_FIGHT_INFO:1055,GET_GUN_FIGHT_USER_INFO:1057,GET_GUN_FIGHT_ALLIANCE_RANK:1056,ALLIANCE_GET_SHOW_TASK:1184,ALLIANCE_TASK_TANK:1185,ALLIANCE_ACHEVEMENT_TASK_GET_REWARD:1186,ALLIANCE_BADGE_READ:1187,ARMYEQUIP_NEW_MATERIAL_PRODUCE:1643,ARMYEQUIP_NEW_MATERIAL_PRODUCE_DELETE:1644,ARMYEQUIP_NEW_MATERIAL_PRODUCE_GET:1645,ARMYEQUIP_NEW_MATERIAL_COMPOSE:1646,ARMYEQUIP_NEW_MATERIAL_DISMANTLE:1647,ARMYEQUIP_NEW_EQUIP_COMPOSE:1648,ARMYEQUIP_NEW_EQUIP_DISMANTLE:1649,ARMYEQUIP_NEW_EQUIP_CHANGE:1650,HURT_TANK_QUEST:1652,ACTIVITY_GET_SCORE_REWARD:1642,GET_GUN_FIGHT_USER_REWARD:1058,GET_ARIDROP_POINT:1059,SEND_SYSTEM_MSG:1060,GET_ALLIANCE_DISPLAY_TIME:1353,GET_AL_MONSTER_SIEGE_ACT_RANK_INFO:1354,AWARD_AL_MONSTER_SIEGE_RANK:1355,GET_AL_MONSTER_SIEGE_ITEM_COUNT:1356,GET_AL_MONSTER_RANK_DATA:1357,Compose_Treasure_Debris:1358,Get_Treasure_Theme_Reward:1359,ACTIVITY_ALLIANCEBP_RANK:1348,NBATTLE_ARENA_PVE:1660,ARENA_PVE_MAIN_REQUEST:1661,ARENA_PVE_RANK:1662,ARENA_PVE_CONFIG:1663,ARENA_PVE_RECORD_LOG:1664,MigrateCode_getCode:1653,MigrateCode_CreateCode:1654,MigrateCode_UseCode:1655,ARENA_PVP_MAIN_REQUEST:1665,ARENA_PVP_SETD_DEFEND:1666,ARENA_PVP_DF_DETAIL:1667,ARENA_PVP_PLAYER_LIST:1668,ARENA_PVP_START_FIGHT:1669,ARENA_PVP_BATTLE_RECORD:1670,PVP_BUY_TICKET_ITEM:1671,Activity_Hero_Return_Reward_Select:1656,Activity_Hero_Return_Roll:1657,GET_WORLD_SERVER_BRIEFING:1658,GET_WORLD_SERVER_OTHER_BRIEFING:1659,King_Mark_Get:1673,King_Mark_CHANGE:1672,GET_TREASURE_MAP_DATA_BY_TYPE:1680,GET_RECENT_TREASURE_MAP_DATA:1681,CREATE_TREASURE_MAP_DATA:1682,DONATE_TREASURE_MAP_ITEM:1683,AWARD_DONATE_ITEM_TREASURE_MAP:1684,LOTTERY_TURN_TABLE_TREASURE_MAP:1685,TreasureMapChooseBoss:1686,GET_TREASURE_MAP_WORLD_BOSS_INFO:1687,GET_HURT_TREASURE_MAP_WORLD_BOSS_RANK:1688,GET_TREASURE_MAP_WORLD_SHOP:1689,BUY_IN_TREASURE_MAP_WORLD_SHOP:1690,GET_TREASURE_MAP_TASK_INFO:1691,GET_TREASURE_MAP_TASK_REWARD:1692,GIVE_UP_TREASURE_MAP_TASK:1693,King_Castle_Effect_Equip:1677,ACTIVITY_GURBAN_BUY_ADV:1674,ACTIVITY_GURBAN_USE_ITEM:1675,LUCK_MALL_REFRESH:1678,LUCK_MALL_BUY:1679,ACTIVITY_KINGDOM_GETINFO:1676,ACTIVITY_WORK_AWARD:1700,ADD_EXPLORE_SEA_SLOT:1694,AWARD_EXPLORE_SEA:1695,COMPOSE_EXPLORE_SEA_BOX:1696,SPEED_UP_EXPLORE_SEA:1697,START_EXPLORE_SEA:1698,EXPLORE_SEA_HUNT_ALL:1708,GET_NEARST_TERRITORY_MARCH_TIME:1710,ACTIVITY_RED_BLUE_RESET_AWARD:1701,GET_DECORATION_SUITS:1702,AWARD_DECORATION_SUIT:1703,Convert_ExcludeHero_Patch:1705,GET_WORLD_RESOURCE_AMOUNT:1063,LIKENESS_SURVEY:1699,OPEN_ALL_SEA_CLOUD:1715,UNLOCK_AREA_WAR_SEA:1716,AREA_SEA_FIGHT:1717,MONEY_TREE_INFO_V1:1801,MONEY_TREE_CLICK_V1:1802,EC_GET_EXCHANG_INFO:1488,EC_GET_EXCHANG_REQUEST:1489,EC_GET_BUFF:1490,EC_STRONGEST_LEADER_COMPETITION:1484,EC_STRONGEST_LEADER_RANK:1485,EC_STRONGEST_LEADER_DONATE:1486,EC_STRONGEST_LEADER_GET_REWARD:1487},cc._RF.pop()},{}],ResponseId:[function(e,t,a){"use strict";cc._RF.push(t,"1a796cLGrxAeJdu1zsJKFye","ResponseId"),Object.defineProperty(a,"__esModule",{value:!0}),a.ResponseId={ERROR_ID:-1,LOGIN:1,USER_DISCONNECT:2,PUSH_KICK_OUT:5,PUSH_MigrationRole:11019,PUSH_BUILDING:10101,PUSH_BUILDINGS:10109,PUSH_ENERGY:10021,PUSH_REWARD:10031,PUSH_REALNAME:10032,PUSH_EXP:10041,PUSH_AREA:10104,PUSH_QUESTS:10050,PUSH_QUEST:10051,DELETE_ARMY:10202,ARMY_DROP_LIST:10204,ARMY_INFO_LIST:10205,PUSH_ARMY:10201,PUSH_PAYMENT:10501,PUSH_OCCUPATIONS:10105,PUSH_POINT:10102,PUSH_REMOVE_OBSTALCE:10103,PUSH_PEOPLE:10106,DROP_BUILDING:10107,PUSH_MAX_ITEM:10709,DROP_BUILDING_LIST:10117,BUILDING_INFO_LIST:10118,PUSH_UNLOCK_OCEAN:10111,PUSH_ArmyBox:10203,PUSH_TOOL:10401,PUSH_ITEMS:10402,PUSH_SHAREBOX:10701,PUSH_TimeDowns:10702,PUSH_AutoCollect:10108,PUSH_EXCHANGE:10502,PUSH_EXCHANGE_ORDERED:10448,PUSH_TIME_CARDS:10510,PUSH_ACChargeLevel:10110,USER_MARCH_INFO:10019,MARCH_INFO:10007,PUSH_TERRITORY_INFO:10020,PUSH_USE_WORLD_EFFECT_ITEM:10413,MARCH_ATTACKMONSTER_FINISH:10163,WORLD_SITE_PUSH:10169,WORLD_POINT_MARCH_PUSH:10170,WORLD_SITES_PUSH:10171,USER_SHIELD_PUSH:10172,PUSH_THRONE_INFO:10173,PUSH_THRONE_KING_GIFT:10174,PUSH_THRONE_TOWER_ATTACK:10175,PUSH_CROSS_TELEPORTER_INFO_:10176,PUSH_CROSS_FIGHT_SERVER_INFO:10177,PUSH_THRONE_BATTLE_TIME:10178,PUSH_AIRDROP_AIRPLANE:10180,PUSH_AIRDROP_DROP_CHANGE:10181,PUSH_AIRDROP_VOTE_TIME:10183,ORDER_QUEUE_INFO:10119,ORDER_QUEUES_BATCH_INFO:10120,ARMY_EQUIP_INFO_PUSH:10121,ARMY_GROUP_EQUIP_INFO_PUSH:10125,Push_Treasure_Info:10126,Push_Decoration_Suit:10127,Treasure_Record_Push:10122,Push_Chapter_Task:10123,Push_Chapter_Task_List:10124,USERARMY_MARCHSTATE:10164,PUSH_TILEINFO:10018,PUSH_ENEMYREFRESH:10162,PUSH_OWNER_WORLD_POINT_INFO:10165,PUSH_WORLD_DESTORYED:10166,PUSH_ATTACK_ARMIES:10167,PUSH_SYSTEM_SOUND_PLAY:20001,MARCH_ATTACKBOSS_FINISH:10266,WORLD_BOSS_APPEAR:10267,WORLD_BOSS_INFO:10268,PUSH_AddFriend:10601,PUSH_DelFriend:10602,PUSH_ADDFriending:10603,PUSH_CANCELADDFriending:10604,PUSH_RESOURCE:10001,PUSH_STRTIPS:10002,PUSH_STAR:10012,Push_PVE:10301,PUSH_DAILY_QUEST_INFO:10703,PUSH_DAILY_QUEST_ALL_INFO:10704,PUSH_CLEAROBSTACLE:10706,PUSH_TILE_PVE:10707,PUSH_NOTICE:10052,PUSH_GAME_NOTICE:10263,PUSH_SINGLE_MAIL:10264,PUSH_SHAREBOX_ARMY:1111121212,PUSH_WORLD_CHAT:10670,PUSH_FreeCoin:10801,WELCOME_REWARD_STATE:10520,PUSH_GROWTH_FUND:10511,PUSH_SHOP_BUY_LIMIT:10410,PUSH_SHOP_BUY_LIMIT_TIME:10411,PUSH_USER_DATA_COMMON:10053,PUSH_NOTICE_PARA:10054,PUSH_COMMON_MESSAGE:10057,PUSH_ALLIANCE_INFO:10420,PUSH_ALLIANCE_KICKED:10421,PUSH_ALLIANCE_RANK_CHANGE:10422,PUSH_ALLIANCE_INFO_CHANGE:10423,PUSH_ALLIANCE_APPLY_CHANGE:10424,PUSH_ALLIANCE_APPLY_ACCEPTED:10425,PUSH_ALLIANCE_HELP_DATA:10426,PUSH_ALLIANCE_HELP_ADD:10427,PUSH_ALLIANCE_HELP_REMOVE:10428,PUSH_ALLIANCE_MEMBER_DYNAMIC:10429,PUSH_ALLIANCE_BUFF:10056,PUSH_BUFF:10055,PUSH_STATE:10460,PUSH_FIND_REFUGEECAMP:10802,PUSH_ITEM_GET_MONSTER:10803,PUSH_COUNTRY_NOTICE_INFO:10362,PUSH_ALLIANCE_SCIENCEDATA:10430,PUSH_ALLIANCE_DIAMOND_DONATE_NUM:10432,PUSH_ALLIANCE_SHOP:10433,PUSH_ALLIANCE_BUILDING_CHANGE:10434,PUSH_ALLIANCE_MOVE_INVITE:10436,PUSH_ALLIANCE_MEMBER_INVITE_ADD:10443,PUSH_ALLIANCE_MEMBER_INVITE_DELETE:10444,PUSH_ALLIANCE_MEMBER_INVITE_DELETEALL:10445,PushAllianceSelfHelpList:10446,PUSH_ALLIANCE_BOSS:10435,PUSH_PAY_TO_SERVER:10503,PUSH_PAY_CHECK_NOT_ENOUGH:10506,PUSH_CHATROOM_CHANGE:11e3,SCIENCE_SHARE_NEWUSER:10710,SCIENCE_SHARE_USER:10711,SHARE_PUSH:10712,PUSH_ACTIVITY_STATE:10901,PUSH_TREASURE_TIME:10902,PUSH_BUILDING_BOX:10903,PUSH_ONE_ACTIVITY:10904,PUSH_BIND_ACCOUNT:11001,PUSH_SET_APP_PLAYERINFO:11005,PUSH_FORCE_CONFIG_UPDATE:20003,PUSH_ALLIANCE_Assembly:12e3,PUSH_ALLIANCE_Assembly_DEL:12001,PUSH_ALLIANCE_Assembly_Success:12002,PUSH_ALLIANCE_Assembly_Created:12003,PUSH_ALLIANCE_Assemblyed:12004,PUSH_CASTLE_FACE_CHANGE:10905,PUSH_CASTLE_EFFECT_CHANGE:11011,PUSH_CASTLE_NAMEPLATE_CHANGE:10907,PUSH_CASTLE_ARMYLINE_CHANGE:10908,PUSH_HEADFRAMES_CHANGE:10909,PUSH_HERO_INFO:10906,PUSH_HERO_SKIN_GET:10910,PUSH_HERO_SKIN_CHANGE:10911,PUSH_HERO_DELETE:10913,PUSH_HERO_ACTIVE_SKILL_INFO:10470,EVERYDAYREWARD_UPDATE_PUSH:10713,PUSH_VIP_CHANGE:11002,PUSH_FIRST_CHARGE_BENEFIT_CHANGE:10504,MINE_INFO:11003,DUBBING_INFO:10512,WORLD_BGM_INFO:10513,ALLIANCE_EXCHANGE_ADD:10437,ALLIANCE_EXCHANGE_HELPED:10438,ALLIANCE_EXCHANGE_CANCELED:10439,ALLIANCE_EXCHANGE_REMOVE:10440,ALLIANCE_CHAT_REWARD_PUSH:10441,PUSH_ALLIANCE_GIFT_INFO:10442,LIMIT_GIFT_POP:11004,PUSH_UPDATA_DAILY_REQUEST:10720,Push_WorldTreasure_Result:10721,GROW_ROAD_INFO:10717,GROW_ROAD_SUPER_FLAG:10716,GROW_ROAD_ALL_TASK_INFO:10714,GROW_ROAD_UPDATED_TASK_INFO:10715,PUSH_SERVER_STATE:13e3,PUSH_RESTART_GAME:13001,FIRST_PAY_CNY:10505,ACTIVITY_SUMMER_LOTTERY_INFO:10718,PUSH_WORLD_TREASURE_QUEST:10719,PUSH_COUNTRY_BOSS_DATA:10722,PUSH_PRODUCT_COMPLETE:10723,ACTIVITY_REVERSE_CARD:11006,PUSH_PVE_TOWER_DATA:11008,ACTIVITY_LUCKY_DRAW_RESET:11007,PROFESSION_CHANGED_PUSH:11101,DEF_ARMY_CANDIDATE_INFO:11102,PUSH_SHOPPOINT_ACTIVITY:11009,PUSH_MY_PROFESSIONAL_TOWERS:10182,USER_MONSTER_SIEGE_INFO:11103,ALLIANCE_MONSTER_SIEGE_INFO:11104,PUSH_MOD_CHANGE:11012,DEGENERATOR_INFO_PUSH:10514,DEGENERATOR_MAIL_PUSH:10515,DEGENERATOR_REFRESH_PUSH:10516,WORLDBATTLE_SCORE_PUSH:13002,Push_Protect_Data:11013,PUSH_MILITARY_RANK:11014,MILITARY_RANK_SHOPS:11015,PUSH_ONE_ACTIVITYEXTRA:10912,PUSH_ALLIANCEBP_ACTIVITYPOINT:10914,Push_PresetMarchData:11016,Push_AdventureData:11018,GROUP_CHAT_CFG_CHANGE:11200,GROUP_CHAT_MEMBER_CHANGE:11201,PUSH_SALE_NUM_CHANGE:10412,FORMULA_MAKE_COMPLETE:10722,DEF_TRAPS_SLOTS_INFO:11105,POTION_USE_EFFECT:20002,EIGHT_COUNTRY_STATUS:13200,KVK_ALLIANCE_BUILDING_STATUS_CHANGE:13201,KVK_ALLIANCE_INFO_CHANGE:13202,KVK_COUNTRY_INFO_CHANGE:13203,KVK_INFO_CHANGE:13204,EC_PREPARE_INFO_PUSH:13211,KVK_ACHEVEMENT_CHANGE:13212,KVK_FINISH_CHANGE:13213,KVK_PROGRESS_CHANGE:13214,KVK_EXPEDITION_FINISH_CHANGE:13215,DECORATE_STOREHOUSE_CHANGE:10059,GUN_FIGHT_INFO:11017,HEAD_PUSH:11020,EMOTION_PUSH:11021,ALLIANCE_BADGE_AND_TASK_RED_DOT:10447,Push_Status_Buff:10060,AREAN_CONFIG_PUSH:10267,TREASURE_MAP_DATA_REMOVE:10724,TREASURE_MAP_DATA_ADD:10725,TREASURE_MAP_DATA_UPDATE:10726,TREASURE_MAP_TASKS:10727,KING_MARK_PUSH:10179,EXPLORE_SEA_LEGEND_BOX_NOTICE:10728,EIGHT_COUNTRY_STRONGEST_LEADER:13216,EIGHT_COUNTRY_CHANGE_TASK:13217,Push_New_Treasure_Piece_Log:11021},cc._RF.pop()},{}],SceneName:[function(e,t,a){"use strict";cc._RF.push(t,"b4b11nXGEtDq6iz1iRS7RGb","SceneName"),Object.defineProperty(a,"__esModule",{value:!0}),a.SceneName={LOGIN:"Login",HOME:"Home",WORLD:"WorldMap",HOMEOTHER:"HomeOther"},cc._RF.pop()},{}],SoundPath:[function(e,t,a){"use strict";cc._RF.push(t,"0093cywycJFQpIWtvGck6H+","SoundPath"),Object.defineProperty(a,"__esModule",{value:!0}),a.SoundPath={Button_CommonYes:"sound/common_button_click",Button_CommonNo:"sound/bad_move",Button_Error:"sound/common_button_error",CITY_BG:"sound/home_music",World_BG:"sound/pve_map_music",ARMRY_BG:"sound/Victory_Theme",BATTLE_BG:"sound/battle_preview",BUILDING_LEVELUP:"sound/effect_levelup",ARMY_ATTACK:"sound/army_atk",Build_ATTACK:"sound/building_atk",ARMY_DIE:"sound/warrior_death",Build_DIE:"sound/tower_death",Exp_Get:"sound/exp_many",Coin_Get:"sound/coin_many",Wood_Get:"sound/wood_appear",Oil_Get:"sound/resource_appear",Gold_Get:"sound/resource_appear",OtherRes_Get:"sound/resource_appear",Coin_Order:"sound/order_gold",Wood_Order:"sound/order_wood",Oil_Order:"sound/order_oil",Player_LevelUp:"sound/exp_level_up",Battle_Start:"sound/start_battle",Battle_Win:"sound/battle_win",Battle_Lose:"sound/battle_lost",Building_Construct:"sound/building_construct",New_Task:"sound/new_task",Quest_Complete:"sound/quest_complete",RES_COLLECT_END:"sound/gold_collect",building_merge_success:"sound/building_merge_success",army_merge_success:"sound/army_merge_success",merge_fail:"sound/bad_move",kingwar_intro:"sound/kingwar_intro",kingwar_loop:"sound/kingwar_loop",Open_Mail:"sound/open_mail",Click_Tip:"sound/click_tip",Enter_Bag:"sound/enter_bag",Spine_Run:"sound/spine_run",Spine_Stop:"sound/spine_stop",Draw_Card:"sound/draw_card",Draw_Card_Bravo:"sound/draw_card_bravo",PayFinish:"sound/pay_finished",Maintance:"sound/maintance",Talent_Research:"sound/talent_research",Factory_Work:"sound/factory_work",Item_Merge:"sound/item_merge",Open_Box:"sound/open_box",Add_Exp:"sound/add_exp",Click_Tab:"sound/click_tab",click_reward:"sound/click_reward",Click_OK:"sound/click_ok",Open_Shield:"sound/open_shield",CrossServer_Intro:"sound/cserver_1",CrossServer_Loop:"sound/cserver_2",March_Start:"sound/march_start",Start_Rally:"sound/start_rally",Attack:"sound/attack",Attacked:"sound/attacked",King_Build:"sound/king_build",Click_Hammer:"sound/click_hammer",Enter_Base:"sound/enter_base",Enter_World:"sound/enter_world",Vein_Block:"sound/vein_block",Block_Click:"sound/block_click",Count_Down:"sound/count_down"},cc._RF.pop()},{}],TableName:[function(e,t,a){"use strict";cc._RF.push(t,"be22cXCzRhCta5AgxJtlDeU","TableName"),Object.defineProperty(a,"__esModule",{value:!0}),a.TableName={ACTIVITY_PUZZLE:"activity_puzzle",ACTIVITY_SCRATCH:"activity_scratch",ACTIVITY_SCRATCH_ICON:"activity_scratch_icon",AD:"ad",AD_TEST:"ad_test",AVATAR:"avatar",ALLIANCE_BUILDING:"alliance_building",ALLIANCE_LEVEL_TASK:"alliance_level_task",ALLIANCE_LEVEL:"alliance_level",ALLIANCE_BADGE:"alliance_badge",ALLIANCE_SCIENCE:"alliance_science",ALLIANCE_FUNCTION_UNLOCK:"alliance_function_unlock",ALLIANCE_SHOP:"alliance_shop",ALLIANCE_STAR_TASK:"alliance_star_task",ALLI_ITEM_HELP:"alli_item_help",ALLI_ITEM_HELP_NUM:"alli_item_help_num",MAP:"map_x2",AREA:"area_x2",AREA_UNLOCK:"area_unlock",ARMY:"army",ARMY_CLASS:"army_class",BOSS:"boss",BOSS_REWARD:"boss_reward",BUILDING:"building",BULLET:"bullet",CASTLESKIN:"skin",CASTLEEFFECT:"castle_effect",CONSIGMENT:"consignment",CONTINUOUS_CHALLENGE:"continuous_challenge",CONVERT:"convert",COUNTRY_BOSS_DAMAGEREWARD:"country_boss_damageReward",CROSS_SERVER_POINT_REWARD:"cross_server_point_reward",DATACONFIG:"data_config",DAILYTASK:"dailyTask",DECORATION_COMPOSE:"decoration_compose",DECORATION_CONTENTS:"decoration_contents",DEPLOY:"deploy",DICE:"dice",DICE_EXTRA_REWARD:"dice_extra_reward",DISTRICT:"district",DRESS_HEADFRAME:"dress_headframe",DRESS_NAMEPLATE:"dress_nameplate",EASTER:"easter",EFFECTBUFF:"effect_buff",EFFECT_BUFF_TABLE:"effect_buff_table",EMOTION:"emotion",EMOTION_GROUP:"emotion_group",EMOTION_NEW:"emotion_new",ENDOWMENT:"endowment",ENHANCE:"enhance",ETERNAL_LAND_REWARD:"eternal_land_reward",ETERNAL_LAND_RANK:"eternal_land_rank",ETERNAL_LAND_DESC:"eternal_land_desc",EVENT_SHARE_HELP:"event_share_help",EVENT_LOGIN:"event_login",EXCHANGE_PAGE:"exchange_page",EXPEDITION_SHOP:"expedition_shop",EXTRACT:"extract",GIFTBOX:"giftbox",GROW_ROAD_REWARD:"grow_road_reward",GROW_ROAD_TASK:"grow_road_task",GUIDE:"guide",GUIDE_ACTIVITY:"guide_activity",GUIDE_FREE:"guide_free",FOREIGN_PRICE:"foreign_price",HERO:"hero",HEROSKILL:"hero_skill",HEROSKIN:"hero_skin",HERO_COMBINATION:"hero_combination",HERO_LEVEL:"hero_level",HERO_PARA:"hero_para",HERO_VOICE_PACK:"hero_voice_pack",RECO_HERO:"reco_hero",HUNT:"hunt",HUNTNEW:"huntnew",HUNTCHIPSCONVERT:"hunt_chips_convert",HYPERLINK_MENU:"hyperlink_menu",HYPERLINK_MENU_V1:"hyperlink_menu_v1",INIT_OBSTACLE:"init_obstacle",ITEM:"item",ITEM_COMPOSE:"item_compose",ISLAND_LEVEL:"island_level",ISLAND_PVE:"island_pve",ISLAND_SHOP:"island_shop",ISLAND_DIFFICULT:"island_difficult",KVK_BUILDING:"kvk_building",LANGUAGE_SETTING:"language_setting",LEAGUE_RANK:"league_rank",LEGIONSHOP:"legion_shop",MAIL:"mail",MANUFACTURE:"manufacture",MAP_BUILDING:"map_building",MARCH_SKIN:"march_skin",MILITARY_RANK:"military_rank",MINING:"mining",MINUS_DIAMOND:"minus_diamond",MISSION:"mission",MODEL:"model",MONEY_SCORE_SHOP:"money_score_shop",MONSTER:"monster",MONSTER_GROUP:"monster_group",MONSTER_REFRESH:"monster_refresh",NOTIFICATION:"notification",ONLINE_REWARD:"online_reward",PLAYER_LEVEL:"player_level",PREPARATION_TASK:"preparation_task",PROBABILITY:"probability",PROVINCE:"province",PVE_MONSTER:"pve_monster",RANK:"rank",RESOURCE:"resource",REWARD:"reward",SCIENCE:"science",SCIENCE_V1:"science_v1",SELECTION:"selection",SERVER_TASK:"server_task",SHARE_BOX:"share_box",SHOP:"shop",SHOP_LIMIT:"shop_limit",SKILL:"skill",SKILL_BOX_CONVERT:"skill_box_convert",SKIN:"skin",SKIN_LIMITED:"skin_limited",STATUS:"status",status_buff:"status_buff",SYSTEM_VOICE_PACK:"system_voice_pack",WORLD_BG_MUSIC:"system_bgm",RES_REPLACE_G123:"res_replace_g123",SYSTEMUNLOCK:"system_unlock",TALENT:"talent",TARGET_RANK_REWARD:"target_rank_reward",TASK:"task",THRONE:"throne",THRONE_GIFT:"throne_gift",THRONE_BUFF:"throne_buff",THRONE_TITLE:"throne_title",TRAPS_AND_POTIONS:"traps_and_potions",TRAPS_EFFECT:"traps_effect",TREASURE_MAP_REWARD:"treasure_map_reward_preview",TURN_CARD_REWARD:"turn_card_reward",TUTORIAL:"tutorial",TUTORIAL_DIALOG:"tutorial_dialog",UNLOCK_LEVEL:"unlock_level",UNLOCK_LEVEL_V1:"unlock_level_v1",UNION_GIFT:"union_gift",UNION_BOX:"union_box",VIP:"vip",VIP_SHOP:"vip_shop",WORLDBATTLESHOP:"worldbattleshop",WORLD_PRECIOUS:"world_precious",ARMY_EQUIP:"army_equip",Isle_Battle:"islandbattle",DECORATION_ANIMALS:"decoration_animals",ChapterTask:"newbie_coremission",ChapterTask_v1:"newbie_coremission_v1",Chapter:"chapter",Chapter_v1:"chapter_v1",kvk_district:"kvk_district",NATIONAL_FLAG:"national_flag",ARENA_THEME:"arena_theme",ARENA_THEME_HERO:"arena_theme_hero",ARENA_NPC:"arena_npc",Mail_Convert:"mail_convert",Hero_Return:"hero_return",LUCKY_MALL:"lucky_mall",LUCKY_MALL_DISCOUNT:"lucky_mall_discount",TreasureContents:"treasure_contents",ROULETTE_ITEM:"Roulette_item",ROULETTE_CONFIG:"Roulette_config",TREASURE_SHOP:"treasure_shop",TREASURE_MISSION:"treasure_mission",DEGENERATOR:"degenerator",Roulette_config:"Roulette_config",Roulette_item:"Roulette_item",MARINE_PATROL_SETTING:"marine_patrol_setting",likeness_survey:"likeness_survey",full_armament_day:"full_armament_day",full_armament_task:"full_armament_task",full_armament_task_type:"full_armament_task_type",Vein:"vein"},cc._RF.pop()},{}],UIDataInfo:[function(e,t,a){"use strict";var o,n;cc._RF.push(t,"1bedbfch8lFo4us2/pijuYe","UIDataInfo"),Object.defineProperty(a,"__esModule",{value:!0}),function(e){e[e.TYPE_UI=0]="TYPE_UI",e[e.TYPE_POP=1]="TYPE_POP",e[e.TYPE_TIPS=2]="TYPE_TIPS",e[e.TYPE_TOP=3]="TYPE_TOP",e[e.TYPE_BATTLE=4]="TYPE_BATTLE",e[e.TYPE_RELATIVELY=5]="TYPE_RELATIVELY"}(o=a.UIType||(a.UIType={})),function(e){e[e.Dialog=0]="Dialog",e[e.Screen=1]="Screen",e[e.None=2]="None"}(n=a.UIDataFrameType||(a.UIDataFrameType={}));var i=function(){function e(e,t,a,o,n,i,r,s){void 0===n&&(n=0),void 0===i&&(i=null),void 0===r&&(r=!1),void 0===s&&(s=!1),this.name=e,this.uiType=t,this.uiPath=a,this.openAnime=o,this.initType=n,this.frameOptions=i,this.ignorePadAdaptor=r,this.hideBack=s}return Object.defineProperty(e.prototype,"fullPath",{get:function(){if(!this.frameOptions)return this.uiPath?"ea_prefab/"+this.uiPath+"/"+this.name:"ea_prefab/"+this.name;switch(this.frameOptions.frame){case n.Dialog:return"ea_prefab/ui/comm/UIFrameDialog";case n.None:return"ea_prefab/ui/comm/UIFrameNone";default:return"ea_prefab/ui/comm/UIFrameScreen"}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BattleMainPanel",{get:function(){return this._NBattleMainPanel},enumerable:!0,configurable:!0}),e.ProductionArmyPanel=new e("ProductionArmyPanel",o.TYPE_POP,"ui",0),e.ConfirmPanel=new e("ConfirmPanel",o.TYPE_TIPS,"ui",3),e.AllianceDonateConfirmPanel=new e("AllianceDonateConfirmPanel",o.TYPE_TIPS,"ui",3),e.ErrorMsgPanel=new e("ErrorMsgPanel",o.TYPE_TIPS,"ui",3),e.RestartGame=new e("RestartGame",o.TYPE_TIPS,"ui",1),e.SimpleDescTips=new e("SimpleDescTips",o.TYPE_TIPS,"ui",1),e.QuestComponent=new e("prefabQuestPanel",o.TYPE_POP,"ui/quest",0,1,{frame:n.Screen,title:"102384"},!1,!0),e.DailyQuestRefreshConfirmComponent=new e("prefabDailyQuestRefreshConfirmPanel",o.TYPE_POP,"ui/quest",1,1),e.BuildingRecyclePanel=new e("BuildingRecyclePanel",o.TYPE_POP,"ui",1),e.MailPanel=new e("MailPanel",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"102294"},!1,!0),e.MailSystemPanel=new e("MailSystemPanel",o.TYPE_POP,"ui",1),e.MailSystemRewardPanel=new e("MailSystemRewardPanel",o.TYPE_POP,"ui",1),e.MailCollectionPanel=new e("MailCollectionPanel",o.TYPE_POP,"ui",1),e.MailScoutPanel=new e("MailScoutPanel",o.TYPE_POP,"ui",1),e.MailScoutDetailPanel=new e("MailScoutDetailPanel",o.TYPE_POP,"ui",1),e.MailBattleBuffsPanel=new e("BattleBuffsPanel",o.TYPE_POP,"battle",1),e.MailAllianceSendToAllPanel=new e("MailAllianceSendToAllPanel",o.TYPE_POP,"ui",1),e.SignPanel=new e("SignPanel",o.TYPE_POP,"ui",1),e.UnLockPanelComponent=new e("prefabUnLockPanel",o.TYPE_RELATIVELY,"ui/unlock",1),e.UnLockTilePanelComponent=new e("prefabUnLockTilePanel",o.TYPE_TIPS,"ui/unlock",3,1,{frame:n.Dialog,title:"areaUnlock_x2",width:530,height:436}),e.UnLockArmyPanelComponent=new e("prefabUnLockArmyPanel",o.TYPE_RELATIVELY,"ui/unlock",1),e.prefabUnLockCitySkinPanel=new e("prefabUnLockCitySkinPanel",o.TYPE_RELATIVELY,"ui/unlock",1),e.prefabShareImageConfirmPanel=new e("prefabShareImageConfirmPanel",o.TYPE_RELATIVELY,"ui/unlock",1),e.FriendPowerPanel=new e("FriendPowerPanel",o.TYPE_POP,"ui",1),e.FreeGoldPanel=new e("FreeGoldPanel",o.TYPE_POP,"ui",1),e.SpeedCDPanel=new e("SpeedCDPanel",o.TYPE_POP,"ui",1),e.ArmySpeedPopup=new e("ArmySpeedPopup",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"102283"}),e.ArmyEquipListPopup=new e("ArmyEquipListPopup",o.TYPE_POP,"ui",1),e.ArmyEquipUpgradePopup=new e("ArmyEquipUpgradePopup",o.TYPE_POP,"ui",1),e.ArmyEquipComposePopup=new e("ArmyEquipComposePopup",o.TYPE_POP,"ui",1),e.ArmyEquipInstalledPopup=new e("ArmyEquipInstalledPopup",o.TYPE_POP,"ui",1),e.GetMorePopup=new e("prefabGetMore",o.TYPE_POP,"ui",1),e.CastleFacePopup=new e("CastleFacePopup",o.TYPE_POP,"ui",1),e.UseItemCommonPanel=new e("UseItemCommonPanel",o.TYPE_POP,"ui",0),e.PayView=new e("PayView",o.TYPE_POP,"ui",0),e.PaySuccess=new e("PaySuccess",o.TYPE_POP,"ui",0),e.BuyEnergyPanel=new e("BuyEnergyPanel",o.TYPE_POP,"ui",1,0,{frame:n.Dialog,title:"102073",height:520}),e.ArmyBoxPanel=new e("ArmyBoxPanel",o.TYPE_POP,"ui",0,1),e.GetResourcePanel=new e("GetResourcePanel",o.TYPE_POP,"ui",1),e.GMPanel=new e("GMView",o.TYPE_POP,"__subpack/comm",0,0,{frame:n.Screen,title:"GM Menu"},!0,!0),e.BagPanel=new e("BagPanel",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"102090"},!0,!0),e.DetailDesPanel=new e("DetailDesPanel",o.TYPE_TIPS,"ui",0),e.PropDetailPanel=new e("PropDetailPanel",o.TYPE_TIPS,"ui",0),e.FriendsPanel=new e("FriendsPanel",o.TYPE_POP,"ui",0),e.FriendingPanel=new e("FriendingPanel",o.TYPE_POP,"ui",0),e.AddFriendPanel=new e("AddFriendPanel",o.TYPE_POP,"ui",0),e.AddFriendContentPanel=new e("AddFriendContentPanel",o.TYPE_POP,"ui",0),e.SharkMoneyTreePanel=new e("SharkMoneyTreePanel",o.TYPE_POP,"ui",1),e.CoinTreePanel=new e("prefabCoinTree",o.TYPE_POP,"ui/cointree",1),e.HospitalPanel=new e("NHospitalPanel",o.TYPE_POP,"ui",0,0,{frame:n.Screen,title:"102191"}),e.HostipalLearnPanel=new e("HostipalLearnPanel",o.TYPE_POP,"ui",1),e.MessageInfoPanel=new e("MessageInfoPanel",o.TYPE_POP,"ui",1),e.PromotionListPanel=new e("PromotionListPanel",o.TYPE_POP,"ui",0),e.ChapterNode=new e("ChapterNode",o.TYPE_POP,"battle",0),e.PveVsPanel=new e("PveVsPanel",o.TYPE_POP,"battle",0),e.ShougejiShowPanel=new e("ShougejiShowPanel",o.TYPE_POP,"battle",0),e.FavoriteAddPopup=new e("FavoriteAddPopup",o.TYPE_POP,"ui",1),e.FavoriteListPopup=new e("FavoriteListPopup",o.TYPE_POP,"ui",1),e._BattleMainPanel=new e("BattleMain",o.TYPE_POP,"battle",1),e._NBattleMainPanel=new e("NBattleMain",o.TYPE_POP,"battle",1,0,null,!1,!0),e.NBattleReportArmySelector=new e("PrefabNArmyListSelector",o.TYPE_POP,"battle_v3",1),e.NBattleReportMail=new e("PrefabNBattleMail",o.TYPE_POP,"battle_v3",1),e.ChangeNamePanel=new e("ChangeNamePanel",o.TYPE_POP,"ui",1),e.WorldBossRankPanel=new e("WorldBossRankPanel",o.TYPE_POP,"world_boss",1),e.WorldBossAppearTipPanel=new e("WorldBossAppearTipPanel",o.TYPE_POP,"world_boss",1),e.WorldBossDetailPanel=new e("WorldBossDetailPanel",o.TYPE_POP,"world_boss",4),e.WorldMapScoutPanel=new e("WorldMapScoutPanel",o.TYPE_POP,"world",0),e.BattleWinPanel=new e("BattleWinPanel",o.TYPE_POP,"battle",0),e.BattleLosePanel=new e("BattleLosePanel",o.TYPE_POP,"battle",0),e.ArmyRepairPanel=new e("ArmyRepairPanel",o.TYPE_POP,"ui",1,0,{frame:n.Dialog,title:"102459",width:590,height:742}),e.NArmyRepairPanel=new e("NArmyRepairPanel",o.TYPE_POP,"ui",0),e.UserAuthor=new e("UserAuthor",o.TYPE_POP,"ui",0),e.VideoFunctionPanel=new e("VideoFunctionPanel",o.TYPE_POP,"ui",0),e.MainUI=new e("MainUI",o.TYPE_UI,"ui",0),e.BuildingListPanel=new e("BuildingListPanel",o.TYPE_POP,"ui",2,1),e.WorldUIChooseArea=new e("prefabWorldUIChooseArea",o.TYPE_POP,"world",1),e.WorldUIEnemy=new e("prefabWorldUIEnemy",o.TYPE_POP,"world",4),e.WorldAssemblyEnemy=new e("prefabWorldUIAssemblyEnemy",o.TYPE_POP,"world",4),e.WorldUIRefugeeCamp=new e("prefabWorldUIRefugeeCamp",o.TYPE_POP,"world",4),e.WorldUIMilitaryQuest=new e("WorldUIMilitaryQuest",o.TYPE_POP,"world",4),e.WorldUICity=new e("prefabWorldCityPopup",o.TYPE_POP,"world",4),e.WorldUISearch=new e("prefabWorldUISearch",o.TYPE_POP,"world",1),e.WorldUIBattleResult=new e("prefabWorldBattleResult",o.TYPE_POP,"world",1),e.WorldUIMarchDetailInfo=new e("prefabWorldMarchDetailInfo",o.TYPE_POP,"world/march",1),e.WorldMarchSpeedUp=new e("prefabWormdMarchSpeedUp",o.TYPE_POP,"world/march",1),e.WorldUIMonsterSearch=new e("prefabMonsterSearch",o.TYPE_POP,"world",1),e.WorldResourcePopup=new e("WorldResourcePopup",o.TYPE_POP,"world",4),e.WorldFunctionTile=new e("WorldFunctionTile",o.TYPE_POP,"world",1),e.WorldMinimap=new e("prefabMinimap",o.TYPE_POP,"world",0,0,null,!0),e.WorldUITreasure=new e("prefabWorldUIWorldTreasurePop",o.TYPE_POP,"world",4),e.WorldTowerPopup=new e("WorldTowerPopup",o.TYPE_POP,"world",4),e.WorldSitePanel=new e("WorldSitePanel",o.TYPE_POP,"__subpack",4),e.WorldSiteDetailPanel=new e("WorldSiteDetailPanel",o.TYPE_POP,"world",1),e.WorldSiteSettingPanel=new e("WorldSiteSettingPanel",o.TYPE_POP,"__subpack",1),e.WorldSiteHistoryPanel=new e("WorldSiteHistoryPanel",o.TYPE_POP,"world",1),e.EquipItemGetPanel=new e("EquipItemGetPanel",o.TYPE_POP,"__subpack",1),e.AllianceMainPanel=new e("AllianceMainPanel",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"102175"},!1,!0),e.AllianceMainOtherPopup=new e("AllianceMainOtherPopup",o.TYPE_POP,"alliance",1),e.AllianceJoinPopup=new e("AllianceJoinPopup",o.TYPE_POP,"alliance",1),e.AllianceApplyPopup=new e("AllianceApplyPopup",o.TYPE_POP,"alliance",1),e.AllianceMemberPopup=new e("AllianceMemberPopup",o.TYPE_POP,"alliance",0),e.AllianceMemberManagePopup=new e("AllianceMemberManagePopup",o.TYPE_POP,"alliance",1),e.AllianceMemberRankPopup=new e("AllianceMemberRankPopup",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"118739"}),e.AutoAssemlbyPanel=new e("AutoAssemlbyPanel",o.TYPE_POP,"__subpack",1),e.AllianceChangeRankPopup=new e("AllianceChangeRankPopup",o.TYPE_POP,"alliance",1),e.AllianceSelectIconPopup=new e("AllianceSelectIconPopup",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"102583"},!1,!0),e.AllianceChangeInfoPopup=new e("AllianceChangeInfoPopup",o.TYPE_POP,"alliance",1),e.AlliancePermissionPopup=new e("AlliancePermissionPopup",o.TYPE_POP,"alliance",1),e.AllianceRecommendPopup=new e("AllianceRecommendPopup",o.TYPE_POP,"alliance",0),e.AllianceFirstJoinRewardPopup=new e("AllianceFirstJoinRewardPopup",o.TYPE_POP,"alliance",1),e.AllianceAssemlbyPanel=new e("AllianceAssemlbyPanel",o.TYPE_POP,"alliance",1),e.AllianceAssemlbyDetailPanel=new e("AllianceAssemblyDetailPanel",o.TYPE_POP,"alliance",1),e.AllianceHelpPanel=new e("AllianceHelpPanel_New",o.TYPE_POP,"alliance",1),e.AllianceColorPanel=new e("AllianceColorPanel",o.TYPE_POP,"alliance",1),e.AllianceAssistanceRecordPanel=new e("AllianceAssistanceRecordPanel",o.TYPE_POP,"alliance",1),e.AllianceAssistancesPanel=new e("AllianceAssistancesPanel",o.TYPE_POP,"alliance",1),e.AssemblyBattleRecordPanel=new e("AssemblyBattleRecordPanel",o.TYPE_POP,"alliance",1),e.AllianceWelfarePanel=new e("AllianceWelfarePanel",o.TYPE_POP,"alliance",1),e.AllianceSciencePanel=new e("AllianceSciencePanel",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"102635"}),e.AllianceSciencePopup=new e("AllianceSciencePopup",o.TYPE_POP,"alliance",1),e.AllianceShopPanel=new e("AllianceShopPanel",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"102656"}),e.AllianceTerritoryMainPanel=new e("AllianceTerritoryMainPanel",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"102667"}),e.AllianceFortressTroopPanel=new e("AllianceFortressTroopPanel",o.TYPE_POP,"alliance",1),e.AllianceBuildingPanel=new e("AllianceBuildingPanel",o.TYPE_POP,"alliance",1),e.AllianceBossPopup=new e("AllianceBossPopup",o.TYPE_POP,"alliance",0,1,{frame:n.Screen,title:"allianceMachine008"},!1,!0),e.SciencePanel=new e("SciencePanel",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"106939"},!1,!0),e.ScienceCompletePanel=new e("ScienceCompletePanel",o.TYPE_RELATIVELY,"ui",1,1),e.ScienceLearnPanel=new e("ScienceLearnPanel",o.TYPE_POP,"ui",1,1),e.HeadquartersPanel=new e("HeadquartersPanel",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:""},!1,!0),e.HeadquartersLearnPanel=new e("HeadquartersLearnPanelNew",o.TYPE_POP,"ui",1,1,{frame:n.Dialog,title:"",width:596,height:552}),e.HeadquartersScienceInfoPop=new e("HeadquartersScienceInfoPop",o.TYPE_POP,"ui",1,1,{frame:n.Dialog,title:""},!1,!0),e.PowerRankPanel=new e("prefabPowerRank",o.TYPE_POP,"ui",0,0,{frame:n.Screen,title:"102289"},!1,!0),e.PlayerInfoPanel=new e("prefabPlayerInfoPanel",o.TYPE_POP,"ui",1),e.GetItemPanel=new e("prefabGetItem",o.TYPE_POP,"ui",1),e.GiftShopPanel=new e("prefabGiftShop",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"102093"},!1,!0),e.WelcomeRewardPanel=new e("prefabWelcomeReward",o.TYPE_POP,"ui",1),e.CommonRewardPanel=new e("prefabRewardPanel",o.TYPE_POP,"ui",1),e.RewardPreviewPanel=new e("prefabRewardPreview",o.TYPE_POP,"ui",1),e.TableViewTemplate=new e("prefabTableViewTemplate",o.TYPE_POP,"ui",1),e.GrowthFundUnBuyTips=new e("prefabGrowthFundUnBuyTips",o.TYPE_POP,"ui",1),e.ItemNumSelectPanel=new e("prefabItemNumSelect",o.TYPE_POP,"ui",1),e.FinancialCenterPanel=new e("prefabFinancialCenter",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"106941"},!1,!0),e.GrowthFundPanel=new e("prefabGrowthFundPanel",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"107203"},!1,!0),e.MonthlyCardPanel=new e("prefabMonthlyCard",o.TYPE_POP,"ui",1,1),e.DevSwitchPanel=new e("prefabDevSwitch",o.TYPE_POP,"ui",1),e.ActivityPanelNew=new e("prefabActivityNew",o.TYPE_POP,"activity",0,1,{frame:n.Screen,title:""},!1,!0),e.ActivityPanel=e.ActivityPanelNew,e.ActivityRankPanel=new e("prefabActivityRankListNode",o.TYPE_POP,"activity",1),e.ActivityServerRankPanel=new e("prefabActivityServerRankview",o.TYPE_POP,"activity",0,1,{frame:n.Screen,title:"118742"},!1,!0),e.ActivityRewardRankPanel=new e("prefabActivityRewardRankListNode",o.TYPE_POP,"activity",1),e.ActivityDeatilPanel=new e("prefabActivityDetail",o.TYPE_POP,"activity",1),e.ActivityValentineRankPanel=new e("prefabActivityValentineRank",o.TYPE_POP,"activity",1),e.ActivityValentineGivePanel=new e("prefabActivityValentineGive",o.TYPE_POP,"activity",1),e.ActivityValentineRankRewardPanel=new e("prefabActivityValentineRankReward",o.TYPE_POP,"activity",1),e.ActivityExchangeSelectPanel=new e("prefabExchangeNumSelect",o.TYPE_POP,"activity",1),e.LevelPanel=new e("LevelPanel",o.TYPE_POP,"",0),e.NpcNoticePanel=new e("NpcNoticePanel",o.TYPE_POP,"ui",3,0,{frame:n.None,title:""}),e.NpcNoticeG123Panel=new e("NpcNoticeG123Panel",o.TYPE_POP,"ui",3),e.NpcPlayerGuidePanel=new e("NpcPlayerGuidePanel",o.TYPE_POP,"ui",1),e.NpcPlayerGuidePanelNew=new e("NpcPlayerGuidePanelNew",o.TYPE_POP,"ui",1),e.NpcNoticeTalkPanel=new e("NpcNoticeTalkPanel",o.TYPE_POP,"ui",1),e.GuideWelcomeG123Panel=new e("GuideWelcomeG123Panel",o.TYPE_POP,"ui",0),e.GuideWelcomeStatic=new e("GuideWelcomeStatic",o.TYPE_POP,"ui",0),e.GuideWelcomeBlack=new e("GuideWelcomeBlack",o.TYPE_POP,"ui",0),e.GuideWelcomeHelicopter=new e("GuideWelcomeHelicopter",o.TYPE_POP,"ui",0),e.AutoCollectTile=new e("AutoCollectTile",o.TYPE_POP,"ui",1),e.AutoCollectLevelUp=new e("AutoCollectLevelUp",o.TYPE_POP,"ui",1),e.AutoCollectConfirm=new e("AutoCollectConfirm",o.TYPE_POP,"ui",1),e.CollectionMachine=new e("CollectionMachine",o.TYPE_POP,"ui/collectionMachine",1),e.CollectionMachineImmediately=new e("CollectionMachineImmediately",o.TYPE_POP,"ui/collectionMachine",1),e.CollectionMachineList=new e("CollectionMachineList",o.TYPE_POP,"ui/collectionMachine",1),e.CollectionMachineTips=new e("CollectionMachineTips",o.TYPE_POP,"ui/collectionMachine",1),e.ACLevelUpShowPanel=new e("ACLevelUpShowPanel",o.TYPE_POP,"ui",1),e.ProductionFactoryPanel=new e("ProductionFactoryPanel",o.TYPE_POP,"__subpack/Production",0,0,{frame:n.Screen,title:"Manufacture001"},!1,!0),e.ProductionRewardPanel=new e("ProductionRewardPanel",o.TYPE_POP,"__subpack/Production",1),e.AllianceHelpSelectPanel=new e("AllianceHelpSelectPanel",o.TYPE_POP,"__subpack",1),e.ChatMainPanel=new e("NchatMainPanel",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"102419"},!0,!0),e.ChatPrivatePanel=new e("chatPrivatePanel",o.TYPE_POP,"ui",0,0,null,!0),e.UserInfoPanel=new e("UserInfoPanel",o.TYPE_POP,"ui",0),e.UserSettingPanel=new e("UserSettingPanel",o.TYPE_POP,"ui",1),e.ShareRewardBox=new e("ShareRewardBox",o.TYPE_POP,"share",1),e.CustomerServicePanel=new e("CustomerServicePanel",o.TYPE_POP,"share",1),e.FBFriendHelpTips=new e("FBFriendHelpTips",o.TYPE_POP,"__subpack/share",1),e.StatusBuffInfoPanel=new e("StatusBuffInfoPanel",o.TYPE_POP,"__subpack",1),e.BattleReportComparisonPanel=new e("BattleReportComparisonPanel",o.TYPE_POP,"__subpack",1),e.BattleBuffComparisonPanel=new e("BattleBuffComparisonPanel",o.TYPE_POP,"__subpack",1),e.HeroDubblingPack=new e("HeroDubblingPack",o.TYPE_POP,"ui",1),e.TreasurePanel=new e("TreasurePanel",o.TYPE_POP,"ui",1),e.PublicAddressPanel=new e("PublicAddressPanel",o.TYPE_POP,"ui",1),e.FavWxPanel=new e("",o.TYPE_POP,"ui",1),e.ShoppingMallPanel=new e("ShoppingMallPanel",o.TYPE_POP,"ui",0,0,{frame:n.Screen,title:"102254"},!1,!0),e.CityBuffPanel=new e("CityBuffPanel",o.TYPE_POP,"__subpack",1),e.CityBuffPanelScreen=new e("CityBuffPanelScreen",o.TYPE_POP,"__subpack",0,0,{frame:n.Screen,title:""}),e.TreasureBuffPanel=new e("treasureBuffPanel",o.TYPE_POP,"__subpack/treasure",0,0,{frame:n.Dialog,title:"",width:598,height:981}),e.BuildingHandbookPanel=new e("BuildingHandbookPanel",o.TYPE_POP,"ui",0,0,{frame:n.Screen,title:"102255"}),e.TreasureSystemPanel=new e("TreasureSystemPanel",o.TYPE_POP,"__subpack/treasure",0),e.TreasureDetailPopup=new e("TreasureDetailPopup",o.TYPE_POP,"__subpack/treasure",0),e.TreasureHandbookPanel=new e("TreasureHandbookPanel",o.TYPE_POP,"__subpack/treasure",0,0,{frame:n.Screen,title:"102255"}),e.TreasurePieceLogPanel=new e("TreasurePieceLogPanel",o.TYPE_POP,"__subpack/treasure",0,0,{frame:n.Dialog,title:"treasure_contents071"}),e.TreasurePieceProgressPanel=new e("TreasurePieceProgressPanel",o.TYPE_POP,"__subpack/treasure",0,0,{frame:n.None,title:"102255"}),e.BrokenTreasureInfoPanel=new e("BrokenTreasureInfoPanel",o.TYPE_POP,"__subpack/treasure",0,0,{frame:n.None,title:""}),e.WorldRankPanel=new e("WorldRankPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Screen,title:"world_rank006"},!1,!0),e.CountryBossMainPanel=new e("CountryBossMainPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Screen,title:"country_boss001"},!1,!0),e.CountryBossDamageRewardPanel=new e("CountryBossDamageRewardPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Screen,title:"country_boss007"},!1,!0),e.CountryBossRewardPanel=new e("CountryBossRewardPanel",o.TYPE_POP,"__subpack",1),e.CommonRankPanel=new e("CommonRankPanel",o.TYPE_POP,"__subpack",1),e.CountryBossComingPanel=new e("CountryBossComingPanel",o.TYPE_POP,"__subpack",1),e.WorldCountryBossPopup=new e("WorldCountryBossPopup",o.TYPE_POP,"__subpack",4),e.CommonItemGetPanel=new e("CommonItemGetPanel",o.TYPE_POP,"__subpack",1),e.PrivacyProtocolPanel=new e("PrivacyProtocolPanel",o.TYPE_POP,"__subpack",1),e.RealNameVerifyResultPanel=new e("RealNameVerifyResultPanel",o.TYPE_POP,"__subpack",1),e.ChooseServerPanel=new e("ChooseServerPanel",o.TYPE_POP,"ui",1),e.ServerListPanel=new e("ServerListPanel",o.TYPE_POP,"ui",1),e.CharacterDeletePanel=new e("CharacterDeletePanel",o.TYPE_POP,"ui",1),e.ChooseLanguagePanel=new e("ChooseLanguagePanel",o.TYPE_POP,"ui",1),e.GMFunctionsView=new e("GMFunctionsView",o.TYPE_POP,"ui",1),e.SNSlinkPanel=new e("prefabSNSlink",o.TYPE_POP,"ui",1),e.HeroRecruitPopup=new e("HeroRecruitPopup",o.TYPE_POP,"hero",0,0,{frame:n.Screen,title:"building_name2601"},!1,!0),e.HeroRecruitResultPopup=new e("HeroRecruitResultPopup",o.TYPE_POP,"hero",1),e.HeroRecruitRewardListPopup=new e("HeroRecruitRewardListPopup",o.TYPE_POP,"hero",1),e.HeroDetailPopup=new e("HeroDetailPopup",o.TYPE_POP,"hero",0,0,{frame:n.Screen,title:"hero_UI018"},!1,!0),e.HeroListPopup=new e("HeroListPopup",o.TYPE_POP,"hero",0,0,null,!0,!0),e.HeroPropertyPanel=new e("HeroPropertyPanel",o.TYPE_POP,"__subpack/hero",1),e.HeroIntroPopup=new e("HeroIntroPopup",o.TYPE_POP,"hero",1),e.HeroGetPatchPopup=new e("HeroGetPatchPopup",o.TYPE_POP,"hero",1),e.HeroConvertPatchPopup=new e("HeroConvertPatchPopup",o.TYPE_POP,"hero",1),e.HeroSkillItemConvertPopup=new e("HeroSkillItemConvertPopup",o.TYPE_POP,"hero",1),e.HeroStarRiseSuccessPopup=new e("HeroStarRiseSuccessPopup",o.TYPE_POP,"hero",1),e.HeroGetNewPopup=new e("HeroGetNewPopup",o.TYPE_POP,"hero",0),e.HeroSelectMarchPopup=new e("HeroSelectMarchPopup",o.TYPE_POP,"hero",1),e.HeroUseSkillPopup=new e("HeroUseSkillPopup",o.TYPE_POP,"hero",0,0,{frame:n.Dialog,title:"active_skill001",width:590,height:950}),e.HeroSkillDetailPanel=new e("HeroSkillDetailPanel",o.TYPE_TIPS,"hero",0),e.HeroRecommendListPanel=new e("HeroRecommendListPanel",o.TYPE_POP,"hero",0,0,{frame:n.Screen,title:"reco_hero_des_001"},!1,!0),e.HeroRecommendPanel=new e("HeroRecommendPanel",o.TYPE_POP,"hero",0,0,{frame:n.Screen,title:"reco_hero_des_001"},!1,!0),e.UseItemListPopup=new e("UseItemListPopup",o.TYPE_POP,"ui",1),e.ThroneOfficialPopup=new e("ThroneOfficialPopup",o.TYPE_POP,"__subpack/throne",0,0,{frame:n.Screen,title:"kingdom_017"}),e.ThroneOfficialInfoPopup=new e("ThroneOfficialInfoPopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneRankPopup=new e("ThroneRankPopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneGiftPopup=new e("ThroneGiftPopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneGiftRecordPopup=new e("ThroneGiftRecordPopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneManagePopup=new e("ThroneManagePopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneBuffListPopup=new e("ThroneBuffListPopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneGetBuffPopup=new e("ThroneGetBuffPopup",o.TYPE_POP,"__subpack/throne",1),e.ThronePastKingsPopup=new e("ThronePastKingsPopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneHelpPopup=new e("ThroneHelpPopup",o.TYPE_POP,"__subpack/throne",1),e.ThroneReportPopup=new e("ThroneReportPopup",o.TYPE_POP,"__subpack/throne",1,0,{frame:n.Dialog,title:"cross_server_report_000",width:590,height:970}),e.ThroneBattleTimePanel=new e("ThroneBattleTimePanel",o.TYPE_POP,"__subpack/throne",0,0,{frame:n.Dialog,title:"wonder_vote_022",width:590,height:930}),e.VoteTimeSelectPanel=new e("VoteTimeSelectPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Dialog,title:"airdrop_vote_001",width:590,height:930}),e.WorldThronePopup=new e("WorldThronePopup",o.TYPE_POP,"__subpack/throne",4),e.VideoTreatSoldierPanel=new e("VideoTreatSoldierPanel",o.TYPE_POP,"ui",3),e.VideoGetDiamondPanel=new e("VideoGetDiamondPanel",o.TYPE_POP,"ui",1),e.G123VipGM=new e("G123VipGM",o.TYPE_POP,"ui",1),e.LineCodeGot_G123=new e("LineCodeGot_G123",o.TYPE_POP,"ui",1),e.LineShopGift_G123=new e("LineShopGift_G123",o.TYPE_POP,"ui",1),e.G123MayUnitSkinGift=new e("G123MayUnitSkinGift",o.TYPE_POP,"__subpack",0),e.DubblingPack=new e("DubblingPack",o.TYPE_POP,"ui",1),e.EmotionGiftView=new e("prefabEmotionGift",o.TYPE_POP,"__subpack",1),e.BuildingExchangePanel=new e("BuildingExchangePanel",o.TYPE_POP,"__subpack",1),e.AirDropPanel=new e("AirDropPanel",o.TYPE_POP,"__subpack",1),e.AirDropExchangePanel=new e("AirDropExchangePanel",o.TYPE_POP,"__subpack",1),e.WorldMarchArmyDetailPanel=new e("WorldMarchArmyDetailPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Dialog,title:"march_019",width:590,height:950}),e.WorldTreasureRewardPanel=new e("WorldTreasureRewardPanel",o.TYPE_POP,"__subpack/activity",1),e.DarkPortalDonatePanel=new e("DarkPortalDonatePanel",o.TYPE_POP,"__subpack/CrossServer",1),e.DarkPortalFightPanel=new e("DarkPortalFightPanel",o.TYPE_POP,"__subpack/CrossServer",1),e.DarkPortalArmyPanel=new e("DarkPortalArmyPanel",o.TYPE_POP,"__subpack/CrossServer",0,1,{frame:n.Dialog,title:"107421",width:590,height:950}),e.CrossServerActivity=new e("CrossServerActivity",o.TYPE_POP,"__subpack/CrossServer",0,1,{frame:n.Screen,title:"cross_server_001"},!1,!0),e.AllianceGiftPanel=new e("AllianceGiftPanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"gift_desc003"},!1,!0),e.BattleRecordPanel=new e("BattleRecordPanel",o.TYPE_POP,"__subpack/CrossServer",1),e.ServerScoreRankPanel=new e("ServerScoreRankPanel",o.TYPE_POP,"__subpack/CrossServer",1),e.CrossServerEventLogPanel=new e("CrossServerEventLogPanel",o.TYPE_POP,"__subpack/CrossServer",1),e.SubPackSample=new e("PrefabSubPackSample",o.TYPE_POP,"__subpack",1),e.ShareFailTip=new e("prefabShareFailTip",o.TYPE_POP,"__subpack",1),e.AllianceInvitePanel=new e("AllianceInvitePanel",o.TYPE_POP,"__subpack",1),e.ChooseHeadIconPanel=new e("ChooseHeadIconPanel",o.TYPE_POP,"__subpack",1),e.VipMainPanel=new e("VipMainPanel",o.TYPE_POP,"__subpack",0,1,null,!0),e.vipGiftPop=new e("vipGiftPop",o.TYPE_POP,"__subpack",1,1),e.monthlyAdvanceCardPanel=new e("prefabMonthlyAdvanceCard",o.TYPE_POP,"__subpack",0,1),e.BindAccountPanel=new e("BindAccountPanel",o.TYPE_POP,"__subpack",3),e.NewBindAccountPanel=new e("NewBindAccountPanel",o.TYPE_POP,"__subpack",3),e.HotUpdatePanel=new e("HotUpdatePanel",o.TYPE_TOP,"__subpack",3),e.ChoosePayChannel=new e("ChoosePayChannel",o.TYPE_TOP,"__subpack",0),e.CustomServicePanel=new e("CustomServicePanel",o.TYPE_TIPS,"__subpack",1),e.SubscribePushPanel=new e("SubscribePushPanel",o.TYPE_TIPS,"__subpack",1),e.SuperVipPanel=new e("SuperVipPanel",o.TYPE_POP,"__subpack",1),e.QQBuluoPanel=new e("QQBuluoPanel",o.TYPE_POP,"__subpack",1),e.QQReturnGiftPanel=new e("QQReturnGiftPanel",o.TYPE_POP,"__subpack",1),e.RateMePanel=new e("RateMePanel",o.TYPE_POP,"__subpack",3),e.DevInfoPanel=new e("DevInfoPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Screen,title:"Enviroment Info"},!1,!0),e.IntroductingPanel=new e("IntroductingPanel",o.TYPE_TOP,"__subpack",0),e.MyCoinPanel=new e("MyCoinPanel",o.TYPE_POP,"__subpack",1),e.ShieldLogPanel=new e("ShieldLogPanel",o.TYPE_POP,"__subpack",1),e.ChapterTaskPanel=new e("ChapterTaskPanel",o.TYPE_POP,"__subpack/ChapterTask",1),e.TreasureInfoPanel=new e("TreasureInfoPanel",o.TYPE_POP,"__subpack/ChapterTask",1),e.TreasureRewardPanel=new e("TreasureRewardPanel",o.TYPE_POP,"__subpack/ChapterTask",1),e.BrokenTreasurePanel=new e("BrokenTreasurePanel",o.TYPE_POP,"__subpack/ChapterTask",1),e.ChapterTaskGuidePanel=new e("ChapterTaskGuidePanel",o.TYPE_POP,"__subpack/ChapterTask",1),e.RankRewardPanel=new e("RankRewardPanel",o.TYPE_POP,"__subpack",1),e.firstChargeBenefitPanel=new e("firstChargeBenefitPanel",o.TYPE_POP,"__subpack",1,1,{frame:n.None}),e.firstChargeBenefitG123Panel=new e("firstChargeBenefitG123Panel",o.TYPE_POP,"__subpack",1,1),e.firstChargeBenefitPanelNew=new e("firstChargeBenefitPanelNew",o.TYPE_POP,"ui",0,1,{frame:n.None}),e.WareHousePanel=new e("WareHousePanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"102079"}),e.WareHouseLearnPanel=new e("WareHouseLearnPanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Dialog,height:518,title:"defaultLattice005"}),e.WareHouseMergePanel=new e("WareHouseMergePanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"defaultLattice002"}),e.userInfoMainPanel=new e("UserInfoMainPanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"102079"},!1,!0),e.strengthenPanel=new e("StrengthenPanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"106947"},!1,!0),e.StrengthenminingPanel=new e("StrengthenminingPanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Dialog,title:"mining008"}),e.StrengthenexchangePanel=new e("StrengthenexchangePanel",o.TYPE_POP,"__subpack",1,1,{frame:n.Dialog,title:"mining009",height:530}),e.ChangeGenderPanel=new e("ChangeGenderPanel",o.TYPE_POP,"__subpack",1,1,{frame:n.Dialog,title:"public159",height:396,width:536}),e.ItemExchangePanel=new e("ItemExchangePanel",o.TYPE_POP,"__subpack",1,0,{frame:n.Dialog,title:"treasure_activity_018",height:1026,width:598}),e.GoToAppPanel=new e("prefabIOSDownloader",o.TYPE_POP,"__subpack",1,1),e.LimitTimePanel=new e("limitedTimePanel",o.TYPE_POP,"__subpack",1,1,{frame:n.Dialog,title:"exchangeDesUi",width:590,height:950}),e.ChildrenDayExchangePanel=new e("ChildrenDayExchangePanel",o.TYPE_POP,"__subpack",1,1,{frame:n.Dialog,title:"mining009",height:655}),e.SkinGiftPanel=new e("prefabSkinGift",o.TYPE_POP,"__subpack",1,1),e.ProtectCastleAssitantPanel=new e("ProtectCastleAssitantPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Dialog,title:"107421",width:590,height:950}),e.ProtectCastleAssitantPanelNew=new e("ProtectCastleAssitantPanelNew",o.TYPE_POP,"__subpack",0,0,{frame:n.Dialog,title:"107421",width:590,height:950}),e.AllianceAssistancesDialog=new e("AllianceAssistancesDialog",o.TYPE_POP,"__subpack",0,0,{frame:n.Dialog,title:"assistance_army",width:590,height:950}),e.ProtectCastleAssitantSetting=new e("ProtectCastleAssitantSetting",o.TYPE_POP,"__subpack",0,1,{frame:n.Dialog,title:"defend_setting_001",width:590,height:950}),e.FriendInviteDetail=new e("prefabFriendInviteDetail",o.TYPE_POP,"__subpack",1,1,{frame:n.Dialog,title:"recruit_mission002",width:596,height:950}),e.BagDeleteItemPanel=new e("BagDeleteItemPanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Dialog,title:"102052",width:590,height:381}),e.heroLearnSkill=new e("HeroLearnSkill",o.TYPE_POP,"hero",0,1,{frame:n.Screen,title:"heroSkill_010"},!1,!0),e.herobreakItemPop=new e("HerobreakItemPop",o.TYPE_POP,"hero",0,1,{frame:n.Dialog,height:543,title:"heroSkill_019"}),e.heroSkillupPop=new e("HeroSkillupPop",o.TYPE_POP,"hero",0,1,{frame:n.Dialog,height:543,title:"heroSkill_021"}),e.HeroForgottenSkillPop=new e("HeroForgottenSkillPop",o.TYPE_POP,"hero",0,1,{frame:n.Dialog,height:390,width:530,title:"heroSkill_020"}),e.HeroUpgradePop=new e("HeroUpgradePop",o.TYPE_POP,"hero",0,1,{frame:n.Dialog,height:952,width:594,title:"102419"}),e.heroLearnTalent=new e("HeroLearnTalent",o.TYPE_POP,"hero",0,1,{frame:n.Screen,title:"heroTalent_003"},!1,!0),e.heroGetTenTalentPopup=new e("HeroGetTenTalentPopup",o.TYPE_POP,"hero",1),e.heroTalentExchangePop=new e("HeroTalentExchangePop",o.TYPE_POP,"hero",1),e.ActivityDiceRecordPanel=new e("ActivityDiceRecordPanel",o.TYPE_POP,"__subpack/activity",1),e.heroSkillObtainPop=new e("HeroSkillObtainPop",o.TYPE_POP,"hero",0,1,{frame:n.Dialog,height:545,width:594,title:"skill_lable_009"}),e.heroChipExchangePop=new e("HeroChipExchangePop",o.TYPE_POP,"hero",0,1,{frame:n.Dialog,height:545,width:594,title:"skill_lable_012"}),e.HeroFetterPanel=new e("HeroFetterPanel",o.TYPE_POP,"hero",0,0,{frame:n.Screen,title:"combination_004"},!1,!0),e.HeroFetterSkillDetail=new e("HeroFetterSkillDetail",o.TYPE_POP,"hero",1),e.ActivityReverseCardTaskPanel=new e("prefabActivityReverseCardTask",o.TYPE_POP,"__subpack/activity",1,1,{frame:n.Dialog,title:"turn_card_pannel002",width:592,height:955}),e.ActivityReverseCardRewards=new e("prefabActivityReverseCardRewards",o.TYPE_POP,"__subpack/activity",1,1,{frame:n.Dialog,title:"turn_card_pannel001",width:592,height:961}),e.ActivityReverseRewardPopupPanel=new e("prefabACGetReversePop",o.TYPE_POP,"__subpack/activity",0),e.ProbabilityPanel=new e("ProbabilityPanel",o.TYPE_POP,"__subpack",1,1,{frame:n.Dialog,title:"public179",height:385,width:527}),e.ExchangePointPopup=new e("ExchangePointPopup",o.TYPE_POP,"__subpack",1,1,{frame:n.Dialog,title:"public785",height:385,width:527}),e.DetailPanel=new e("DetailPanel",o.TYPE_POP,"__subpack",1),e.PengPengDetailPanel=new e("PengPengDetailPanel",o.TYPE_POP,"__subpack",1),e.ChangeNationalPanel=new e("prefabChangeFlag",o.TYPE_POP,"__subpack",1),e.RefugeePosPopup=new e("RefugeePosPopup",o.TYPE_POP,"__subpack",1),e.PrefabActivityRefugeePop=new e("prefabActivityRefugeePop",o.TYPE_POP,"__subpack",1,0),e.HeroGiftSSRPanel=new e("prefabHeroGiftSSR_G123",o.TYPE_POP,"__subpack",1),e.FirstPageGiftPanel=new e("FirstPageGiftPanel",o.TYPE_POP,"__subpack",1),e.IslandBattleMainView=new e("IslandBattleMainView",o.TYPE_POP,"__subpack/islandBattle",0,0,{frame:n.Screen,title:""},!1,!0),e.IslandBattleMainViewPop=new e("IslandBattleMainViewPop",o.TYPE_POP,"__subpack/islandBattle",0,0),e.IslandBattleBuffsPanel=new e("IslandBattleBuffsPanel",o.TYPE_POP,"__subpack/islandBattle",1),e.IslandBattleShopNode=new e("IslandBattleShopNode",o.TYPE_POP,"__subpack/islandBattle",0,0,{frame:n.Screen,title:"island010"}),e.IslandBattleLevelNode=new e("IslandBattleLevelNode",o.TYPE_POP,"__subpack/islandBattle",0,0,{frame:n.Screen,title:"island024"},!1,!0),e.growRoadPrefab=new e("growRoadPrefab",o.TYPE_POP,"__subpack/GrowRoad",0,1,{frame:n.Screen,title:""},!1,!0),e.IsleMainPanel=new e("IsleMainPanel",o.TYPE_POP,"__subpack/islandBattle",0,0,{frame:n.Screen,title:""},!1,!0),e.IsleBattleLogPanel=new e("IsleBattleLogPanel",o.TYPE_POP,"__subpack/islandBattle",0,0),e.IsleBattleBuffPanel=new e("IsleBattleBuffPanel",o.TYPE_POP,"__subpack/islandBattle",0,0),e.IsleFlagPopup=new e("IsleFlagPopup",o.TYPE_POP,"__subpack/islandBattle",0,0),e.PveTowerPanel=new e("PveTowerPanel",o.TYPE_POP,"__subpack/islandBattle",0,0,{frame:n.Screen,title:""},!1,!0),e.PveMainPanel=new e("PveMainPanel",o.TYPE_POP,"__subpack/islandBattle",0,0,{frame:n.Screen,title:"building_name3101"},!1,!0),e.HeroReturnLvUpPopup=new e("HeroReturnLvUpPopup",o.TYPE_POP,"__subpack/activity",1),e.HeroReturnRewardSelectPopup=new e("HeroReturnRewardSelectPopup",o.TYPE_POP,"__subpack/activity",1),e.AddUpChargePanel=new e("prefabAddUpChargePop",o.TYPE_POP,"__subpack/activity",1),e.PrefabAdPreferentialGiftView=new e("PrefabAdPreferentialGiftView",o.TYPE_POP,"__subpack",1),e.prefabEmotionGift=new e("prefabEmotionGift",o.TYPE_POP,"__subpack",1),e.WorldBGMusicGift=new e("WorldBGMusicGift",o.TYPE_POP,"__subpack",1),e.HeroChipExchangeDetailPop=new e("HeroChipExchangeDetailPop",o.TYPE_POP,"hero",0,1,{frame:n.Dialog,height:543,title:"skill_lable_012"}),e.RealNameVerifyPanel=new e("RealNameVerifyPanel",o.TYPE_POP,"__subpack",1),e.WebViewPanel=new e("WebViewPanel",o.TYPE_TIPS,"__subpack/comm",0,1,{frame:n.Screen,title:"? \u7f51\u9875"}),e.pveVsPanelNew=new e("PveVsPanelNew",o.TYPE_POP,"__subpack",0,1,{frame:n.Dialog,title:"",height:947,width:593}),e.MarinePatrolEntrancePanel=new e("MarinePatrolEntrancePanel",o.TYPE_POP,"ui",0,1,{frame:n.Dialog,title:"",height:947,width:593}),e.MoneyScoreShop=new e("MoneyScoreShop",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Screen,title:"activity95_002"}),e.LuckyDrawCardView=new e("LuckyDrawCardView",o.TYPE_POP,"__subpack/activity",0,0,{frame:n.Screen,title:"activity_lottery001"}),e.RechargeScoreShopPackageView=new e("RechargeScoreShopPackageView",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Screen,title:"rechargeScoreShop006"}),e.RechargeScoreShopTaskView=new e("RechargeScoreShopTaskView",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Screen,title:"rechargeScoreShop005"}),e.RechargeScoreSpinPop=new e("RechargeScoreSpinPop",o.TYPE_POP,"__subpack/activity",0,0),e.VideoCommonPanel=new e("VideoCommonPanel",o.TYPE_POP,"__subpack/activity",0,0),e.ActivityItemNumSelect=new e("ActivityItemNumSelect",o.TYPE_TIPS,"__subpack/activity",1,0),e.HammerBossRankPopup=new e("HammerBossRankPopup",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,title:"diamond_cost_btn004",height:947,width:593}),e.itemGetArmyPanel=new e("itemGetArmyPanel",o.TYPE_POP,"__subpack",0,1,{frame:n.Dialog,title:"army_box001",height:384,width:532}),e.ItemSelectRewardPanel=new e("ItemSelectRewardPanel",o.TYPE_POP,"__subpack",0,0),e.HeroTalentSelectPanel=new e("HeroTalentSelectPanel",o.TYPE_POP,"__subpack/hero",0,1,{frame:n.Dialog,title:"heroTalent_043",height:952,width:596}),e.ActivityExchangeRankPanel=new e("ActivityExchangeRankPanel",o.TYPE_POP,"__subpack/activity",0,1),e.ChoiceProfessionPrefab=new e("ChoiceProfessionPrefab",o.TYPE_POP,"__subpack/Profession",0,1,{frame:n.Screen,title:"title_professional_01"}),e.ProfessionTalentPrefab=new e("ProfessionTalentPrefab",o.TYPE_POP,"__subpack/Profession",0,1,{frame:n.Screen,title:""}),e.ProfessionTalentStudyPrefab=new e("ProfessionTalentStudyPrefab",o.TYPE_POP,"__subpack/Profession",0,1,{frame:n.Dialog,title:"106939",height:746,width:596}),e.ProfessionBackItemsPrefab=new e("ProfessionBackItemsPrefab",o.TYPE_POP,"__subpack/Profession",0,1,{frame:n.Dialog,title:"",height:384,width:545}),e.ProfessionFocusChoicePrefab=new e("ProfessionFocusChoicePrefab",o.TYPE_POP,"__subpack/Profession",0,1,{frame:n.Dialog,title:"title_professional_01",height:746,width:596}),e.ProfessionTalentDetails=new e("ProfessionTalentDetails",o.TYPE_POP,"__subpack/Profession",0,1,{frame:n.Dialog,title:"????",height:746,width:596}),e.ProfessionTowerListPrefab=new e("ProfessionTowerListPrefab",o.TYPE_POP,"__subpack/Profession",0,1,{frame:n.Screen,title:"career_talent_title05",height:746,width:596}),e.HeroSkinGiftPanel=new e("HeroSkinGiftPanel",o.TYPE_POP,"__subpack",1,1),e.HeroSkinListPanel=new e("HeroSkinListPanel",o.TYPE_POP,"__subpack/hero",0,1),e.HammerBossPAPopup=new e("HammerBossPAPanel",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,title:"warhammer_guide_020",height:947,width:593}),e.PrivacyConfirmPanel=new e("PrivacyConfirmPanel",o.TYPE_POP,"ui",0),e.SocialListPanel=new e("SocialListPanel",o.TYPE_POP,"ui",0),e.openBuildingViewPrefab=new e("openBuildingViewPrefab",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"hyperlinkmenu_000"},!1,!0),e.HeroExchangeTalent=new e("HeroExchangeTalent",o.TYPE_POP,"__subpack/hero",0,1,{frame:n.Dialog,title:"talent_exchange_000",height:947,width:593}),e.OctoberOneActivityRewardPop=new e("OctoberOneActivityRewardPop",o.TYPE_POP,"__subpack/activity",0),e.OctoberOneActivityRewardPopRailGun=new e("OctoberOneActivityRewardPopRailGun",o.TYPE_POP,"__subpack/activity",0),e.OctoberOneActivityRecord=new e("OctoberOneActivityRecord",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,title:"activity_scratch005",height:747,width:593}),e.ItemComposePanel=new e("ItemComposePanel",o.TYPE_POP,"__subpack",0,0),e.ItemComposeResultPanel=new e("ItemComposeResultPanel",o.TYPE_POP,"__subpack",0,0),e.ThanksGivingDescription=new e("ThanksGivingDescription",o.TYPE_POP,"__subpack/activity",1),e.ThanksGivingreward=new e("ThanksGivingreward",o.TYPE_POP,"__subpack/activity",1),e.ActivityMondayRecordPop=new e("ActivityMondayRecordPop",o.TYPE_POP,"activity",1),e.ActivityMondayLevelUp=new e("ActivityMondayLevelUp",o.TYPE_POP,"activity",1),e.ItemComposeRulePanel=new e("ItemComposeRulePanel",o.TYPE_POP,"__subpack",0,0),e.OctoberOneRewardPreview=new e("OctoberOneRewardPreview",o.TYPE_POP,"__subpack/activity",1),e.OctoberOneRailGunRewardPreview=new e("OctoberOneRailGunRewardPreview",o.TYPE_POP,"__subpack/activity",1),e.BountyQuestRankPromotion=new e("BountyQuestRankPromotion",o.TYPE_POP,"ui/quest",0,0),e.BountyQuestRewardPreviewPanel=new e("prefabBountyQuestRewardPreview",o.TYPE_POP,"ui/quest",1),e.CityEffectView=new e("CityEffectView",o.TYPE_POP,"__subpack",0,0),e.HeadFrameView=new e("HeadFrameView",o.TYPE_POP,"__subpack",0,0),e.prefabActivityValentineGiftRecord=new e("prefabActivityValentineGiftRecord",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,title:"rose_011",height:947,width:593}),e.defenderMonsterFortressTabView=new e("defenderMonsterFortressTabView",o.TYPE_POP,"__subpack/defenderMonster",1,1,{frame:n.Dialog,title:"102667",width:596,height:950}),e.prefabWorlddefenderMonsterFortress=new e("prefabWorlddefenderMonsterFortress",o.TYPE_POP,"__subpack/defenderMonster",4),e.CollectionRewardPrefab=new e("CollectionRewardPrefab",o.TYPE_POP,"__subpack",0,1,{frame:n.Dialog,title:"",height:384,width:545}),e.connectModPanel=new e("connectModPanel",o.TYPE_POP,"__subpack/Mod",0,0,{frame:n.Dialog,title:"MOD",width:596,height:754}),e.ActivityRewardDetails=new e("ActivityRewardDetails",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,width:596,height:948,title:""}),e.modChatList=new e("modChatList",o.TYPE_POP,"__subpack/Mod",0,1,{frame:n.Screen,title:"\u4f1a\u8bdd\u5217\u8868"},!1,!0),e.SixteenChampionActivity=new e("SixteenChampionActivity",o.TYPE_POP,"__subpack/SixteenChampion",0,1,{frame:n.Screen,title:"tournament_activity_001"},!1,!0),e.SixteenRewardPre=new e("SixteenRewardPre",o.TYPE_POP,"__subpack/SixteenChampion",0,1,{frame:n.Dialog,width:596,height:948,title:"daily_task006"}),e.ActivityPackageView=new e("ActivityPackageView",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Screen,title:"ActivityGiftBox019"},!1,!0),e.prefabVoucher=new e("prefabVoucher",o.TYPE_POP,"__subpack/Mod",0,1,{frame:n.Dialog,title:"cdkey004",width:528,height:384}),e.ActivitybreakItemPop=new e("ActivitybreakItemPop",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,height:543,title:"ActivityHunt009"}),e.ActivityChipExchangePop=new e("ActivityChipExchangePop",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,height:545,width:594,title:"ActivityHunt010"}),e.ActivityChipExchangeDetailPop=new e("ActivityChipExchangeDetailPop",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,height:543,title:"ActivityHunt013"}),e.ActivityLuckyMiningExchange=new e("ActivityLuckyMiningExchange",o.TYPE_POP,"__subpack/activity",0),e.ActivityLuckyMiningTreasureList=new e("ActivityLuckyMiningTreasureList",o.TYPE_POP,"__subpack/activity",0),e.ActivityLuckyBagReceive=new e("ActivityLuckyBagReceive",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,width:596,height:948,title:"ActivityLuckyBag007"}),e.ActivityRewardListPopup=new e("ActivityRewardListPopup",o.TYPE_POP,"__subpack/activity",1),e.LevelUpPanel=new e("levelUpPanel",o.TYPE_POP,"__subpack",1),e.ChatDetailPanel=new e("ChatDetailPanel",o.TYPE_TIPS,"__subpack/chat",0),e.ChatTipsPanel=new e("ChatTipsPanel",o.TYPE_POP,"__subpack/chat",0,0,{frame:n.Screen,title:"chat_rule_006"}),e.ChatSettingPanel=new e("ChatSettingPanel",o.TYPE_POP,"__subpack/chat",1,1),e.ChatChooseFriend=new e("ChatChooseFriend",o.TYPE_POP,"__subpack/chat",0,1,{frame:n.Screen,title:"Chat_optimization002"}),e.ChatGroupSettingPanel=new e("ChatGroupSettingPanel",o.TYPE_POP,"__subpack/chat",0,1,{frame:n.Screen,title:"Chat_optimization006"}),e.ChatGroupPanel=new e("chatGroupPanel",o.TYPE_POP,"__subpack/chat",0,1),e.consignmentCenterPanel=new e("consignmentCenterPanel",o.TYPE_POP,"__subpack/Consignment",0,0,{frame:n.Screen,title:"consignment_071"},!1,!0),e.consignmentcommodityList=new e("consignmentcommodityList",o.TYPE_POP,"__subpack/Consignment",0,0,{frame:n.Screen,title:"consignment_004"},!1,!0),e.ActivityCalendarMain=new e("ActivityCalendarMain",o.TYPE_POP,"__subpack/activity",0,0,{frame:n.Screen,title:"Event_calendar011"},!1,!0),e.ActivityCalendarPop=new e("ActivityCalendarPop",o.TYPE_POP,"__subpack/activity",0,0),e.consignmentdetailsPop=new e("consignmentdetailsPop",o.TYPE_POP,"__subpack/Consignment",0,1,{frame:n.Dialog,title:"consignment_012",width:596,height:950}),e.StrengthenPop=new e("StrengthenPop",o.TYPE_POP,"__subpack",0,1),e.ChatMutedPanel=new e("ChatMutedPanel",o.TYPE_POP,"__subpack/Mod",0,0,{frame:n.Dialog,title:"mod_mute005",width:596,height:538}),e.ActivityEasterSelectRewardPanel=new e("ActivityEasterSelectRewardPanel",o.TYPE_POP,"__subpack/activity",0,0),e.ActivityEasterPreviewRewardPanel=new e("ActivityEasterPreviewRewardPanel",o.TYPE_POP,"__subpack/activity",0,0),e.ActivityEasterRewardPanel=new e("ActivityEasterRewardPanel",o.TYPE_POP,"__subpack/activity",0,0),e.ECPrepareStagePanel=new e("ECPrepareStagePanel",o.TYPE_POP,"__subpack/EightCountry",0,1),e.ECPrepareRankPanel=new e("ECPrepareRankPanel",o.TYPE_POP,"__subpack/EightCountry",0,1),e.ECPrepareRankRewardPanel=new e("ECPrepareRankRewardPanel",o.TYPE_POP,"__subpack/EightCountry",0,1),e.ECPrepareChooseArmyPanel=new e("ECPrepareChooseArmyPanel",o.TYPE_POP,"__subpack/EightCountry",0,1,{frame:n.Dialog,title:"kvk_title053",width:598,height:962}),e.EightCountryRewardRankPanel=new e("EightCountryRewardRankPanel",o.TYPE_POP,"__subpack/EightCountry",0,1,{frame:n.Screen,title:"diamond_cost_btn004"}),e.EightCountryProgressRewardRankPanel=new e("EightCountryProgressRewardRankPanel",o.TYPE_POP,"__subpack/EightCountry",0,1,{frame:n.Screen,title:"kvk_title002"}),e.EightCountryExpeditionBasePanel=new e("EightCountryExpeditionBasePanel",o.TYPE_POP,"__subpack/EightCountry",0,1,{frame:n.Dialog,title:"kvk_title029",height:962,width:598}),e.EightCountryExpeditionBaseStatePanel=new e("EightCountryExpeditionBaseStatePanel",o.TYPE_POP,"__subpack/EightCountry",0,0,{frame:n.Dialog,title:"kvk_title041",height:960,width:596}),e.EightCountryCanBuildingPop=new e("EightCountryCanBuildingPop",o.TYPE_POP,"__subpack/EightCountry",4),e.EightCountryFixedBuildingPop=new e("EightCountryFixedBuildingPop",o.TYPE_POP,"__subpack/EightCountry",4),e.EightCountryAllianceTerritoryMainPanel=new e("EightCountryAllianceTerritoryMainPanel",o.TYPE_POP,"__subpack/EightCountry",0,0,{frame:n.Screen,title:"102667"}),e.EightCountryCanBuildingDetailPop=new e("EightCountryCanBuildingDetailPop",o.TYPE_POP,"__subpack/EightCountry",4),e.EightCountryMiniMapResourcePop=new e("EightCountryMiniMapResourcePop",o.TYPE_POP,"__subpack/EightCountry",4),e.EightCountryColorChoicePop=new e("EightCountryColorChoicePop",o.TYPE_POP,"__subpack/EightCountry",4,1,{frame:n.Dialog,title:"kvk_info_028",height:952,width:594}),e.EightCountryBuildingStatusPanel=new e("EightCountryBuildingStatusPanel",o.TYPE_POP,"__subpack/EightCountry",4,1,{frame:n.Dialog,title:"kvk_info_016",height:952,width:594}),e.EightCountryWorldMinimap=new e("EightCountryWorldMinimap",o.TYPE_POP,"__subpack/EightCountry",0,1),e.ActivityEasterRewardTip=new e("ActivityEasterRewardTip",o.TYPE_TIPS,"__subpack/activity",0,0),e.AdventureMainPanel=new e("AdventureMainPanel",o.TYPE_POP,"__subpack/Adventure",0,0,{frame:n.Screen,title:"adventure090"},!1,!0),e.AdventureStrongerPanel=new e("AdventureStrongerPanel",o.TYPE_POP,"__subpack/Adventure",0,0,{frame:n.Screen,title:"adventure115"},!1,!0),e.AdventureSweepPanel=new e("AdventureSweepPanel",o.TYPE_POP,"__subpack/Adventure",1,0),e.AdventureSweepRewardPanel=new e("AdventureSweepRewardPanel",o.TYPE_POP,"__subpack/Adventure",1,0),e.AdventureHeroSelectPanel=new e("AdventureHeroSelectPanel",o.TYPE_POP,"__subpack/Adventure",0,0),e.AdventureShopPanel=new e("AdventureShopPanel",o.TYPE_POP,"__subpack/Adventure",0,0,{frame:n.Screen,title:"adventure116"},!1,!0),e.AdventureEmbattlePanel=new e("AdventureEmbattlePanel",o.TYPE_POP,"__subpack/Adventure",0,0,{frame:n.Screen,title:"adventure036"},!1,!0),e.AdventureBossChallengePanel=new e("AdventureBossChallengePanel",o.TYPE_POP,"__subpack/Adventure",1,0),e.AdventureBattleLosePanel=new e("AdventureBattleLosePanel",o.TYPE_POP,"__subpack/Adventure",1,0),e.AdventureBattleWinPanel=new e("AdventureBattleWinPanel",o.TYPE_POP,"__subpack/Adventure",1,0),e.TutorialDialogPanel=new e("TutorialDialogPanel",o.TYPE_POP,"__subpack",1,0),e.AdventureEntrancePanel=new e("AdventureEntrancePanel",o.TYPE_POP,"__subpack/Adventure",0,0,{frame:n.Screen,title:"building_name3101"},!1,!0),e.AdventureMapPanel=new e("AdventureMapPanel",o.TYPE_POP,"__subpack/Adventure",0,0,{frame:n.Screen,title:"adventure065"},!1,!0),e.AdventureUnlockPop=new e("AdventureUnlockPop",o.TYPE_POP,"__subpack/Adventure",1,0),e.AdventureRankPanel=new e("AdventureRankPanel",o.TYPE_POP,"__subpack/Adventure",0,0,{frame:n.Screen,title:"adventure015"},!1,!0),e.AdventureRewardListPanel=new e("AdventureRewardListPanel",o.TYPE_POP,"__subpack/Adventure",0,0),e.AdventurePlayerFormation=new e("AdventurePlayerFormation",o.TYPE_POP,"__subpack/Adventure",0,0),e.AdventureBattleGiftPop=new e("AdventureBattleGiftPop",o.TYPE_POP,"__subpack/Adventure",0,0),e.AdventurePropertyPanel=new e("AdventurePropertyPanel",o.TYPE_POP,"__subpack/Adventure",0,0),e.DecorateComposePanel=new e("prefabDecorateCompose",o.TYPE_POP,"__subpack/Decorate",0,1,{frame:n.Screen,title:"building_name3701"},!1,!0),e.DecorateComposeDetailPanel=new e("prefabDecorateComposeDetail",o.TYPE_POP,"__subpack/Decorate",0,0,{frame:n.Dialog,title:"decoration_compose_009",width:598,height:962}),e.ChooseAllianceFortressTroopPanel=new e("prefabChooseAllianceFortressTroop",o.TYPE_POP,"alliance",0,0,{frame:n.Dialog,title:"102667",width:596,height:950}),e.AllianceBossPatchGetPanel=new e("AllianceBossPatchGetPanel",o.TYPE_POP,"alliance",1),e.FightLaunchTowerPopup=new e("FightLaunchTowerPopup",o.TYPE_POP,"__subpack/throne",4),e.ActivityDailyRankdetailPop=new e("ActivityDailyRankdetailPop",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,title:"????",height:950,width:594}),e.ActivityDailyRankdetailTips=new e("ActivityDailyRankdetailTips",o.TYPE_POP,"__subpack/activity",0,1,{frame:n.Dialog,title:"100127",height:540,width:594}),e.prefabActivityLaunchTowerAchevementPanel=new e("prefabActivityLaunchTowerAchevementPanel",o.TYPE_POP,"__subpack/throne",0,0,{frame:n.Dialog,title:"launch_tower_battle_005",width:598,height:964}),e.prefabActivityLaunchTowerRankPanel=new e("prefabActivityLaunchTowerRankPanel",o.TYPE_POP,"__subpack/throne",0,0,{frame:n.Dialog,title:"launch_tower_battle_004",width:598,height:964}),e.cointreeTipPanel=new e("cointreeTipPanel",o.TYPE_TIPS,"__subpack",3),e.ProfessionMainUITips=new e("MainUITalentTips",o.TYPE_POP,"__subpack/Profession",1),e.AllianceAchevementPrefab=new e("AllianceAchevementPrefab",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"alliance_level_003"},!1,!0),e.AllianceAchevementRankPrefab=new e("AllianceAchevementRankPrefab",o.TYPE_POP,"alliance",0,0,{frame:n.Screen,title:"alliance_level_003"},!1,!0),e.ArmyEquipNewMaterialPanel=new e("ArmyEquipNewMaterialPanel",o.TYPE_POP,"__subpack/armyEquipNew",0,0,{frame:n.Screen,title:"ArmyEquipNew002"},!1,!0),e.ArmyEquipNewMainPanel=new e("ArmyEquipNewMainPanel",o.TYPE_POP,"__subpack/armyEquipNew",0,0,{frame:n.Screen,title:"ArmyEquipNew028"},!1,!0),e.ArmyEquipNewEmManufacturNode=new e("ArmyEquipNewEmManufacturNode",o.TYPE_POP,"__subpack/armyEquipNew",0,0,{frame:n.Screen,title:"ArmyEquipNew003"},!1,!0),e.ArmyEquipNewItemSelectPanel=new e("ArmyEquipNewItemSelectPanel",o.TYPE_POP,"__subpack/armyEquipNew",1),e.ArmyEquipNewRewardPanel=new e("ArmyEquipNewRewardPanel",o.TYPE_POP,"__subpack/armyEquipNew",1),e.ArmyEquipNewConfigurationPanel=new e("ArmyEquipNewConfigurationPanel",o.TYPE_POP,"__subpack/armyEquipNew",0,0,{frame:n.Screen,title:"ArmyEquipNew001"},!1,!0),e.ArmyEquipNewItemGetPanel=new e("ArmyEquipNewItemGetPanel",o.TYPE_POP,"__subpack/armyEquipNew",1),e.ArmyEquipAndScienceMainPanel=new e("ArmyEquipAndScienceMainPanel",o.TYPE_POP,"__subpack/armyEquipNew",0,0,{frame:n.Screen,title:"building_name3802"},!1,!0),e.commonTextTips=new e("commonTextTips",o.TYPE_POP,"__subpack",4),e.prefabActivitydefenderMonsterRankPanel=new e("prefabActivitydefenderMonsterRankPanel",o.TYPE_POP,"__subpack/defenderMonster",0,0,{frame:n.Dialog,title:"launch_tower_battle_004",width:598,height:964}),e.ActivityAllianceBPGiftPanel=new e("ActivityAllianceBPGiftPanel",o.TYPE_POP,"__subpack/activity",1,0,{frame:n.Dialog,title:"activity_30003_01",width:598,height:563}),e.ActivityPurchaceRewardPanel=new e("ActivityPurchaceRewardPanel",o.TYPE_POP,"__subpack/activity",1),e.UserMigrationCodePanel=new e("UserMigrationCodePanel",o.TYPE_POP,"__subpack/MigrationCode",1),e.UserInstallAppPrompt=new e("UserInstallAppPrompt",o.TYPE_POP,"__subpack/MigrationCode",1),e.NMailGroupPanel=new e("NMailGroupPanel",o.TYPE_POP,"__subpack/NMail",0,1,{frame:n.Screen,title:"102294"},!1,!0),e.NMailListPanel=new e("NMailListPanel",o.TYPE_POP,"__subpack/NMail",0,1,{frame:n.Screen,title:"102294"},!1,!0),e.MailCollectionPanelNew=new e("MailCollectionPanelNew",o.TYPE_POP,"__subpack/NMail",0,1,{frame:n.Screen,title:"mail_new_type_005"},!1,!0),e.SkinSelectPanel=new e("SkinSelectPanel",o.TYPE_POP,"ui",1,0,{frame:n.Dialog,title:"dress_box_des_001",width:590,height:960}),e.EightCountryEnterNode=new e("EightCountryEnterNode",o.TYPE_POP,"__subpack/EightCountry",4),e.WorldServerTheaterPanel=new e("WorldServerTheaterPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.Screen,title:""}),e.WorldServerPowerRank=new e("WorldServerPowerRank",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"102289"}),e.WorldServerAlliancePowerRank=new e("WorldServerAlliancePowerRank",o.TYPE_POP,"__subpack",0,1,{frame:n.Screen,title:"102289"}),e.WorldServerThroneOfficialPopup=new e("WorldServerThroneOfficialPopup",o.TYPE_POP,"__subpack",0,0,{frame:n.Screen,title:"kingdom_017"}),e.WorldServerLeavePop=new e("worldServerLeavePop",o.TYPE_POP,"__subpack",1),e.ArenaPvePanel=new e("ArenaPvePanel",o.TYPE_POP,"__subpack/Arena",0,1,{frame:n.Screen,title:"pve_arena_info_002"}),e.ArenaPveConfigPanel=new e("ArenaPveConfigPanel",o.TYPE_POP,"__subpack/Arena",1,0,{frame:n.Dialog,title:"pve_arena_info_010",width:598,height:960}),e.ArenaPveBattleRecordPanel=new e("ArenaPveBattleRecordPanel",o.TYPE_POP,"__subpack/Arena",1,0,{frame:n.Dialog,title:"pve_arena_info_018",width:598,height:682}),e.ArenaPveRankPanel=new e("ArenaPveRankPanel",o.TYPE_POP,"__subpack/Arena",1),e.ArenaBattleWinPanel=new e("ArenaBattleWinPanel",o.TYPE_POP,"__subpack/Arena",1),e.PVPMainpanel=new e("PVPMainpanel",o.TYPE_POP,"__subpack/Arena/PVP",0,1,{frame:n.Screen,title:"pvp_arena_info_001"}),e.PVPChanllengePanel=new e("PVPChanllengePanel",o.TYPE_POP,"__subpack/Arena/PVP",1,0,{frame:n.Dialog,title:"pvp_arena_info_012",width:594,height:862}),e.PVPRecordPanel=new e("PVPRecordPanel",o.TYPE_POP,"__subpack/Arena/PVP",1,0,{frame:n.Dialog,title:"pvp_arena_info_009",width:594,height:962}),e.PVPRewardRankPanel=new e("PVPRewardRankPanel",o.TYPE_POP,"__subpack/Arena/PVP",1,0,{frame:n.Dialog,title:"110045",width:594,height:962}),e.ArenaPvpBattleResultPanel=new e("ArenaPvpBattleResultPanel",o.TYPE_POP,"__subpack/Arena/PVP",1),e.ActivitySniperEliteRewardPop=new e("ActivitySniperEliteRewardPop",o.TYPE_POP,"activity",0,0,{frame:n.Dialog,title:"ActivityBeachLanding06",width:598,height:962}),e.WorldServerListPanel=new e("WorldServerListPanel",o.TYPE_POP,"__subpack",0),e.PVPItemGetPanel=new e("PVPItemGetPanel",o.TYPE_POP,"__subpack/Arena/PVP",1),e.DimMineView=new e("DimMineView",o.TYPE_POP,"activity",0,0,{frame:n.Screen,title:"DimMine015"}),e.DimMineDetailView=new e("DimMineDetailView",o.TYPE_POP,"activity",1,0,{frame:n.None}),e.DimMineBattleMailView=new e("DimMineBattleMailView",o.TYPE_POP,"activity",1,0,{frame:n.None}),e.DimMineItemDetailView=new e("DimMineItemDetailView",o.TYPE_POP,"activity",1,0,{frame:n.None}),e.PrefabMonthlyCardNew=new e("prefabMonthlyCardNew",o.TYPE_POP,"ui",0,0,{frame:n.None}),e.PrefablifetimeCardNew=new e("prefablifetimeCardNew",o.TYPE_POP,"ui",0,0,{frame:n.None}),e.TreasureMapContributePanel=new e("TreasureMapContributePanel",o.TYPE_POP,"treasureMap",1,0,{frame:n.Dialog,title:"treasure_guild_infotable_01",width:598,height:962}),e.TreasureMapMsgListPanel=new e("TreasureMapMsgListPanel",o.TYPE_POP,"treasureMap",1),e.TreasureMapChooseBossPanel=new e("TreasureMapChooseBossPanel",o.TYPE_POP,"treasureMap",1),e.TreasureMapBossRewardPanel=new e("TreasureMapBossRewardPanel",o.TYPE_POP,"treasureMap",0,1,{frame:n.Screen,title:"daily_task006"}),e.TreasureMapShopPanel=new e("TreasureMapShopPanel",o.TYPE_POP,"treasureMap",0,1,{frame:n.Screen,title:"treasure_guild_infotable_03"}),e.TreasureMapTurnTablePanel=new e("TreasureMapTurnTablePanel",o.TYPE_POP,"treasureMap",1,0,{frame:n.Dialog,title:"treasure_guild_infotable_02",width:598,height:962}),e.TreasureMapContributeInfoPanel=new e("TreasureMapContributeInfoPanel",o.TYPE_POP,"treasureMap",1),e.ThroneOfficialManagePopup=new e("ThroneOfficialManagePopup",o.TYPE_POP,"__subpack/throne",1),e.KingMarkChangePanel=new e("KingMarkChangePanel",o.TYPE_POP,"__subpack/throne",1),e.EightCountryGetItemtPanel=new e("EightCountryGetItemtPanel",o.TYPE_POP,"__subpack/EightCountry",1),e.EightCountryDonateSelectPanel=new e("EightCountryDonateSelectPanel",o.TYPE_POP,"__subpack/EightCountry",0,0),e.ActivityDeepSeaTreasureMargePanel=new e("ActivityDeepSeaTreasureMargePanel",o.TYPE_POP,"activity",1,0),e.ActivityDeepSeaOpenTreasurePanel=new e("ActivityDeepSeaOpenTreasurePanel",o.TYPE_POP,"activity",1,0),e.ActivityDeepSeaHuntAllPanel=new e("ActivityDeepSeaHuntAllPanel",o.TYPE_POP,"activity",1,0,{frame:n.Dialog,title:"UnderTheSea41",width:596,height:692}),e.ActivityRedBlueGiftPrefab=new e("ActivityRedBlueGiftPrefab",o.TYPE_POP,"activity",1),e.ActivityShareBoxRewardPanel=new e("ActivityShareBoxRewardPanel",o.TYPE_POP,"activity",0),e.DecorationSuitPanel=new e("DecorationSuitPanel",o.TYPE_POP,"ui",0,1,{frame:n.Screen,title:"decoration_contents_title001"}),e.RateMeCommonPanel=new e("RateMeCommonPanel",o.TYPE_POP,"__subpack",0,0,{frame:n.None}),e.CastleSkinChangeView=new e("CastleSkinChangeView",o.TYPE_POP,"ui",1,0,{frame:n.None}),e.ECStrongestLeaderPanel=new e("ECStrongestLeaderPanel",o.TYPE_POP,"__subpack/EightCountry",0,1,{frame:n.Screen,title:"full_armament_001"}),e.BlockVeinPanel=new e("BlockVeinPanel",o.TYPE_POP,"__subpack",1,0,{frame:n.None,title:""}),e.BlockVeinPopup=new e("BlockVeinPopup",o.TYPE_POP,"__subpack",0,0,{frame:n.None,title:""}),e.EightCountryAdvancePanel=new e("prefabActivityEightCountry",o.TYPE_POP,"__subpack/activity",0,0,{frame:n.Screen,title:"eight_countries_teaser001"}),e.ECExchangePanel=new e("ECExchangePanel",o.TYPE_POP,"__subpack/EightCountry",0,0,{frame:n.Screen,title:"activityname_1075"}),e.ECBuffPanel=new e("ECBuffPanel",o.TYPE_POP,"__subpack/EightCountry",1,0,{frame:n.Dialog,title:"kvk_info_110",width:598,height:962}),e}();a.UIDataInfo=i,cc._RF.pop()},{}],AllianceChatRewardData:[function(e,t,a){"use strict";cc._RF.push(t,"962b6FD/aBFMKlG+2qXEoK8","AllianceChatRewardData"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.UpdateData=function(e){this._id=e.id,this._aid=e.aid,this._type=e.type,this._reward=e.reward,this._multiple=e.multiple,this._start=e.start,this._end=e.end,this._player=e.player},Object.defineProperty(e.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Aid",{get:function(){return this._aid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Reward",{get:function(){return this._reward},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Multiple",{get:function(){return this._multiple},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"End",{get:function(){return this._end},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Player",{get:function(){return this._player},enumerable:!0,configurable:!0}),e}();a.default=o,cc._RF.pop()},{}],AllianceData:[function(e,t,a){"use strict";cc._RF.push(t,"dcfe7o0w89OtYC8HO2KiHZ5","AllianceData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("./AllianceHelpData"),i=e("../../Core/Event/EventCenter"),r=e("../Const/EventId"),s=e("./DataCenter"),l=e("./AllianceScienceData"),c=e("./AllianceDynamicData"),d=e("../../fws/utils/FWSTool"),p=e("./AllianceShopData"),u=e("./AllianceTerritoryData"),h=e("./AllianceChatRewardData"),m=e("./AllianceStarTaskData"),f=e("./AllianceGiftData"),_=e("./AutoAssemlbyData"),y=e("../Tools/GameTools"),g=e("../Tools/SubPackMsgs"),C=e("../Const/TableName"),v=function(){function e(){this.IsRobot=!1,this.CreateTime=-1,this.scienceData=new l.default,this.memberDynamicList=new Array,this.shopData=new p.default,this.territoryData=new u.default,this._allianceHelpList=new Array,this._deleteHelpList=new Array,this._helpCoin=0,this._allianceHelpCount=0,this._allianceHelpMax=0,this._allianceHelpHonorCount=0,this._allianceHelpHonorMax=0,this._selfHelpList=new Array,this._SymbolColor=1,this._AllianceStarTaskData=new m.default,this._chatRewardList=new Array,this._allianceGiftData=new f.default,this._autoAssemlbyData=new _.default,this._allianceBossDonateFree=!1,this.SymbolTotem=0,this._showAymbolTotem=0,this._ownBadgeArray=[1,2],this._achevementlevel=0,this._achevementStar=0,this._langStr=""}return Object.defineProperty(e.prototype,"kvkTerritoryData",{get:function(){return g.send(g.Names.EIGHT_COUNTRY_TERRITORY_GET_ONE_ENTITY,null).data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Achevementlevel",{get:function(){return this._achevementlevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OwnBadgeArray",{get:function(){return this._ownBadgeArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AchevementStar",{get:function(){return this._achevementStar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShowAymbolTotem",{get:function(){return this._showAymbolTotem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Aid",{get:function(){return this._aid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ServerId",{get:function(){return this._serverId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LeaderUid",{get:function(){return this._leaderUid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LeaderName",{get:function(){return this._leaderName||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Power",{get:function(){return this._power},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MemberCount",{get:function(){return this._memberCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MemberMax",{get:function(){return this._memberMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceHelpList",{get:function(){return this._allianceHelpList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeleteHelpList",{get:function(){return this._deleteHelpList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HelpCoin",{get:function(){return this._helpCoin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceHelpCount",{get:function(){return this._allianceHelpCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceHelpMax",{get:function(){return this._allianceHelpMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfHelpData",{get:function(){return this.getSelfHelpData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceHelpHonorCount",{get:function(){return this._allianceHelpHonorCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceHelpHonorMax",{get:function(){return this._allianceHelpHonorMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SymbolColor",{get:function(){return void 0==this._SymbolColor||0==this._SymbolColor?1:this._SymbolColor},set:function(e){this._SymbolColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ChatRewardList",{get:function(){return this._chatRewardList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceStarTaskData",{get:function(){return this._AllianceStarTaskData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceGiftData",{get:function(){return this._allianceGiftData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllianceBossDonateFree",{get:function(){return this._allianceBossDonateFree},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AutoAssemlbyData",{get:function(){return this._autoAssemlbyData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lang",{get:function(){return this._langStr},set:function(e){this._langStr=e},enumerable:!0,configurable:!0}),e.prototype.ClearDeleteHelpList=function(){this._deleteHelpList.length>0&&this._deleteHelpList.splice(0,this._deleteHelpList.length)},e.prototype.UpdateData=function(e){var t=this.isInAlliance();if(this._aid=e.aid,this._serverId=e.serverId,this._leaderUid=e.leaderUid,this._leaderName=e.leaderName,this._power=e.power,this._memberCount=e.memberCount,this._memberMax=e.memberMax,this.Notice=e.notice,this.Manifesto=e.manifesto,this.Rank=e.rank,void 0!==e.basic){if(this.Name=e.basic.name,this.Tag=e.basic.tag,this.SymbolTotem=e.basic.symbolTotem,this.JoinType=e.basic.joinType,this.LevelLimit=e.basic.levelLimit,this.ProvinceLimit=e.basic.provinceLimit,this._SymbolColor=e.basic.symbolColor,this._achevementStar=e.basic.starNum||0,this.refreshAchevementLevel(),e.basic.haveBadge){this._ownBadgeArray=e.basic.haveBadge.split(",");for(var a=0;a<this._ownBadgeArray.length;a++)this._ownBadgeArray[a]=Number(this._ownBadgeArray[a])}else this._ownBadgeArray=[1,2];var o=this.IsRobot;this.IsRobot=1==e.basic.type,o!=this.IsRobot&&i.EVENT.emit(r.EventId.AllianceDataUpdate),this._langStr=e.basic.lang||""}null==this._aid&&(this._aid=0),null==this._leaderUid&&(this._leaderUid=0),null==this._leaderName&&(this._leaderName=""),this.UpdateSelfHelpData(e.selfCoinHelp),this.UpdateSelfHelpList(e.selfHelps),!t&&this.isInAlliance()&&s.DATA.UserData.GetAllianceExchangesByTypeHandler(),e.createTime&&(this.CreateTime=e.createTime)},e.prototype.refreshAchevementLevel=function(){for(var e=o.TABLE.getTableByKey("alliance_level"),t=0;t<e.length;t++){if(0==t&&this._achevementStar<e[t].need_star){this._achevementlevel=0;break}if(t==e.length-1&&this._achevementStar>=e[t].need_star){this._achevementlevel=e[t].id;break}if(this._achevementStar<e[t].need_star){this._achevementlevel=e[t-1].id;break}}},e.prototype.isInAlliance=function(){return!(void 0===this._aid||null===this._aid||isNaN(this._aid)||this._aid<=0)},e.prototype.UpdateAllianceHelpData=function(e,t){void 0===t&&(t=!1),this._allianceHelpList.length>0&&this._allianceHelpList.splice(0,this._allianceHelpList.length),this.UpdateAllianceHelpList(e.coinHelps),this.UpdateAllianceHelpList(e.itemHelps),this.UpdateAllianceHelpList(e.resourceHelps);var a=e.selfCoinHelp;this.UpdateSelfHelpData(a),this.UpdateAllianceHelpCountAndHonor(e),this.UpdateSelfHelpList(e.selfHelps),t?i.EVENT.emit(r.EventId.AllianceHelpUpdate,3):i.EVENT.emit(r.EventId.AllianceHelpUpdate)},e.prototype.UpdateAllianceHelpCountAndHonor=function(e){0==this._allianceHelpMax&&(this._allianceHelpMax=parseInt(y.default.getDataConfigData(130062))),0==this._allianceHelpHonorMax&&(this._allianceHelpHonorMax=parseInt(y.default.getDataConfigData(9910))),null!=e.alhtdcnt&&(this._allianceHelpCount=e.alhtdcnt),null!=e.alhdhonor&&(this._allianceHelpHonorCount=e.alhdhonor)},e.prototype.UpdateSelfHelpList=function(e,t){if(void 0===t&&(t=!0),t&&this._selfHelpList.length>0&&this._selfHelpList.splice(0,this._selfHelpList.length),e&&0!=e.length)for(var a=0;a<e.length;a++){for(var o=null,i=e[a].requestHelp.type,r=0;r<this._selfHelpList.length;r++)if(this._selfHelpList[r].Type==i){o=this._selfHelpList[r];break}null==o&&(o=new n.default,this._selfHelpList.push(o)),o.UpdateDataWithHelper(e[a])}},e.prototype.DeleteSelfHelpList=function(e){for(var t=0;t<this._selfHelpList.length;t++)if(this._selfHelpList[t].Type==e){this._selfHelpList.splice(t,1);break}i.EVENT.emit(r.EventId.AllianceHelpUpdate)},e.prototype.getSelfHelpData=function(){return 0==this._selfHelpList.length?null:this._selfHelpList[0]},e.prototype.UpdateSelfHelpData=function(e){if(!d.Obj.isEmpty(e)){var t=e.coin;null!=t&&(this._helpCoin=t)}},e.prototype.UpdateAllianceHelpHonorCount=function(e){this._allianceHelpHonorCount=e},e.prototype.UpdateAllianceHelpList=function(e){if(null==e)return!1;for(var t=!1,a=0;a<e.length;a++){var o=new n.default;o.UpdateData(e[a]),this.CheckHelpDataEffective(o)&&(this._allianceHelpList.push(o),t=!0)}return t},e.prototype.CheckHelpDataEffective=function(e){if(1==e.Type)return!0;for(var t=0,a=y.default.getDataConfigData(130066).split(","),o=0;o<a.length;o++){var n=a[o].split("|");if(2==n.length&&parseInt(n[0])==e.ItemId){t=parseInt(n[1]);break}}return 0==t&&(t=parseInt(y.default.getDataConfigData(130067))),!(s.DATA.UserData.Level<e.PlayerInfo.level+t)},e.prototype.AddAllianceHelpList=function(e){if(null!=e){var t=this.UpdateAllianceHelpList(e.coinHelps),a=this.UpdateAllianceHelpList(e.itemHelps),o=this.UpdateAllianceHelpList(e.resourceHelps),n="";e.coinHelps&&e.coinHelps.length>0&&t?n=e.coinHelps[0].uid:e.itemHelps&&e.itemHelps.length>0&&a?n=e.itemHelps[0].uid:e.resourceHelps&&e.resourceHelps.length>0&&o&&(n=e.resourceHelps[0].uid),i.EVENT.emit(r.EventId.AllianceHelpUpdate,2,n)}},e.prototype.AddAllianceHelpDataToList=function(e){if(!(s.DATA.UserData.Level<e.PlayerInfo.level+2||100*e.Num>=s.DATA.UserData.Resource.Coin)){for(var t=!1,a=0;a<this._allianceHelpList.length;a++)if(this._allianceHelpList[a].Id==e.Id){t=!0;break}0==t&&this._allianceHelpList.push(e)}},e.prototype.DeleteAllianceHelpData=function(e){for(var t="",a=0;a<this._allianceHelpList.length;a++){var o=this._allianceHelpList[a];if(o.Id==e){t=o.Uid,o.DataDelete(),this._deleteHelpList.push(o),this._allianceHelpList.splice(a,1);break}}i.EVENT.emit(r.EventId.AllianceHelpUpdate,1,t)},e.prototype.UpdateAlianceMemberDynamic=function(e){this.memberDynamicList=[];for(var t=0;t<e.length;t++){var a=new c.default;a.initByData(e[t]),this.memberDynamicList.push(a)}},e.prototype.AddAlianceMemberDynamic=function(e){for(var t=0;t<e.length;t++){var a=new c.default;a.initByData(e[t]),this.memberDynamicList.push(a)}i.EVENT.emit(r.EventId.AllianceMemberDynamicUpdate)},e.prototype.getAllianceMemberDynamicList=function(){return this.memberDynamicList.reverse()},e.prototype.getAllianceScienceScore=function(){var e=o.TABLE.getTableDataById(C.TableName.DATACONFIG,"16005");if(d.Obj.isEmpty(e))return 0;var t=d.Obj.getPropertyByNames(e,null,"value");return Number(t)},e.prototype.UpdateChatRewardList=function(e){this._chatRewardList.length>0&&this._chatRewardList.splice(0,this._chatRewardList.length);for(var t=0;t<e.length;t++){var a=new h.default;a.UpdateData(e[t]),this._chatRewardList.push(a)}},e.prototype.UpdateOneChatReward=function(e,t){if(2==t){for(var a=0;a<this._chatRewardList.length;a++)if(e.id==this._chatRewardList[a].Id){this._chatRewardList.splice(a,1);break}}else if(3==t)this._chatRewardList.length>0&&this._chatRewardList.splice(0,this._chatRewardList.length);else{var o=!1;for(a=0;a<this._chatRewardList.length;a++)if(e.id==this._chatRewardList[a].Id){o=!0;break}if(0==o){var n=new h.default;n.UpdateData(e),this._chatRewardList.push(n)}}},e.prototype.UpdateAllianceTaskData=function(e){this._AllianceStarTaskData.UpdateData(e)},e.prototype.UpdateAllianceGiftData=function(e){this._allianceGiftData.UpdateData(e)},e.prototype.UpdateAllianceBossDonateFree=function(e){e&&void 0!=e.todayFree&&e.todayFree!=this._allianceBossDonateFree&&(this._allianceBossDonateFree=e.todayFree,i.EVENT.emit(r.EventId.AllianceBossDonateUptate))},e}();a.default=v,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../fws/utils/FWSTool":"FWSTool","../Const/EventId":"EventId","../Const/TableName":"TableName","../Tools/GameTools":"GameTools","../Tools/SubPackMsgs":"SubPackMsgs","./AllianceChatRewardData":"AllianceChatRewardData","./AllianceDynamicData":"AllianceDynamicData","./AllianceGiftData":"AllianceGiftData","./AllianceHelpData":"AllianceHelpData","./AllianceScienceData":"AllianceScienceData","./AllianceShopData":"AllianceShopData","./AllianceStarTaskData":"AllianceStarTaskData","./AllianceTerritoryData":"AllianceTerritoryData","./AutoAssemlbyData":"AutoAssemlbyData","./DataCenter":"DataCenter"}],AllianceDynamicData:[function(e,t,a){"use strict";cc._RF.push(t,"54b1fLTmDpL9rzNIa7dXPPu","AllianceDynamicData"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../../Core/Common/LocalManager"),i=e("../Tools/GameTools"),r=e("../../Core/Common/TableManager"),s=e("../../fws/utils/FWSTool"),l=e("../Tools/PlayerInfoTool"),c=e("../Const/TableName");(function(e){e[e.join_alliance=1]="join_alliance",e[e.exit_alliance=2]="exit_alliance",e[e.kick_alliance=3]="kick_alliance",e[e.up_power=4]="up_power",e[e.down_power=5]="down_power",e[e.alliance_science=6]="alliance_science",e[e.battle_win=7]="battle_win",e[e.battle_fail=8]="battle_fail",e[e.territory_build=9]="territory_build",e[e.territory_complete=10]="territory_complete"})(o=a.MemberDynamicType||(a.MemberDynamicType={}));var d=function(){function e(){this.event=0,this.params=[],this.time=0}return e.prototype.initByData=function(e){if(e){if(void 0!=e.event&&(this.event=e.event),void 0!=e.params){var t=e.params[0];if(t&&"string"==typeof t&&-1!=t.indexOf("level"))for(var a=0;a<e.params.length;a++){var o=e.params[a];if("number"==typeof o)this.params.push(o);else if(o&&"string"==typeof o&&-1!=o.indexOf("level")){var n=i.default.JSON_PARSE(o),r={nickname:"",avatarurl:""};n&&(r.nickname=i.default.getPlayerDisplayName(n),r.avatarurl=l.getAvatarUrlFromTPlayerInfo(n)),this.params.push(r)}else this.params.push(o)}else this.params=e.params}void 0!=e.time&&(this.time=e.time)}},e.prototype.getNickName=function(){return s.Obj.isEmpty(this.params[1])?"":i.default.getPlayerDisplayName(this.params[1],n.LOCAL.getText("102115"))},e.prototype.getDetailStr=function(){if(this.event==o.join_alliance)return n.LOCAL.getText("102601");if(this.event==o.exit_alliance)return n.LOCAL.getText("101042");if(this.event==o.kick_alliance)return n.LOCAL.getText("101043",this.getNickName());if(this.event==o.up_power)return n.LOCAL.getText("101044",this.getNickName(),this.params[2]);if(this.event==o.down_power)return n.LOCAL.getText("101045",this.getNickName(),this.params[2]);if(this.event==o.alliance_science){var e=r.TABLE.getTableDataById(c.TableName.ALLIANCE_SCIENCE,this.params[0].toString());return n.LOCAL.getText("101046",e.name,this.params[1])}if(this.event==o.battle_win)return this.params.length>2?n.LOCAL.getText("101047",this.getNickName(),this.params[2],this.params[3]):n.LOCAL.getText("101048",this.getNickName());if(this.event==o.battle_fail)return this.params.length>2?n.LOCAL.getText("101049",this.getNickName(),this.params[2],this.params[3]):n.LOCAL.getText("101050",this.getNickName());if(this.event==o.territory_build){if(3==this.params.length)if(null!=(t=r.TABLE.getTableDataById(c.TableName.ALLIANCE_BUILDING,this.params[1].toString())))return n.LOCAL.getText("league_message_007",this.getNickName(),n.LOCAL.getText(t.name));return""}if(this.event==o.territory_complete){var t;if(3==this.params.length)if(null!=(t=r.TABLE.getTableDataById(c.TableName.ALLIANCE_BUILDING,this.params[1].toString())))return n.LOCAL.getText("league_build_008",n.LOCAL.getText(t.name));return""}},e.prototype.getName=function(){return this.event==o.join_alliance?this.params[0].nickname:this.event==o.exit_alliance?this.params[0].nickname:this.event==o.kick_alliance?this.params[0].nickname:this.event==o.up_power?this.params[0].nickname:this.event==o.down_power?this.params[0].nickname:this.event==o.alliance_science?"":this.event==o.battle_win?this.params[0].nickname:this.event==o.battle_fail?this.params[0].nickname:this.event==o.territory_build?this.params[0].nickname:this.event==o.territory_complete?this.params[0].nickname:void 0},e.prototype.getIcon=function(){return this.event==o.join_alliance?this.params[0].avatarurl:this.event==o.exit_alliance?this.params[0].avatarurl:this.event==o.kick_alliance?this.params[0].avatarurl:this.event==o.up_power?this.params[0].avatarurl:this.event==o.down_power?this.params[0].avatarurl:this.event==o.alliance_science?"":this.event==o.battle_win?this.params[0].avatarurl:this.event==o.battle_fail?this.params[0].avatarurl:this.event==o.territory_build?this.params[0].avatarurl:this.event==o.territory_complete?this.params[0].avatarurl:void 0},e}();a.default=d,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../fws/utils/FWSTool":"FWSTool","../Const/TableName":"TableName","../Tools/GameTools":"GameTools","../Tools/PlayerInfoTool":"PlayerInfoTool"}],AllianceGiftData:[function(e,t,a){"use strict";cc._RF.push(t,"40287m/fjRKzoGqQr8Nf1H6","AllianceGiftData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Tools/GameTools"),n=function(){function e(){this._level=0,this._rewardNum=0,this._refreshTime=0,this._userGiftList=new Array,this._alGiftList=new Array}return e.prototype.UpdateData=function(e){null!=e&&(e.alInfo&&this.UpdateAllianceInfo(e.alInfo),e.userInfo&&this.UpdateUserInfo(e.userInfo))},e.prototype.UpdateAllianceInfo=function(e){this._keyNum=e.giftKey,this._exp=e.giftExp,this._level=e.giftLevel,this._rewardNum=e.alDailyNGiftCnt,this._refreshTime=e.alDailyNGiftCntRefTime},e.prototype.UpdateUserInfo=function(e){if(e.userGifts){var t=e.userGiftsOp;if(1===t){for(var a=0;a<e.userGifts.length;a++)for(var o=e.userGifts[a].id,n=0;n<this._userGiftList.length;n++)if(this._userGiftList[n].Id==o){this._userGiftList.splice(n,1);break}}else if(0===t)for(a=0;a<e.userGifts.length;a++){o=e.userGifts[a].id;var r=null;for(n=0;n<this._userGiftList.length;n++)if(this._userGiftList[n].Id==o){r=this._userGiftList[a];break}if(null!=r)r.UpdateData(e.userGifts[a]);else(s=new i).UpdateData(e.userGifts[a]),this._userGiftList.push(s)}else if(null==t){this._userGiftList.length>0&&this._userGiftList.splice(0,this._userGiftList.length);for(a=0;a<e.userGifts.length;a++){var s;(s=new i).UpdateData(e.userGifts[a]),this._userGiftList.push(s)}}}if(e.alGiftRewards){this._alGiftList.length>0&&this._alGiftList.splice(0,this._alGiftList.length);for(a=0;a<e.alGiftRewards.length;a++)this._alGiftList.push(e.alGiftRewards[a])}},e.prototype.getTotalRewardNum=function(){return this._userGiftList.length+this._alGiftList.length},Object.defineProperty(e.prototype,"KeyNum",{get:function(){return this._keyNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Exp",{get:function(){return this._exp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RewardNum",{get:function(){return this._rewardNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserGiftList",{get:function(){return this._userGiftList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AlGiftList",{get:function(){return this._alGiftList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RefreshTime",{get:function(){return this._refreshTime},enumerable:!0,configurable:!0}),e}();a.default=n;var i=function(){function e(){}return e.prototype.UpdateData=function(e){this._id=e.id,this._unionBoxId=e.unionBoxId,this._unionBoxType=e.unionBoxType,this._endTime=e.endTime,this._msgInfo=o.default.JSON_PARSE(e.info),this._createTime=e.createTime},Object.defineProperty(e.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnionBoxId",{get:function(){return this._unionBoxId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnionBoxType",{get:function(){return this._unionBoxType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndTime",{get:function(){return this._endTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MsgInfo",{get:function(){return this._msgInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CreateTime",{get:function(){return this._createTime},enumerable:!0,configurable:!0}),e}();a.AllianceGiftRewardData=i,cc._RF.pop()},{"../Tools/GameTools":"GameTools"}],AllianceHelpData:[function(e,t,a){"use strict";cc._RF.push(t,"fe88cRskt1HJLXef9JLip6E","AllianceHelpData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./PlayerInfo"),n=e("../../Core/Common/TableManager"),i=e("../Const/TableName"),r=function(){function e(){this._isMySelf=!1,this._Item_Para=1,this._helpers=new Array,this._playerInfo=new o.default,this._HelperInfo=new o.default}return e.GetAllianceHelpId=function(e,t,a){return e+"-"+t.toString()+"-"+a},e.prototype.DataDelete=function(){this._id="-1"},e.prototype.setIsMySelf=function(e){this._isMySelf=e},Object.defineProperty(e.prototype,"IsMySelf",{get:function(){return this._isMySelf},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Qid",{get:function(){return this._qid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Aid",{get:function(){return this._aid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RequestTime",{get:function(){return this._requestTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HelpCount",{get:function(){return this._helpCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxCount",{get:function(){return this._maxCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemId",{get:function(){return this._itemId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Num",{get:function(){return this._num},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayerInfo",{get:function(){return this._playerInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Honor",{get:function(){return this._honor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"State",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HelpInfo",{get:function(){return this._HelperInfo},enumerable:!0,configurable:!0}),e.prototype.UpdateDataWithHelper=function(e){var t=e.helperInfo;t&&this._HelperInfo.update(t.playerInfo),this.UpdateData(e.requestHelp)},e.prototype.UpdateData=function(t){if(this._uid=t.uid,this._type=t.type,this._qid=t.qid.toString(),this._aid=t.aid,this._requestTime=t.requestTime,this._helpCount=t.helpCount,this._maxCount=t.maxCount,this._helpers.splice(0,this._helpers.length),this._itemId=t.itemId,this._num=t.num,this._playerInfo.update(t.playerInfo),this._honor=t.honor,this._state=t.state,this._id=e.GetAllianceHelpId(this._uid,this._type,this._qid),this._Item_Para=1,1==this._type&&this._itemId){var a=n.TABLE.getTableDataById(i.TableName.ALLI_ITEM_HELP,this._itemId.toString());a&&(this._Item_Para=a.item_para)}},e}();a.default=r,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../Const/TableName":"TableName","./PlayerInfo":"PlayerInfo"}],AllianceScienceData:[function(e,t,a){"use strict";cc._RF.push(t,"a035cA1vgdLYImPeX0Ca797","AllianceScienceData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./AllianceScienceItemData"),n=e("../../Core/Common/TableManager"),i=e("../Tools/GameTools"),r=e("./DataCenter"),s=e("../alliance/AllianceController"),l=e("../Const/TableName");(function(e){e[e.develop=1]="develop",e[e.war=2]="war"})(a.AllianceScienceType||(a.AllianceScienceType={}));var c=function(){function e(){this.donateGoldCount=0,this.donateGoldTime=0,this.donateDiamondCost=0,this.currendScore=0,this.scienceDevDataList=new Array,this.scienceWarDataList=new Array,this.cfgDevGroupId=[10100,10200,10300,10500,10600,10700,10800,10900],this.cfgWarGroupId=[20100,20200,20300,20400,20500,20600,20700,20800,20900,21e3],this.crit=!1,this.addPoint=0,this.DiamondDonateNum=0,this.donateDailyHonor=0}return e.prototype.initByData=function(e){e&&(void 0!=e.donateDiamondCost&&(this.donateDiamondCost=e.donateDiamondCost),void 0!=e.donateGoldCount&&(this.donateGoldCount=e.donateGoldCount),void 0!=e.donateGoldTime&&(this.donateGoldTime=e.donateGoldTime),void 0!=e.currendScore&&(this.currendScore=e.currendScore))},e.prototype.updateByData=function(e){},e.prototype.getTypeByItemData=function(e){return[]},e.prototype.getTotalResearchNum=function(){var e=0;return this.scienceDevDataList.forEach(function(t){e+=t.lv}),this.scienceWarDataList.forEach(function(t){e+=t.lv}),e},e.prototype.updateScienceItemList=function(e){for(var t=0;t<e.length;t++){var a=e[t];this.updateScienceItemData(a)}},e.prototype.updateScienceItemData=function(e){var t=new o.default;t.initByServerData(e);for(var a=0;a<this.scienceDevDataList.length;a++){if(this.scienceDevDataList[a].sid==t.sid)return this.scienceDevDataList[a]=t}for(a=0;a<this.scienceWarDataList.length;a++){if(this.scienceWarDataList[a].sid==t.sid)return this.scienceWarDataList[a]=t}},e.prototype.updateDonate=function(e){this.updateScienceItemData(e),void 0!=e.crit&&(this.crit=e.crit),void 0!=e.addPoint&&(this.addPoint=e.addPoint)},e.prototype.initAllianceInitData=function(e){this.scienceDevDataList=[],this.scienceWarDataList=[];for(var t=0;t<this.cfgDevGroupId.length;t++){(a=new o.default).initByCfgData(this.cfgDevGroupId[t]),this.scienceDevDataList.push(a)}for(t=0;t<this.cfgWarGroupId.length;t++){var a;(a=new o.default).initByCfgData(this.cfgWarGroupId[t]),this.scienceWarDataList.push(a)}for(t=0;t<e.scs.length;t++){for(var n=e.scs[t],i=0;i<this.scienceDevDataList.length;i++){var r=this.scienceDevDataList[i];if(n.sid==r.sid){r.initByServerData(n);break}}for(var s=0;s<this.scienceWarDataList.length;s++){r=this.scienceWarDataList[s];if(n.sid==r.sid){r.initByServerData(n);break}}}},e.prototype.getCostDiamond=function(){return this.getDataConfigDataBy(16001,this.DiamondDonateNum)},e.prototype.getDataConfigDataBy=function(e,t){var a=i.default.getDataConfigData(e).toString().split("|"),o=t;o>=a.length&&(o=a.length-1);var n=0;return o>=0&&(n=parseInt(a[o])),n},e.prototype.getCostCoin=function(){return n.TABLE.getTableDataById(l.TableName.PLAYER_LEVEL,r.DATA.UserData.Level.toString()).donation_gold},e.prototype.getScienceItemDataByGroupId=function(e){for(var t=0;t<this.scienceDevDataList.length;t++){if(this.scienceDevDataList[t].sid==e)return this.scienceDevDataList[t]}for(t=0;t<this.scienceWarDataList.length;t++){if(this.scienceWarDataList[t].sid==e)return this.scienceWarDataList[t]}},e.prototype.isEdit=function(e){return s.AllianceController.getInstance().isHasPermission(e)},e}();a.default=c,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../Const/TableName":"TableName","../Tools/GameTools":"GameTools","../alliance/AllianceController":"AllianceController","./AllianceScienceItemData":"AllianceScienceItemData","./DataCenter":"DataCenter"}],AllianceScienceItemData:[function(e,t,a){"use strict";cc._RF.push(t,"2e29b5nSd5HtJTHZWjctK6Z","AllianceScienceItemData"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../../Core/Common/LocalManager");(function(e){e[e.Normal=0]="Normal",e[e.UpLeveling=1]="UpLeveling"})(o||(o={}));var i=e("../../Core/Common/TableManager"),r=e("./DataCenter"),s=e("../Const/TableName"),l=function(){function e(){this.aid=0,this.sid=0,this.exp=0,this.status=0,this.lv=0,this.recommend=!1,this.lockStatus=!1,this.endTime=0,this.lineIndex=0,this._Data=null}return e.prototype.initByData=function(e){e&&(void 0!=e.aid&&(this.aid=e.aid),void 0!=e.sid&&(this.sid=e.sid),void 0!=e.exp&&(this.exp=e.exp),void 0!=e.endTime&&(this.endTime=e.endTime),void 0!=e.lv&&(this.lv=e.lv),void 0!=e.status&&(this.status=e.status),void 0!=e.recommend&&(this.recommend=e.recommend))},e.prototype.initByCfgData=function(e){this.sid=e,this.lockStatus=!1;var t=this.getAllianceScienceByGroupIdOfLevel(e,0);null!=t&&(this._Data=t)},e.prototype.initByServerData=function(e){this.initByData(e),this.lockStatus=!0;var t=this.getAllianceScienceByGroupIdOfLevel(this.sid,Number(this.lv));null!=t&&(this._Data=t)},e.prototype.isUpLevel=function(){return this.status!=o.UpLeveling&&(this.exp>=this.getMaxExp()&&0!=this.getMaxExp())},e.prototype.isRecommend=function(){return this.recommend},e.prototype.Data=function(){return this._Data},e.prototype.isLock=function(){return 10400!=this.sid&&this.lockStatus},e.prototype.getAllUpItemList=function(){return[]},e.prototype.getMaxExp=function(){return this._Data?this._Data.lvup_exp:1},e.prototype.isStatus=function(){return 0==this.status},e.prototype.getExpProgress=function(){var e=this.exp/this.getMaxExp();return e>1&&(e=1),e},e.prototype.isMaxLevel=function(){if(this._Data){if(0==this._Data.lvup_exp)return!0;if(null==this.getAllianceScienceByGroupIdOfLevel(this.sid,this.lv+1))return!0}return!1},e.prototype.getMaxLevel=function(){var e,t=i.TABLE.getTableGroup(s.TableName.ALLIANCE_SCIENCE),a=0;for(var o in t)void 0!=(e=t[o]).group_id&&e.group_id==this.sid&&e.level>a&&(a=e.level);return a},e.prototype.getDesc=function(){return this._Data?n.LOCAL.getText(this._Data.desc):""},e.prototype.getName=function(){return this._Data?n.LOCAL.getText(this._Data.name):n.LOCAL.getText("100518")},e.prototype.updateShowLine=function(e){this.lineIndex=e},e.prototype.getCfgLevel=function(){},e.prototype.getCfgIcon=function(){if(this._Data)return this._Data.icon},e.prototype.getUpLevelLastTime=function(){if(0!=this.endTime)return this.endTime-r.DATA.ServerTime},e.prototype.getPropressTime=function(){var e=this.getUpLevelLastTime()/this._Data.lvup_time;return e>1&&(e=1),e},e.prototype.getAllianceScienceByGroupIdOfLevel=function(e,t){var a,o=i.TABLE.getTableGroup(s.TableName.ALLIANCE_SCIENCE);for(var n in o)if(void 0!=(a=o[n]).group_id&&a.group_id==e&&a.level==t)return a;return null},e.prototype.getCurrentEffect=function(){if(1==this._Data.type)return this._Data.parm1;var e=i.TABLE.getTableDataById(s.TableName.EFFECTBUFF,this._Data.parm1.toString());return e.value_type>1?(this._Data.parm2/e.value_type*100).toFixed(1)+"%":this._Data.parm2},e.prototype.getNextEffect=function(){if(!this.isMaxLevel()){var e=this.getAllianceScienceByGroupIdOfLevel(this.sid,this.lv+1);if(null==e)return"";if(1==this._Data.type)return e.parm1;var t=i.TABLE.getTableDataById(s.TableName.EFFECTBUFF,e.parm1.toString());return t.value_type>1?(e.parm2/t.value_type*100).toFixed(1)+"%":e.parm2}},e.prototype.getDonateExp=function(){return this._Data?this._Data.donation_exp:0},e.prototype.getDonateScore=function(){return this._Data?this._Data.alliance_point:0},e.prototype.getUnLockString=function(){var e=this._Data.unlock_condition.split(";");if(2!=e.length)return"";var t=this.getAllianceScienceByGroupIdOfLevel(Number(e[0]),Number(e[1]));return n.LOCAL.getText("100519",n.LOCAL.getText(t.name),e[1])},e}();a.default=l,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../Const/TableName":"TableName","./DataCenter":"DataCenter"}],AllianceShopData:[function(e,t,a){"use strict";cc._RF.push(t,"e4491+W8F1BZYKzU7Y1BYfK","AllianceShopData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./AllianceShopItemData"),n=e("../Tools/GameTools"),i=e("./DataCenter"),r=e("../../Core/Event/EventCenter"),s=e("../Const/EventId"),l=function(){function e(){this.shopItemList=new Array,this.end_time=0,this.new=!1}return e.prototype.initByData=function(e){if(e&&(void 0!=e.end_time&&(this.end_time=e.end_time),void 0!=e.new&&(this.new=e.new,r.EVENT.emit(s.EventId.AllianceShopStatus)),this.shopItemList=[],void 0!=e.items))for(var t=0;t<e.items.length;t++){var a=e.items[t],n=new o.default;n.initByData(a),this.shopItemList.push(n)}},e.prototype.updateShopStatus=function(){this.new=!1,r.EVENT.emit(s.EventId.AllianceShopStatus)},e.prototype.updateByData=function(){},e.prototype.isShowRedPoint=function(){return this.new},e.prototype.updateItemList=function(e){for(var t=0;t<e.length;t++){var a=e[t];this.updateItemData(a)}},e.prototype.updateItemData=function(e){var t=new o.default;t.initByData(e);for(var a=0;a<this.shopItemList.length;a++){if(this.shopItemList[a].id==t.id){this.shopItemList[a].updateByData(e),r.EVENT.emit(s.EventId.AllianceShopItemDataUpdate,this.shopItemList[a]);break}}},e.prototype.getSortShop=function(){return this.shopItemList.sort(function(e,t){return e.getCfg().order-t.getCfg().order})},e.prototype.getLastTime=function(){return n.default.getSimpleTimeShow(this.end_time-i.DATA.ServerTime)},e}();a.default=l,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../Const/EventId":"EventId","../Tools/GameTools":"GameTools","./AllianceShopItemData":"AllianceShopItemData","./DataCenter":"DataCenter"}],AllianceShopItemData:[function(e,t,a){"use strict";cc._RF.push(t,"1e811X2oWFMloypgkxDVKR1","AllianceShopItemData"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../../Core/Common/LocalManager"),i=e("../../Core/Common/TableManager"),r=e("./DataCenter"),s=e("../Const/TableName");(function(e){e[e.coinType=1]="coinType",e[e.goldType=2]="goldType",e[e.scienceScore=3]="scienceScore"})(o||(o={}));var l=function(){function e(){this.id=0,this.buyTimes=0,this._data=null}return e.prototype.initByData=function(e){e&&(void 0!=e.shopId&&(this.id=e.shopId),void 0!=e.buyTimes&&(this.buyTimes=e.buyTimes),this.UpdateData())},e.prototype.updateByData=function(e){e&&(void 0!=e.shopId&&(this.id=e.shopId),void 0!=e.buyTimes&&(this.buyTimes=e.buyTimes),this.UpdateData())},e.prototype.initByConfig=function(e){this.id=e,this.buyTimes=2,this.UpdateData()},e.prototype.getCfg=function(){return null!=this._data?this._data:null},e.prototype.getCfgName=function(){if(null!=this._data){var e=i.TABLE.getTableDataById(s.TableName.ITEM,this._data.item_id.toString());if(e)return e.name}return n.LOCAL.getText("100566")},e.prototype.getBuyType=function(){return this._data?this._data.tyep:1},e.prototype.getBuyCommodityPrice=function(){return this._data?this._data.price_shop:0},e.prototype.getBuyMaxCount=function(){var e=this.getLastCommodityCount();return e>0&&r.DATA.UserData.Resource.Honor>=e*this.getBuyCommodityPrice()?e:Math.floor(r.DATA.UserData.Resource.Honor/this.getBuyCommodityPrice())},e.prototype.getLastCommodityCount=function(){return this.isLimitCommodity()?this._data.buy_limit-this.buyTimes:-99},e.prototype.isBuyCommodity=function(){return!this.isLimitCommodity()||this.buyTimes<this._data.buy_limit},e.prototype.isBuyOneCommodity=function(){return r.DATA.UserData.Resource.Honor>=this.getBuyCommodityPrice()},e.prototype.isLimitCommodity=function(){return null!=this._data&&this._data.buy_limit>0},e.prototype.UpdateData=function(){this._data=i.TABLE.getTableDataById(s.TableName.ALLIANCE_SHOP,this.id.toString())},e.prototype.getShopItemMeta=function(e){return i.TABLE.getTableDataById(s.TableName.ALLIANCE_SHOP,e)},e}();a.default=l,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../Const/TableName":"TableName","./DataCenter":"DataCenter"}],AllianceStarTaskData:[function(e,t,a){"use strict";cc._RF.push(t,"bdc43IcmW1KR6mOL+ZazSVe","AllianceStarTaskData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../Const/TableName"),i=function(){function e(){this._taskList=new Array,this._reward=0}return e.prototype.UpdateData=function(e){if(null!=e&&(this._star=e.star,this._dismiss=e.dismiss,this._reward=e.reward,this._taskList.length>0&&this._taskList.splice(0,this._taskList.length),null!=e.list))for(var t=0;t<e.list.length;t++){var a=new r(e.list[t]);this._taskList.push(a)}},Object.defineProperty(e.prototype,"Star",{get:function(){return this._star},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dismiss",{get:function(){return this._dismiss},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TaskList",{get:function(){return this._taskList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Reward",{get:function(){return this._reward},set:function(e){this._reward=e},enumerable:!0,configurable:!0}),e}();a.default=i;var r=function(){function e(e){this.UpdateData(e)}return e.prototype.UpdateData=function(e){null!=e&&(this.Id=e.id,this.Val=e.val,this.State=e.st,this.Data=o.TABLE.getTableDataById(n.TableName.ALLIANCE_STAR_TASK,this.Id.toString()))},e}();a.StarTaskData=r,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../Const/TableName":"TableName"}],AllianceTerritoryData:[function(e,t,a){"use strict";cc._RF.push(t,"5c286Q+RUJBZKt1a8AJNRIW","AllianceTerritoryData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./AllianceTerritoryItemData"),n=e("../../Core/Common/TableManager"),i=e("../../Core/Net/NetMgr"),r=e("../Const/RequestId"),s=e("../Tools/GameTools"),l=e("../Const/EventId"),c=e("../../Core/Event/EventCenter"),d=e("../../fws/utils/FWSTool"),p=e("./DataCenter"),u=e("../alliance/AllianceCommon"),h=e("../Const/TableName"),m=function(){function e(){this._allianceTerritoryItemIdArr=[],this._allianceTerritoryItemMap={},this._haveSetInitData=!1}return e.prototype.initTerritoryData=function(){if(!this._haveSetInitData){this._haveSetInitData=!0;var e=n.TABLE.getTableGroup(h.TableName.ALLIANCE_BUILDING);for(var t in e){var a=parseInt(t);this._allianceTerritoryItemIdArr.push(a);var i=new o.default;i.setXmlInfoById(a),this._allianceTerritoryItemMap[a]=i}}},e.prototype.getTerritoryItemDataById=function(e){return this._allianceTerritoryItemMap[e]},e.prototype.getTerritoryItemDataByUid=function(e){var t=null;for(var a in this._allianceTerritoryItemMap){var o=this._allianceTerritoryItemMap[a];if(null!=o&&o.Uid==e){t=o;break}}return t},e.prototype.getTerritoryItemIdArrByType=function(e){var t=this,a=[];return this._allianceTerritoryItemIdArr.forEach(function(o){var n=t.getTerritoryItemDataById(o);n.type===e&&1==n.IsVisible&&a.push(o)}),a},e.prototype.sendCmdGetTerritoryInfo=function(){if(this.initTerritoryData(),p.DATA.UserData.ServerId==p.DATA.UserData.OriginServerId){var e=this;i.NET.send(r.RequestId.ALLIANCE_GET_TERRITORY,{},this,function(t){var a=s.default.JSON_PARSE(t.d);null!=a&&e.handleServerData(a)})}},e.prototype.handleServerData=function(e){var t=this,a=e.infos;d.Obj.isEmpty(a)||(a.forEach(function(e){t.handleSingleServerData(e)}),c.EVENT.emit(l.EventId.AllianceTerritoryDataUpdate))},e.prototype.handleSingleServerData=function(e){var t=e.id,a=this.getTerritoryItemDataById(t);a&&a.setServerInfo(e)},e.prototype.judgeIfHaveTerritoryCanGarrison=function(){for(var e=p.DATA.UserData.Alliance.territoryData.getTerritoryItemIdArrByType(1),t=0;t<e.length;t++){if(p.DATA.UserData.Alliance.territoryData.getTerritoryItemDataById(e[t]).State==u.AllianceTerritoryBuildStatus.CanGarrison)return!0}return!1},e.prototype.judgeIfHaveTerritoryCanBuild=function(){for(var e=p.DATA.UserData.Alliance.territoryData.getTerritoryItemIdArrByType(1),t=0;t<e.length;t++){if(p.DATA.UserData.Alliance.territoryData.getTerritoryItemDataById(e[t]).State==u.AllianceTerritoryBuildStatus.CanBuild)return!0}return!1},e.prototype.getBuildingTerritoryData=function(){for(var e=p.DATA.UserData.Alliance.territoryData.getTerritoryItemIdArrByType(1),t=0;t<e.length;t++){var a=p.DATA.UserData.Alliance.territoryData.getTerritoryItemDataById(e[t]);if(a.State==u.AllianceTerritoryBuildStatus.Building)return a}return null},e}();a.default=m,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/utils/FWSTool":"FWSTool","../Const/EventId":"EventId","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Tools/GameTools":"GameTools","../alliance/AllianceCommon":"AllianceCommon","./AllianceTerritoryItemData":"AllianceTerritoryItemData","./DataCenter":"DataCenter"}],AllianceTerritoryItemData:[function(e,t,a){"use strict";cc._RF.push(t,"8f5ddOs0ldAia+PVkfRaeFr","AllianceTerritoryItemData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../Core/Common/TableManager"),i=e("../../fws/utils/FWSTool"),r=e("./DataCenter"),s=e("../alliance/AllianceCommon"),l=e("../Const/TableName"),c=function(){function e(){this._id=0,this.name=0,this.type=0,this.curBuildValue=0,this.maxBuildValue=0,this.buildFinishTimeDuration=0,this.buildFinishTimeStamp=0,this.ligeance_width=0,this.ligeance_height=0,this.width=0,this.height=0,this.unlock1=0,this.unlock2=0,this.unlock3=0,this.unlock4="",this.myCondition1=0,this.myCondition2=0,this.myCondition3=0,this.myCondition4=0,this.jurisdiction="",this.prefab="",this.donationValue=0,this.donationScore=0,this.is_visible=0,this._Uid=0,this._state=0,this.curArmyNum=0,this.maxArmyNum=0,this.curMarchNum=0,this.maxMarchNum=0,this.point={x:0,y:0},this.coinNum=0,this.diamondNum=0,this.goldCost=0,this.coinCost=0,this.memberCityNum=0,this.lastDonateTime=0,this.durability=null}return e.prototype.setXmlInfoById=function(e){this._id=e;var t=n.TABLE.getTableDataById(l.TableName.ALLIANCE_BUILDING,e.toString());this.name=t.name,this.type=t.type,this.maxBuildValue=t.build_value,this.ligeance_width=t.ligeance_width,this.ligeance_height=t.ligeance_height,this.width=t.width,this.height=t.height,this.unlock1=t.unlock1,this.unlock2=t.unlock2,this.unlock3=t.unlock3,this.unlock4=t.unlock4,this.jurisdiction=t.jurisdiction,this.prefab=t.prefab,this.donationValue=t.donation_value,this.donationScore=t.donation_value_score,this.is_visible=t.is_visible},e.prototype.setServerInfo=function(e){this._state=e.st,this._state===s.AllianceTerritoryBuildStatus.Locked&&(this.myCondition1=e.lock[1],this.myCondition2=e.lock[2],this.myCondition3=e.lock[3],this.myCondition4=e.lock[4]),this._Uid=e.uuid;var t=e.info;i.Obj.isEmpty(t)||(this.curMarchNum=t.cur_march,this.maxMarchNum=t.max_march,this.curArmyNum=t.cur_army,this.maxArmyNum=t.max_army,this.curBuildValue=t.cur_def,this.maxBuildValue=t.max_def,this.buildFinishTimeDuration=t.duration,this.buildFinishTimeStamp=t.time,this.point=t.point,null!=t.donate&&(this.coinNum=t.donate.coinNum,this.diamondNum=t.donate.diamonNum,this.goldCost=t.donate.goldCost,this.coinCost=t.donate.coinCost),this.lastDonateTime=t.lastDonateTime,this.durability=e.info.durability,this.memberCityNum=e.info.memberCityNum)},Object.defineProperty(e.prototype,"MemberCityNum",{get:function(){return this.memberCityNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return o.LOCAL.getText(this.name.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurBuildValue",{get:function(){return this.curBuildValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxBuildValue",{get:function(){return this.maxBuildValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BuildFinishTime",{get:function(){return 0===this.curArmyNum?this.buildFinishTimeDuration:this.buildFinishTimeStamp-r.DATA.ServerTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TerritoryWidth",{get:function(){return this.ligeance_width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TerritoryHeight",{get:function(){return this.ligeance_height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Width",{get:function(){return this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Height",{get:function(){return this.height},enumerable:!0,configurable:!0}),e.prototype.haveUnlockCondition=function(){return this.unlock1>0||this.unlock2>0||this.unlock3>0||this.unlock4.length>0},Object.defineProperty(e.prototype,"UnlockNeedNumberOfPeople",{get:function(){return this.unlock1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MyNumberOfPeople",{get:function(){return this.myCondition1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnlockNeedPower",{get:function(){return this.unlock2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MyPower",{get:function(){return this.myCondition2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnlockNeedResearchScienceTotalNum",{get:function(){return this.unlock3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MyResearchScienceTotalNum",{get:function(){return this.myCondition3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnlockNeedAuth",{get:function(){return this.jurisdiction.toString().split(";")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UnlockNeedMember",{get:function(){return this.unlock4.split(",")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MyMember",{get:function(){return this.myCondition4},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WorldPrefab",{get:function(){return this.prefab},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DonationValue",{get:function(){return this.donationValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DonationScore",{get:function(){return this.donationScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pic",{get:function(){return"image/world_unit/"+this.prefab},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsVisible",{get:function(){return this.is_visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"State",{get:function(){return this._state},set:function(e){this._state=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurMarchNum",{get:function(){return this.curMarchNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxMarchNum",{get:function(){return this.maxMarchNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurArmyNum",{get:function(){return this.curArmyNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxArmyNum",{get:function(){return this.maxArmyNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WorldMapPos",{get:function(){return this.point},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CoinNum",{get:function(){return this.coinNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DiamondNum",{get:function(){return this.diamondNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GoldCost",{get:function(){return this.goldCost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CoinCost",{get:function(){return this.coinCost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Uid",{get:function(){return this._Uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LastDonateTime",{get:function(){return this.lastDonateTime},enumerable:!0,configurable:!0}),e}();a.default=c,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../fws/utils/FWSTool":"FWSTool","../Const/TableName":"TableName","../alliance/AllianceCommon":"AllianceCommon","./DataCenter":"DataCenter"}],ArmyEquipData:[function(e,t,a){"use strict";cc._RF.push(t,"eff4anFfJFExoxCFbwUqu7/","ArmyEquipData"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(){}return Object.defineProperty(e.prototype,"ItemId",{get:function(){return this._itemId},set:function(e){this._itemId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ArmyType",{get:function(){return this._armyType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pos",{get:function(){return this._pos},enumerable:!0,configurable:!0}),e.prototype.UpdateData=function(e){this._itemId=e.itemId,this._armyType=e.armyType,this._pos=e.pos},e}();a.default=o,cc._RF.pop()},{}],AutoAssemlbyData:[function(e,t,a){"use strict";cc._RF.push(t,"76b30hJyvJHVY+u/lZ6NSIb","AutoAssemlbyData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Event/EventCenter"),n=e("../Const/EventId"),i=e("./DataCenter"),r=function(){function e(){}return e.prototype.UpdateData=function(e){e&&(this._ArmyType=e.at,this._TargetType=e.tt,this._endTime=e.end,this._IsOpen=e.open,this._index=e.idx,o.EVENT.emit(n.EventId.AutoAssemlbyDataUpdate))},Object.defineProperty(e.prototype,"ArmyType",{get:function(){return this._ArmyType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TargetType",{get:function(){return this._TargetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndTime",{get:function(){return this._endTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsOpen",{get:function(){return 1==this._IsOpen&&this._endTime>=i.DATA.ServerTime?1:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e}();a.default=r,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../Const/EventId":"EventId","./DataCenter":"DataCenter"}],BattleData:[function(e,t,a){"use strict";cc._RF.push(t,"41657tCukBAgIufliBo0GkX","BattleData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../Const/TableName"),i=function(){return function(e,t,a,o){void 0===o&&(o=null),this.CurBattleWin=!1,this.Type=e,this.Attacker=t,this.Defender=a,this.otherData=o}}();a.BattleData=i;var r=function(){return function(e,t,a,o,n,i,r,s){void 0===o&&(o=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=null),this.armys=null,this.heros=null,this.extraHeros=null,this.itemName="",this.iconUrl=null,this.wxUrl=null,this.otherData=null,this.uid=e,this.itemName=t,this.curSceneType=a,this.iconUrl=o,this.wxUrl=n,this.armys=i,this.heros=s,this.otherData=r}}();a.BattleItemData=r;var s=function(){return function(e,t,a,i){void 0===t&&(t=null),void 0===a&&(a=0),void 0===i&&(i=0),this.ArmyData=null,this.modelData=null,this.armyNum=0,this.armyNum=i,this.armyID=e,this.serverID=null==t?e.toString():t,this.ArmyData={};var r=o.TABLE.getTableDataById(n.TableName.ARMY,this.armyID.toString());Object.assign(this.ArmyData,r),null!=r&&null!=this.ArmyData&&(this.modelData=o.TABLE.getTableDataById(n.TableName.MODEL,this.ArmyData.orign_model.toString()),a>0&&(this.ArmyData.power=a))}}();a.BattleArmyData=s,function(e){e[e.PVE=0]="PVE",e[e.PVP=1]="PVP",e[e.PVE_OBSTACLE=2]="PVE_OBSTACLE",e[e.PVM=3]="PVM",e[e.PVP_Alliance=4]="PVP_Alliance",e[e.PVP_MilitaryRank=5]="PVP_MilitaryRank",e[e.PVR=6]="PVR",e[e.REPLAY=7]="REPLAY",e[e.REPLAY_NewFight=8]="REPLAY_NewFight",e[e.PVP_Alliance_Assembly_Create=9]="PVP_Alliance_Assembly_Create",e[e.PVP_Alliance_Assembly_Join=10]="PVP_Alliance_Assembly_Join",e[e.PVP_Alliance_Assistance=11]="PVP_Alliance_Assistance",e[e.WorldBoss=12]="WorldBoss",e[e.AllianceBuilding=13]="AllianceBuilding",e[e.WorldSite=14]="WorldSite",e[e.AllianceBoss=15]="AllianceBoss",e[e.Throne=16]="Throne",e[e.Protect_Select_solider=17]="Protect_Select_solider",e[e.AIR_DROP=18]="AIR_DROP",e[e.AIR_DROP_Intercept=19]="AIR_DROP_Intercept",e[e.DarkPortal_Donate=20]="DarkPortal_Donate",e[e.CROSS_SEND_SOLDIER=21]="CROSS_SEND_SOLDIER",e[e.PVE_Island=22]="PVE_Island",e[e.PVE_Tower=23]="PVE_Tower",e[e.WorldTreasure_March=24]="WorldTreasure_March",e[e.WorldTreasure_Fight=25]="WorldTreasure_Fight",e[e.Country_Boss=26]="Country_Boss",e[e.PVP_Alliance_Supper_Assembly_Create=27]="PVP_Alliance_Supper_Assembly_Create",e[e.BUILD_PVR_TOWER=28]="BUILD_PVR_TOWER",e[e.BUILD_BUFF_TOWER=29]="BUILD_BUFF_TOWER",e[e.ATTACK_TOWER=30]="ATTACK_TOWER",e[e.TOWER_COLLECT=31]="TOWER_COLLECT",e[e.TOWER_ASSISTANCE=32]="TOWER_ASSISTANCE",e[e.AL_DEFENDER_MONSTER=33]="AL_DEFENDER_MONSTER",e[e.PVM_MILITARY=34]="PVM_MILITARY",e[e.PresetMarch=35]="PresetMarch",e[e.TO_KVK_ALLIANCE_BUILD=36]="TO_KVK_ALLIANCE_BUILD",e[e.TO_KVK_WORLD_BUILD=37]="TO_KVK_WORLD_BUILD",e[e.Adventure_Boss=38]="Adventure_Boss",e[e.Isle_Embattle=39]="Isle_Embattle",e[e.ARENA_PVE_BATTLE=40]="ARENA_PVE_BATTLE",e[e.ARENA_PVP_BATTLE=41]="ARENA_PVP_BATTLE",e[e.ARENA_PVP_DEFEND_BATTLE=42]="ARENA_PVP_DEFEND_BATTLE",e[e.ATTACK_TREASURE_MAP_WORLD_BOSS=43]="ATTACK_TREASURE_MAP_WORLD_BOSS",e[e.ATTACK_DIM_MINE=44]="ATTACK_DIM_MINE"}(a.BattleType||(a.BattleType={})),function(e){e[e.BattlePrepare=0]="BattlePrepare",e[e.BattleFightClick=1]="BattleFightClick",e[e.BattleFighting=2]="BattleFighting",e[e.BattleEnd=3]="BattleEnd"}(a.BattleState||(a.BattleState={})),function(e){e[e.Land=0]="Land",e[e.Sea=1]="Sea",e[e.Air=2]="Air"}(a.BattleScene||(a.BattleScene={})),cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../Const/TableName":"TableName"}],DataCenter:[function(e,t,a){"use strict";cc._RF.push(t,"f24ceMtM9lNh5WM3ISUr48T","DataCenter"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(){}return e.purge=function(){e._userData=e.UserDataCreator()},Object.defineProperty(e,"UserData",{get:function(){if(e.UserDataCreator)return e._userData||(e._userData=e.UserDataCreator()),e._userData},enumerable:!0,configurable:!0}),e.UpdateServerTime=function(t){null!==t&&void 0!==t&&0!==t&&(e._TimeDelay=t-e.getLocalTime())},Object.defineProperty(e,"ServerTime",{get:function(){return e._TimeDelay+e.getLocalTime()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TimeDelay",{get:function(){return e._TimeDelay},enumerable:!0,configurable:!0}),e.getLocalTime=function(){return Math.floor(Date.now()/1e3)},Object.defineProperty(e,"ServerFloatTime",{get:function(){return e._TimeDelay+e.getfLocalTime()},enumerable:!0,configurable:!0}),e.getfLocalTime=function(){return Date.now()/1e3},Object.defineProperty(e,"ClientTime",{get:function(){return Date.now()},enumerable:!0,configurable:!0}),e.UserDataCreator=null,e._userData=null,e._TimeDelay=0,e}();a.DataCenter=o,a.DATA=o,cc._RF.pop()},{}],GameConst:[function(e,t,a){"use strict";cc._RF.push(t,"24019iL8eRGQYJLAgIFsyyf","GameConst"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../Const/TableName"),i=function(){function e(){}return e.GetVideoCD=function(){return this.videocd>0?this.videocd:(this.videocd=Number.parseInt(o.TABLE.getTableDataById(n.TableName.DATACONFIG,"4002").value),this.videocd)},e.GetLoginRewardLevel=function(){return this.loginRewardLevel>0?this.loginRewardLevel:(this.loginRewardLevel=Number.parseInt(o.TABLE.getTableDataById(n.TableName.DATACONFIG,"4003").value),this.loginRewardLevel)},e.GetShareLimitNum=function(){return this.shareLimitNum},e.CanBattleOldLevel=!1,e.BuyEngergy=20,e.ModelRotaion=36,e.BW=136,e.BH=98,e.MS=1,e.HOLDING_ZINDEX_OFFSET=1e4,e.DRAG_MERGE_ZINDEX_OFFSET=9999,e.MERGE_LEVEL_LIMIT_VARIABLE=5,e.HOME_AREA_ZINDEX_OFFSET=0,e.WORKE_SHOW_ZINDEX=cc.macro.MAX_ZINDEX,e.WORKE_HIDE_ZINDEX=cc.macro.MIN_ZINDEX,e.helpShare=700,e.coinShare=701,e.woodShare=802,e.oilShare=803,e.Spe1ToolId=200001,e.Spe1PosId=24036,e.FriendsShareBoxID=201,e.myappreward="myappreward",e.videocd=0,e.loginRewardLevel=0,e.shareLimit="shareLimit",e.shareLimitNum=9999,e.HOSPITAL_ADD_QUEUE_USE_GOLD=!1,e}();a.default=i,a.GetResNum=function(e){return e<30?1:e<200?2:e<1e3?3:e<1e4?4:e<1e5?5:7},a.GetGoldNum=function(e){return e<=5?e:e<24?10:e<50?15:e<100?20:50},cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../Const/TableName":"TableName"}],GlobalData:[function(e,t,a){"use strict";cc._RF.push(t,"e8522k3nypBkqr443OmGiNA","GlobalData"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(){this.IsReviewVersion=!1,this.netGame=!1,this.accountId="",this.game_ip="",this.GameVersion="0.0.1",this.BuildVersion="1",this.HotUpdateVersion="",this.ResourceUrl="",this.GameBestDomain="",this.GameFallbackDomain=null,this.ServerlistFallbackDomain=null,this.ShowServers=!1,this.LoginMode=0,this.DynResVer="1.0.0",this.LangVer="1.0.0",this.Regions="",this.SwitchStr="",this.ForceGameUpdateVer="1.0.0",this.ConfigPatchVers=[],this.ClientPaymentOrderID="",this.UserIconDic={},this.changeServerId=-1,this.changeServerIp="",this.GetAllServerDataUrl="",this.JumpServer=!1,this.preServerList=["4001"],this.serverRegion="",this.firstEnterGame=!0,this.launchStatus=0,this.UserFirstReg=0,this.GameVersion=window.GameVersion,this.BuildVersion=window.BuildVersion,this.DynResVer=window.GameVersion,this.UpdateVer=["2.0.0","1.0.0","1.0.0"]}return e.getInst=function(){return this._inst||(this._inst=new e)},Object.defineProperty(e.prototype,"newbieLaunch",{get:function(){return 1===this.launchStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inLaunch",{get:function(){return this.launchStatus<2},enumerable:!0,configurable:!0}),e}();a.GlobalData=o,window.OnlineServer=!0,window.GameVersion="1.119.1",window.BuildVersion="402",a.GLOBAL=o.getInst(),cc._RF.pop()},{}],GuideData:[function(e,t,a){"use strict";cc._RF.push(t,"1e846ol629NHqDXxrBmGFSQ","GuideData"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../../Core/Common/LocalManager"),i=e("../../System/ComponentBase"),r=e("../Tools/GameTools"),s=e("../../Core/Event/EventCenter"),l=e("../Const/EventId"),c=e("./DataCenter"),d=e("../Const/GameDefine"),p=e("../Common/UIManager"),u=e("../../Core/Net/NetMgr"),h=e("../Const/RequestId"),m=e("../../fws/utils/FWS2DUtils"),f=e("../Common/TaskGuide"),_=e("../../fws/utils/LocalStorageUtils"),y=e("../Common/BIManager"),g=e("../Common/Tutorial"),C=e("../controllers/WorkerController");(function(e){e[e.e_G123EventType_TreasureBox=0]="e_G123EventType_TreasureBox",e[e.e_G123EventType_GoldMachine=1]="e_G123EventType_GoldMachine",e[e.e_G123EventType_GoldTree=2]="e_G123EventType_GoldTree",e[e.e_G123EventType_ScienceCan=3]="e_G123EventType_ScienceCan",e[e.e_G123EventType_ScienceEquipEnhence=4]="e_G123EventType_ScienceEquipEnhence",e[e.e_G123EventType_ScienceDone=5]="e_G123EventType_ScienceDone",e[e.e_G123EventType_ScienceEquip=6]="e_G123EventType_ScienceEquip",e[e.e_G123EventType_ResGet=7]="e_G123EventType_ResGet",e[e.e_G123EventType_PowerUp=8]="e_G123EventType_PowerUp",e[e.e_G123EventType_FallBox=9]="e_G123EventType_FallBox",e[e.e_G123EventType_AlaScience=10]="e_G123EventType_AlaScience",e[e.e_G123EventType_BossTime=11]="e_G123EventType_BossTime",e[e.e_G123EventType_ProtectionEnd=12]="e_G123EventType_ProtectionEnd",e[e.e_G123EventType_Army1=13]="e_G123EventType_Army1",e[e.e_G123EventType_Army2=14]="e_G123EventType_Army2",e[e.e_G123EventType_Army3=15]="e_G123EventType_Army3"})(o=a.G123EventType||(a.G123EventType={}));var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._GuideInited=!1,t._step=d.GuideState.None,t._startGuide=!1,t._pveStep=0,t._autoCheckNum=0,t._autoOpen=!0,t._mainCheckNum=0,t._npcTipNum=0,t.NpcSpaceTime=13,t.NpcTipGuideMinLv=8,t._npcTipList=[],t.sysTipsVec=["110155","110156","110157","110193","110158","110159","110160"],t.msgVec=["110194","110161","110162","110163","110164","110165","110166","110167","110168","110169","110170","110171","110172","110173","110174","110175","110176","110177","110178","110179","110180","110181","110182","110183","110184","110185","110186","110187","110188"],t.msgG123Vec=["\u958b\u653e\u3067\u304d\u308b\u88c5\u98fe\u7bb1\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\u3088\uff01\u958b\u3051\u306b\u884c\u304d\u307e\u3057\u3087\u3046\uff01","\u5145\u96fb\u304c\u5207\u308c\u305f\u307f\u305f\u3044\u3067\u3059\u3002\u5145\u96fb\u3057\u307e\u3057\u3087\u3046\uff01","\u4eca\u65e5\u306e\u91d1\u6210\u6728\u306f\u63fa\u3089\u3057\u307e\u3057\u305f\u304b\uff1f\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\uff01","\u306a\u306b\u3084\u3089\u767a\u5c55\u3067\u304d\u308b\u307f\u305f\u3044\u3067\u3059\uff01\u898b\u306b\u884c\u3063\u3066\u307f\u307e\u3057\u3087\u3046\uff01","\u90e8\u54c1\u304c\u5f37\u5316\u3067\u304d\u308b\u307f\u305f\u3044\u3067\u3059\u3002\u5f37\u5316\u3057\u307e\u3057\u3087\u3046\u3002","\u90e8\u54c1\u306e\u5f37\u5316\u304c\u7d42\u308f\u3063\u305f\u307f\u305f\u3044\u3067\u3059\uff01\u7d9a\u3051\u3066\u5f37\u5316\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01","\u306a\u306b\u3084\u3089\u65b0\u3057\u3044\u90e8\u54c1\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\uff01\u88c5\u7740\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01","\u7269\u8cc7\u88dc\u7d66\u304c\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\uff01\u53d7\u3051\u53d6\u308a\u306b\u884c\u304d\u307e\u3057\u3087\u3046\uff01","\u4f53\u529b\u304c\u6e80\u30bf\u30f3\u307f\u305f\u3044\u3067\u3059\uff01\u3069\u3053\u304b\u884c\u304d\u307e\u305b\u3093\u304b\uff1f","\u5b9d\u7bb1\u304c\u958b\u3051\u308b\u307f\u305f\u3044\u3067\u3059\uff01\u65e9\u901f\u958b\u3051\u306b\u884c\u304d\u307e\u3057\u3087\u3046\uff01","\u79d1\u5b66\u5bc4\u4ed8\u304c\u3067\u304d\u308b\u307f\u305f\u3044\u3067\u3059\u3002\u9023\u76df\u306b\u884c\u304d\u307e\u3057\u3087\u3046\u3002","BOSS\u304c\u8972\u3063\u3066\u304d\u307e\u3057\u305f\uff01\u6025\u3044\u3067\u8fce\u6483\u614b\u52e2\u306b\u3064\u3044\u3066\u304f\u3060\u3055\u3044\uff01","\u30b7\u30fc\u30eb\u30c9\u304c\u3042\u306810\u5206\u3067\u306a\u304f\u306a\u308b\u307f\u305f\u3044\u3067\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002","\u5175\u55b6\u304c\u7a7a\u3044\u3066\u308b\u307f\u305f\u3044\u3067\u3059\uff01\u751f\u7523\u3057\u3066\u307f\u307e\u305b\u3093\u304b\uff1f","\u6d77\u8ecd\u57fa\u5730\u304c\u7a7a\u3044\u3066\u308b\u307f\u305f\u3044\u3067\u3059\uff01\u751f\u7523\u3057\u3066\u307f\u307e\u305b\u3093\u304b\uff1f","\u7a7a\u8ecd\u57fa\u5730\u304c\u7a7a\u3044\u3066\u308b\u307f\u305f\u3044\u3067\u3059\uff01\u751f\u7523\u3057\u3066\u307f\u307e\u305b\u3093\u304b\uff1f"],t}return __extends(t,e),t.getInst=function(){return null==t._inst&&(t._inst=new t),t._inst},t.purge=function(){t._inst=null,t._UnLockTileOrderIds=[],t._UnLockBuildingIds=[],t._NewUnlockTileOrderIds=[],t._GuideUnlockAreaIds=[]},Object.defineProperty(t.prototype,"StartGuide",{get:function(){return this._startGuide},enumerable:!0,configurable:!0}),t.prototype.HasStartGuide=function(){this._startGuide=!0},Object.defineProperty(t.prototype,"GuideStep",{get:function(){return this._step},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PveStep",{get:function(){return this._pveStep},set:function(e){this._pveStep=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GuideUnlockAreaIds",{get:function(){if(t._GuideUnlockAreaIds.length>0)return t._GuideUnlockAreaIds;for(var e=t.UnLockTileOrderIds,a=0;a<e.length;a++)t._GuideUnlockAreaIds.push(e[a]);if(c.DATA.UserData.FunctionOn(d.FunctionKey.key_novice_adjustments)){var o=t.NewUnlockTileOrderIds;for(a=0;a<o.length;a++){var n=parseInt(o[a][1]);t._GuideUnlockAreaIds.push(n)}}return t._GuideUnlockAreaIds},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UnLockTileOrderIds",{get:function(){if(t._UnLockTileOrderIds.length>0)return t._UnLockTileOrderIds;var e=95e4;c.DATA.UserData.FunctionOn(d.FunctionKey.key_novice_adjustments)&&(e=950003);var a=r.default.getDataConfigData(e);if(a)for(var o=a.split("|"),n=0;n<o.length;n++)t._UnLockTileOrderIds.push(parseInt(o[n]));else t._UnLockTileOrderIds=[805,705,807,707,606,605];return t._UnLockTileOrderIds},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NewUnlockTileOrderIds",{get:function(){if(t._NewUnlockTileOrderIds.length>0)return t._NewUnlockTileOrderIds;for(var e=r.default.getDataConfigData(950006).split("|"),a=0;a<e.length;a++){var o=e[a].split(",");t._NewUnlockTileOrderIds.push(o)}return t._NewUnlockTileOrderIds},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UnLockBuildingIds",{get:function(){if(t._UnLockBuildingIds.length>0)return t._UnLockBuildingIds;if(c.DATA.UserData.FunctionOn(d.FunctionKey.key_novice_adjustments))for(var e=r.default.getDataConfigData(950001).split("|"),a=0;a<e.length;a++){var o=e[a].split(",");if(o.length>0){var n=parseInt(o[0]);n>0&&t._UnLockBuildingIds.push(n)}}else t._UnLockBuildingIds=[1801,1901,2001,2101,2201];return t._UnLockBuildingIds},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GuideAreaId",{get:function(){if(t._GuideAreaId>0)return t._GuideAreaId;if(c.DATA.UserData.FunctionOn(d.FunctionKey.key_novice_adjustments)){var e=t.UnLockTileOrderIds;e.length>0&&(t._GuideAreaId=e[0])}else t._GuideAreaId=805;return t._GuideAreaId},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GuideSecAreaId",{get:function(){if(t._GuideSecAreaId>0)return t._GuideSecAreaId;if(c.DATA.UserData.FunctionOn(d.FunctionKey.key_novice_adjustments)){var e=t.UnLockTileOrderIds;e.length>1&&(t._GuideSecAreaId=e[1])}else t._GuideSecAreaId=705;return t._GuideSecAreaId},enumerable:!0,configurable:!0}),t.prototype.IsInGuide=function(){return this._step!=d.GuideState.End&&this._step!=d.GuideState.None},t.prototype.saveGuideStep=function(){var e=c.DATA.UserData.UID.toString()+"_GuideStep";_.set(e,this._step),u.NET.send(h.RequestId.SaveGuideStep,{text:this._step.toString()},this,function(e){null!=e.d&&""!=e.d&&e.s}),r.default.useGuide200605()||y.default.Instance.PostUserGuide({guideid:(1e4+this._step).toString()})},t.prototype.initCurGuideStep=function(e,t){if(void 0===t&&(t=!0),t&&""===e)this._step=d.GuideState.Hello;else if(!this._GuideInited)if(0!=c.DATA.UserData.FunctionOn(d.FunctionKey.Guide)){if(null!=e){if(this._GuideInited=!0,this._step=d.GuideState.None,""==e){var a=c.DATA.UserData.UID.toString()+"_GuideStep";this._step=_.get(a)}else this._step=parseInt(e);var o=this._step;this.checkCurGuideStep(),o!=this._step&&this.saveGuideStep(),this._pveStep=0}}else this._step=d.GuideState.None},t.prototype.isFuncTipOpen=function(){return"G123"===window.channel},t.prototype.setAutoOpen=function(e){this.isFuncTipOpen()||(this._autoOpen=e,this._autoCheckNum=0,this._mainCheckNum=0,this._npcTipNum=0)},t.prototype.ClearCount=function(){this._mainCheckNum=0,this._npcTipNum=0},t.prototype.onEnterFrame=function(){if(0!=this._autoOpen)if(this._step==d.GuideState.PVE||this._step==d.GuideState.ProductArmy||this._step==d.GuideState.Help)this._autoCheckNum+=1,this._autoCheckNum>=10&&this.checkGuideTips();else if(0==this.IsInGuide())if(this._mainCheckNum+=1,this._npcTipNum+=1,0==p.default.Instance().GetPopViewNum()){this._mainCheckNum>=10&&(this._mainCheckNum=0,s.EVENT.emit("onShowTaskTips"),f.default.Instance.ResetGuide());var e=this.NpcTipGuideMinLv;if(this.isFuncTipOpen()&&(e=1e4,c.DATA.UserData.Level>=this.NpcTipGuideMinLv&&!this.hasNPCFuncTip()))return;this._npcTipNum>=this.NpcSpaceTime&&c.DATA.UserData.Level<e&&(this._npcTipNum=0,(c.DATA.UserData.FunctionOn(d.FunctionKey.NpcTip)||this.isFuncTipOpen())&&s.EVENT.emit("ShowNpcTipNode"))}else this._mainCheckNum=0,this._npcTipNum=0},t.prototype.checkCurGuideStep=function(){if(0!=c.DATA.UserData.FunctionOn(d.FunctionKey.Guide)){var e=d.GuideState.None;if(this._step<d.GuideState.Hello&&(e=d.GuideState.Hello),e==d.GuideState.None&&this._step<=d.GuideState.ProductArmy){for(var a=!0,o=c.DATA.UserData.Armys,n=0;n<o.length;n++)if(o[n].Data.level>=3){a=!1;break}a&&(e=d.GuideState.ProductArmy)}if(e==d.GuideState.None&&this._step<=d.GuideState.Enemy){var i=!1;if(null!=c.DATA.UserData.GetTilePveData(t.GuideAreaId)&&(i=!0),!i){var r=c.DATA.UserData.Areas;for(n=0;n<r.length;n++)if(r[n]==t.GuideAreaId){i=!0;break}}0==i&&(e=d.GuideState.Enemy)}if(e==d.GuideState.None&&this._step<=d.GuideState.PVE){for(i=!1,r=c.DATA.UserData.Areas,n=0;n<r.length;n++)if(r[n]==t.GuideAreaId){i=!0;break}0==i&&(e=d.GuideState.PVE)}if(e==d.GuideState.None&&this._step<=d.GuideState.Help&&(C.WorkerController.Instance.isSaved()||(e=d.GuideState.Help)),e==d.GuideState.None&&this._step<=d.GuideState.Repair){var s=0,l=c.DATA.UserData.Buildings;for(n=0;n<l.length;n++)1==l[n].Broken&&t.UnLockBuildingIds.indexOf(l[n].BuildingId)<0&&l[n].Data&&s++;s>0&&(e=d.GuideState.Repair)}e==d.GuideState.None&&(e=d.GuideState.End),e!=this._step&&(this._step=e)}else this._step=d.GuideState.None},t.prototype.changeGuideSetp=function(){var e=this._step;return this.checkCurGuideStep(),e!=this._step&&(this.saveGuideStep(),s.EVENT.emit(l.EventId.GuideStepChange),this._step==d.GuideState.Help&&this.checkGuideTips([],!1,!0,!0),!0)},t.prototype.checkGuideTips=function(e,t,a,o){void 0===e&&(e=[]),void 0===t&&(t=!1),void 0===a&&(a=!0),void 0===o&&(o=!1),this._autoCheckNum=0;for(var i={},u=0;u<e.length;u++)i[e[u]]=1;if(this._step==d.GuideState.Help&&1!=i[this._step])return(0==p.default.Instance().GetPopViewNum()||t)&&0==o&&(p.default.Instance().ShowTips(n.LOCAL.getText("110150")),g.default.Instance.StartTutorial(8)),!0;if(this._step==d.GuideState.Repair&&1!=i[this._step]){a&&p.default.Instance().ShowTips(n.LOCAL.getText("110151"));var h=p.default.Instance().HomeMap.getGuideNode(this._step);return s.EVENT.emit(l.EventId.ShowGuideTips,h),r.default.useGuide200605()||y.default.Instance.PostUserGuide({guideid:"10006"}),!0}if(this._step==d.GuideState.ProductArmy&&1!=i[this._step]){var m=c.DATA.UserData.getAllArmyByArmyId(10001),f=c.DATA.UserData.getAllArmyByArmyId(10002);if(m.length>=2||f.length>=2)this.checkProductArmyTips();else{p.default.Instance().ShowTips(n.LOCAL.getText("110152"));h=p.default.Instance().HomeMap.getGuideNode(this._step);s.EVENT.emit(l.EventId.ShowGuideTips,h)}return!0}if(this._step==d.GuideState.PVE&&1!=i[this._step]){var _=this.specialCheckPve();if(t&&(_=3),2==_)this.checkProductArmyTips();else if(3==_){p.default.Instance().ShowTips(n.LOCAL.getText("110153"));h=p.default.Instance().HomeMap.getGuideNode("Area");s.EVENT.emit(l.EventId.ShowGuideTips,h)}else{p.default.Instance().ShowTips(n.LOCAL.getText("110152"));h=p.default.Instance().HomeMap.getGuideNode(this._step);s.EVENT.emit(l.EventId.ShowGuideTips,h)}return!0}return s.EVENT.emit(l.EventId.HideGuideTips),!1},t.prototype.checkProductArmyTips=function(){if(this._step!=d.GuideState.PVE&&this._step!=d.GuideState.ProductArmy)return!1;var e=c.DATA.UserData.getAllArmyByArmyId(10002);if(e.length<2&&(e=c.DATA.UserData.getAllArmyByArmyId(10001)),e.length>=2){for(var t=p.default.Instance().HomeMap.getGuideNode(this._step,!0,e[0]),a=e[1],o=r.default.getMapPosByPosId(e[0]),i=999999999,u=1;u<e.length;u++){var h=r.default.getMapPosByPosId(e[u]),f=m.distance(o,h);i>f&&(i=f,a=e[u])}var _=p.default.Instance().HomeMap.getGuideNode(this._step,!1,a);t&&_&&(s.EVENT.emit(l.EventId.ShowGuideMoveTips,{sNode:t,eNode:_}),p.default.Instance().ShowTips(n.LOCAL.getText("110154")))}return!0},t.prototype.specialCheckPve=function(){if(null==c.DATA.UserData.GetTilePveData(t.GuideAreaId))return 0;var e=c.DATA.UserData.getAllArmyByArmyId(10001);return c.DATA.UserData.Armys.length>e.length?3:e.length<2?1:2},t.prototype.isEnableLv1SoldierNum=function(e){var t=c.DATA.UserData.Armys;if(t.length>=e)return!0;for(var a=0,o=0;o<t.length;o++)if((a+=Math.pow(2,t[o].Data.level-1))>=e)return!0;return!1},t.prototype.getRandMsg=function(){for(var e=c.DATA.UserData.Areas,a=!1,o=0;o<e.length;o++)if(e[o]==t.GuideSecAreaId){a=!0;break}if(0==a)return"110189";if(c.DATA.UserData.Level>=this.NpcTipGuideMinLv)return this.isFuncTipOpen()&&this._npcTipList.length>0?this._npcTipList.shift():"110188";if(Math.random()<.5){var n=Math.floor(this.msgVec.length*Math.random());if(n<this.msgVec.length){var i=this.msgVec[n];return this.msgVec.splice(n,1),i}}var r=Math.floor(this.sysTipsVec.length*Math.random());return r<this.sysTipsVec.length?this.sysTipsVec[r]:""},t.prototype.pushNPCTalk=function(e){this.isFuncTipOpen()&&(this._npcTipList.splice(0,0,this.msgG123Vec[e]),this._npcTipNum=this.NpcSpaceTime)},t.prototype.removeNPCTalk=function(e){if(this.isFuncTipOpen()){var t=this._npcTipList.indexOf(this.msgG123Vec[e]);t>=0&&this._npcTipList.splice(t,1)}},t.prototype.hasNPCFuncTip=function(){return this._npcTipList&&this._npcTipList.length>0},t.prototype.StartTipInstant=function(){var e=this;if(this.isFuncTipOpen()&&c.DATA.UserData.Level>=this.NpcTipGuideMinLv){this._npcTipList=[];var t=r.default.getDataConfigData(5100).split("|");parseInt(t[1]);c.DATA.UserData.Level>=5&&u.NET.send(h.RequestId.GET_MYWORLDCITY_SHIELD,{},this,function(t){var a=r.default.JSON_PARSE(t.d);null!==a&&(r.default.ObjIsEmpty(a.shieldTime)||a.shieldTime>0&&a.shieldTime>c.DATA.ServerTime&&a.shieldTime-c.DATA.ServerTime<=600&&e._npcTipList.push(e.msgG123Vec[o.e_G123EventType_ProtectionEnd]))})}this._npcTipNum=this.NpcSpaceTime-2},t._inst=null,t._GuideAreaId=0,t._GuideSecAreaId=0,t.GuideBuildId=1701,t.UIGuideStep=0,t.MaxArmyX=0,t.MaxArmyY=0,t._UnLockTileOrderIds=[],t._UnLockBuildingIds=[],t._NewUnlockTileOrderIds=[],t._GuideUnlockAreaIds=[],t.isInGuide=!1,t}(i.default);a.default=v,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../System/ComponentBase":"ComponentBase","../../fws/utils/FWS2DUtils":"FWS2DUtils","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../Common/BIManager":"BIManager","../Common/TaskGuide":"TaskGuide","../Common/Tutorial":"Tutorial","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Tools/GameTools":"GameTools","../controllers/WorkerController":"WorkerController","./DataCenter":"DataCenter"}],HeroData:[function(e,t,a){"use strict";cc._RF.push(t,"de5f5f0XvVFXIuWH/eNs6gE","HeroData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../../fws/utils/FWSTool"),i=e("./DataCenter"),r=e("../Const/GameDefine"),s=e("../Const/TableName"),l=e("../../fws/platforms/PlatformCore"),c=function(){function e(){this._id=0,this._name="",this._tag="",this._icon="",this._bust="",this._type=1,this._quality=0,this._star=0,this._starExp=0,this._starExpMax=0,this._level=0,this._maxLevel=0,this._exp=0,this._needExp=0,this._power=0,this._skill=0,this._excludePatchItem=0,this._active_skill=0,this._patchId=0,this._needPatchCnt=0,this._war=0,this._warAdd=0,this._def=0,this._defAdd=0,this._command=0,this._commandAdd=0,this._bgType="",this._source="",this._state=0,this._serverDef=0,this._skinId=0,this._skinList="",this._bgPath="",this._extraSkill=[],this._buffSkills=[],this._talents=[],this._is_show=0,this._get_show=0,this._jp_des="",this._skillUse=0,this._skillCdEndTime=0,this._firstSkillList=[],this._secondSkillList=[],this._firstBuffList=[],this._secondBuffList=[],this._hero_type=0}return e.prototype.getSkillsListByIndex=function(e){return 1==e?this._firstSkillList:2==e?this._secondSkillList:this._extraSkill},e.prototype.getBuffListByIndex=function(e){return 1==e?this._firstBuffList:2==e?this._secondBuffList:this._buffSkills},Object.defineProperty(e.prototype,"SkillsIndex",{get:function(){return this._skillsIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FirstSkillList",{get:function(){return this._firstSkillList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FirstBuffList",{get:function(){return this._firstBuffList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SecondSkillList",{get:function(){return this._secondSkillList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SecondBuffList",{get:function(){return this._secondBuffList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Talents",{get:function(){return this._talents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExtraSkill",{get:function(){return this._extraSkill},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BuffSkills",{get:function(){return this._buffSkills},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BGPath",{get:function(){return this._bgPath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ServerDef",{get:function(){return this._serverDef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tag",{get:function(){return this._tag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Bust",{get:function(){return this._bust},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Quality",{get:function(){return this._quality},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Star",{get:function(){return this._star},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"StarExp",{get:function(){return this._starExp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"StarExpMax",{get:function(){return this._starExpMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxLevel",{get:function(){return this._maxLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Exp",{get:function(){return this._exp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NeedExp",{get:function(){return this._needExp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Power",{get:function(){return this._power},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Skill",{get:function(){return this._skill},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PatchId",{get:function(){return this._patchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NeedPatchCnt",{get:function(){return this._needPatchCnt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanStarRise",{get:function(){return this.NeedPatchCnt<=this.PatchCnt&&this._star<5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"War",{get:function(){return this._war},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WarAdd",{get:function(){return this._warAdd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Def",{get:function(){return this._def},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefAdd",{get:function(){return this._defAdd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Command",{get:function(){return this._command},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CommandAdd",{get:function(){return this._commandAdd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BgType",{get:function(){return this._bgType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Source",{get:function(){return this._source},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PatchCnt",{get:function(){return i.DATA.UserData.getItemAmount(this._patchId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"State",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkinId",{get:function(){return this._skinId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Is_show",{get:function(){return this._is_show?this._is_show:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Get_show",{get:function(){return this._get_show?this._get_show:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Jp_des",{get:function(){return this._jp_des},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillUse",{get:function(){return this._skillUse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkillCdEndTime",{get:function(){return this._skillCdEndTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ActiveSkill",{get:function(){return this._active_skill},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SkinList",{get:function(){return this._skinList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExcludePatchItem",{get:function(){return this._excludePatchItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeroType",{get:function(){return this._hero_type},enumerable:!0,configurable:!0}),e.prototype.UpdateData=function(e){this._serverDef=n.Obj.getProperty(e,"def",0),this._id=n.Obj.getProperty(e,"id",0),this._level=n.Obj.getProperty(e,"level",1),this._exp=parseInt(n.Obj.getProperty(e,"levelExp",0)),this._star=n.Obj.getProperty(e,"star",0),this._starExp=parseInt(n.Obj.getProperty(e,"starExp",0)),this._state=n.Obj.getProperty(e,"state",0),this._extraSkill=n.Obj.getProperty(e,"skills",[]),this._buffSkills=n.Obj.getProperty(e,"buffSkills",[]),this._firstSkillList=n.Obj.getProperty(e,"firstSkills",[]),this._secondSkillList=n.Obj.getProperty(e,"subSkills",[]),this._firstBuffList=n.Obj.getProperty(e,"firstBuffSkills",[]),this._secondBuffList=n.Obj.getProperty(e,"subBuffSkills",[]),this._skillsIndex=parseInt(n.Obj.getProperty(e,"skillsIndex",0)),this._talents=n.Obj.getProperty(e,"talents",[]),this._skillUse=n.Obj.getProperty(e,"skillUse",0),this._skillCdEndTime=n.Obj.getProperty(e,"skillCdEndTime",0);var t=o.TABLE.getTableDataById(s.TableName.HERO,this._id.toString());if(t){this._name=t.name,this._tag=t.label,this._icon=t.hero_icon,this._bust=t.hero_tachie,this._type=t.type,this._bgPath=t.bg_img,this._quality=t.quality,this._skill=t.skill,this._active_skill=t.active_skill,this._needPatchCnt=t.fragmentsNumber,this._excludePatchItem=t.exclude_item,this._war=t.war+(this._level-1)*t.warAdd,this._def=t.def+(this._level-1)*t.defAdd,this._command=t.command,this._bgType=t.backGround,this._source=t.source,this._is_show=t.is_show,this._get_show=t.get_show,this._jp_des=t.jp_des,t.skin&&(this._skinList=t.skin),this._hero_type=t.hero_type;for(var a=0;a<this._star;a++){var l=n.Obj.getProperty(t,"upStar"+(a+1),"").split(","),c=0;a===this._star-1?(c=Math.min(this._starExp,l.length),this._starExpMax=l.length):c=l.length;for(var d=0;d<c;d++){var p=l[d].split("|");p.length>=3&&(this._war+=parseInt(p[0]),this._def+=parseInt(p[1]),this._command+=parseInt(p[2]))}}this._war=Math.floor(i.DATA.UserData.Buff.getValueWithBuff(this._war,r.BuffType.HeroPropertyUp,!0,"HeroProperty",1)),this._def=Math.floor(i.DATA.UserData.Buff.getValueWithBuff(this._def,r.BuffType.HeroPropertyUp,!0,"HeroProperty",2)),this._command=Math.floor(i.DATA.UserData.Buff.getValueWithBuff(this._command,r.BuffType.HeroPropertyUp,!0,"HeroProperty",3));var u=o.TABLE.getTableDataById(s.TableName.HEROSKILL,t.skill);u&&(this._power=this._war+this._def+this._command+u.power)}this._maxLevel=20+20*this._star;var h=o.TABLE.getTableDataById(s.TableName.HERO_LEVEL,this._level.toString());h&&(this._needExp=n.Obj.getProperty(h,"exp"+this._quality,0));var m=o.TABLE.getTableDataById(s.TableName.HERO_LEVEL,this._star.toString());m&&(this._needPatchCnt=n.Obj.getProperty(m,"star"+this._quality,0));var f=o.TABLE.getTableGroup(s.TableName.ITEM);for(var _ in f)if(f[_].type==r.ItemType.HeroPatch&&f[_].para1==this._id){this._patchId=parseInt(_);break}var y=n.Obj.getProperty(e,"skinId",0);this.UpdateSkin(y),this.checkShowPlat()},e.prototype.UpdateSkin=function(e){var t;if(this._skinId=e,this._skinId){if(t=o.TABLE.getTableDataById(s.TableName.HEROSKIN,this._skinId.toString())){1==this.checkInPlat(t.plat)&&(this._icon=t.hero_icon,this._bust=t.hero_tachie,this._bgPath=t.bg_img)}}else(t=o.TABLE.getTableDataById(s.TableName.HERO,this._id.toString()))&&(this._icon=t.hero_icon,this._bust=t.hero_tachie,this._bgPath=t.bg_img)},e.prototype.checkInPlat=function(e){void 0===e&&(e="");var t=!1;if(e)for(var a=e.split("|"),o=0;o<a.length;o++){if("g123"===l.instance.platformSID&&"G123"===a[o]){t=!0;break}if(a[o]==l.instance.platformSID){t=!0;break}}else t=!0;return t},e.prototype.checkShowPlat=function(){var e=o.TABLE.getTableDataById(s.TableName.HERO,this._id.toString());if(e&&(!this.checkInPlat(e.plat)&&e.show_hero_id)){var t=o.TABLE.getTableDataById(s.TableName.HERO,e.show_hero_id.toString());t&&(this._icon=t.hero_icon,this._bust=t.hero_tachie,this._name=t.name,this._skill=t.skill)}},e}();a.default=c,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../Const/GameDefine":"GameDefine","../Const/TableName":"TableName","./DataCenter":"DataCenter"}],MailData:[function(e,t,a){"use strict";cc._RF.push(t,"29a28HK77VJ8a9CaWQl1AJ+","MailData");var o,n=e("../../fws/utils/X");(function(e){var t;e.USE_NEW_MAIL_MODEL=!1,e.mailSetNewModelSwitch=function(t){n.info("new_mail_model_switch:"+t),e.USE_NEW_MAIL_MODEL=t},e.loadMailCount=50,function(e){e[e.t_alliance=1]="t_alliance",e[e.t_active=2]="t_active",e[e.t_system=3]="t_system",e[e.t_battle=4]="t_battle",e[e.t_collect=5]="t_collect",e[e.t_battle_pve=6]="t_battle_pve",e[e.t_store=7]="t_store"}(t=e.MailShowGroupType||(e.MailShowGroupType={})),function(e){e[e.type_owner=1]="type_owner",e[e.type_system=2]="type_system",e[e.type_war=3]="type_war",e[e.type_store=4]="type_store",e[e.type_challenge=5]="type_challenge",e[e.type_collect=6]="type_collect",e[e.type_boss=7]="type_boss",e[e.type_scout=8]="type_scout",e[e.type_alliance=9]="type_alliance",e[e.type_new_battle_report=10]="type_new_battle_report",e[e.type_attack_monster=11]="type_attack_monster",e[e.type_AssemblyBoss=12]="type_AssemblyBoss",e[e.type_throne_attack=13]="type_throne_attack",e[e.type_plat_pay_reward=14]="type_plat_pay_reward",e[e.type_activity=15]="type_activity"}(e.MailType||(e.MailType={})),function(e){e[e.unread=0]="unread",e[e.readed=1]="readed"}(e.MailReadStatus||(e.MailReadStatus={})),function(e){e[e.unreceived=0]="unreceived",e[e.received=1]="received"}(e.MailRewardStatus||(e.MailRewardStatus={})),function(e){e[e.GOURL=1]="GOURL"}(e.MailButtonAction||(e.MailButtonAction={})),e.mailGroupMap={1:{showType:t.t_alliance,title:"mail_new_type_001",icon:"",mails:[],unreadCount:0,time:0,serverAllMallCount:0,unRewardCount:0},2:{showType:t.t_active,title:"mail_new_type_003",icon:"",mails:[],unreadCount:0,time:0,serverAllMallCount:0,unRewardCount:0},3:{showType:t.t_system,title:"mail_new_type_002",icon:"",mails:[],unreadCount:0,time:0,serverAllMallCount:0,unRewardCount:0},4:{showType:t.t_battle,title:"mail_new_type_004",icon:"",mails:[],unreadCount:0,time:0,serverAllMallCount:0,unRewardCount:0},5:{showType:t.t_collect,title:"mail_new_type_005",icon:"",mails:[],unreadCount:0,time:0,serverAllMallCount:0,unRewardCount:0},6:{showType:t.t_battle_pve,title:"mail_new_type_006",icon:"",mails:[],unreadCount:0,time:0,serverAllMallCount:0,unRewardCount:0},7:{showType:t.t_store,title:"mail_new_type_007",icon:"",mails:[],unreadCount:0,time:0,serverAllMallCount:0,unRewardCount:0}},e.mailMap={}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../fws/utils/X":"X"}],PlayerInfo:[function(e,t,a){"use strict";cc._RF.push(t,"20f46hd1R5OHbLl5F9stx45","PlayerInfo"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Tools/GameTools"),n=e("../Const/GameDefine"),i=e("../../fws/utils/FWSTool"),r=e("../../fws/platforms/PlatformCore"),s=e("../../fws/utils/X"),l=e("../../Core/Net/NetMgr"),c=e("./DataCenter"),d={avatarUrl:"headimgurl",nickName:"nickname"},p=function(){function e(e){void 0===e&&(e=null),this._data={},this.update(e)}return e.prototype.getDisplayName=function(e){if(void 0===e&&(e=""),this._data){var t=this._data.username||this._data.nickname||e;return t=i.Str.replaceSpecChars(t)}return e},e.prototype.getDisplayAvatarUrl=function(e){void 0===e&&(e="");var t=o.default.getDefaultAvatarByGender(this.gender);if(c.DATA.UserData.FunctionOn(n.FunctionKey.AvatarBlock))return t;if(this._data){var a=this._data.avatarurl||this._data.headimgurl_custom||this._data.headimgurl||e,i=c.DATA.UserData.FunctionOn(n.FunctionKey.UploadHeadImage)&&r.instance.canUploadHeaderPicture;if(""==this._data.headimgurl_custom||a!=this._data.headimgurl_custom||i||(a=t),a.indexOf("aprialsfool20")>=0){c.DATA.getLocalTime()>1585756800&&(a="headIcon_1_1")}return a||"headIcon_1_1"}return e||"headIcon_1_1"},e.prototype.canBeReportHeadIcon=function(){if(c.DATA.UserData.FunctionOn(n.FunctionKey.AvatarBlock))return!1;if(this._data&&(c.DATA.UserData.FunctionOn(n.FunctionKey.UploadHeadImage)&&r.instance.canUploadHeaderPicture&&this._data.headimgurl_custom))return!0;return!1},Object.defineProperty(e.prototype,"avatarurl",{get:function(){return this._data&&this._data.avatarurl||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gender",{get:function(){return this._data?this._data.usergender||this._data.gender||n.TPlayerGender.Unknow:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return!!this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"username",{get:function(){return this._data&&this._data.username||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nickname",{get:function(){return this._data&&this._data.nickname||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"province",{get:function(){return this._data&&this._data.province||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headimgurl",{get:function(){return this._data&&this._data.headimgurl||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headimgurl_custom",{get:function(){return this._data&&this._data.headimgurl_custom||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nationalflag",{get:function(){return this._data&&this._data.nationalflag||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._data&&this._data.level||1},enumerable:!0,configurable:!0}),e.prototype.update=function(e,t){void 0===t&&(t=!1);var a=!1;if(i.Obj.isEmpty(e))return a;var n=null;return(n=i.Obj.isString(e)?o.default.JSON_PARSE(e):e)?(r.instance.disableOldUpdatePlayerInfo||n.username==n.nickname&&(n.username="",a=!0),t?(this._data=this._data||{},Object.assign(this._data,n)):this._data=n,a):a},e.prototype.updatePlatformUserInfo=function(e){if(e){for(var t in this._data=this._data||{},e){var a=t,o=e[t],n=d[a]||a;this._data[n]=o}i.Obj.isNumber(r.instance.submitPlatformRequestId())&&this.submitPlatformPlayerInfo(e),this.updatePlayerInfo()}},e.prototype.submitPlatformPlayerInfo=function(e){var t=r.instance.submitPlatformRequestId();t>0&&(s.color("orange","(PlayerInfo) \u63d0\u4ea4\u5e73\u53f0\u7528\u6237\u4fe1\u606f\u7ed9\u670d\u52a1\u5668",e),l.NET.send(t,e,this,function(e){s.color("orange","(PlayerInfo) \u63d0\u4ea4\u5e73\u53f0\u7528\u6237\u4fe1\u606f\u7ed9\u670d\u52a1\u5668(\u56de\u5e94)",e)}))},e.prototype.updatePlayerInfo=function(){},Object.defineProperty(e.prototype,"authorized",{get:function(){return!(!this._data||!this._data.nickname&&!this._data.headimgurl)},enumerable:!0,configurable:!0}),e.prototype.initNickName=function(e,t){void 0===t&&(t=!0),s.color("orange","(PlayerInfo) \u66f4\u6539\u540d\u79f0",e),this._data=this._data||{},i.Str.isEmpty(this._data.nickname)&&(this._data.nickname=e),t&&this.updatePlayerInfo()},e.prototype.updateName=function(e,t){void 0===t&&(t=!0),s.color("orange","(PlayerInfo) \u66f4\u6539\u540d\u79f0",e),this._data=this._data||{},this._data.username=e,t&&this.updatePlayerInfo()},e.prototype.updateGender=function(e,t){void 0===t&&(t=!0),s.color("orange","(PlayerInfo) \u66f4\u6539\u6027\u522b",e),this._data=this._data||{},this._data.usergender=e,t&&this.updatePlayerInfo()},e.prototype.updateAvatar=function(e,t){void 0===t&&(t=!0),s.color("orange","(PlayerInfo) \u66f4\u6539\u5934\u50cf",e),this._data=this._data||{},this._data.avatarurl=e,t&&this.updatePlayerInfo()},e.prototype.updateNationalFlag=function(e,t){void 0===t&&(t=!0),s.color("orange","(PlayerInfo) \u66f4\u6539\u56fd\u65d7",e),this._data=this._data||{},this._data.nationalflag=e},e}();a.default=p,window.PlayerInfo=p,cc._RF.pop()},{"../../Core/Net/NetMgr":"NetMgr","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Const/GameDefine":"GameDefine","../Tools/GameTools":"GameTools","./DataCenter":"DataCenter"}],ServerData:[function(e,t,a){"use strict";cc._RF.push(t,"96206/vhj5NX4ZgAj4VOFxh","ServerData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./PlayerInfo"),n=e("./DataCenter"),i=e("../Tools/GameTools"),r=e("../Const/GameDefine"),s=e("../../fws/platforms/PlatformCore"),l=e("../Common/PFOpenData"),c=e("../Common/GM"),d=e("../../fws/utils/ErrorReport"),p=e("../Const/GameDefine"),u=function(){function e(){this._playerInfo=null,this._uid=0,this._level=1,this._url="",this._isUnion=0,this._canDel=0,this._country="",this._isGM=!1,this._pfs=[],this._serverRegion=p.GameServerRegion.China,this._playerInfo=new o.default,this._url=""}return e.prototype.UpdateServerData=function(e){this._id=e.id,this._rate=e.rate,this._url=i.default.gameIpCombineAccLines(e.url,e),this._country=e.countrys||"",this._slistShowType=e.slistShowType,this._isGM=1==e.isGM,e.platforms&&"all"!=e.platforms&&(this._pfs=e.platforms.split("|")),e.region&&(this._serverRegion=e.region)},e.prototype.UpdateUserData=function(e,t){this._id=e.serverId,this._uid=e.uid,this._playerInfo.update(e.playerInfo),this._level=e.level,this._isUnion=e.isUnion||0,this._canDel=e.canDel||0},Object.defineProperty(e.prototype,"slistShowType",{get:function(){return this._slistShowType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGM",{get:function(){return this._isGM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pfs",{get:function(){return this._pfs},enumerable:!0,configurable:!0}),e.prototype.submitReport=function(){try{var e={};e.id=this.Id,e.url=this.Url,e.GM_is=c.is(),e.this_isGM=this.isGM,e.channelVals=l.default.Instance.Channel||"",e.platform=s.instance.platformSID,e.pfs=this._pfs,d.trace({data:JSON.stringify(e),type:"ClickChangeServer"})}catch(e){}},Object.defineProperty(e.prototype,"matchPlatformSid",{get:function(){if(n.DATA.UserData.FunctionOn(r.FunctionKey.server_list_backend_filter))return!0;if(c.is()&&this.isGM)return!0;if(!c.is()&&this.isGM)return!1;var e=(l.default.Instance.Channel||"").split("_")[0];if("g123"===e||"googleplay"===e){if(!this._pfs||0==this._pfs.length)return!1;if("all"==this._pfs[0])return!1}return!this._pfs||0==this._pfs.length||("all"==this._pfs[0]||(this._pfs.indexOf(s.instance.platformSID)>=0||(!e||this._pfs.indexOf(e)>=0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Country",{get:function(){return this._country},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rate",{get:function(){return this._rate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Uid",{get:function(){return this._uid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserName",{get:function(){return i.default.getPlayerDisplayName(this.PlayerInfo,this._uid+"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayerInfo",{get:function(){return this._playerInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsUnion",{get:function(){return this._isUnion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanDel",{get:function(){return this._canDel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Url",{get:function(){if(""==this._url)for(var e=n.DATA.UserData.ServerList,t=0;t<e.length;t++)if(e[t].Id==this._id){this._url=e[t]._url;break}return this._url},enumerable:!0,configurable:!0}),e}();a.default=u,cc._RF.pop()},{"../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../Common/GM":"GM","../Common/PFOpenData":"PFOpenData","../Const/GameDefine":"GameDefine","../Tools/GameTools":"GameTools","./DataCenter":"DataCenter","./PlayerInfo":"PlayerInfo"}],ThroneGiftData:[function(e,t,a){"use strict";cc._RF.push(t,"7770bZCN4JF27uw7zevtTWX","ThroneGiftData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./PlayerInfo"),n=function(){function e(){this._GiftPlayers={}}return e.prototype.UpdateData=function(e){this._GiftPlayers={},this._Id=e.id,this._PlayerNum=0;for(var t=e.players,a=0;a<t.length;a++){var n=t[a].uid,i=new o.default;i.update(t[a].playerInfo),this._GiftPlayers[n]=i,this._PlayerNum++}},Object.defineProperty(e.prototype,"Id",{get:function(){return this._Id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GiftPlayers",{get:function(){return this._GiftPlayers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlayerNum",{get:function(){return this._PlayerNum},enumerable:!0,configurable:!0}),e}();a.default=n,cc._RF.pop()},{"./PlayerInfo":"PlayerInfo"}],UserStaticData:[function(e,t,a){"use strict";cc._RF.push(t,"e5470SOb91OsprfJfZfP1KN","UserStaticData"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(){this.UnlimitedMerge=!1,this.HideBaseItemName=!1,this.HideHomeAirNode=!1,this.MarchToNearstTerritoryTime=-1,this.NoticePlayerMoveToTerritoryAround=!1,this.HaveNewTreasurePieceLog=!1}return e.Instance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.Purge=function(){this.UnlimitedMerge=!1,this.HideBaseItemName=!1,this.HideHomeAirNode=!1,this.NoticePlayerMoveToTerritoryAround=!1,this.MarchToNearstTerritoryTime=-1,this.HaveNewTreasurePieceLog=!1},e._instance=null,e}();a.default=o,a.USData=o.Instance(),cc._RF.pop()},{}],ECStrongestLeaderController:[function(e,t,a){"use strict";cc._RF.push(t,"206bfJalnZBloKZBrc4eKhB","ECStrongestLeaderController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/mvc/FWSMvc"),n=e("../../Core/Net/NetMgr"),i=e("../Const/RequestId"),r=e("../Tools/GameTools"),s=e("../../Core/Common/TableManager"),l=e("../Const/TableName"),c=e("../../Core/Event/EventCenter"),d=e("../Data/DataCenter"),p=e("../Common/UIManager"),u=e("../Const/UIDataInfo"),h=function(e){function t(){var t=e.call(this)||this;return t._data={id:101,endTime:1598670102,score:0,myRank:0,totalRank:0,taskArray:[{id:101,score:100,status:1},{id:102,score:100,status:1},{id:103,score:100,status:1}]},t._fullArmamentDayConfig=null,t._fullArmamentTaskTypeConfig=null,t._fullArmamentTaskConfig=null,t._rankDataObj=[{rankArray:[{playerInfo:"",score:200,uid:0,realIndex:0,s:1},{playerInfo:"",score:1e3,uid:0,realIndex:0,s:2}],selfRank:0,selfScore:0,rankEndTime:1598670102},{rankArray:[{playerInfo:"",score:200,realIndex:0,uid:0,s:3},{playerInfo:"",score:1e3,realIndex:0,uid:0,s:4}],selfRank:5,selfScore:6,rankEndTime:1598670202}],t._rankRewardDataObj=[[],[]],t}return __extends(t,e),Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t,t._instance.connect()),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.getCompetitionRedNum=function(){var e=0;if(this._data&&this._data.taskArray&&this._data.taskArray.length)for(var t=0;t<this._data.taskArray.length;t++)1==this._data.taskArray[t].status&&e++;return e},t.prototype.updateFull_armament_dayConfig=function(){this._data&&this._data.id?(this._fullArmamentDayConfig=s.TABLE.getTableDataById(l.TableName.full_armament_day,String(this._data.id)),this.updateFullArmamentTaskTypeConfig(),this.updateFullArmamentTaskConfig(),this.updateRankRewardDataObj(),c.EVENT.emit("fullArmamentTaskTypeConfig_changed")):(this._fullArmamentDayConfig=null,this._fullArmamentTaskTypeConfig=null,this._fullArmamentTaskConfig=null)},Object.defineProperty(t.prototype,"FullArmamentDayConfig",{get:function(){return this._fullArmamentDayConfig||this.updateFull_armament_dayConfig(),this._fullArmamentDayConfig},enumerable:!0,configurable:!0}),t.prototype.updateFullArmamentTaskTypeConfig=function(){if(this._fullArmamentTaskTypeConfig=[],this._fullArmamentDayConfig||this.updateFull_armament_dayConfig(),this._fullArmamentDayConfig&&this._fullArmamentDayConfig.mission_type)for(var e=this._fullArmamentDayConfig.mission_type.split("|"),t=0;t<e.length;t++){var a=s.TABLE.getTableDataById(l.TableName.full_armament_task_type,e[t]);this._fullArmamentTaskTypeConfig.push(a)}},Object.defineProperty(t.prototype,"FullArmamentTaskTypeConfig",{get:function(){return this._fullArmamentTaskTypeConfig},enumerable:!0,configurable:!0}),t.prototype.updateFullArmamentTaskConfig=function(){return this._fullArmamentTaskConfig=[],this._fullArmamentDayConfig||this.updateFull_armament_dayConfig(),this._fullArmamentDayConfig&&this._fullArmamentDayConfig.task_type&&(this._fullArmamentTaskConfig=s.TABLE.getTableDataByKeyValue(l.TableName.full_armament_task,"type",this._fullArmamentDayConfig.task_type)),this._fullArmamentTaskConfig},Object.defineProperty(t.prototype,"FullArmamentTaskConfig",{get:function(){return this._fullArmamentTaskConfig},enumerable:!0,configurable:!0}),t.prototype.askECStrongestLeaderData=function(){var e=this;n.NET.send(i.RequestId.EC_STRONGEST_LEADER_COMPETITION,{},this,function(t){if(0==t.s){var a=r.default.JSON_PARSE(t.d);e._data=a,e.updateFull_armament_dayConfig(),c.EVENT.emit("REQUEST_STRONGEST_LEADER_DATA_FINIFH"),c.EVENT.emit("UPDATE_EC_STRONGEST_LEADER_RED_DOT")}})},t.prototype.askRankData=function(){var e=this;n.NET.send(i.RequestId.EC_STRONGEST_LEADER_RANK,{},this,function(t){if(0==t.s){var a=r.default.JSON_PARSE(t.d);if(e._rankDataObj=a.result,e._rankDataObj[1]&&e._rankDataObj[1].rankArray&&e._rankDataObj[1].rankArray.length)for(var o=0;o<e._rankDataObj[1].rankArray.length;o++)0==o?e._rankDataObj[1].rankArray[o].realIndex=0:e._rankDataObj[1].rankArray[o].score==e._rankDataObj[1].rankArray[o-1].score?e._rankDataObj[1].rankArray[o].realIndex=e._rankDataObj[1].rankArray[o-1].realIndex:e._rankDataObj[1].rankArray[o].realIndex=o,e._rankDataObj[1].rankArray[o].uid&&d.DATA.UserData.UID==e._rankDataObj[1].rankArray[o].uid&&(e._rankDataObj[1].selfRank=e._rankDataObj[1].rankArray[o].realIndex+1);c.EVENT.emit("REQUEST_STRONGEST_LEADER_RANK_DATA_FINIFH")}})},t.prototype.getRankDataByIndex=function(e){return this._rankDataObj[e]},t.prototype.updateRankRewardDataObj=function(){this._rankRewardDataObj=[[],[]];var e=null;if(this._fullArmamentDayConfig)e=this._fullArmamentDayConfig.rank_reward;else{var t=s.TABLE.getTableByKey(l.TableName.full_armament_day);e=t[t.length-1].rank_reward}for(var a=e.split("|"),o=0;o<a.length;o++){var n={rankHigh:(c=a[o].split(","))[0],ranklow:c[1],reward:c[2],score:c[3]};this._rankRewardDataObj[0].push(n)}if(!this._rankRewardDataObj[1].length){var i=r.default.getDataConfigData(910044).split("|");for(o=0;o<i.length;o++){var c;n={rankHigh:(c=i[o].split(","))[0],ranklow:c[1],reward:c[2],score:c[3]};this._rankRewardDataObj[1].push(n)}}},t.prototype.getRankRewardDataObjByInde=function(e){var t=this._rankRewardDataObj[e];return t.length||(this.updateRankRewardDataObj(),t=this._rankRewardDataObj[e]),t},t.prototype.onFMessage_SUBPACK_EIGHT_COUNTRY_CHANGE_TASK=function(e){return this.askECStrongestLeaderData(),this.askRankData(),!0},t.prototype.onFMessage_SUBPACK_EIGHT_COUNTRY_STRONGEST_LEADER=function(e){var t=e.data;if(t.score&&(this._data.score=t.score),t.myRank&&(this._data.myRank=t.myRank),t.taskArray&&t.taskArray.length)for(var a=0;a<t.taskArray.length;a++)for(var o=0;o<this._data.taskArray.length;o++)t.taskArray[a].id==this._data.taskArray[o].id&&(this._data.taskArray[o].score=t.taskArray[a].score,this._data.taskArray[o].status=t.taskArray[a].status);return c.EVENT.emit("REQUEST_STRONGEST_LEADER_DATA_FINIFH"),!0},t.prototype.getReward=function(e){var t=this;n.NET.send(i.RequestId.EC_STRONGEST_LEADER_GET_REWARD,{task:e},this,function(a){if(0==a.s){var o=r.default.JSON_PARSE(a.d);if(o.reward&&Object.keys(o.reward).length){o.reward&&o.reward.resource&&o.ar&&(o.reward.resource.kvk_res=o.ar);var n={serverReward:o.reward};p.default.Instance().OpenUI(u.UIDataInfo.CommonRewardPanel,n)}for(var i=0;i<t._data.taskArray.length;i++)t._data.taskArray[i].id==e&&(t._data.taskArray[i].status=2);c.EVENT.emit("REQUEST_STRONGEST_LEADER_GET_REWARD_FINIFH",e),c.EVENT.emit("UPDATE_EC_STRONGEST_LEADER_RED_DOT")}})},t}(o.FMessageConnectionAbstract);a.default=h,h.Instance,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../Common/UIManager":"UIManager","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],AddRes:[function(e,t,a){"use strict";cc._RF.push(t,"0eb77xEFNVN84XfSrfBBHLZ","AddRes"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../Const/GameDefine"),i=e("../../Tools/GameTools"),r=e("../../../Core/Utils/UpdateSpriteFrame"),s=e("../../../Core/Utils/SetPosition"),l=e("../../Common/UIManager"),c=e("../../Common/LoadManager"),d=e("../../../Core/Common/LocalManager"),p=e("../../../fws/utils/X"),u=cc._decorator,h=u.ccclass,m=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.type=null,t.text=null,t.doubleNode=null,t}var a;return __extends(t,e),a=t,t.prototype.cpnLoad=function(){},t.prototype.InitData=function(e,t,a){var o=i.default.getResourceIcon(e);r.UpdateSpriteFrame(o,this.type),this.label.string=t,this.doubleNode.active=2==a,e==n.ResourceType.Power&&(this.text.node.active=!1);var s=i.default.getResourceName(e);this.text.string=s,e==n.ResourceType.sharkMoneyTreeBox&&(this.text.string=d.LOCAL.getText("coin_tree_001"));var l=this.cpnCallFunc(function(e){e.destroy()},this.node),c=cc.moveBy(.6,cc.v2(0,120)).easing(cc.easeOut(3)),p=cc.sequence(c,cc.delayTime(.3),cc.fadeOut(.4),l);this.node.runAction(p)},t.AddRes=function(e,t,o){c.LoadManager.loadPrefab("ea_prefab/item/AddRes",function(n,i){if(null==n){var r=cc.instantiate(i);l.default.Instance().popLayer.addChild(r),s.SetPosition(o,r),r.getComponent(a).InitData(e,t,1)}else p.log(n)})},t.AddResByWorldPos=function(e,t,o,n){c.LoadManager.loadPrefab("ea_prefab/item/AddRes",function(i,r){if(null==i){var s=cc.instantiate(r);l.default.Instance().tipsLayer.addChild(s),o=o.add(cc.v2(0,20)),o=s.parent.convertToNodeSpaceAR(o),s.setPosition(o),s.getComponent(a).InitData(e,t,n)}else p.log(i)})},__decorate([m(cc.Label)],t.prototype,"label",void 0),__decorate([m(cc.Sprite)],t.prototype,"type",void 0),__decorate([m(cc.Label)],t.prototype,"text",void 0),__decorate([m(cc.Node)],t.prototype,"doubleNode",void 0),t=a=__decorate([h],t)}(o.default);a.default=f,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Utils/SetPosition":"SetPosition","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../../fws/utils/X":"X","../../Common/LoadManager":"LoadManager","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Tools/GameTools":"GameTools"}],BattleItem:[function(e,t,a){"use strict";cc._RF.push(t,"7494cyCUw9Me4f/CLlvuQo6","BattleItem"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Utils/SetPosition"),n=e("../../../Core/Common/SoundManager"),i=e("../../Tools/GameTools"),r=e("../../Data/DataCenter"),s=e("../../Common/LoadManager"),l=e("../../Data/BattleData"),c=function(){function e(e,t,a,o){this.nodePos=null,this.BattleItemCoreData=e}return e.prototype.getUID=function(){if(this.roleType==d.Attacker){if(!i.default.ObjIsEmpty(r.DATA.CurBattleData)&&!i.default.ObjIsEmpty(r.DATA.CurBattleData.Attacker))return r.DATA.CurBattleData.Attacker.uid}else if(this.roleType==d.Defender&&!i.default.ObjIsEmpty(r.DATA.CurBattleData)&&!i.default.ObjIsEmpty(r.DATA.CurBattleData.Defender))return r.DATA.CurBattleData.Defender.uid;return 0},e.prototype.DoDie=function(){this.IsDie=!0,this.PlayDieEffect()},e.prototype.PlayDieEffect=function(){var e="effect/prefab/"+this.ModelData.die_effect,t=this.nodePos,a=this.pos;s.LoadManager.loadPrefab(e,function(e,n){if(!e&&!i.default.ObjIsEmpty(t)){var r=cc.instantiate(n);t.addChild(r),o.SetPosition(t,r,a)}}),n.SOUND.playClip(this.ModelData.die_sound)},e.prototype.PlayHurtedEffect=function(e){var t=e,a=this.nodePos,n=this.pos;s.LoadManager.loadPrefab(t,function(e,t){if(!e&&!i.default.ObjIsEmpty(a)){var r=cc.instantiate(t);a.addChild(r),o.SetPosition(a,r,n)}})},e.prototype.ToString=function(){return this.dataType.toString()+"=>"+this.id.toString()},e}();a.BattleItem=c;var d,p,u,h=function(){return function(e){this.parentData=e;var t=this.parentData.TableData.power,a=t;if(r.DATA.CurBattleData&&r.DATA.CurBattleData.Type===l.BattleType.Adventure_Boss){var o=r.DATA.UserData.AdventureData.CurrentStageData;o&&(e.roleType==d.Defender?(t=Math.floor(t*o.enemyhp_correction),a=Math.floor(a*o.enemyattack_correction)):a=Math.floor(a*o.selfattack_correction))}this.hp=t,this.maxHp=t,this.attack=a}}();a.BattleAttr=h,function(e){e.Attacker="Attacker",e.Defender="Defender"}(d||(d={})),a.RoleType=d,function(e){e.Army="Army",e.Building="Building",e.Hero="Hero"}(p||(p={})),a.DataType=p,function(e){e[e.Common=0]="Common",e[e.Dodge=1]="Dodge",e[e.Cri=2]="Cri",e[e.Kill=3]="Kill",e[e.CriKill=4]="CriKill"}(u||(u={})),cc._RF.pop()},{"../../../Core/Common/SoundManager":"SoundManager","../../../Core/Utils/SetPosition":"SetPosition","../../Common/LoadManager":"LoadManager","../../Data/BattleData":"BattleData","../../Data/DataCenter":"DataCenter","../../Tools/GameTools":"GameTools"}],ResFly:[function(e,t,a){"use strict";cc._RF.push(t,"ab626loP5hKrrbaGYJhNxH4","ResFly"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Const/GameDefine"),n=e("./ResFlyCompent"),i=e("../../../Core/Common/TableManager"),r=e("../../Const/TableName"),s=e("../../../Core/Common/SoundManager"),l=e("../../Const/SoundPath"),c=function(){function e(){}return e.FlyOneResource=function(t,a,o,i,r,s,l,c,d){void 0===d&&(d=1);var p=o;return e.AllRes.has(a)&&(n.default.ResFly(t,a,i,o,r,s,l,c,!0,d),p+=e.flyCD),p},e.FlyResource=function(t,a,n,i,r,s,l,c){void 0===c&&(c=1);var d=n;return a.coin&&(d=e.FlyOneResource(t,o.ResourceType.Coin,d,Math.ceil(a.coin),i,r,s,l,c)),a.gold&&(d=e.FlyOneResource(t,o.ResourceType.Gold,d,a.gold,i,r,s,l,c)),a.honor&&(d=e.FlyOneResource(t,o.ResourceType.Honor,d,a.honor,i,r,s,l,c)),d},e.FlyFromPos=function(t,a,c,d,p,u,h,m){void 0===c&&(c=1),void 0===d&&(d=0),void 0===p&&(p=null),void 0===u&&(u=null),void 0===h&&(h=null),void 0===m&&(m=1);var f=d;if(a&&(a.resource?e.FlyResource(t,a.resource,f,p,u,h,c,m):e.FlyResource(t,a,f,p,u,h,c,m),a.power&&e.FlyOneResource(t,o.ResourceType.Power,f,a.power,p,u,h,c,m),a.energy&&e.FlyOneResource(t,o.ResourceType.Energy,f,a.energy,p,u,h,c,m),a.exp&&(s.SOUND.playClip(l.SoundPath.Add_Exp),e.FlyOneResource(t,o.ResourceType.Exp,f,a.exp,p,u,h,c,m)),a.adventureBox&&e.FlyOneResource(t,o.ResourceType.AdventureRewardBox,f,a.adventureBox,p,u,h,c,m),a.army_id)){var _=i.TABLE.getTableDataById(r.TableName.ARMY,a.army_id.toString());n.default.ArmyFlyWithPos(t,_)}},e.GetFlyWorldPosByNode=function(e){return null==e||null==e.parent?null:e.parent.convertToWorldSpaceAR(e.position)},e.Fly=function(t,a,o,n,i,r,s,l){if(void 0===o&&(o=1),void 0===n&&(n=0),void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=1),null!=t&&null!=t.parent){var c=t.parent.convertToWorldSpaceAR(t.position);e.FlyFromPos(c,a,o,n,i,r,s,l)}},e.FlyCallBack=function(t,a,o){e.Fly(t,a,1,0,null,o)},e.AllRes=new Map,e.flyCD=1.2,e}();a.default=c,cc._RF.pop()},{"../../../Core/Common/SoundManager":"SoundManager","../../../Core/Common/TableManager":"TableManager","../../Const/GameDefine":"GameDefine","../../Const/SoundPath":"SoundPath","../../Const/TableName":"TableName","./ResFlyCompent":"ResFlyCompent"}],ResFlyCompent:[function(e,t,a){"use strict";cc._RF.push(t,"b063doAtPNFnZ+jeJfbbH/E","ResFlyCompent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../../Core/Utils/Random"),i=e("../../../Core/Utils/SetPosition"),r=e("../../Tools/GameTools"),s=e("../../../Core/Utils/UpdateSpriteFrame"),l=e("./ResFly"),c=e("../../../Core/Utils/GetCompentToAdd"),d=e("../Battle/AddRes"),p=e("../../Common/UIManager"),u=e("../../../Core/Common/SoundManager"),h=e("../../Const/SoundPath"),m=e("../../Const/GameDefine"),f=e("../../../Core/Common/TableManager"),_=e("../../Data/GameConst"),y=e("../../Scene/SceneManager"),g=e("../../Const/SceneName"),C=e("../../Common/LoadManager"),v=e("../../../fws/utils/X"),I=e("../../Const/TableName"),T=cc._decorator,S=T.ccclass,A=T.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._rewardRate=1,t.useAddRes=!0,t.iconNode=null,t.particleNode=null,t.particle=null,t.targetFlyToNode=null,t.targetFlyFromWorldPos=null,t.flyString=null,t.FlyCallBack=null,t}var a;return __extends(t,e),a=t,t.prototype.cpnLoad=function(){this.cpnNodeOn(this.node,cc.Node.EventType.TOUCH_START,this.PlayFly,this),this.cpnNodeOn(this.node,cc.Node.EventType.TOUCH_MOVE,this.PlayFly,this),this.cpnNodeOn(this.node,cc.Node.EventType.TOUCH_END,this.PlayFly,this),this.cpnNodeOn(this.node,cc.Node.EventType.TOUCH_CANCEL,this.PlayFly,this)},t.prototype.Play=function(e,t,o){this._tarPos=e,this._restype=t,this._text=o;var r=cc.moveBy(.36,cc.v2((1==n.GetRandomNum(1,2)?-1:1)*n.GetRandomNum(10,100),(1==n.GetRandomNum(1,2)?-1:1)*n.GetRandomNum(10,100))).easing(cc.easeOut(3)),s=this.cpnCallFunc(function(e){var t=e.getComponent(a);null!=t.targetFlyFromNode&&i.SetPosition(t.targetFlyFromNode,t.node),t.iconNode.active=!0,t._restype==m.ResourceType.Power?(t.particleNode&&(t.particleNode.active=!0),t.particle&&t.particle.resetSystem()):t.particleNode&&(t.particleNode.active=!1)},this.node),l=this.cpnCallFunc(function(e){e.getComponent(a).PlayFly()},this.node);if(this.delayTime>0){var c=cc.sequence(cc.delayTime(this.delayTime),s,r,l);this.node.runAction(c)}else if(this._restype==m.ResourceType.Power){c=cc.sequence(s,l);this.node.runAction(c)}else{c=cc.sequence(s,r,l);this.node.runAction(c)}},t.prototype.PlayArmy=function(e){this._tarPos=e;var t=this.cpnCallFunc(function(e){e.getComponent(a).PlayFly()},this.node);if(this.delayTime>0){var o=cc.sequence(cc.delayTime(this.delayTime),t);this.node.runAction(o)}else this.PlayFly()},t.prototype.PlayFly=function(){var e=this;null!=this.targetFlyFromWorldPos&&null!=this.flyString&&this.useAddRes&&this._restype!=m.ResourceType.Power&&d.default.AddResByWorldPos(this._restype,this.flyString,this.targetFlyFromWorldPos,this._rewardRate),null!=this.targetFlyToNode&&(this._tarPos=i.GetPosition(this.targetFlyToNode,this.node)),this.cpnNodeOff(cc.Node.EventType.TOUCH_START,this.PlayFly,this),this.cpnNodeOff(cc.Node.EventType.TOUCH_MOVE,this.PlayFly,this),this.cpnNodeOff(cc.Node.EventType.TOUCH_END,this.PlayFly,this),this.cpnNodeOff(cc.Node.EventType.TOUCH_CANCEL,this.PlayFly,this),this._restype,this.cpnNodeOff(cc.Node.EventType.MOUSE_ENTER,this.PlayFly,this),this.node.stopAllActions();var t=cc.moveTo(.6,this._tarPos).easing(cc.easeIn(.6)),o=this.cpnCallFunc(function(t){var o=t.getComponent(a),n=o._restype;if(n>0&&null==e.targetFlyToNode){var i=l.default.AllRes.get(n);if(i){var r=cc.repeat(cc.sequence(cc.scaleTo(.04,1.2,1.2),cc.scaleTo(.08,.8,.8),cc.scaleTo(.04,1,1)),1);i.scaleNode&&i.scaleNode.runAction(r),i.onShowEffect()}}null!=o.FlyCallBack&&o.FlyCallBack(),n!=m.ResourceType.Building&&n!=m.ResourceType.Item&&n!=m.ResourceType.Army?o.InPool():o.node.destroy()},this.node),n=cc.sequence(t,o);this.node.runAction(n)},t.prototype.InPool=function(){this.flyString=null,this.targetFlyFromWorldPos=null,this.targetFlyToNode=null,this.particleNode&&(this.particleNode.active=!1);var e=a.resFlyingPool.indexOf(this);-1!=e&&a.resFlyingPool.splice(e,1),a.resFlyPool.push(this),this.node.stopAllActions(),this.node.parent=p.default.Instance().flyLayer,this.node.opacity=0},t.purge=function(){a.resFlyPool.splice(0,a.resFlyPool.length),a.resFlyingPool.splice(0,a.resFlyingPool.length)},t.prototype.cpnDestroy=function(){var e=a.resFlyingPool.indexOf(this);-1!=e&&a.resFlyingPool.splice(e,1)},t.ResFly=function(e,t,o,n,i,r,s,l,c,d){if(void 0===n&&(n=0),void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=1),void 0===c&&(c=!0),void 0===d&&(d=1),0!=o){if(a.resFlyingPool.length>=a.maxPoolNum)return;switch(t){case m.ResourceType.Coin:y.default.Instance().CurSceneName===g.SceneName.HOME&&(-1!=a.coinPlayId&&(cc.audioEngine.stopEffect(a.coinPlayId),a.coinPlayId=-1),u.SOUND.playClip(h.SoundPath.Coin_Get,null,function(e){a.coinPlayId=e}));break;case m.ResourceType.Wood:u.SOUND.playClip(h.SoundPath.Wood_Get);break;case m.ResourceType.Oil:u.SOUND.playClip(h.SoundPath.Oil_Get);break;case m.ResourceType.Gold:u.SOUND.playClip(h.SoundPath.Gold_Get);break;case m.ResourceType.Exp:u.SOUND.playClip(h.SoundPath.Exp_Get);break;default:u.SOUND.playClip(h.SoundPath.OtherRes_Get)}null==a.resFlyPrefabNood?C.LoadManager.loadPrefab("ea_prefab/item/ResFly",function(p,u){p?v.log(p):(a.resFlyPrefabNood=u,a.ResFlyTO(o,t,i,e,n,r,s,l,c,d))}):a.ResFlyTO(o,t,i,e,n,r,s,l,c,d)}else v.log("fly changeValue nil")},t.ResFlyTO=function(e,t,o,n,d,u,h,f,y,g){void 0===u&&(u=null),void 0===h&&(h=null),void 0===f&&(f=1),void 0===y&&(y=!0),void 0===g&&(g=1);var C=_.GetResNum(e);t==m.ResourceType.Power&&C<7&&C++,t==m.ResourceType.Gold&&(C=_.GetGoldNum(e));for(var v=Math.floor(e/C),I=e,T=1==C?0:.36/(C-1),S=0;S<C;S++)if(S==C-1&&(v=e),a.resFlyingPool.length>a.maxPoolNum)0==S&&null!=u&&u();else{var A=null;if(a.resFlyPool.length>0){var D=a.resFlyPool.pop();if(!D)continue;if(!(A=D.node))continue;A.opacity=255}else A=cc.instantiate(a.resFlyPrefabNood);if(r.default.verifyNode(A)){A.stopAllActions(),A.setScale(g);var N=c.GetCompentToAdd(A,"ResFlyCompent");A.getComponentInChildren(cc.Animation).enabled=t==m.ResourceType.Coin;var b=r.default.getResourceIcon(t);s.UpdateSpriteFrame(b,A.getComponentInChildren(cc.Sprite));var L=o;if(!r.default.verifyNode(L)){var E=l.default.AllRes.get(t);L=E?E.node:null}r.default.verifyNode(h)?A.setParent(h):null!=p.default.Instance().HomeMap&&null!=o?A.setParent(p.default.Instance().HomeMap.resFlyNode):A.setParent(L),i.SetPositionByWorldPos(n,A);a.resFlyingPool.push(N),0==S&&(N.FlyCallBack=u),null==o&&S==C-1&&t>0&&(N.flyString="+"+r.default.GetLargeNumberShow(I));var P=i.GetPosition(L,A);N.iconNode.active=!1,N.particleNode&&(N.particleNode.active=!1),N.targetFlyToNode=o,N.delayTime=d+T*S,N.targetFlyFromWorldPos=n,N._rewardRate=f,N.useAddRes=y,N.Play(P,t,v),e-=v}}},t.ArmyFlyWithPos=function(e,t){C.LoadManager.loadPrefab("ea_prefab/item/ResFly",function(a,o){if(a)v.log(a);else if(r.default.verifyComponent(p.default.Instance().MainUI)){var n=cc.instantiate(o);p.default.Instance().popLayer.addChild(n),i.SetPositionByWorldPos(e,n),r.default.UpdateArmyIcon(t,n.getComponent(cc.Sprite));var s=i.GetPosition(p.default.Instance().MainUI.bagNode,n);c.GetCompentToAdd(n,"ResFlyCompent").PlayArmy(s)}})},t.ArmyFly=function(e,t){var o=i.GetWorldPosPosition(e);a.ArmyFlyWithPos(o,t)},t.ItemFly=function(e,t){var a=i.GetWorldPosPosition(e),o=l.default.AllRes.get(m.ResourceType.Item);r.default.verifyComponent(o)&&C.LoadManager.loadPrefab("ea_prefab/item/ResFly",function(e,n){if(e)v.log(e);else{var l=cc.instantiate(n);p.default.Instance().popLayer.addChild(l),i.SetPositionByWorldPos(a,l);var d=f.TABLE.getTableDataById(I.TableName.ITEM,t.toString());r.default.ObjIsEmpty(d)||s.UpdateSpriteFrame(d.icon,l.getComponent(cc.Sprite));var u=c.GetCompentToAdd(l,"ResFlyCompent"),h=i.GetPosition(o.node,l);u.Play(h,m.ResourceType.Item,1)}})},t.BuildFly=function(e,t){var a=l.default.AllRes.get(m.ResourceType.Item);r.default.verifyComponent(a)&&C.LoadManager.loadPrefab("ea_prefab/item/ResFlyExp",function(o,n){if(o)v.log(o);else{var s=cc.instantiate(n);p.default.Instance().popLayer.addChild(s),i.SetPositionByWorldPos(e,s);var l=f.TABLE.getTableDataById(I.TableName.BUILDING,t.toString()),d=c.GetCompentToAdd(s,"ResFlyCompent");r.default.UpdateBuildingIcon(l,s.getComponentInChildren(cc.Sprite));var u=i.GetPosition(a.node,s);d._restype=m.ResourceType.Building,d.PlayArmy(u)}})},t.resFlyPool=new Array,t.resFlyingPool=new Array,t.maxPoolNum=30,t.resFlyPrefabNood=null,t.coinPlayId=-1,__decorate([A(cc.Node)],t.prototype,"iconNode",void 0),__decorate([A(cc.Node)],t.prototype,"particleNode",void 0),__decorate([A(cc.ParticleSystem)],t.prototype,"particle",void 0),t=a=__decorate([S],t)}(o.default);a.default=D,cc._RF.pop()},{"../../../Core/Common/SoundManager":"SoundManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Utils/GetCompentToAdd":"GetCompentToAdd","../../../Core/Utils/Random":"Random","../../../Core/Utils/SetPosition":"SetPosition","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../../fws/utils/X":"X","../../Common/LoadManager":"LoadManager","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Const/SceneName":"SceneName","../../Const/SoundPath":"SoundPath","../../Const/TableName":"TableName","../../Data/GameConst":"GameConst","../../Scene/SceneManager":"SceneManager","../../Tools/GameTools":"GameTools","../Battle/AddRes":"AddRes","./ResFly":"ResFly"}],Worker:[function(e,t,a){"use strict";cc._RF.push(t,"b2155Hb1KxBjpE7JA23z3zt","Worker"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../Const/GameDefine"),i=e("../../../fws/display/FWSComponent"),r=e("../../Tools/GameTools"),s=e("../../Common/UIManager"),l=e("../../controllers/WorkerController"),c=e("../../../fws/utils/FWSTool"),d=e("../../Data/DataCenter"),p=e("../../Data/GuideData"),u=e("../../Const/UIDataInfo"),h=e("../../Data/GameConst"),m=e("../../Common/BIManager"),f=e("../../../fws/utils/LocalStorageUtils"),_=e("../../../fws/utils/X"),y=e("../../../fws/platforms/PlatformCore"),g=e("../../Common/Tutorial"),C=e("../../../fws/platforms/AIEventDefine"),v=cc._decorator,I=v.ccclass,T=v.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BaseNode=null,t.WorkBaseNode=null,t.IdleBaseNode=null,t.StartBtn=null,t.StartNode=null,t.HelpNode=null,t.GuideNode=null,t._autoCollectBuildingID=1801,t._tobeWorkContent=null,t._workDirStr=null,t._isUpdateZIndex=!1,t}return __extends(t,e),t.prototype.cpnStart=function(){this.HelpNode.getComponent(cc.Animation).play("peopleHelp")},t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this)},t.prototype.PlayAnime=function(e){_.log("Worker-playAnime:"+e),this.WorkBaseNode&&(this.WorkBaseNode.active=!1),this.IdleBaseNode&&(this.IdleBaseNode.active=!1),this.BaseNode.active=!0;for(var t,a=this.BaseNode.children,o=null,n=0;n<a.length;n++){var i=a[n];i.name==e?(i.active=!0,o=i):i.active=!1}o&&(l.WorkerController.Instance.useNewWorkeModel()?(t=o.getComponent(cc.Animation))&&t.play(this.getAnimeNameByDir(e)):null!=o&&(t=o.getChildByName(e).getComponent(cc.Animation)).play(this.getAnimeNameByDir(e)))},t.prototype.getAnimeNameByDir=function(e){var t=e;return l.WorkerController.Instance.useNewWorkeModel()?(e==n.WorkerDir.Up?t="A_xiuligong_run_shang":e==n.WorkerDir.LeftUp||e==n.WorkerDir.RightUp?t="A_xiuligong_run_zuoshang":e==n.WorkerDir.Left||e==n.WorkerDir.Right?t="A_xiuligong_run_zuo":e==n.WorkerDir.LeftDown||e==n.WorkerDir.RightDown?t="A_xiuligong_run_zuoxia":e==n.WorkerDir.Down&&(t="A_xiuligong_run_xia"),t):(e==n.WorkerDir.Up?t="moveUp":e==n.WorkerDir.LeftUp||e==n.WorkerDir.RightUp?t="moveLeftUp":e==n.WorkerDir.Left||e==n.WorkerDir.Right?t="moveLeft":e==n.WorkerDir.LeftDown||e==n.WorkerDir.RightDown?t="moveLeftDown":e==n.WorkerDir.Down&&(t="moveDown"),t)},t.prototype.PlayWorkAnime=function(e){_.log("Worker-playAnime:"+e),this.WorkBaseNode.active=!0,this.BaseNode.active=!1,this.IdleBaseNode.active=!1;for(var t=this.WorkBaseNode.children,a=null,o=0;o<t.length;o++){var n=t[o];n.name==e?(n.active=!0,a=n):n.active=!1}if(a){var i=a.getComponent(cc.Animation);i&&i.play(this.getWorkAnimeNameByDir(e))}},t.prototype.getWorkAnimeNameByDir=function(e){var t=e;return e==n.WorkerDir.Up?t="A_xiuligong_work_shang":e==n.WorkerDir.LeftUp||e==n.WorkerDir.RightUp?t="A_xiuligong_work_zuoshang":e==n.WorkerDir.Left||e==n.WorkerDir.Right?t="A_xiuligong_work_zuo":e==n.WorkerDir.LeftDown||e==n.WorkerDir.RightDown?t="A_xiuligong_work_zuoxia":e==n.WorkerDir.Down&&(t="A_xiuligong_work_xia"),t},t.prototype.PlayIdleAnime=function(e){_.log("Worker-playAnime:"+e),this.WorkBaseNode.active=!1,this.IdleBaseNode.active=!0,this.BaseNode.active=!1;for(var t=this.IdleBaseNode.children,a=null,o=0;o<t.length;o++){var n=t[o];n.name==e?(n.active=!0,a=n):n.active=!1}if(a){var i=a.getComponent(cc.Animation);i&&i.play(this.getIdleAnimeNameByDir(e))}},t.prototype.getIdleAnimeNameByDir=function(e){var t=e;return e==n.WorkerDir.Up?t="A_xiuligong_daiji_shang":e==n.WorkerDir.LeftUp||e==n.WorkerDir.RightUp?t="A_xiuligong_daiji_zuoshang":e==n.WorkerDir.Left||e==n.WorkerDir.Right?t="A_xiuligong_daiji_zuo":e==n.WorkerDir.LeftDown||e==n.WorkerDir.RightDown?t="A_xiuligong_daiji_zuoxia":e==n.WorkerDir.Down&&(t="A_xiuligong_daiji_xia"),t},t.prototype.OnGameStartClick=function(){if(g.default.Instance.CheckClickTarget(this.StartBtn),!p.default.getInst().checkGuideTips([n.GuideState.Help])){y.instance.postStatsEvent("guide_touch_worker"),l.WorkerController.Instance.setCanWork(!1),l.WorkerController.Instance.setSaved(!0),_.log("gameStarttttttt");var e=d.DATA.UserData.UID.toString()+"_WorkerSaved";f.set(e,"1"),this.HelpNode.active=!1,this.StartBtn.active=!1;var t=this.StartNode.getChildByName("people").getComponent(cc.Animation);t.on("stop",this.StartAnimeFinishCall,this),l.WorkerController.Instance.useNewWorkeModel()?t.play("A_xiuligong_stand_zuoxia"):t.play("peopleMove"),C.TutorialRecoder.sendTutorialMsg(6),p.default.getInst().GuideStep==n.GuideState.Help&&(r.default.useGuide200605()||m.default.Instance.PostUserGuide({guideid:"7301"})),p.default.getInst().changeGuideSetp()}},t.prototype.StartAnimeFinishCall=function(){r.default.useGuide200605()?s.default.Instance().OpenUI(u.UIDataInfo.NpcNoticeG123Panel,{step:1,name:o.LOCAL.getText("g123_tutorial_name_02"),content:o.LOCAL.getText("g123_tutorial_011"),pic:"hero_tachie001",sound:"tutorial_012"}):s.default.Instance().OpenUI(u.UIDataInfo.NpcNoticePanel,{id:1,type:0,txt:o.LOCAL.getText("100244")}),_.log("StartAnimeFinishCallStartAnimeFinishCallStartAnimeFinishCall"),this.StartNode.getChildByName("people").getComponent(cc.Animation).off("stop",this.StartAnimeFinishCall,this),l.WorkerController.Instance.useNewWorkeModel()?this.PlayIdleAnime(n.WorkerDir.LeftDown):this.PlayAnime(n.WorkerDir.LeftUp),this.StartNode.active=!1,l.WorkerController.Instance.setCanWork(!0),r.default.useGuide200605()||m.default.Instance.PostUserGuide({guideid:"10005"})},t.prototype.onFMessage_WorkerMsgsMoveToAutoCollectBuilding=function(e){return this.moveToAutoCollectBuildingAndHide(),!0},t.prototype.onFMessage_WorkerMsgsMoveToWork=function(e){if(null===s.default.Instance().HomeMap)return!0;this.node.active=!0,this.node.stopAllActions(),this.cpnUnschedule(this.moveToAutoCollectBuildingAndHide),this._tobeWorkContent=e.data;var t=this.getWorkMoveEndPosAndSetMoveDir(),a=this.node.position,o=.005*t.sub(a).mag();o=Math.min(1.5,o);var n=cc.moveTo(o,t),i=this.cpnCallFunc(this.workMoveToEnd,this),l=cc.sequence(n,i);return this.node.zIndex=h.default.WORKE_SHOW_ZINDEX,this.node.active=!0,this.node.runAction(l),this._isUpdateZIndex=!0,r.default.verifyComponent(s.default.Instance().MainUI)&&s.default.Instance().MainUI.setWorkStopNodeShow(!0),!0},t.prototype.onFMessage_WorkerMsgsWorkFinished=function(e){return this._tobeWorkContent=null,this.node.stopAllActions(),this._isUpdateZIndex=!1,l.WorkerController.Instance.useNewWorkeModel()&&this.PlayIdleAnime(this._workDirStr),r.default.verifyComponent(s.default.Instance().MainUI)&&s.default.Instance().MainUI.setWorkStopNodeShow(!1),!0},t.prototype.onFMessage_WorkerMsgsStopWork=function(e){this._tobeWorkContent=null,this.node.stopAllActions(),this._isUpdateZIndex=!1,r.default.verifyComponent(s.default.Instance().MainUI)&&s.default.Instance().MainUI.setWorkStopNodeShow(!1);return this.cpnUnschedule(this.moveToAutoCollectBuildingAndHide),this.cpnScheduleOnce(this,this.moveToAutoCollectBuildingAndHide,2),!0},t.prototype.moveToAutoCollectBuildingAndHide=function(){var e=s.default.Instance().HomeMap.getBuildingItemByBuildingId(this._autoCollectBuildingID,!1);if(e&&1!==e.BuildingData.Broken){var t=e.getCenterPointPosInMap(),a=this.getMoveEndPosAndSetMoveDir(t,null),o=this.node.position,n=.005*a.sub(o).mag(),i=cc.moveTo(n,a),r=this.cpnCallFunc(this.hideMoveToEnd,this),l=cc.sequence(i,r);this.node.runAction(l),this._isUpdateZIndex=!0}},t.prototype.hideMoveToEnd=function(){l.WorkerController.Instance.useNewWorkeModel()&&this.PlayIdleAnime(this._workDirStr),this.node.stopAllActions(),this._isUpdateZIndex=!1,this.node.zIndex=h.default.WORKE_HIDE_ZINDEX},t.prototype.workMoveToEnd=function(){if(l.WorkerController.Instance.useNewWorkeModel()?this.PlayWorkAnime(this._workDirStr):this.PlayAnime(this._workDirStr),null!==s.default.Instance().HomeMap)if(c.Obj.isEmpty(this._tobeWorkContent))l.WorkerController.Instance.workFinished();else try{var e=this._tobeWorkContent.moveToEndCallbackHandler;e.handler.call(e.target,e.data)}catch(e){l.WorkerController.Instance.workFinished()}else l.WorkerController.Instance.workError()},t.prototype.getMoveEndPosAndSetMoveDir=function(e,t){var a=this.node.position,o=e,n=o.sub(a),i=Math.atan2(n.y,n.x)/Math.PI*180,r=this.getDirByAngle(i),s=r;if(!c.Obj.isEmpty(t)&&!c.Obj.isEmpty(t[r])){var l=t[s];o.addSelf(l);var d=o.sub(a),p=Math.atan2(d.y,d.x)/Math.PI*180;s=this.getDirByAngle(p)}return this._workDirStr=r,this.PlayAnime(s),o},t.prototype.getWorkMoveEndPosAndSetMoveDir=function(){var e=this._tobeWorkContent.workPos,t=this._tobeWorkContent.workPosOffset;return this.getMoveEndPosAndSetMoveDir(e,t)},t.prototype.getDirByAngle=function(e){var t;return e>=-22.5&&e<22.5?t=n.WorkerDir.Right:e>=22.5&&e<67.5?t=n.WorkerDir.RightUp:e>=67.5&&e<112.5?t=n.WorkerDir.Up:e>=112.5&&e<157.5?t=n.WorkerDir.LeftUp:e>=157.5||e<-157.5?t=n.WorkerDir.Left:e>=-157.5&&e<-112.5?t=n.WorkerDir.LeftDown:e>=-112.5&&e<-67.5?t=n.WorkerDir.Down:e>=-67.5&&e<-22.5&&(t=n.WorkerDir.RightDown),t},t.prototype.setMoveDir=function(e){var t=this.node.position,a=e.sub(t),o=Math.atan2(a.y,a.x)/Math.PI*180,i=null;o>=-22.5&&o<22.5?i=n.WorkerDir.Right:o>=22.5&&o<67.5?i=n.WorkerDir.RightUp:o>=67.5&&o<112.5?i=n.WorkerDir.Up:o>=112.5&&o<157.5?i=n.WorkerDir.LeftUp:o>=157.5||o<-157.5?i=n.WorkerDir.Left:o>=-157.5&&o<-112.5?i=n.WorkerDir.LeftDown:o>=-112.5&&o<-67.5?i=n.WorkerDir.Down:o>=-67.5&&o<-22.5&&(i=n.WorkerDir.RightDown),null!==i&&this.PlayAnime(i)},t.prototype.init=function(){var e=s.default.Instance().HomeMap.getBuildingItemByBuildingId(this._autoCollectBuildingID,!1);if(e&&1!==e.BuildingData.Broken){var t=e.getCenterPointPosInMap();this.node.position=t,this.node.zIndex=h.default.WORKE_HIDE_ZINDEX}},t.prototype.hideWorker=function(){this.node.active=!1,this.node.zIndex=h.default.WORKE_HIDE_ZINDEX},t.prototype.guideShowWorker=function(){l.WorkerController.Instance.setCanWork(!1),this.node.active=!0,this.node.zIndex=h.default.WORKE_SHOW_ZINDEX},t.prototype.cpnUpdate100MS=function(e){},__decorate([T(cc.Node)],t.prototype,"BaseNode",void 0),__decorate([T(cc.Node)],t.prototype,"WorkBaseNode",void 0),__decorate([T(cc.Node)],t.prototype,"IdleBaseNode",void 0),__decorate([T(cc.Node)],t.prototype,"StartBtn",void 0),__decorate([T(cc.Node)],t.prototype,"StartNode",void 0),__decorate([T(cc.Node)],t.prototype,"HelpNode",void 0),__decorate([T(cc.Node)],t.prototype,"GuideNode",void 0),t=__decorate([I],t)}(i.default);a.default=S,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../fws/display/FWSComponent":"FWSComponent","../../../fws/platforms/AIEventDefine":"AIEventDefine","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../../fws/utils/X":"X","../../Common/BIManager":"BIManager","../../Common/Tutorial":"Tutorial","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Data/GameConst":"GameConst","../../Data/GuideData":"GuideData","../../Tools/GameTools":"GameTools","../../controllers/WorkerController":"WorkerController"}],EffectPlay:[function(e,t,a){"use strict";cc._RF.push(t,"66124g3dupBMYyMvcsukW1z","EffectPlay"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=cc._decorator,i=n.ccclass,r=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.particleSys=null,t.ani=null,t.AutoDestroy=!0,t}return __extends(t,e),t.prototype.callback=function(){this.callbackHandler&&this.callbackHandler.call(this.callbackTarget)},t.prototype.cpnLoad=function(){null==this.ani&&(this.ani=this.getComponent(cc.Animation),null==this.ani&&(this.ani=this.getComponentInChildren(cc.Animation))),null==this.particleSys&&(this.particleSys=this.getComponent(cc.ParticleSystem),null==this.particleSys&&(this.particleSys=this.getComponentInChildren(cc.ParticleSystem))),this.AutoDestroy&&(this.particleSys?this.cpnScheduleOnce(this,this.PlayEnd,this.particleSys.duration):this.ani&&this.ani.on("finished",this.PlayEnd,this))},t.prototype.PlayEnd=function(){this.callback(),this.AutoDestroy?this.node.destroy():this.node.active=!1},t.prototype.RePlay=function(){this.node.active=!0,this.particleSys&&this.particleSys.resetSystem(),this.ani&&this.ani.resume()},__decorate([r(cc.ParticleSystem)],t.prototype,"particleSys",void 0),__decorate([r(cc.Animation)],t.prototype,"ani",void 0),__decorate([r],t.prototype,"AutoDestroy",void 0),t=__decorate([i],t)}(o.default);a.default=s,cc._RF.pop()},{"../../../System/ComponentBase":"ComponentBase"}],EffectTitlePrefab:[function(e,t,a){"use strict";cc._RF.push(t,"2fe30aLDS1HXYIVXiesf9eL","EffectTitlePrefab"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=cc._decorator,i=n.ccclass,r=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shortLabel=null,t.anim=null,t}return __extends(t,e),t.prototype.Init=function(e,t){this.shortLabel.string=e},t.prototype.playAnim=function(){this.anim.play("A_gongxihuode_touxian")},__decorate([r(cc.Label)],t.prototype,"shortLabel",void 0),__decorate([r(cc.Animation)],t.prototype,"anim",void 0),t=__decorate([i],t)}(o.default);a.default=s,cc._RF.pop()},{"../../../System/ComponentBase":"ComponentBase"}],HeadquartersItem:[function(e,t,a){"use strict";cc._RF.push(t,"2adfbyerUhGAqnBMRJg+aVd","HeadquartersItem"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../../System/ComponentBase"),i=e("../../Const/EventId"),r=e("../../../Core/Event/EventCenter"),s=e("../../Data/DataCenter"),l=e("../../../Core/Common/TableManager"),c=e("../../Common/UIManager"),d=e("../../Common/TaskGuide"),p=e("../../Const/GameDefine"),u=e("../../../fws/utils/X"),h=e("../../Const/TableName"),m=e("../../controllers/ScienceController"),f=e("../../Tools/GameTools"),_=e("../../../Core/Utils/UpdateSpriteFrame"),y=e("../../Const/UIDataInfo"),g=e("../../Const/RequestId"),C=e("../../../Core/Net/NetMgr"),v=cc._decorator,I=v.ccclass,T=v.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BaseNode=null,t.LockNode=null,t.preScienceNode=null,t.resNode=null,t.EffectNode=null,t.LabName=null,t.LabLevel=null,t.Icon=null,t.RedPoint=null,t.iconSign=null,t.signImages=[],t.unLockLabel=null,t.unlockIcon=null,t.unlockImages=[],t.LabLevelAfter=null,t.preNameLabel=null,t.levelUpBtnNode=null,t.ItemIcon=null,t.ItemIconBg=null,t.LabItem=null,t.LabCoin=null,t.getItemButton=null,t.getCoinButton=null,t.LabDesc=null,t.coinEnoughNode=null,t.itemEnoughNode=null,t.lastScienceIcon=null,t.lastScienceSign=null,t._ScienceId=0,t._ScienceData=null,t._ConditionScience=null,t._ScienceLocked=!1,t._lastLockState=!1,t._ScienceLockTips="",t._scienceIds=null,t._LastScienceId=-1,t._itemNumNeed=0,t._unlockAnime=!1,t._isBtnClicking=!1,t._CoinNeedWithoutBuff=0,t._scienceMaxLevel=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"ScienceLocked",{get:function(){return this._ScienceLocked},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ConditionScience",{get:function(){return this._ConditionScience},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScienceId",{get:function(){return this._ScienceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScienceData",{get:function(){return this._ScienceData},enumerable:!0,configurable:!0}),t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),r.EVENT.on(i.EventId.Resource_Update,this.updateRedPoint,this),r.EVENT.on(i.EventId.Item_Update,this.updateRedPoint,this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),r.EVENT.off(i.EventId.Resource_Update,this.updateRedPoint,this),r.EVENT.off(i.EventId.Item_Update,this.updateRedPoint,this)},t.prototype.updateItem=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=-1),this.BaseNode.active=null!=e,this._isBtnClicking=!1,this._ScienceData=e,e){this._ScienceId=e.id,this._ScienceLockTips="",this._scienceIds=null;var a=e.unlock_level;this._ConditionScience=null,this._lastLockState=this._ScienceLocked,this._ScienceLocked=!1,this.node.name=e.group_id.toString(),d.default.Instance.AddGuideDelegate(this.node);var n=s.DATA.UserData.getScienceByGroupId(this.ScienceData.group_id),i=!1;if(null!=n&&n.ScienceId==this._ScienceId&&(i=!0),this._scienceMaxLevel=i,s.DATA.UserData.Level<a||0==e.is_open||1==i)if(this._ScienceLocked=0==i,0==e.is_open)this._ScienceLockTips=o.LOCAL.getText("100289");else{var r=l.TABLE.getTableDataById(h.TableName.DATACONFIG,"2008").value;this._ScienceLockTips=a>r||i?o.LOCAL.getText("100290"):o.LOCAL.getText("100090",a.toString())}else if(0!=parseInt(e.condition_science))for(var c=(e.condition_science+"").split(","),p=0;p<c.length;p++){var u=l.TABLE.getTableDataById(h.TableName.SCIENCE_V1,c[p]);if(void 0!=u){this._ConditionScience=u;var f=s.DATA.UserData.getScienceByGroupId(this.ConditionScience.group_id);if(null==f||f.Data.level<this.ConditionScience.level){this._ScienceLocked=!0;var _=m.default.GuideLearnScience(e.group_id);_&&0!=_.length?this._scienceIds=_:this._ScienceLockTips=o.LOCAL.getText("100291",o.LOCAL.getText(this.ConditionScience.name)+"]"+this.ConditionScience.level.toString());break}}}this.LockNode&&(this.LockNode.active=this._ScienceLocked),this.unlockIcon&&(this.unlockIcon.spriteFrame=null),this.iconSign&&(this.iconSign.node.active=!0,this.iconSign.spriteFrame=null,this.signImages[this._ScienceData.type-1]&&(this.iconSign.spriteFrame=this.signImages[this._ScienceData.type-1])),this.LabName&&(this.LabName.string=o.LOCAL.getText(e.name),this.LabLevel.string=o.LOCAL.getText("name_001",e.level.toString()));var y=this;if(y.Icon.node.active=!0,this._LastScienceId!=e.id&&(this._LastScienceId=e.id,m.default.UpdateHeadquartersIcon(e,y.Icon,function(){y.Icon.setState(cc.Sprite.State.NORMAL)})),this.LabLevelAfter&&33e4==e.group_id&&(this.LabLevelAfter.string=e.level.toString()),this.resNode&&(this.resNode.active=!this._scienceIds),this.updateRedPoint(),this.LabDesc&&(this.LabDesc.string=o.LOCAL.getText(e.desc,String(e.level))),this.lastScienceIcon&&this.lastScienceSign)if(this._scienceIds){if(this.preScienceNode.active=!0,this._scienceIds.conditions.length&&this._scienceIds.conditions[0].id){var g=this._scienceIds.conditions[0].id,C=l.TABLE.getTableDataById(h.TableName.SCIENCE_V1,g.toString());if(C){var v=this;m.default.UpdateHeadquartersIcon(C,this.lastScienceIcon,function(){v.lastScienceIcon.setState(cc.Sprite.State.NORMAL)}),this.signImages[C.type-1]?this.lastScienceSign.spriteFrame=this.signImages[C.type-1]:this.lastScienceSign.spriteFrame=null,this.preNameLabel.string=o.LOCAL.getText(C.name)+o.LOCAL.getText("name_001",C.level.toString())}}}else this.preScienceNode.active=!1}},t.prototype.updateRedPoint=function(){if(this.ScienceData){var e=this.updateItemAndReturnEnough(),t=this.updateCoinAndReturnEnough();e&&t&&0==this._ScienceLocked&&0==this._scienceMaxLevel?(this.RedPoint&&(this.RedPoint.active=!0),this.LabName&&(this.LabName.node.color=(new cc.Color).fromHEX("#000000"),this.LabLevel.node.color=(new cc.Color).fromHEX("#ffffff")),this.levelUpBtnNode&&(this.levelUpBtnNode.stopAllActions(),this.levelUpBtnNode.active=!0,this.levelUpBtnNode.runAction(cc.repeatForever(cc.sequence(cc.repeat(cc.sequence(cc.scaleTo(.4,1.1),cc.scaleTo(.4,1)),4),cc.delayTime(3)))))):(this.levelUpBtnNode&&(this.levelUpBtnNode.active=!1),this.RedPoint&&(this.RedPoint.active=!1),this.LabName&&(this._ScienceLocked?(this.LabName.node.color=(new cc.Color).fromHEX("#000000"),this.LabLevel.node.color=(new cc.Color).fromHEX("#ffffff")):(this.LabName.node.color=(new cc.Color).fromHEX("#860202"),this.LabLevel.node.color=(new cc.Color).fromHEX("#ff6666")),this.unLockLabel.string="",""!=this._ScienceLockTips&&(this.unLockLabel.string=o.LOCAL.getText("101104"),this.LabName.string="",this.LabLevel.string="")))}},t.prototype.updateItemAndReturnEnough=function(){if(this.ScienceData){var e=!0,t=l.TABLE.getTableDataById(h.TableName.ITEM,this.ScienceData.item_id.toString());if(null!=t){var a=this.ScienceData.item_amount,o=s.DATA.UserData.getItemAmount(this.ScienceData.item_id);if(a>o&&(e=!1),this._ItemId=this.ScienceData.item_id,this._itemNumNeed=a,this.LabItem&&this.ItemIcon&&this.ItemIconBg){this.UpdateRichTextData(a,o,this.LabItem),_.UpdateSpriteFrame(t.icon,this.ItemIcon);var n=f.default.getNomalBgStrByQuality(t.quality);_.UpdateSpriteFrame(n,this.ItemIconBg),this.getItemButton.node.active=!e}}return this.itemEnoughNode&&(this.itemEnoughNode.active=e),e}},t.prototype.updateCoinAndReturnEnough=function(){if(this.ScienceData){var e=!0,t=m.default.getScienceLevelUpCoin(this.ScienceData);this._CoinNeedWithoutBuff=t,s.DATA.UserData.FunctionOn(p.FunctionKey.key_novice_adjustments)&&(this._CoinNeedWithoutBuff+=this.ScienceData.exp);var a=s.DATA.UserData.Resource.getResource(p.ResourceType.Coin);return t>a&&(e=!1),this.LabCoin&&this.getCoinButton&&(this.UpdateRichTextData(t,a,this.LabCoin),this.getCoinButton.node.active=!e),this.coinEnoughNode&&(this.coinEnoughNode.active=e),e}},t.prototype.UpdateRichTextData=function(e,t,a){var o=a.getChildByName("Label1"),n=a.getChildByName("Label2"),i=f.default.GetLargeNumberShow(t);o.getComponent(cc.Label).string=i,t<e?(o.color=cc.color(250,88,43),n.color=cc.color(255,255,255)):(o.color=cc.color(137,235,106),n.color=cc.color(137,235,106)),n.getComponent(cc.Label).string="/"+f.default.GetLargeNumberShow(e)},t.prototype.isLock=function(){return""!=this._ScienceLockTips},t.prototype.updateAllLineLock=function(e){this.unlockIcon&&this.unlockImages[e]&&(this.iconSign.node.active=!1,this.Icon.node.active=!1,this.unlockIcon.spriteFrame=this.unlockImages[e])},t.prototype.playLightEffect=function(e,t){if(!this.ScienceData)return!1;if(this._lastLockState&&0==this.ScienceLocked&&33e4!=this.ScienceData.group_id&&(this._unlockAnime=!0),e>0){if(e==this.ScienceData.group_id&&33e4==this.ScienceData.group_id)return this.cpnScheduleOnce(this,this.playEffect,t),!0;if(this._unlockAnime)return this._unlockAnime=!1,this.cpnScheduleOnce(this,this.playEffect,t),!0}return!1},t.prototype.playEffect=function(){f.default.verifyComponent(this)&&this.EffectNode&&(this.EffectNode.active=!1,this.EffectNode.active=!0,this.EffectNode.getComponent(cc.Animation).play())},t.prototype.OnScienceItemClick=function(){if(""==this._ScienceLockTips){if(1==this._ScienceLocked&&this._scienceIds)if(this._ScienceData&&this._ScienceData.group_id){var e=m.default.GuideLearnScience(this._ScienceData.group_id);e&&0!=e.length&&m.default.openScienceLearnPanel(e,null)}else u.log("\u6253\u5f00\u79d1\u6280\u5b66\u4e60\u9762\u677f  \u53c2\u6570\u9519\u8bef");0==this.ScienceLocked&&m.default.openScienceLearnPanel(this.ScienceId)}else c.default.Instance().ShowTips(this._ScienceLockTips)},t.prototype.onLastScienceClick=function(){if(this._scienceIds&&this._scienceIds.conditions.length>0){var e=l.TABLE.getTableDataById(h.TableName.SCIENCE_V1,this._scienceIds.conditions[0].id.toString());e&&m.default.openScienceLearnPanel(e.id)}},t.prototype.OnLevelUpClick=function(){if(""==this._ScienceLockTips){if(0==this.ScienceLocked){if(this._isBtnClicking)return void u.log("\u91cd\u590d\u70b9\u51fb");this._isBtnClicking=!0;var e={scienceId:this._ScienceId,gold:0},t=this;r.EVENT.emit(i.EventId.ScienceExpFly,this._CoinNeedWithoutBuff,this.levelUpBtnNode.parent.convertToWorldSpaceAR(this.levelUpBtnNode.position)),C.NET.send(g.RequestId.Science_LevelUp,e,this,function(e){if(f.default.verifyComponent(t))if(t._isBtnClicking=!1,0==e.s&&null!=e.d){var a=f.default.JSON_PARSE(e.d);s.DATA.UserData.UpdateScience(a.science,!1);var n=l.TABLE.getTableDataById(h.TableName.SCIENCE_V1,a.science.scienceId);n&&c.default.Instance().ShowTips(o.LOCAL.getText("newarea_unlock018",o.LOCAL.getText(t.ScienceData.name),n.level))}else null!=e.d&&c.default.Instance().ShowTips(o.LOCAL.getNetMsgText(e.d))})}}else c.default.Instance().ShowTips(this._ScienceLockTips)},t.prototype.OnItemClick=function(){this.ScienceData&&this._ItemId&&f.default.ShowItemDetailView(this.ItemIcon.node,this.ScienceData.item_id,p.ResourceType.Item)},t.prototype.onItemAddClick=function(){if(!s.DATA.UserData.FunctionOn(p.FunctionKey.key_novice_adjustments)&&s.DATA.UserData.Level<s.DATA.UserData.OpenWorldLevel)c.default.Instance().ShowTips(o.LOCAL.getText("100167",s.DATA.UserData.OpenWorldLevel.toString()));else{var e={itemid:this._ItemId,needNum:this._itemNumNeed};c.default.Instance().OpenUI(y.UIDataInfo.GetItemPanel,e)}},t.prototype.onCoinAddClick=function(){f.default.judgeIfShowFirstCharge()||c.default.Instance().OpenUI(y.UIDataInfo.MyCoinPanel)},t.prototype.onTouchInfo=function(){c.default.Instance().OpenUI(y.UIDataInfo.HeadquartersScienceInfoPop,this._ScienceId-1)},__decorate([T(cc.Node)],t.prototype,"BaseNode",void 0),__decorate([T(cc.Node)],t.prototype,"LockNode",void 0),__decorate([T(cc.Node)],t.prototype,"preScienceNode",void 0),__decorate([T(cc.Node)],t.prototype,"resNode",void 0),__decorate([T(cc.Node)],t.prototype,"EffectNode",void 0),__decorate([T(cc.Label)],t.prototype,"LabName",void 0),__decorate([T(cc.Label)],t.prototype,"LabLevel",void 0),__decorate([T(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([T(cc.Node)],t.prototype,"RedPoint",void 0),__decorate([T(cc.Sprite)],t.prototype,"iconSign",void 0),__decorate([T([cc.SpriteFrame])],t.prototype,"signImages",void 0),__decorate([T(cc.Label)],t.prototype,"unLockLabel",void 0),__decorate([T(cc.Sprite)],t.prototype,"unlockIcon",void 0),__decorate([T([cc.SpriteFrame])],t.prototype,"unlockImages",void 0),__decorate([T(cc.Label)],t.prototype,"LabLevelAfter",void 0),__decorate([T(cc.Label)],t.prototype,"preNameLabel",void 0),__decorate([T(cc.Node)],t.prototype,"levelUpBtnNode",void 0),__decorate([T(cc.Sprite)],t.prototype,"ItemIcon",void 0),__decorate([T(cc.Sprite)],t.prototype,"ItemIconBg",void 0),__decorate([T(cc.Node)],t.prototype,"LabItem",void 0),__decorate([T(cc.Node)],t.prototype,"LabCoin",void 0),__decorate([T(cc.Button)],t.prototype,"getItemButton",void 0),__decorate([T(cc.Button)],t.prototype,"getCoinButton",void 0),__decorate([T(cc.Label)],t.prototype,"LabDesc",void 0),__decorate([T(cc.Node)],t.prototype,"coinEnoughNode",void 0),__decorate([T(cc.Node)],t.prototype,"itemEnoughNode",void 0),__decorate([T(cc.Sprite)],t.prototype,"lastScienceIcon",void 0),__decorate([T(cc.Sprite)],t.prototype,"lastScienceSign",void 0),t=__decorate([I],t)}(n.default);a.default=S,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Event/EventCenter":"EventCenter","../../../Core/Net/NetMgr":"NetMgr","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../../fws/utils/X":"X","../../Common/TaskGuide":"TaskGuide","../../Common/UIManager":"UIManager","../../Const/EventId":"EventId","../../Const/GameDefine":"GameDefine","../../Const/RequestId":"RequestId","../../Const/TableName":"TableName","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Tools/GameTools":"GameTools","../../controllers/ScienceController":"ScienceController"}],HeroElementItem:[function(e,t,a){"use strict";cc._RF.push(t,"ca15dSIYDRMj7mA4iG9GGxr","HeroElementItem"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../Const/GameDefine"),i=e("../../../Core/Common/TableManager"),r=e("../../Tools/GameTools"),s=e("../../../Core/Common/LocalManager"),l=e("../UI/PropDetailPanel"),c=e("../../../Core/Utils/UpdateSpriteFrame"),d=e("../../hero/HeroController"),p=e("../../controllers/ArmyEquipController"),u=e("../../Const/TableName"),h=cc._decorator,m=h.ccclass,f=h.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabLevel=null,t.BgType1=null,t.BgType2=null,t.SkillIcon=null,t.EquipIcon=null,t.skillQualityBg=null,t._Level=0,t._ElementName="",t._ElementDesc="",t._ClickEnable=!0,t._ShowLevel=!1,t._ExtraId=0,t._ExtraData=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"ElementName",{get:function(){return this._ElementName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ElementDesc",{get:function(){return this._ElementDesc},enumerable:!0,configurable:!0}),t.prototype.UpdateItem=function(e,t,a,o,i,r,s){void 0===r&&(r=0),void 0===s&&(s=null),this._ClickEnable=i,this._Id=e,this._ElementType=a,this._Level=t,this._ShowLevel=o,this._ExtraId=r,this._ExtraData=s,this._ElementType==n.HeroElementType.Skill?this.UpdateSkillItem():this._ElementType==n.HeroElementType.Equip?this.UpdateEquipItem():this._ElementType==n.HeroElementType.Talent&&this.UpdateTalentItem()},t.prototype.UpdateSkillItem=function(){if(this.BgType1.active=!0,this._Id>0){var e=i.TABLE.getTableDataById(u.TableName.HEROSKILL,this._Id.toString());if(e)if(1==e.skill_type)r.default.setSpriteFrame("image/hero_skill/"+e.skill_icon,this.SkillIcon);else{var t=i.TABLE.getTableByKey("item","type",42,"para1",this._Id,"level",1);if(t.length>0){var a=t[0];if(r.default.setSpriteFrame(t[0].icon,this.SkillIcon),a.quality){this.skillQualityBg.node.active=!0;var o="";2==a.quality?(o="image/mainui_old/label2_skillitem",s.LOCAL.getText("skill_lable_001")):3==a.quality?(o="image/mainui_old/label1_skillitem",s.LOCAL.getText("skill_lable_002")):this.skillQualityBg.node.active=!1,c.UpdateSpriteFrame(o,this.skillQualityBg)}}}this._Level>0&&this._ShowLevel&&(this.LabLevel.node.active=!0,this.LabLevel.string=s.LOCAL.getText("name_001",this._Level.toString()))}},t.prototype.UpdateTalentItem=function(){if(this.BgType1.active=!0,this._Id>0){var e=i.TABLE.getTableDataById(u.TableName.TALENT,this._Id.toString());e&&r.default.setSpriteFrame(e.icon,this.SkillIcon)}},t.prototype.UpdateEquipItem=function(){if(this.BgType2.active=!0,this._Id>0){var e=i.TABLE.getTableDataById(u.TableName.ITEM,this._Id.toString());if(e){c.UpdateSpriteFrame(e.icon,this.EquipIcon),this.LabLevel.node.active=!0,this._Level=e.level,this.LabLevel.string=s.LOCAL.getText("name_001",e.level.toString());var t=p.ArmyEquipController.getInstance().getBgStr(this._Id);r.default.setSpriteFrame("image/mainui_old/"+t,this.BgType2.getComponent(cc.Sprite))}}},t.prototype.InitElementNameAndDesc=function(){if(!(this._Id<=0))if(this._ElementType==n.HeroElementType.Skill){var e=i.TABLE.getTableDataById(u.TableName.HEROSKILL,this._Id.toString());if(e&&1==e.skill_type){var t=d.HeroController.getInstance().getHeroSkillBaseInfo(this._ExtraId,this._ExtraData),a=t[0],o=t[1];t[2];this._ElementDesc=o,this._ElementName=a;var r=d.HeroController.getInstance().getHeroActiveSkillBaseInfo(this._ExtraId,!1),l=(r[0],r[1]);r[2];""!=l&&(this._ElementDesc=s.LOCAL.getText("active_skill005")+"\n"+this._ElementDesc+"\n"+s.LOCAL.getText("active_skill004")+"\n"+l)}else{var c=i.TABLE.getTableByKey("item","type",42,"para1",this._Id,"level",this._Level)[0],p=i.TABLE.getTableDataById(u.TableName.HEROSKILL,c.para1);(h=i.TABLE.getTableDataById(u.TableName.EFFECTBUFF,p.effect)).value_type&&1e4==h.value_type?this._ElementDesc=s.LOCAL.getText(c.desc,String((Number(p.para)+d.HeroController.getInstance().getSkillBuff(p.para_equip_skill,c.level))/100)):this._ElementDesc=s.LOCAL.getText(c.desc,String(Number(p.para)+d.HeroController.getInstance().getSkillBuff(p.para_equip_skill,c.level))),this._ElementName=s.LOCAL.getText(c.name)}}else if(this._ElementType==n.HeroElementType.Talent){var h,m=i.TABLE.getTableDataById(u.TableName.TALENT,this._Id.toString());if(m)if(this._ElementName=s.LOCAL.getText(m.name),h=i.TABLE.getTableDataById(u.TableName.EFFECTBUFF,m.buff)){var f=i.TABLE.getTableDataById(u.TableName.HERO,this._ExtraId.toString()),_="";if(f){var y=Math.max(f.quality-3,0);_=" + "+(100*(this._Level*(m.max_num+m.add_num*y)/1e8)).toFixed(2)+"%"}this._ElementDesc=s.LOCAL.getText(h.string),""!=_&&(this._ElementDesc=this._ElementDesc+_)}}else if(this._ElementType==n.HeroElementType.Equip){var g=i.TABLE.getTableDataById(u.TableName.ITEM,this._Id.toString());if(g&&(this._ElementName=s.LOCAL.getText(g.name),this._ElementDesc=s.LOCAL.getText(g.desc,"0"),this._ExtraId>0)){var C=i.TABLE.getTableDataById(u.TableName.ENHANCE,this._Id.toString());if(C){var v=C.buff_land;this._ExtraId===n.ArmyType.Sea?v=C.buff_sea:this._ExtraId===n.ArmyType.Air&&(v=C.buff_air);var I=i.TABLE.getTableDataById(u.TableName.EFFECTBUFF,v.toString());if(I){var T=(C.para/I.value_type*100).toFixed(1);this._ElementDesc=s.LOCAL.getText(g.desc,T)}}}}},t.prototype.onItemClick=function(){this._ClickEnable&&this._Id>0&&l.default.ShowHeroElementDetail(this.node,this._Id,this._Level,this._ElementType,this._ExtraId,0,this._ExtraData)},__decorate([f(cc.Label)],t.prototype,"LabLevel",void 0),__decorate([f(cc.Node)],t.prototype,"BgType1",void 0),__decorate([f(cc.Node)],t.prototype,"BgType2",void 0),__decorate([f(cc.Sprite)],t.prototype,"SkillIcon",void 0),__decorate([f(cc.Sprite)],t.prototype,"EquipIcon",void 0),__decorate([f(cc.Sprite)],t.prototype,"skillQualityBg",void 0),t=__decorate([m],t)}(o.default);a.default=_,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../Const/GameDefine":"GameDefine","../../Const/TableName":"TableName","../../Tools/GameTools":"GameTools","../../controllers/ArmyEquipController":"ArmyEquipController","../../hero/HeroController":"HeroController","../UI/PropDetailPanel":"PropDetailPanel"}],PropItem:[function(e,t,a){"use strict";cc._RF.push(t,"7517c7bRuVHq7rnHm3mWSO8","PropItem"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../../Core/Common/TableManager"),i=e("../../../Core/Utils/UpdateSpriteFrame"),r=e("../../Tools/GameTools"),s=e("../../Const/GameDefine"),l=e("../../../fws/utils/FWSTool"),c=e("../../../Core/Common/LocalManager"),d=e("../../../fws/utils/X"),p=e("../../../fws/utils/ErrorReport"),u=e("../../Data/HeroData"),h=e("../../Data/DataCenter"),m=e("../../Const/TableName"),f=e("../../../fws/platforms/PlatformCore"),_=e("../../Profession/ProfessionController"),y=cc._decorator,g=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabEffect=null,t.NumberNode=null,t.LabNumber=null,t.Bg=null,t.PropIcon=null,t.ResIcon=null,t.ArmyIcon=null,t.LabEffectBg=null,t.propItemButton=null,t.HeroIcon=null,t.HeroPatchNode=null,t.HeroPatchIcon=null,t.skillQualityBg=null,t.nameOrDesLayout=null,t.nameOrDesLabel=null,t.choiceBg=null,t.ArmyIconMask=null,t.HeroPatchMask=null,t.EquipPatchNode=null,t._ItemId=0,t._ItemType=0,t._detailOffY=0,t._itemCount=-1,t._needCount=0,t._extraData={},t._canClick=!0,t.clickDel=null,t.extraData=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"ItemCount",{get:function(){return this._itemCount},set:function(e){this._itemCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NeedCount",{get:function(){return this._needCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ItemID",{get:function(){return this._ItemId},enumerable:!0,configurable:!0}),t.prototype.setExtraData=function(e){this._extraData=e},t.prototype.UpdateItem=function(e,t,a,o,r,l){void 0===t&&(t=-1),void 0===a&&(a=0),void 0===o&&(o=0),void 0===r&&(r=""),void 0===l&&(l=!1),this._ItemId=e;var d=n.TABLE.getTableDataById(m.TableName.ITEM,e.toString());this._ItemType=s.ResourceType.Item,this._detailOffY=o,d?[42,46].indexOf(d.type)>=0?this.updateHeroSkillFragmentItem(e,t,a):(this._needCount=a,this._itemCount=t,this.UpdateItemNumNode(this._itemCount,l),""!==r&&(this.LabNumber.string=r),this.LabEffect.string=c.LOCAL.getText(d.icon_text),""==d.icon_text?this.LabEffectBg.active=!1:this.LabEffectBg.active=!0,this.UpdateQuality(d.quality),this.HeroIcon.node.active=!1,this.setEquipPatchNodeActive(!1),d.type===s.ItemType.HeroPatch||d.type===s.ItemType.CastleFacePatch||d.type===s.ItemType.ArmyLineSkinPatch?(this.PropIcon.node.active=!1,this.HeroPatchNode.active=!0,this.HeroPatchMask&&(this.HeroPatchMask.active=!0),i.UpdateSpriteFrame(d.icon,this.HeroPatchIcon),i.UpdateSpriteFrame("image/hero/hero_chip_old_"+d.quality,this.HeroPatchNode.getChildByName("patch").getComponent(cc.Sprite))):(d.type===s.ItemType.ArmyPaperChip&&this.setEquipPatchNodeActive(!0),this.HeroPatchNode.active=!1,this.HeroPatchMask&&(this.HeroPatchMask.active=!1),this.PropIcon.node.active=!0,i.UpdateSpriteFrame(d.icon,this.PropIcon))):p.custom("LOGIN_ERROR",{resp:"\u672a\u627e\u5230item\u914d\u7f6e",itemId:e},p.TraceLevels.FATAL)},t.prototype.setEquipPatchNodeActive=function(e){this.EquipPatchNode&&(this.EquipPatchNode.active=e)},t.prototype.UpdateItemNumNode=function(e,t){return this.NumberNode.active=e>0||this._needCount>0,e>=0&&(this._needCount>0?(this.LabNumber.string=t?e.toString()+"/"+r.default.GetLargeNumberShow(this._needCount):e.toString(),this._needCount>e?this.LabNumber.node.color=cc.color(255,0,0):this.LabNumber.node.color=cc.color(255,255,255)):this.LabNumber.string=r.default.GetLargeNumberShow(e)),this._itemCount=e,e>=this._needCount},t.prototype.UpdateSpItem=function(e,t,a,o){void 0===t&&(t=-1),void 0===a&&(a=0),void 0===o&&(o=0),this._ItemId=e,this._ItemType=s.ResourceType.SpItem,this._detailOffY=o,this._canClick=!1,this._needCount=a,this._itemCount=t,this.UpdateItemNumNode(this._itemCount,!1),this.LabEffect.string="",this.LabEffectBg.active=!1,this.HeroIcon.node.active=!1,this.setEquipPatchNodeActive(!1),this.HeroPatchNode.active=!1,this.HeroPatchMask&&(this.HeroPatchMask.active=!1),this.PropIcon.node.active=!0,i.UpdateSpriteFrame("image/EightCountry/secretIcon/secrectIcon_"+e.toString(),this.PropIcon)},t.prototype.UpdateItem_exchange=function(e,t,a){void 0===t&&(t=-1),void 0===a&&(a=-1),this._ItemId=e;var o=n.TABLE.getTableDataById(m.TableName.ITEM,e.toString());if(this._ItemType=s.ResourceType.Item,null==o){this.UpdateQuality(1),this.LabEffectBg.active=!1,this.LabEffect.string="";var l=this.node.getChildByName("addicon");return l&&(l.active=!0),void(this.PropIcon.spriteFrame=null)}var d=this.node.getChildByName("addicon");d&&(d.active=!1),this._itemCount=t,this.NumberNode.active=a>=0,this._itemCount>=0&&(a>0?(this.LabNumber.string=r.default.GetLargeNumberShow(this._itemCount),a>this._itemCount?this.LabNumber.node.color=cc.color(255,0,0):this.LabNumber.node.color=cc.color(255,255,255)):this.LabNumber.string=r.default.GetLargeNumberShow(this._itemCount)),this.LabEffect.string=c.LOCAL.getText(o.icon_text),""==o.icon_text?this.LabEffectBg.active=!1:this.LabEffectBg.active=!0,this.UpdateQuality(o.quality),this.setEquipPatchNodeActive(!1),o.type===s.ItemType.HeroPatch||o.type===s.ItemType.CastleFacePatch||o.type===s.ItemType.ArmyLineSkinPatch?(this.PropIcon.node.active=!1,this.HeroPatchNode.active=!0,this.HeroPatchMask&&(this.HeroPatchMask.active=!0),i.UpdateSpriteFrame(o.icon,this.HeroPatchIcon),i.UpdateSpriteFrame("image/hero/hero_chip_old_"+o.quality,this.HeroPatchNode.getChildByName("patch").getComponent(cc.Sprite))):(o.type===s.ItemType.ArmyPaperChip&&this.setEquipPatchNodeActive(!0),this.HeroPatchNode.active=!1,this.HeroPatchMask&&(this.HeroPatchMask.active=!1),this.PropIcon.node.active=!0,i.UpdateSpriteFrame(o.icon,this.PropIcon))},t.prototype.UpdateItem_new=function(e,t,a){this._ItemId=e;var o=n.TABLE.getTableDataById(m.TableName.ITEM,e.toString());this._ItemType=s.ResourceType.Item,null!=o&&(this._itemCount=t,this.NumberNode.active=!0,this._itemCount>=0&&a>=0&&(this.LabNumber.string=t+"/"+r.default.GetLargeNumberShow(a),a>this._itemCount?this.LabNumber.node.color=cc.color(255,0,0):this.LabNumber.node.color=cc.color(255,255,255)),this.LabEffect.string=c.LOCAL.getText(o.icon_text),""==o.icon_text?this.LabEffectBg.active=!1:this.LabEffectBg.active=!0,this.UpdateQuality(o.quality),this.setEquipPatchNodeActive(!1),o.type===s.ItemType.HeroPatch||o.type===s.ItemType.CastleFacePatch||o.type===s.ItemType.ArmyLineSkinPatch?(this.PropIcon.node.active=!1,this.HeroPatchNode.active=!0,this.HeroPatchMask&&(this.HeroPatchMask.active=!0),i.UpdateSpriteFrame(o.icon,this.HeroPatchIcon),i.UpdateSpriteFrame("image/hero/hero_chip_old_"+o.quality,this.HeroPatchNode.getChildByName("patch").getComponent(cc.Sprite))):(o.type===s.ItemType.ArmyPaperChip&&this.setEquipPatchNodeActive(!0),this.HeroPatchNode.active=!1,this.HeroPatchMask&&(this.HeroPatchMask.active=!1),this.PropIcon.node.active=!0,i.UpdateSpriteFrame(o.icon,this.PropIcon)))},t.prototype.UpdateQuality=function(e){var t=r.default.getNomalBgStrByQuality(e);r.default.setSpriteFrame(t,this.Bg)},t.prototype.UpdateRes=function(e,t,a,o){void 0===t&&(t=0),void 0===a&&(a=0),void 0===o&&(o=0),this._ItemType=e,this._ItemId=e,this._itemCount=t,this._detailOffY=o,e>100?i.UpdateSpriteFrame(r.default.getResourceIcon(e),this.PropIcon):i.UpdateSpriteFrame(r.default.getResourceIcon(e),this.ResIcon),t+a>0?(this.NumberNode.active=!0,a>0?(this.LabNumber.string=r.default.GetLargeNumberShow(a),this.LabNumber.node.color=a>t?cc.color(255,0,0):cc.color(255,255,255)):this.LabNumber.string=r.default.GetLargeNumberShow(t)):this.NumberNode.active=!1,this.setEquipPatchNodeActive(!1),this.LabEffect.string="",this.LabEffectBg.active=!1},t.prototype.UpdateArmyItem=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=0),this._ItemId=e,this._ItemType=s.ResourceType.Army,this._detailOffY=a,this._itemCount=t,this.NumberNode.active=t>0,t>0&&(this.LabNumber.string=t.toString());var o=n.TABLE.getTableDataById(m.TableName.ARMY,this._ItemId.toString());if(l.Obj.isEmpty(o))this.ArmyIconMask&&(this.ArmyIconMask.active=!1);else{this.ArmyIconMask&&(this.ArmyIconMask.active=!0),r.default.UpdateArmyIcon(o,this.ArmyIcon);var i=l.Obj.getPropertyStringByNames(o,"","level");this.LabEffect.string=c.LOCAL.getText("name_001",i.toString())}this.setEquipPatchNodeActive(!1)},t.prototype.UpdateBuildingItem=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=0),this._ItemId=e,this._ItemType=s.ResourceType.Building,this._detailOffY=a,this._itemCount=t,this.NumberNode.active=t>0,t>0&&(this.LabNumber.string=t.toString());var o=n.TABLE.getTableDataById(m.TableName.BUILDING,this._ItemId.toString());if(l.Obj.isEmpty(o))this.ArmyIconMask&&(this.ArmyIconMask.active=!1);else if(this.ArmyIconMask&&(this.ArmyIconMask.active=!0),r.default.UpdateBuildingIcon(o,this.ArmyIcon),this.UpdateQuality(o.quality),26==o.type)this.LabEffect.string="";else{var i=l.Obj.getPropertyStringByNames(o,"","level");this.LabEffect.string=c.LOCAL.getText("name_001",i.toString())}this.setEquipPatchNodeActive(!1)},t.prototype.UpdateHeroItem=function(e){this._ItemId=0,this._ItemType=s.ResourceType.Building,this.NumberNode.active=!1;var t=n.TABLE.getTableDataById(m.TableName.HERO,e.toString());if(this.PropIcon.node.active=!1,this.setEquipPatchNodeActive(!1),this.HeroPatchNode.active=!1,!l.Obj.isEmpty(t)){this.HeroIcon.node.active=!0;var a=new u.default;a.UpdateData(t),r.default.setSpriteFrame(a.Icon,this.HeroIcon),this.UpdateQuality(t.quality),this.LabEffect.string=""}},t.prototype.updateHeroSkillFragmentItem=function(e,t,a,o,l){void 0===t&&(t=-1),void 0===a&&(a=0),void 0===o&&(o=""),void 0===l&&(l=!1),this._ItemId=e;var d=n.TABLE.getTableDataById(m.TableName.ITEM,e.toString());if(this._ItemType=s.ResourceType.Item,null!=d){if(this._itemCount=t,this.NumberNode.active=!0,a>0?this.LabNumber.string=r.default.GetLargeNumberShow(this._itemCount)+"/"+r.default.GetLargeNumberShow(a):this._itemCount>=0?this.LabNumber.string=r.default.GetLargeNumberShow(this._itemCount):this.NumberNode.active=!1,this.LabEffect.string=c.LOCAL.getText(d.icon_text),""==d.icon_text?this.LabEffectBg.active=!1:this.LabEffectBg.active=!0,d.quality){this.skillQualityBg.node.active=!0;var p="";2==d.quality?p="image/mainui_old/label2_skillitem":3==d.quality?p="image/mainui_old/label1_skillitem":this.skillQualityBg.node.active=!1,i.UpdateSpriteFrame(p,this.skillQualityBg)}this.UpdateQuality(3),this.HeroIcon&&(this.HeroIcon.node.active=!1),this.setEquipPatchNodeActive(!1),d.type===s.ItemType.HERO_SKILL_FRAGMENT?(this.PropIcon.node.active=!1,this.HeroPatchNode.active=!0,this.HeroPatchMask&&(this.HeroPatchMask.active=!0),i.UpdateSpriteFrame(d.icon,this.HeroPatchIcon),l&&(t?(this.HeroPatchIcon.setState(cc.Sprite.State.NORMAL),this.skillQualityBg.setState(cc.Sprite.State.NORMAL)):(this.HeroPatchIcon.setState(cc.Sprite.State.GRAY),this.skillQualityBg.setState(cc.Sprite.State.GRAY)))):(this.HeroPatchNode.active=!1,this.HeroPatchMask&&(this.HeroPatchMask.active=!1),this.PropIcon.node.active=!0,i.UpdateSpriteFrame(d.icon,this.PropIcon),this.skillQualityBg.setState(cc.Sprite.State.NORMAL)),o&&this.nameOrDesLayout&&(this.nameOrDesLayout.active=!0,this.nameOrDesLabel.string=c.LOCAL.getText(o))}},t.prototype.updateHeroSkillItem=function(e,t){void 0===t&&(t=-1),this._ItemId=e;var a=n.TABLE.getTableDataById(m.TableName.ITEM,e.toString());if(this._ItemType=s.ResourceType.Item,null!=a){if(this._itemCount=t,this.NumberNode.active=!0,this._itemCount>=0&&(this.LabNumber.string=r.default.GetLargeNumberShow(this._itemCount)),a.quality){this.skillQualityBg.node.active=!0}this.setEquipPatchNodeActive(!1),this.HeroPatchNode.active=!1,this.PropIcon.node.active=!0,i.UpdateSpriteFrame(a.icon,this.PropIcon)}},t.prototype.UpdateArmyEquipItem=function(e,t,a,o,r,l){void 0===t&&(t=-1),void 0===a&&(a=0),void 0===o&&(o=0),void 0===r&&(r=""),void 0===l&&(l=!1),this._ItemId=e;var c=n.TABLE.getTableDataById(m.TableName.ARMY_EQUIP,e.toString());this._ItemType=s.ResourceType.ArmyEquip,this._detailOffY=o,c?(this.LabEffect.string="",this.LabEffectBg.active=!1,this._needCount=a,this._itemCount=t,this.UpdateItemNumNode(this._itemCount,l),""!==r&&(this.LabNumber.string=r),this._canClick=!1,this.UpdateQuality(c.quality),this.setEquipPatchNodeActive(!1),this.HeroPatchNode.active=!1,this.HeroIcon.node.active=!1,this.HeroPatchMask&&(this.HeroPatchMask.active=!1),this.PropIcon.node.active=!0,i.UpdateSpriteFrame(c.icon,this.PropIcon)):p.custom("LOGIN_ERROR",{resp:"\u672a\u627e\u5230item\u914d\u7f6e",itemId:e},p.TraceLevels.FATAL)},t.prototype.setButtonInteractable=function(e){this.propItemButton.interactable=e},t.prototype.SetClick=function(e){this._canClick=e},t.prototype.UpdateSelectState=function(e){this.choiceBg.active=e},t.prototype.SetClickDel=function(e,t,a){void 0===a&&(a=null),this.clickDel=e,this.clickObj=t,this.extraData=a},t.prototype.Click_ShowDeatil=function(){null!=this.clickDel?this.clickDel.call(this.clickObj,this._ItemId,this._itemCount,this.extraData):(d.log("Click_ShowDeatil:"+this._ItemId+"   canClick:"+this._canClick),0!=this._ItemId&&this._canClick&&(r.default.ShowItemDetailView(this.node,this._ItemId,this._ItemType,this._detailOffY,null,this._itemCount),f.instance.postAIEvent(this.ItemClickEvent(this._extraData,this._ItemId,this._ItemType))))},t.prototype.getArmyName=function(e,t){void 0===t&&(t=-1);var a=n.TABLE.getTableDataById(m.TableName.ARMY,String(e));if(!a)return"";var o=t;-1==t&&(o=_.default.Instance.ProfessionId);var i=a.name;o>0&&a.new_name&&(i=a.new_name);var r=a.orign_model;o>0&&a.pro_model&&(r=a.pro_model);var s=n.TABLE.getTableDataById(m.TableName.MODEL,String(r));return s&&s.name&&(i=s.name),c.LOCAL.getText(i)},t.prototype.getResourceNameKey=function(e){return e==s.ResourceType.Gold?"100017":e==s.ResourceType.Wood?"100018":e==s.ResourceType.Oil?"100019":e==s.ResourceType.Coin?"100020":e==s.ResourceType.Energy?"resource_energy":e==s.ResourceType.Exp?"100492":e==s.ResourceType.Honor?"100021":e==s.ResourceType.Power?"100022":e==s.ResourceType.Oila?"110118":e==s.ResourceType.Metal?"110120":e==s.ResourceType.Soil?"110121":e==s.ResourceType.Coal?"110122":e==s.ResourceType.AdventureCoin?"adventure118":""},t.prototype.ItemClickEvent=function(e,t,a){var o="",i=a;if(a===s.ResourceType.Army)o=this.getArmyName(t),i=s.ResourceType.Army;else if(a===s.ResourceType.Item){var r=n.TABLE.getTableDataById("item",t.toString());r&&(o=c.LOCAL.getText(r.name),i=s.ResourceType.Item)}else if(a===s.ResourceType.Building){var l=n.TABLE.getTableDataById("building",t.toString());l&&(o=c.LOCAL.getText(l.name),i=s.ResourceType.Building)}else o=c.LOCAL.getText(this.getResourceNameKey(t)),i=t;var d="";return e&&e.exchangeId&&(d=e.exchangeId),{action:"g_click",data:{item_id:t,item_type:"item",item_name:o,item_desc:i+"",item_referer:d+""}}},t.prototype.cpnUpdate1000MS=function(){var e=r.default.getTrapListArray();if(h.DATA.UserData.ifLaunchTowerStatus()&&e.indexOf(String(this._ItemId))>=0&&h.DATA.UserData.ifOpenLaunchTower()){this.LabEffect.node.active=!0;var t="00:00:00",a=h.DATA.UserData.LaunchTowerData.end-h.DATA.ServerTime;a>0&&(t=r.default.getSimpleTimeShow(a)),this.LabEffect.string=t}},t.prototype.setGray=function(e){void 0===e&&(e=0),this.ResIcon.setState(e),this.PropIcon.setState(e),this.ArmyIcon.setState(e),this.HeroIcon.setState(e),this.HeroPatchIcon.setState(e),this.ResIcon.setState(e)},__decorate([C(cc.Label)],t.prototype,"LabEffect",void 0),__decorate([C(cc.Node)],t.prototype,"NumberNode",void 0),__decorate([C(cc.Label)],t.prototype,"LabNumber",void 0),__decorate([C(cc.Sprite)],t.prototype,"Bg",void 0),__decorate([C(cc.Sprite)],t.prototype,"PropIcon",void 0),__decorate([C(cc.Sprite)],t.prototype,"ResIcon",void 0),__decorate([C(cc.Sprite)],t.prototype,"ArmyIcon",void 0),__decorate([C(cc.Node)],t.prototype,"LabEffectBg",void 0),__decorate([C(cc.Button)],t.prototype,"propItemButton",void 0),__decorate([C(cc.Sprite)],t.prototype,"HeroIcon",void 0),__decorate([C(cc.Node)],t.prototype,"HeroPatchNode",void 0),__decorate([C(cc.Sprite)],t.prototype,"HeroPatchIcon",void 0),__decorate([C(cc.Sprite)],t.prototype,"skillQualityBg",void 0),__decorate([C(cc.Node)],t.prototype,"nameOrDesLayout",void 0),__decorate([C(cc.Label)],t.prototype,"nameOrDesLabel",void 0),__decorate([C(cc.Node)],t.prototype,"choiceBg",void 0),__decorate([C(cc.Node)],t.prototype,"ArmyIconMask",void 0),__decorate([C(cc.Node)],t.prototype,"HeroPatchMask",void 0),__decorate([C(cc.Node)],t.prototype,"EquipPatchNode",void 0),t=__decorate([g],t)}(o.default);a.default=v,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/utils/ErrorReport":"ErrorReport","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/X":"X","../../Const/GameDefine":"GameDefine","../../Const/TableName":"TableName","../../Data/DataCenter":"DataCenter","../../Data/HeroData":"HeroData","../../Profession/ProfessionController":"ProfessionController","../../Tools/GameTools":"GameTools"}],ScienceItemNew:[function(e,t,a){"use strict";cc._RF.push(t,"d338borfF1Hp6l6WQbaVPZn","ScienceItemNew"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../../System/ComponentBase"),i=e("../../Const/EventId"),r=e("../../../Core/Event/EventCenter"),s=e("../../Data/DataCenter"),l=e("../../../Core/Common/TableManager"),c=e("../../Common/UIManager"),d=e("../../Common/TaskGuide"),p=e("../../Const/GameDefine"),u=e("../../../fws/utils/X"),h=e("../../Const/TableName"),m=e("../../controllers/ScienceController"),f=cc._decorator,_=f.ccclass,y=f.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BaseNode=null,t.LabName=null,t.LabLevel=null,t.Icon=null,t.LineBlue=null,t.LineBlack=null,t.LockNode=null,t.RedPoint=null,t._ScienceId=0,t._Delegate=null,t._ScienceData=null,t._ConditionScience=null,t._ScienceLocked=!0,t._ScienceLockTips="",t._scienceIds={},t._LastScienceId=-1,t}return __extends(t,e),Object.defineProperty(t.prototype,"ScienceLocked",{get:function(){return this._ScienceLocked},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ConditionScience",{get:function(){return this._ConditionScience},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScienceId",{get:function(){return this._ScienceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScienceData",{get:function(){return this._ScienceData},enumerable:!0,configurable:!0}),t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),r.EVENT.on(i.EventId.Resource_Update,this.UpdateRedPoint,this),r.EVENT.on(i.EventId.Item_Update,this.UpdateRedPoint,this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),r.EVENT.off(i.EventId.Resource_Update,this.UpdateRedPoint,this),r.EVENT.off(i.EventId.Item_Update,this.UpdateRedPoint,this)},t.prototype.UpdateRedPoint=function(){this.UpdateItem(this._ScienceData,this._Delegate)},t.prototype.UpdateItem=function(e,t){this.BaseNode.active=!0,this._ScienceData=e,this._Delegate=t,this.LabName.string=o.LOCAL.getText(e.name),this.LabLevel.string=o.LOCAL.getText("name_001",e.level.toString()),this._ScienceId=e.id,this._ScienceLockTips="",this._scienceIds={};var a=e.unlock_level;this._ConditionScience=null,this._ScienceLocked=!1,this.node.name=e.group_id.toString(),d.default.Instance.AddGuideDelegate(this.node);var n=s.DATA.UserData.getScienceByGroupId(e.group_id),i=!1;if(null!=n&&n.ScienceId==this._ScienceId&&(i=!0),s.DATA.UserData.Level<a||0==e.is_open||1==i)if(this._ScienceLocked=0==i,0==e.is_open)this._ScienceLockTips=o.LOCAL.getText("100289");else{var r=l.TABLE.getTableDataById(h.TableName.DATACONFIG,"2008").value;this._ScienceLockTips=a>r||i?o.LOCAL.getText("100290"):o.LOCAL.getText("100090",a.toString())}else if(0!=e.condition_science)for(var c=(e.condition_science+"").split(","),u=0;u<c.length;u++){var f=l.TABLE.getTableDataById(h.TableName.SCIENCE,c[u]);if(void 0!=f){this._ConditionScience=f;var _=s.DATA.UserData.getScienceByGroupId(this.ConditionScience.group_id);if(null==_||_.Data.level<this.ConditionScience.level){this._ScienceLocked=!0;var y=m.default.GuideLearnScience(e.group_id);y&&0!=y.length?this._scienceIds=y:this._ScienceLockTips=o.LOCAL.getText("100291",o.LOCAL.getText(this.ConditionScience.name)+"]"+this.ConditionScience.level.toString());break}}}var g=this;this._LastScienceId!=e.id&&(this._LastScienceId=e.id,m.default.UpdateScienceIcon(e,g.Icon,function(){g.Icon.setState(cc.Sprite.State.NORMAL)}));var C=!0;null!=l.TABLE.getTableDataById(h.TableName.ITEM,e.item_id.toString())&&(e.item_amount>s.DATA.UserData.getItemAmount(e.item_id)&&(C=!1));var v=!0;m.default.getScienceLevelUpCoin(e)>s.DATA.UserData.Resource.getResource(p.ResourceType.Coin)&&(v=!1),this.RedPoint.active=C&&v&&0==this._ScienceLocked&&0==i,this.LockNode.active=this._ScienceLocked},t.prototype.OnItemClick=function(){if(""==this._ScienceLockTips){if(1==this._ScienceLocked&&this._scienceIds)if(this._ScienceData&&this._ScienceData.group_id){var e=m.default.GuideLearnScience(this._ScienceData.group_id);e&&0!=e.length&&m.default.openScienceLearnPanel(e,null)}else u.log("\u6253\u5f00\u79d1\u6280\u5b66\u4e60\u9762\u677f  \u53c2\u6570\u9519\u8bef");null!=this._Delegate&&this._Delegate.ScienceItemNewCallBack(this)}else c.default.Instance().ShowTips(this._ScienceLockTips)},t.prototype.HideLine=function(){this.LineBlue.active=!1,this.LineBlack.active=!1},t.prototype.UpdateLineState=function(e){this.LineBlue.active=e,this.LineBlack.active=0==e},__decorate([y(cc.Node)],t.prototype,"BaseNode",void 0),__decorate([y(cc.Label)],t.prototype,"LabName",void 0),__decorate([y(cc.Label)],t.prototype,"LabLevel",void 0),__decorate([y(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([y(cc.Node)],t.prototype,"LineBlue",void 0),__decorate([y(cc.Node)],t.prototype,"LineBlack",void 0),__decorate([y(cc.Node)],t.prototype,"LockNode",void 0),__decorate([y(cc.Node)],t.prototype,"RedPoint",void 0),t=__decorate([_],t)}(n.default);a.default=g,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Event/EventCenter":"EventCenter","../../../System/ComponentBase":"ComponentBase","../../../fws/utils/X":"X","../../Common/TaskGuide":"TaskGuide","../../Common/UIManager":"UIManager","../../Const/EventId":"EventId","../../Const/GameDefine":"GameDefine","../../Const/TableName":"TableName","../../Data/DataCenter":"DataCenter","../../controllers/ScienceController":"ScienceController"}],UserServerItem:[function(e,t,a){"use strict";cc._RF.push(t,"6bc58fSzDpJNJS7of/SdRGR","UserServerItem"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../../System/ComponentBase"),i=e("../../../Core/Utils/UpdateSpriteFrame"),r=e("../../Data/DataCenter"),s=e("../../Const/GameDefine"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Icon=null,t.LabName=null,t.LabLevel=null,t.LabServer=null,t.BtnDelete=null,t.UnionIconNode=null,t}return __extends(t,e),t.prototype.UpdateData=function(e,t){void 0===t&&(t=!1),this.ServerData=e,this.LabName.string=e.UserName,this.LabLevel.string=o.LOCAL.getText("delete_char005",(e.Level||e.PlayerInfo.level)+""),this.LabServer.string=o.LOCAL.getText("110081")+"S"+e.Id.toString(),this.UnionIconNode&&(this.UnionIconNode.active=1===e.IsUnion),i.UpdateSpriteFrameByWXUrl(e.PlayerInfo.getDisplayAvatarUrl(),this.Icon),null!=this.BtnDelete&&(this.BtnDelete.active=1==e.CanDel&&this.ServerData.Uid!=r.DATA.UserData.UID&&0!=this.ServerData.Uid&&r.DATA.UserData.FunctionOn(s.FunctionKey.DeleteServer))},__decorate([d(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([d(cc.Label)],t.prototype,"LabName",void 0),__decorate([d(cc.Label)],t.prototype,"LabLevel",void 0),__decorate([d(cc.Label)],t.prototype,"LabServer",void 0),__decorate([d(cc.Node)],t.prototype,"BtnDelete",void 0),__decorate([d(cc.Node)],t.prototype,"UnionIconNode",void 0),t=__decorate([c],t)}(n.default);a.default=p,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../Const/GameDefine":"GameDefine","../../Data/DataCenter":"DataCenter"}],CharacterDeletePanel:[function(e,t,a){"use strict";cc._RF.push(t,"4634f6AjHRMe7spZRXUAB7X","CharacterDeletePanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Common/BaseUI"),n=e("../../Common/UIManager"),i=e("../../Const/UIDataInfo"),r=e("../../../Core/Utils/UpdateSpriteFrame"),s=e("../../Common/ConfirmPanel"),l=e("../../../Core/Common/LocalManager"),c=e("../../../Core/Net/NetMgr"),d=e("../../Const/RequestId"),p=e("../../../Core/Event/EventCenter"),u=e("../../Const/EventId"),h=e("../../Tools/GameTools"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabName=null,t.CharacterIcon=null,t.PlayerName="",t.serverData=null,t}return __extends(t,e),t.ShowView=function(e){n.default.Instance().OpenUI(i.UIDataInfo.CharacterDeletePanel,e)},t.prototype.onShow=function(e){this.serverData=e[0],this.PlayerName=this.serverData.UserName+l.LOCAL.getText("delete_char005",this.serverData.Level.toString()),this.LabName.string=this.PlayerName,r.UpdateSpriteFrameByWXUrl(this.serverData.PlayerInfo.getDisplayAvatarUrl(),this.CharacterIcon)},t.prototype.onSureClick=function(){var e=this.serverData.UserName+l.LOCAL.getText("delete_char005",this.serverData.Level.toString()),t=l.LOCAL.getText("delete_char004",e),a=l.LOCAL.getText("delete_char003");s.default.ShowView(t,a,this,this.SendDeleteCharacterToServer,function(){},"","",!1,!0)},t.prototype.SendDeleteCharacterToServer=function(){var e=this,t={targetUID:this.serverData.Uid.toString()},a=this;c.NET.send(d.RequestId.CHARACTER_DELETE,t,this,function(t){if(0==t.s){var o=h.default.JSON_PARSE(t.d);null!=o&&(0==(o=o.result)?(n.default.Instance().ShowTips(l.LOCAL.getText("delete_toast001",e.PlayerName)),p.EVENT.emit(u.EventId.CharacterListUpdate),a.onCancleClick()):-4==o?n.default.Instance().ShowTips(l.LOCAL.getText("delete_toast003")):n.default.Instance().ShowTips(l.LOCAL.getText("delete_toast002",e.PlayerName)))}})},t.prototype.onCancleClick=function(){n.default.Instance().CloseUI(i.UIDataInfo.CharacterDeletePanel)},__decorate([_(cc.Label)],t.prototype,"LabName",void 0),__decorate([_(cc.Sprite)],t.prototype,"CharacterIcon",void 0),t=__decorate([f],t)}(o.default);a.default=y,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Event/EventCenter":"EventCenter","../../../Core/Net/NetMgr":"NetMgr","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../Common/BaseUI":"BaseUI","../../Common/ConfirmPanel":"ConfirmPanel","../../Common/UIManager":"UIManager","../../Const/EventId":"EventId","../../Const/RequestId":"RequestId","../../Const/UIDataInfo":"UIDataInfo","../../Tools/GameTools":"GameTools"}],ChooseServerPanel:[function(e,t,a){"use strict";cc._RF.push(t,"f4014ZiWbVDWb59GLakUmnG","ChooseServerPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../Common/BaseUI"),i=e("../../Common/UIManager"),r=e("../../Const/UIDataInfo"),s=e("./ServerListPanel"),l=e("../../../Core/Net/WebClient"),c=e("../../../fws/utils/HttpUtils"),d=e("../../Data/GlobalData"),p=e("../../Tools/GameTools"),u=e("../../Data/DataCenter"),h=e("../../../Core/Net/NetMgr"),m=e("../../Const/RequestId"),f=e("../../Data/ServerData"),_=e("../../Common/ConfirmPanel"),y=e("../Item/UserServerItem"),g=e("../../Start/ResetGame"),C=e("../../Common/BIManager"),v=e("../../controllers/DevConfigController"),I=e("../../../Core/Event/EventCenter"),T=e("../../Const/EventId"),S=e("./CharacterDeletePanel"),A=e("../../../fws/utils/FWSTool"),D=e("../../../fws/platforms/PlatformCore"),N=e("../../../fws/utils/X"),b=e("../../../fws/utils/LocalStorageUtils"),L=e("../../Common/PFOpenData"),E=e("../../Const/GameDefine"),P=cc._decorator,w=P.ccclass,B=P.property,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Content=null,t.myServerItem=null,t.newServerItem=null,t.syncAccountBtn=null,t.CharacterNumMax=3,t.imUnion=!1,t}var a;return __extends(t,e),a=t,t.ShowView=function(){i.default.Instance().OpenUI(r.UIDataInfo.ChooseServerPanel)},t.PostChangeServerData=function(){if(0!=a.ChangeServerLastUid&&0!=a.ChangeServerLastServerId){var e={fromServer:a.ChangeServerLastServerId,targetSerer:u.DATA.UserData.OriginServerId,fromUid:a.ChangeServerLastUid};C.default.Instance.PostExtraAction("ChangeServerComplete",e),a.ChangeServerLastUid=0,a.ChangeServerLastServerId=0}},t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),I.EVENT.on(T.EventId.CharacterListUpdate,this.getUserServerData,this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),I.EVENT.off(T.EventId.CharacterListUpdate,this.getUserServerData,this)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t);var a=p.default.getDataConfigData(10005);if(null!=a&&(this.CharacterNumMax=parseInt(a)),this.cpnScheduleOnce(this,this.showBusyInfo,4),this.getUserServerData(),this.getAllServerData(),D.instance.canShowBindAccountPanel()){this.syncAccountBtn.active=!0;var o=b.get("app_serverInfoToken"),n=b.get("app_platformSID"),i=b.get("app_channel");(o&&n&&i||1===b.get("app_getToken"))&&(this.syncAccountBtn.getComponent(cc.Button).interactable=!1)}else this.syncAccountBtn.active=!1},t.prototype.getUserServerData=function(){var e=this,t={};if(u.DATA.UserData.FunctionOn(E.FunctionKey.server_list_backend_filter)){var a=(L.default.Instance.Channel||"").split("_")[0];t.devPlatform=D.instance.platformSID,t.channel=a||"",t.lineAddress=d.GLOBAL.GameBestDomain}N.log("(\u5f00\u5173) server_list_backend_filter =",u.DATA.UserData.FunctionOn(E.FunctionKey.server_list_backend_filter)),h.NET.send(m.RequestId.GET_USER_SERVERLIST,t,this,function(t){if(N.log("getUserServerDatagetUserServerData:",t),null!=t.d&&""!=t.d&&3!=t.s){var a=p.default.JSON_PARSE(t.d);u.DATA.UserData.UpdateUserServerList(a),u.DATA.UserData.FunctionOn(E.FunctionKey.server_list_backend_filter)&&a&&a.showServerList&&a.showServerList.serverList&&u.DATA.UserData.UpdateServerList(a.showServerList.serverList),p.default.verifyComponent(e)&&(e.UpdateView(),e.cpnUnschedule(e.showBusyInfo))}})},t.prototype.getAllServerData=function(){if(!(u.DATA.UserData.FunctionOn(E.FunctionKey.server_list_backend_filter)||u.DATA.UserData.ServerList.length>0)){var e=this,t={platform:D.instance.platformSID,gm:1};t.slistShowType=u.DATA.UserData.slistShowType;var a=c.addTimespan(d.GLOBAL.GetAllServerDataUrl);l.get(a,t,this,function(t){try{var a=p.default.JSON_PARSE(t.responseText);a?(N.log("(ChooseServerPanel) getAllServerData:"),N.table(a.serverList)):N.log("(ChooseServerPanel) getAllServerData:",t.responseText),a&&p.default.verifyComponent(e)&&u.DATA.UserData.UpdateServerList(a.serverList)}catch(e){N.error(e)}},function(e){N.warn("GetAllServerDataUrl Fail")})}},t.prototype.showBusyInfo=function(){i.default.Instance().ShowTips(o.LOCAL.getText("public907"))},t.prototype.UpdateView=function(){this.InitView()},t.prototype.InitView=function(){this.Content.safetyDestroyAllChildren();var e=u.DATA.UserData.UserServerList,t=4090,a=0;this.imUnion=!1;for(var o=0;o<e.length;o++)e[o]&&e[o].Uid==u.DATA.UserData.UID&&1===e[o].IsUnion&&(this.imUnion=!0);for(o=0;o<e.length;o++)this.addMyServerItem(e[o]),e[o].Id==t&&(t=-1),e[o]&&1===e[o].IsUnion&&a++;-1!=t&&this.addTestServerItem(t),e.length-a<this.CharacterNumMax&&this.addNewServerItem()},t.prototype.addTestServerItem=function(e){if(0!=v.DevConfigController.Instance.isDevServer()){var t=new f.default,a={id:e,rate:0,url:"wss://server-knight.rivergame.net/s4090"};t.UpdateServerData(a);var o=cc.instantiate(this.myServerItem);o.active=!0,o.parent=this.Content,o.getComponent(y.default).UpdateData(t),o.getChildByName("currMark").active=u.DATA.UserData.UID==t.Uid,o.name=t.Id.toString()}},t.prototype.addMyServerItem=function(e){var t=cc.instantiate(this.myServerItem);t.active=!0,t.parent=this.Content,t.getComponent(y.default).UpdateData(e,this.imUnion),t.getChildByName("currMark").active=u.DATA.UserData.UID==e.Uid,t.name=e.Id.toString()},t.prototype.addNewServerItem=function(){var e=cc.instantiate(this.newServerItem);e.active=!0,e.parent=this.Content},t.prototype.onCloseClick=function(){i.default.Instance().CloseUI(r.UIDataInfo.ChooseServerPanel)},t.prototype.onServerItemClick=function(e){var t=e.target.getComponent(y.default);if(null!=t){var n=t.ServerData.Id;if(u.DATA.UserData.UID!=t.ServerData.Uid){var r=t.ServerData.Url;if(A.Str.isEmpty(r)){if(4090!=n)return void i.default.Instance().ShowTips(o.LOCAL.getText("110038"));r="wss://server-knight.rivergame.net/s"+n}var s=o.LOCAL.getText("110040",n.toString());0==t.ServerData.Uid&&(s+=o.LOCAL.getText("110041")),N.log("onServerItemClickonServerItemClick:",t.ServerData),_.default.ShowView(s,o.LOCAL.getText("110042"),this,function(){a.SendChangeServer(n,t.ServerData.Uid,r,t.ServerData.IsUnion)})}else i.default.Instance().ShowTips(o.LOCAL.getText("110043"))}},t.prototype.onDeletePlayerClick=function(e){N.log("onDeletePlayerClickonDeletePlayerClickonDeletePlayerClick");var t=e.target.parent.getComponent(y.default);null!=t&&(S.default.ShowView(t.ServerData),N.log("onDeletePlayerClickonDeletePlayerClick:",t.ServerData))},t.SendChangeServer=function(e,t,n,i){var r=this;N.log("SendChangeServer:"+e+"   uid:"+t+"   url:"+n);var s="wxMiniProgram";var l={serverId:e,uid:t.toString(),deviceType:s};1===i&&(l.isUnion=1),h.NET.send(m.RequestId.CHANGE_SERVER,l,this,function(i){if(null!=i.d&&""!=i.d&&3!=i.s){var s=p.default.JSON_PARSE(i.d);if(s)if(131!=s.err)p.default.saveServerRegionInfo(s),0==t&&(C.default.Instance.PostExtraAction("ChangeServerStart",{fromServer:u.DATA.UserData.OriginServerId,targetSerer:e}),a.ChangeServerLastServerId=u.DATA.UserData.OriginServerId,a.ChangeServerLastUid=u.DATA.UserData.UID),d.GLOBAL.changeServerId=e,d.GLOBAL.changeServerIp=n,d.GLOBAL.ShowServers=!1,g.default.doResetGame(!1,!1);else{if(D.instance.tryForceUpdate())return;_.default.ShowView(o.LOCAL.getText("system_notice001"),o.LOCAL.getText("system_131845"),r,function(){})}}})},t.prototype.onChangeServerClick=function(){s.default.ShowView()},t.prototype.onSyncAccountClick=function(){if(D.instance.canShowBindAccountPanel()){var e={delegate:this,bindCallBack:function(){},cancelCallBack:function(){}};i.default.Instance().OpenUI(r.UIDataInfo.BindAccountPanel,e)}},t.ChangeServerLastUid=0,t.ChangeServerLastServerId=0,__decorate([B(cc.Node)],t.prototype,"Content",void 0),__decorate([B(cc.Node)],t.prototype,"myServerItem",void 0),__decorate([B(cc.Node)],t.prototype,"newServerItem",void 0),__decorate([B(cc.Node)],t.prototype,"syncAccountBtn",void 0),t=a=__decorate([w],t)}(n.default);a.default=M,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Event/EventCenter":"EventCenter","../../../Core/Net/NetMgr":"NetMgr","../../../Core/Net/WebClient":"WebClient","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/HttpUtils":"HttpUtils","../../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../../fws/utils/X":"X","../../Common/BIManager":"BIManager","../../Common/BaseUI":"BaseUI","../../Common/ConfirmPanel":"ConfirmPanel","../../Common/PFOpenData":"PFOpenData","../../Common/UIManager":"UIManager","../../Const/EventId":"EventId","../../Const/GameDefine":"GameDefine","../../Const/RequestId":"RequestId","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Data/GlobalData":"GlobalData","../../Data/ServerData":"ServerData","../../Start/ResetGame":"ResetGame","../../Tools/GameTools":"GameTools","../../controllers/DevConfigController":"DevConfigController","../Item/UserServerItem":"UserServerItem","./CharacterDeletePanel":"CharacterDeletePanel","./ServerListPanel":"ServerListPanel"}],FreeGoldPanel:[function(e,t,a){"use strict";cc._RF.push(t,"ac5f3ghpKpMjb8JO1/jf1O/","FreeGoldPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../Common/BaseUI"),i=e("../../Common/UIManager"),r=e("../../Const/UIDataInfo"),s=e("../../Tools/GameTools"),l=e("../../../Core/Net/NetMgr"),c=e("../../Const/RequestId"),d=e("../../../fws/utils/FWSTool"),p=e("../Home/ResFly"),u=e("../../controllers/ExchangeController"),h=e("../../ShareSDK/RGShareInterface"),m=e("../../../fws/platforms/PlatformCore"),f=e("../../../fws/utils/ErrorReport"),_=e("../../Data/DataCenter"),y=e("../../Const/GameDefine"),g=cc._decorator,C=g.ccclass,v=g.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.watchVideoBtn=null,t.moreBtn=null,t.vipBtnNode=null,t.vipLevelLabel=null,t.vipNeedLevelLabel=null,t.vipNeedLevelNode=null,t}return __extends(t,e),t.ShowView=function(){var e=this,t=null,a=m.instance.adVideoLoadFrom();h.default.RGShareSDKGetShareType(h.RGSharePoint.SP_FreeDiamondVideo,h.IRGCanUseShareType.canUse_WatchAd,{adtype:a},function(n){if(n!=h.IRGShareType.shartype_watchAd||s.default.CheckGoldVideoShowMax(!1))u.ExchangeController.Instance.canPay()?u.ExchangeController.Instance.openBasePayView():i.default.Instance().ShowTips(o.LOCAL.getText("100130"));else{t=function(){h.default.RGShareSDKDoAction(h.RGSharePoint.SP_FreeDiamondVideo,h.IRGShareType.shartype_watchAd,{adtype:a},{success:function(t,a){var o=0;t&&-1!=a&&(o=1);var n={failed:o};f.trace({resp:"requestServer",data:JSON.stringify({para:n,c:c.RequestId.VIDEO_GET_GOLD})},"video"),l.NET.send(c.RequestId.VIDEO_GET_GOLD,n,e,function(e){do{var t=s.default.JSON_PARSE(e.d);if(null===t)break;var a=d.Obj.getPropertyByNames(t,null,"resource");if(a){p.default.Fly(i.default.Instance().flyLayer,a,1,0,null,null,i.default.Instance().flyLayer);var o=d.Obj.getPropertyByNames(a,null,"resource"),n=d.Obj.getPropertyByNames(o,0,"gold");f.trace({resp:"serverResponse",data:JSON.stringify({c:c.RequestId.VIDEO_GET_GOLD,gold:n})},"video")}}while(0)},!0)},fail:function(t,a,o){if(a&&-1!=o){var n={failed:1};f.trace({resp:"requestServer",data:JSON.stringify({para:n,c:c.RequestId.VIDEO_GET_GOLD})},"video"),l.NET.send(c.RequestId.VIDEO_GET_GOLD,n,e,function(e){do{var t=s.default.JSON_PARSE(e.d);if(null===t)break;var a=d.Obj.getPropertyByNames(t,null,"resource");if(a){p.default.Fly(i.default.Instance().flyLayer,a,1,0,null,null,i.default.Instance().flyLayer);var o=d.Obj.getPropertyByNames(a,null,"resource"),n=d.Obj.getPropertyByNames(o,0,"gold");f.trace({resp:"serverResponse",data:JSON.stringify({c:c.RequestId.VIDEO_GET_GOLD,gold:n})},"video")}}while(0)})}}})};var m=null;u.ExchangeController.Instance.canPay()&&(m=function(){u.ExchangeController.Instance.openBasePayView()}),i.default.Instance().OpenUI(r.UIDataInfo.FreeGoldPanel,t,m)}})},t.prototype.onShow=function(t){if(e.prototype.onShow.call(this,t),this._WatchVideoCallBack=t[0],this._MoreCallBack=t[1],this.watchVideoBtn.active=null!=this._WatchVideoCallBack,this.moreBtn.active=null!=this._MoreCallBack,this.vipBtnNode.active=!1,this.vipLevelLabel.node.active=!1,this.vipNeedLevelNode.active=!1,this.watchVideoBtn.active&&_.DATA.UserData.FunctionOn(y.FunctionKey.vip_videoplay_freereward)){var a=s.default.getDataConfigData(138005);_.DATA.UserData.VipLevel>=Number(a)?(this.watchVideoBtn.active=!1,this.vipBtnNode.active=!0,this.vipLevelLabel.node.active=!0,this.vipLevelLabel.string=o.LOCAL.getText("sharevideo09",String(_.DATA.UserData.VipLevel))):(this.vipNeedLevelNode.active=!0,this.vipNeedLevelLabel.string=o.LOCAL.getText("vip001")+a)}},t.prototype.OnCloseClick=function(){i.default.Instance().CloseUI(r.UIDataInfo.FreeGoldPanel)},t.prototype.watchVideoClick=function(){i.default.Instance().CloseUI(r.UIDataInfo.FreeGoldPanel),null!=this._WatchVideoCallBack&&this._WatchVideoCallBack.call()},t.prototype.vipGetGold=function(){this.OnCloseClick();var e={failed:0};l.NET.send(c.RequestId.VIDEO_GET_GOLD,e,this,function(e){do{var t=s.default.JSON_PARSE(e.d);if(null===t)break;var a=d.Obj.getPropertyByNames(t,null,"resource");a&&p.default.Fly(i.default.Instance().flyLayer,a,1,0,null,null,i.default.Instance().flyLayer)}while(0)},!0)},t.prototype.OnMoreClick=function(){i.default.Instance().CloseUI(r.UIDataInfo.FreeGoldPanel),null!=this._MoreCallBack&&this._MoreCallBack.call()},__decorate([v(cc.Node)],t.prototype,"watchVideoBtn",void 0),__decorate([v(cc.Node)],t.prototype,"moreBtn",void 0),__decorate([v(cc.Node)],t.prototype,"vipBtnNode",void 0),__decorate([v(cc.Label)],t.prototype,"vipLevelLabel",void 0),__decorate([v(cc.Label)],t.prototype,"vipNeedLevelLabel",void 0),__decorate([v(cc.Node)],t.prototype,"vipNeedLevelNode",void 0),t=__decorate([C],t)}(n.default);a.default=I,function(e){e[e.default=1]="default",e[e.BaseRecharge=10001]="BaseRecharge",e[e.WatchVideo=10003]="WatchVideo",e[e.AutoCollect=10702]="AutoCollect",e[e.FreeCoin=10002]="FreeCoin",e[e.FreeGold=10005]="FreeGold"}(a.WatchVideoEnum||(a.WatchVideoEnum={})),cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Net/NetMgr":"NetMgr","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/utils/ErrorReport":"ErrorReport","../../../fws/utils/FWSTool":"FWSTool","../../Common/BaseUI":"BaseUI","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Const/RequestId":"RequestId","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../ShareSDK/RGShareInterface":"RGShareInterface","../../Tools/GameTools":"GameTools","../../controllers/ExchangeController":"ExchangeController","../Home/ResFly":"ResFly"}],HeadquartersPanel:[function(e,t,a){"use strict";cc._RF.push(t,"c16fb+R3QtIEqg9xqZe6YCn","HeadquartersPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../Common/UIManager"),i=e("../../../Core/Event/EventCenter"),r=e("../../Const/EventId"),s=e("../../Data/DataCenter"),l=e("../../Const/GameDefine"),c=e("../../Tools/GameTools"),d=e("../../controllers/ScienceController"),p=e("../../../fws/display/dialogs/DialogContentComponent"),u=e("../Item/HeadquartersItem"),h=e("../../Common/TaskGuide"),m=e("../../Const/UIDataInfo"),f=e("../../Data/GuideData"),_=cc._decorator,y=_.ccclass,g=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scienceNode=null,t.topNode=null,t.leftContent=null,t.leftItem=null,t.leftIcons=[],t.centerContent=null,t.headquartersItem=null,t.diamondLabel=null,t.diamondNode=null,t.coinLabel=null,t.expFlyNode=null,t.scroll=null,t.scrollItemHight=0,t.guideClickEndNode=null,t.guideNode=null,t.headquartersItemPool={},t._leftCfgList=[],t._leftNames=["res_name_101","101009","100046","101010","defend_alliance_22"],t}return __extends(t,e),t.ShowView=function(){s.DATA.UserData.FunctionOn(l.FunctionKey.key_novice_adjustments)&&0!=s.DATA.UserData.FunctionOn(l.FunctionKey.Science)?(n.default.Instance().OpenUI(m.UIDataInfo.HeadquartersPanel),f.default.getInst().removeNPCTalk(f.G123EventType.e_G123EventType_ScienceCan)):n.default.Instance().ShowTips(o.LOCAL.getText("100086"))},t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),i.EVENT.on(r.EventId.Science_Update,this.onScienceUpdate,this),i.EVENT.on(r.EventId.PlayerLevelUpUpdate,this.onPlearLevelUp,this),i.EVENT.on(r.EventId.Resource_Update,this.updateResource,this),i.EVENT.on(r.EventId.ScienceExpFly,this.flyEXP,this),this.guideClickEndNode.on(cc.Node.EventType.TOUCH_START,this.onStopGuide,this,!0),this.guideClickEndNode._touchListener.setSwallowTouches(!1)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),i.EVENT.off(r.EventId.Science_Update,this.onScienceUpdate,this),i.EVENT.off(r.EventId.PlayerLevelUpUpdate,this.onPlearLevelUp,this),i.EVENT.off(r.EventId.Resource_Update,this.updateResource,this),i.EVENT.off(r.EventId.ScienceExpFly,this.flyEXP,this),this.guideClickEndNode.off(cc.Node.EventType.TOUCH_START)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),this.guideClickEndNode.active=!1;var a=s.DATA.UserData.getBuildingArrayByBuildingGroup(l.BuildingGroup.HEADQUARTORS);a.length&&(this.ownerDialogFrame.dfcTitle.string=o.LOCAL.getText(a[0].Data.name));var n=c.default.getDataConfigData(5089);if(n&&(this._leftCfgList=n.split("|")),this.initView(),1!=s.DATA.UserData.getLocalData(l.LocalDataKey.HeadquarterGuide,0)){s.DATA.UserData.setLocalData(l.LocalDataKey.HeadquarterGuide,1);var i=d.default.GetNextScienceDataByGroupId(33e4);i&&6==i.level&&h.default.Instance.StartSpecialGuide(7101)}},t.prototype.initView=function(){var e=d.default.getScienceArrByType(1),t=0;for(var a in e){var o=e[a];o.new_pos_y>t&&(t=o.new_pos_y)}this.headquartersItemPool={},this.topNode&&(this.headquartersItemPool[11]=this.topNode.getComponent(u.default)),this.centerContent.destroyAllChildren();for(var n=2;n<=t;n++)for(var i=1;i<=3;i++){var r=cc.instantiate(this.headquartersItem);r.active=!0,r.parent=this.centerContent;a=10*n+i;this.headquartersItemPool[a]=r.getComponent(u.default)}this.initLeftIcons(),this.updateView()},t.prototype.initLeftIcons=function(){if(0==this.leftContent.childrenCount&&this._leftCfgList.length>0)for(var e=0;e<this._leftCfgList.length;e++){var t=cc.instantiate(this.leftItem),a=t.getChildByName("name"),n=t.getChildByName("icon");a&&a.getComponent(cc.Label)&&n&&n.getComponent(cc.Sprite)&&this.leftIcons[Number(this._leftCfgList[e])]&&this._leftNames[Number(this._leftCfgList[e])]&&(n.getComponent(cc.Sprite).spriteFrame=this.leftIcons[Number(this._leftCfgList[e])],a.getComponent(cc.Label).string=o.LOCAL.getText(this._leftNames[Number(this._leftCfgList[e])]),t.active=!0,t.parent=this.leftContent)}},t.prototype.updateView=function(e){void 0===e&&(e=0),this.updateResource();var t=d.default.getScienceArrByType(1),a={},o=0;for(var n in t){var i=t[n];i.new_pos_y>o&&(o=i.new_pos_y),a[10*i.new_pos_y+i.new_pos_x]=i}for(var n in this.headquartersItemPool){if(r=this.headquartersItemPool[n])(s=a[n])?(r.updateItem(s),r.name=s.group_id.toString()):r.updateItem()}for(var n in this.headquartersItemPool){var r,s;if(r=this.headquartersItemPool[n])if(s=a[n]){for(var l=!0,c=1;c<4;c++){var p=this.headquartersItemPool[10*s.new_pos_y+c],u=a[10*s.new_pos_y+c];if(p&&u&&!p.isLock()){l=!1;break}}l&&r.updateAllLineLock(Number(this._leftCfgList[s.new_pos_y-2]))}}e>0&&this.showLightEffect(e)},t.prototype.showLightEffect=function(e){var t=[];for(var a in this.headquartersItemPool){var o=Math.floor(Number(a)/10)+Number(a)%10;t[o]||(t[o]=[]),t[o].push(this.headquartersItemPool[a])}for(var n=0,i=0;i<t.length;i++)if(t[i]){for(var r=!1,s=0;s<t[i].length;s++){var l=t[i][s];l.ScienceData&&l.playLightEffect(e,n)&&(r=!0)}r&&(n+=2==i?.6:.2)}},t.prototype.updateResource=function(){this.diamondLabel.string=Math.floor(s.DATA.UserData.Resource.Gold).toString(),this.coinLabel.string=c.default.GetLargeNumberShow(s.DATA.UserData.Resource.getResource(l.ResourceType.Coin))},t.prototype.flyEXP=function(e,t){void 0!=e&&e>0&&void 0!=t&&c.default.AddCoinCostExpByPosInUI(e,t,this.expFlyNode)},t.prototype.onStopGuide=function(){h.default.Instance.CheckClickTarget(this.guideNode),this.guideClickEndNode.active=!1},t.prototype.onPlearLevelUp=function(){this.updateView()},t.prototype.onScienceUpdate=function(e){this.updateView(e)},__decorate([g(cc.Node)],t.prototype,"scienceNode",void 0),__decorate([g(cc.Node)],t.prototype,"topNode",void 0),__decorate([g(cc.Node)],t.prototype,"leftContent",void 0),__decorate([g(cc.Node)],t.prototype,"leftItem",void 0),__decorate([g([cc.SpriteFrame])],t.prototype,"leftIcons",void 0),__decorate([g(cc.Node)],t.prototype,"centerContent",void 0),__decorate([g(cc.Node)],t.prototype,"headquartersItem",void 0),__decorate([g(cc.Label)],t.prototype,"diamondLabel",void 0),__decorate([g(cc.Node)],t.prototype,"diamondNode",void 0),__decorate([g(cc.Label)],t.prototype,"coinLabel",void 0),__decorate([g(cc.Node)],t.prototype,"expFlyNode",void 0),__decorate([g(cc.ScrollView)],t.prototype,"scroll",void 0),__decorate([g(cc.Float)],t.prototype,"scrollItemHight",void 0),__decorate([g(cc.Node)],t.prototype,"guideClickEndNode",void 0),t=__decorate([y],t)}(p.default);a.default=C,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Event/EventCenter":"EventCenter","../../../fws/display/dialogs/DialogContentComponent":"DialogContentComponent","../../Common/TaskGuide":"TaskGuide","../../Common/UIManager":"UIManager","../../Const/EventId":"EventId","../../Const/GameDefine":"GameDefine","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Data/GuideData":"GuideData","../../Tools/GameTools":"GameTools","../../controllers/ScienceController":"ScienceController","../Item/HeadquartersItem":"HeadquartersItem"}],PropDetailPanel:[function(e,t,a){"use strict";cc._RF.push(t,"d70a23ZekVFSInjR4/ItjLw","PropDetailPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../Common/BaseUI"),i=e("../../Tools/GameTools"),r=e("../../../Core/Common/TableManager"),s=e("../../Common/UIManager"),l=e("../../Const/UIDataInfo"),c=e("../Item/PropItem"),d=e("../../Const/GameDefine"),p=e("../../../fws/utils/FWSTool"),u=e("../../hero/HeroController"),h=e("../../Profession/ProfessionController"),m=e("../Item/HeroElementItem"),f=e("../../Const/TableName"),_=cc._decorator,y=_.ccclass,g=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemName=null,t.itemDes=null,t.itemNode=null,t.itemPrefab=null,t.talentPrefab=null,t.heroElementItem=null,t.doBtn=null,t.markNode=null,t._doCallBack=null,t}return __extends(t,e),t.ShowView=function(e,t,a,o,n,i){void 0===o&&(o=0),void 0===n&&(n=null),void 0===i&&(i=-1),s.default.Instance().OpenUI(l.UIDataInfo.PropDetailPanel,e,t,a,o,n,i)},t.ShowHeroSkill=function(e,t,a){void 0===a&&(a=0),s.default.Instance().OpenUI(l.UIDataInfo.PropDetailPanel,e,-1,t)},t.ShowProfessionDetail=function(e,t,a){void 0===a&&(a=0),s.default.Instance().OpenUI(l.UIDataInfo.PropDetailPanel,e,-2,t,a)},t.ShowHeroElementDetail=function(e,t,a,o,n,i,r){void 0===n&&(n=0),void 0===i&&(i=0);var c={id:t,level:a,type:o,extraId:n,extraData:r};s.default.Instance().OpenUI(l.UIDataInfo.PropDetailPanel,e,-3,c,i)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),this.itemDes.string="",this.itemName.string="";var a=t[5];if(this.itemName.node.active=!0,t[1]&&-3==t[1]){var n=cc.instantiate(this.heroElementItem).getComponent(m.default),s=t[2];return n.UpdateItem(s.id,s.level,s.type,!0,!1,s.extraId,s.extraData),n.InitElementNameAndDesc(),this.itemName.string=n.ElementName,this.itemDes.string=n.ElementDesc,void this.itemNode.addChild(n.node)}if(t[1]&&-2==t[1]){var l=r.TABLE.getTableDataById(f.TableName.ENDOWMENT,t[2].toString());this.itemName.string=o.LOCAL.getText(l.name),this.itemDes.string=h.default.Instance.getTalentDetailByCfg(l);var _=cc.instantiate(this.talentPrefab);this.itemNode.addChild(_),_.scale=.6;var y=_.getComponent("ProfessionTalentItem");y&&(y.UpdateTalent&&y.UpdateTalent(t[2].toString(),0,!1),y.SetClick&&y.SetClick(!1));var g=t[0],C=cc.v2(cc.winSize.width/2,cc.winSize.height/2);i.default.verifyNode(g)&&i.default.verifyNode(g.parent)&&(C=g.parent.convertToWorldSpaceAR(g.position));var v=this.node.parent.convertToNodeSpaceAR(C);return v.x=0,void this.node.setPosition(v)}if(t[1]&&-1==t[1]){var I=u.HeroController.getInstance().getHeroSkillBaseInfo(t[2]),T=I[0],S=I[1],A=I[2];this.itemDes.string=S,this.itemName.string=T;var D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D);var N=cc.find("layout/PropIcon",D).getComponent(cc.Sprite);i.default.setSpriteFrame("image/hero_skill/"+A,N);var b=D.getComponent(c.default);b.SetClick(!1),b.LabEffect.string="",b.LabEffectBg.active=!1;var L=t[0],E=cc.v2(cc.winSize.width/2,cc.winSize.height/2);i.default.verifyNode(L)&&i.default.verifyNode(L.parent)&&(E=L.parent.convertToWorldSpaceAR(L.position));var P=this.node.parent.convertToNodeSpaceAR(E);return P.x=0,void this.node.setPosition(P)}if(!i.default.ObjIsEmpty(t)){var w=1,B=parseInt(t[2].toString());if(B==d.ResourceType.Item||63==B){if(null!=(n=r.TABLE.getTableDataById(f.TableName.ITEM,t[1].toString()))){if(42==n.type||46==n.type){if(this.itemName.string=o.LOCAL.getText(n.name),46==n.type)this.itemDes.string=o.LOCAL.getText(n.desc);else{var M=r.TABLE.getTableDataById(f.TableName.HEROSKILL,n.para1),U=r.TABLE.getTableDataById(f.TableName.EFFECTBUFF,M.effect);U.value_type&&1e4==U.value_type?this.itemDes.string=o.LOCAL.getText(n.desc,String((Number(M.para)+u.HeroController.getInstance().getSkillBuff(M.para_equip_skill,n.level))/100)):this.itemDes.string=o.LOCAL.getText(n.desc,String(Number(M.para)+u.HeroController.getInstance().getSkillBuff(M.para_equip_skill,n.level)))}D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).updateHeroSkillFragmentItem(t[1],a),D.getComponent(c.default).SetClick(!1)}else{if(!i.default.ObjIsEmpty(n)){if(this.itemName.string=i.default.getItemName(n),this.itemDes.string=i.default.getItemDesc(n.id),n.type===d.ItemType.PowerItem){var R=r.TABLE.getTableDataById(f.TableName.ENHANCE,n.id.toString());if(R){var G=r.TABLE.getTableDataById(f.TableName.EFFECTBUFF,R.buff_land.toString());G&&(this.itemDes.string=p.Str.format(o.LOCAL.getText(n.desc),Math.ceil(R.para/G.value_type*100)))}}w=p.Obj.getPropertyNumberByNames(n,-1)}D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateItem(t[1],a),D.getComponent(c.default).SetClick(!1)}n.word_suffix?(this.markNode.active=!0,this.markNode.getChildByName("labName").getComponent(cc.Label).string=this.itemName.string,this.markNode.getChildByName("labMark").getComponent(cc.Label).string=o.LOCAL.getText(n.word_suffix),this.itemName.node.active=!1):this.markNode.active=!1}}else if(B==d.ResourceType.Army){var O=parseInt(t[1].toString()),k=r.TABLE.getTableDataById(f.TableName.ARMY,O.toString());null!=k&&(this.itemDes.string=i.default.getArmyName(O)+" (Lv."+k.level+")",this.itemName.string=i.default.getArmyName(O));D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateArmyItem(O,a),D.getComponent(c.default).SetClick(!1),k&&(w=k.quality)}else if(B==d.ResourceType.Building){var x=parseInt(t[1].toString()),F=r.TABLE.getTableDataById(f.TableName.BUILDING,x.toString());if(null!=F){S=i.default.getBuildingDesc(x.toString());this.itemDes.string=o.LOCAL.getText(S),this.itemName.string=o.LOCAL.getText(F.name)}D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateBuildingItem(x,a),D.getComponent(c.default).SetClick(!1),F&&(w=F.quality)}else if(B==d.ResourceType.Coin){this.itemName.string=o.LOCAL.getText("100020"),this.itemDes.string=o.LOCAL.getText("100064");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Gold){this.itemName.string=o.LOCAL.getText("100017"),this.itemDes.string=o.LOCAL.getText("100065");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Exp){this.itemName.string=o.LOCAL.getText("110125"),this.itemDes.string=o.LOCAL.getText("adventure096");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Oila){this.itemName.string=o.LOCAL.getText("100019"),this.itemDes.string=o.LOCAL.getText("100066");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Metal){this.itemName.string=o.LOCAL.getText("100067"),this.itemDes.string=o.LOCAL.getText("100068");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Soil){this.itemName.string=o.LOCAL.getText("100069"),this.itemDes.string=o.LOCAL.getText("100070");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Coal){this.itemName.string=o.LOCAL.getText("100071"),this.itemDes.string=o.LOCAL.getText("100072");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Energy){this.itemName.string=o.LOCAL.getText("100073"),this.itemDes.string=o.LOCAL.getText("100074");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Military){this.itemName.string=o.LOCAL.getText("100075"),this.itemDes.string=o.LOCAL.getText("100076");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.BountyCount){this.itemName.string=o.LOCAL.getText("BountyQuest021"),this.itemDes.string=o.LOCAL.getText("BountyQuest022");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.Honor){this.itemName.string=o.LOCAL.getText("public340"),this.itemDes.string=o.LOCAL.getText("public341");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.islandPoint){this.itemName.string=o.LOCAL.getText("island016"),this.itemDes.string=o.LOCAL.getText("island017");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.AGExp){this.itemName.string=o.LOCAL.getText("gift_exp_title"),this.itemDes.string=o.LOCAL.getText("gift_exp_desc");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.AGKey){this.itemName.string=o.LOCAL.getText("gift_key_title"),this.itemDes.string=o.LOCAL.getText("gift_key_desc");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.AdventureCoin){this.itemName.string=o.LOCAL.getText("adventure118"),this.itemDes.string=o.LOCAL.getText("adventure133");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.kvk_res){this.itemName.string=o.LOCAL.getText("kvk_info_088"),this.itemDes.string=o.LOCAL.getText("kvk_info_090");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}else if(B==d.ResourceType.kvk_honor){this.itemName.string=o.LOCAL.getText("kvk_info_089"),this.itemDes.string=o.LOCAL.getText("kvk_info_091");D=cc.instantiate(this.itemPrefab);this.itemNode.addChild(D),D.getComponent(c.default).UpdateRes(t[1],a),D.getComponent(c.default).SetClick(!1)}var V=t[0],H=cc.v2(cc.winSize.width/2,cc.winSize.height/2);i.default.verifyNode(V)&&i.default.verifyNode(V.parent)&&(H=V.parent.convertToWorldSpaceAR(V.position));var W=this.node.parent.convertToNodeSpaceAR(H);W.x=0,this.node.setPosition(W),this.itemName.node.color=i.default.getColorByQuality(w),t.length>=4&&t[3]>0&&(this.node.y+=t[3]),t[4]?(this.doBtn.active=!0,this._doCallBack=t[4]):(this.doBtn.active=!1,this._doCallBack=null)}},t.prototype.doClick=function(){this._doCallBack&&this._doCallBack(),this.CloseUI()},t.prototype.CloseUI=function(){s.default.Instance().CloseUI(l.UIDataInfo.PropDetailPanel)},__decorate([g(cc.Label)],t.prototype,"itemName",void 0),__decorate([g(cc.Label)],t.prototype,"itemDes",void 0),__decorate([g(cc.Node)],t.prototype,"itemNode",void 0),__decorate([g(cc.Prefab)],t.prototype,"itemPrefab",void 0),__decorate([g(cc.Prefab)],t.prototype,"talentPrefab",void 0),__decorate([g(cc.Prefab)],t.prototype,"heroElementItem",void 0),__decorate([g(cc.Node)],t.prototype,"doBtn",void 0),__decorate([g(cc.Node)],t.prototype,"markNode",void 0),t=__decorate([y],t)}(n.default);a.default=C,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../fws/utils/FWSTool":"FWSTool","../../Common/BaseUI":"BaseUI","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Const/TableName":"TableName","../../Const/UIDataInfo":"UIDataInfo","../../Profession/ProfessionController":"ProfessionController","../../Tools/GameTools":"GameTools","../../hero/HeroController":"HeroController","../Item/HeroElementItem":"HeroElementItem","../Item/PropItem":"PropItem"}],SciencePanel:[function(e,t,a){"use strict";cc._RF.push(t,"eca81D5Bf1L3YHmJmqRSRY8","SciencePanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../Common/UIManager"),i=e("../../Const/UIDataInfo"),r=e("../../../Core/Common/TableManager"),s=e("../../../Core/Event/EventCenter"),l=e("../../Const/EventId"),c=e("../../Data/DataCenter"),d=e("../../Const/GameDefine"),p=e("../../Tools/GameTools"),u=e("../Item/ScienceItemNew"),h=e("../../controllers/ScienceController"),m=e("../../Common/LoadManager"),f=e("../../Data/GuideData"),_=e("../../../fws/display/dialogs/DialogContentComponent"),y=e("../../Common/TaskGuide"),g=e("../../Const/TableName"),C=cc._decorator,v=C.ccclass,I=C.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Content=null,t.ToggleContainer=null,t.ToggleView=[],t.ToggleList=[],t.redPoints=[],t.ScienceItemNewPrefab=null,t.diamondLabel=null,t.diamondLabel2=null,t.diamondNode2=null,t.coinLabel=null,t.bgWidget=null,t.expFlyNode=null,t.ScienceItemPool={},t}var a;return __extends(t,e),a=t,t.ShowViewWithDefaultType=function(e){a.LastPageIndex=e,a.ShowView()},t.ShowView=function(){c.DATA.UserData.FunctionOn(d.FunctionKey.key_novice_adjustments)?n.default.Instance().ShowTips(o.LOCAL.getText("100086")):0!=c.DATA.UserData.FunctionOn(d.FunctionKey.Science)?(n.default.Instance().OpenUI(i.UIDataInfo.SciencePanel),f.default.getInst().removeNPCTalk(f.G123EventType.e_G123EventType_ScienceCan)):n.default.Instance().ShowTips(o.LOCAL.getText("100086"))},t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),s.EVENT.on(l.EventId.Science_Update,this.UpdateView,this),s.EVENT.on(l.EventId.PlayerLevelUpUpdate,this.SetView,this),s.EVENT.on(l.EventId.Resource_Update,this.UpdateResource,this),s.EVENT.on(l.EventId.ScienceExpFly,this.flyEXP,this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),s.EVENT.off(l.EventId.Science_Update,this.UpdateView,this),s.EVENT.off(l.EventId.PlayerLevelUpUpdate,this.SetView,this),s.EVENT.off(l.EventId.Resource_Update,this.UpdateResource,this),s.EVENT.off(l.EventId.ScienceExpFly,this.flyEXP,this)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),-1!=y.default.Instance.TaskPara&&(a.LastPageIndex=1),this.InitToggleList(),this.SetView(a.LastPageIndex)},t.prototype.InitToggleList=function(){for(var e=0;e<this.ToggleList.length;e++)this.ToggleList[e].isChecked=a.LastPageIndex==e+1},t.prototype.SetView=function(e){e>=1&&e<=3&&(a.LastPageIndex=e);for(var t=1;t<4;t++){var o="toggle"+t.toString(),n=this.ToggleContainer.getChildByName(o).getComponent(cc.Toggle),i=this.redPoints[t-1];if(2!==t)if(3!==t)n.isChecked=t==a.LastPageIndex;else{var s=(l=r.TABLE.getTableDataById(g.TableName.DATACONFIG,"11110"))&&l.value<=c.DATA.UserData.Level;i&&(i.active=s)}else{var l,d=(l=r.TABLE.getTableDataById(g.TableName.DATACONFIG,"11109"))&&l.value<=c.DATA.UserData.Level;i&&(i.active=d)}}this.UpdateView()},t.prototype.OnTypePageClick=function(e,t){var i,s=parseInt(t.toString());if(2==s&&((i=r.TABLE.getTableDataById(g.TableName.DATACONFIG,"11109"))&&i.value>c.DATA.UserData.Level)){for(var l=0;l<this.ToggleList.length;l++)this.ToggleList[l].isChecked=a.LastPageIndex==l+1;return void n.default.Instance().ShowTips(o.LOCAL.getText("100090",i.value))}if(3==s&&((i=r.TABLE.getTableDataById(g.TableName.DATACONFIG,"11110"))&&i.value>c.DATA.UserData.Level)){for(l=0;l<this.ToggleList.length;l++)this.ToggleList[l].isChecked=a.LastPageIndex==l+1;return void n.default.Instance().ShowTips(o.LOCAL.getText("100090",i.value))}this.diamondNode2.active=1!=s,a.LastPageIndex!=s&&(a.LastPageIndex=s,this.UpdateView())},t.prototype.getScienceListByType=function(e){var t=r.TABLE.getTableGroup(g.TableName.SCIENCE),a=new Array;for(var o in t){var n=t[o];void 0!==n&&null!==n&&n.type==e&&a.push(n)}return a},t.prototype.UpdateItemLines=function(){for(var e in this.ScienceItemPool){var t=this.ScienceItemPool[e];if(null!=t.ScienceData){var a=parseInt(e.toString()),o=Math.floor(a/10)+1,n=Math.floor(a%10),i=this.ScienceItemPool[10*o+n];if(null===i||void 0===i||null==i.ScienceData||t.ScienceData.type==d.ScienceType.ArmyBoost)t.HideLine();else{var r=i.ScienceLocked;t.UpdateLineState(0==r)}}}},t.prototype.UpdateView=function(){if(this.UpdateResource(),1===a.LastPageIndex){var e=h.default.getScienceArrByType(a.LastPageIndex),t=0;for(var i in e){(l=e[i]).pos_y>t&&(t=l.pos_y)}this.ScienceItemPool={},this.Content.destroyAllChildren();for(var r=1;r<=t;r++)for(var s=1;s<=4;s++){(p=cc.instantiate(this.ScienceItemNewPrefab)).parent=this.Content;i=10*r+s;this.ScienceItemPool[i]=p.getComponent(u.default)}for(var i in e){var l,p,f=(l=e[i]).pos_x,_=10*l.pos_y+f;null!=(p=this.ScienceItemPool[_])&&(p.UpdateItem(l,this),p.name=l.group_id.toString())}this.UpdateItemLines()}else if((2===a.LastPageIndex||3===a.LastPageIndex)&&!c.DATA.UserData.FunctionOn(d.FunctionKey.Enhance_Basic))return void n.default.Instance().ShowTips(o.LOCAL.getText("110015"));a.LastPageIndex-1==1?this.bgWidget.bottom=122:this.bgWidget.bottom=0,this.bgWidget.updateAlignment();var y=this.bgWidget.node.getChildByName("bg_ShopPanel3");y&&y.getComponent(cc.Widget)&&y.getComponent(cc.Widget).updateAlignment();var g=function(e){var t=a.LastPageIndex-1===e,o=C.ToggleView[e];if(o.active=t,t&&0===o.childrenCount){var n="";1===e?n="ea_prefab/ui/ArmyEquipInstallView":2===e&&(n="ea_prefab/ui/ArmyEquipDefaultView"),m.LoadManager.loadPrefabSync(n,function(e,t){if(t){var a=cc.instantiate(t);a&&o.addChild(a)}},C)}},C=this;for(r=0;r<this.ToggleView.length;r++)g(r)},t.prototype.ScienceItemNewCallBack=function(e){0==e.ScienceLocked&&h.default.openScienceLearnPanel(e.ScienceId)},t.prototype.OnCloseClick=function(){n.default.Instance().CloseUI(i.UIDataInfo.SciencePanel)},t.prototype.UpdateResource=function(){this.diamondLabel.string=Math.floor(c.DATA.UserData.Resource.Gold).toString(),this.diamondLabel2.string=Math.floor(c.DATA.UserData.Resource.Gold).toString(),this.coinLabel.string=p.default.GetLargeNumberShow(c.DATA.UserData.Resource.getResource(d.ResourceType.Coin))},t.prototype.flyEXP=function(e,t){void 0!=e&&e>0&&void 0!=t&&p.default.AddCoinCostExpByPosInUI(e,t,this.expFlyNode)},t.LastPageIndex=1,__decorate([I(cc.Node)],t.prototype,"Content",void 0),__decorate([I(cc.Node)],t.prototype,"ToggleContainer",void 0),__decorate([I([cc.Node])],t.prototype,"ToggleView",void 0),__decorate([I(cc.Toggle)],t.prototype,"ToggleList",void 0),__decorate([I(cc.Node)],t.prototype,"redPoints",void 0),__decorate([I(cc.Prefab)],t.prototype,"ScienceItemNewPrefab",void 0),__decorate([I(cc.Label)],t.prototype,"diamondLabel",void 0),__decorate([I(cc.Label)],t.prototype,"diamondLabel2",void 0),__decorate([I(cc.Node)],t.prototype,"diamondNode2",void 0),__decorate([I(cc.Label)],t.prototype,"coinLabel",void 0),__decorate([I(cc.Widget)],t.prototype,"bgWidget",void 0),__decorate([I(cc.Node)],t.prototype,"expFlyNode",void 0),t=a=__decorate([v],t)}(_.default);a.default=T,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Event/EventCenter":"EventCenter","../../../fws/display/dialogs/DialogContentComponent":"DialogContentComponent","../../Common/LoadManager":"LoadManager","../../Common/TaskGuide":"TaskGuide","../../Common/UIManager":"UIManager","../../Const/EventId":"EventId","../../Const/GameDefine":"GameDefine","../../Const/TableName":"TableName","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Data/GuideData":"GuideData","../../Tools/GameTools":"GameTools","../../controllers/ScienceController":"ScienceController","../Item/ScienceItemNew":"ScienceItemNew"}],ServerListPanel:[function(e,t,a){"use strict";cc._RF.push(t,"8322cmFF3ZMorrVURjEtIs0","ServerListPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../Common/BaseUI"),i=e("../../Common/UIManager"),r=e("../../Const/UIDataInfo"),s=e("../../Data/DataCenter"),l=e("../../Tools/GameTools"),c=e("../../Common/ListView/FrameTaskManager"),d=e("../../Common/ConfirmPanel"),p=e("./ChooseServerPanel"),u=e("../Item/UserServerItem"),h=e("../../Const/GameDefine"),m=e("../../../fws/utils/X"),f=e("../../Common/GM"),_=cc._decorator,y=_.ccclass,g=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ToggleContainer=null,t.ToggleItem=null,t.ServerListContent=null,t.ServerItem=null,t.UserServerItem=null,t.PageIndex=0,t.ServerRatePool={},t.serverListIdMap={},t}return __extends(t,e),t.ShowView=function(){i.default.Instance().OpenUI(r.UIDataInfo.ServerListPanel)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t);var a=s.DATA.UserData.ServerList;a.length<2&&i.default.Instance().ShowTips(o.LOCAL.getText("public907"));for(var n=0;n<a.length;n++)this.ServerRatePool[a[n].Id.toString()]=a[n].Rate.toString();var r=l.default.getDataConfigData(10004);this.ServerState=r.split("|"),this.InitView()},t.prototype.InitView=function(){this.AddToggleItem(-1),this.AddToggleItem(0);for(var e=s.DATA.UserData.ServerList,t=0,a=0;a<e.length;a++){var o=e[a];this.serverListIdMap[o.Id]=a,o.isGM||o.slistShowType>0||o.matchPlatformSid&&t<o.Id&&(t=o.Id)}var n=Math.floor(t/10)+1;t%10==0&&n>1&&n--;for(a=0;a<n;a++)for(var i=0;i<10;i++){var r=10*a+i+1;if((o=e[this.serverListIdMap[r]])&&(!o.isGM&&!(o.slistShowType>0)&&o.matchPlatformSid)){m.log("(ServerListPanel) \u6dfb\u52a0\u670d\u6807\u7b7e",o),this.AddToggleItem(a+1);break}}},t.prototype.UpdateServerList=function(){if(this.ServerListContent.safetyDestroyAllChildren(),-1==this.PageIndex)for(var e=s.DATA.UserData.UserServerList,t=0;t<e.length;t++)this.AddUserServerItem(e[t]);else if(0==this.PageIndex){var a=new Array;for(e=s.DATA.UserData.ServerList,t=0;t<e.length;t++){var o=e[t];(o.isGM||o.Rate>0||o.slistShowType>0)&&a.push(o)}a.length>0&&a.sort(this.compareServerData);for(t=0;t<a.length;t++){var n=a[t];n.matchPlatformSid&&this.AddServerItem(n.Id,n.isGM,n.pfs,n.Country)}}else{e=s.DATA.UserData.ServerList;var i=10*(this.PageIndex-1);for(t=0;t<e.length;t++){var r=e[t];if(r){var l=r.Id;if(!(l<=i||l>i+10)){var c=r.Country||"";r.isGM||r.matchPlatformSid&&(m.log("(ServerListPanel) \u6dfb\u52a0\u670d",r),this.AddServerItem(l,r.isGM,r.pfs,c))}}}}},t.prototype.compareServerData=function(e,t){return e.Rate>t.Rate?-1:e.Rate<t.Rate?1:e.Id<t.Id?-1:e.Id>t.Id?1:0},t.prototype.AddServerItem=function(e,t,a,o){if(void 0===o&&(o=""),!t||f.is()){var n=this.ServerRatePool[e.toString()];if(null!=n&&""!=n)s.DATA.UserData.FunctionOn(h.FunctionKey.show_foreign_server)||(o=""),function(t){if(l.default.verifyComponent(this)){var a=cc.instantiate(this.ServerItem);a.parent=this.ServerListContent,a.active=!0,a.name=e.toString();var n=cc.find("Layout/ServerName",a).getComponent(cc.Label),i=a.getChildByName("state").getComponent(cc.Sprite),r=a.getChildByName("rateMark"),s=a.getChildByName("countryNode"),c=this.ServerRatePool[e.toString()];if(c=null==c||""==c?0:parseInt(c),o&&""!=o)s.active=!0,s.safetyDestroyAllChildren(),o.split(",").forEach(function(e){var t=new cc.Node;t.parent=s;var a=t.addComponent(cc.Sprite);l.default.setSpriteFrame("image/server/"+e,a)});else s.active=!1;var d=this.getStateByRate(c);r.active=c>0,l.default.setSpriteFrame("image/server/"+d.toString(),i),n.string=e.toString()}}.bind(this,e)()}},t.prototype.getStateByRate=function(e){for(var t=3,a=0;a<this.ServerState.length;a++){if(e>=parseFloat(this.ServerState[a].toString())){t=a+1;break}}return t},t.prototype.AddUserServerItem=function(e){var t=function(t){if(l.default.verifyComponent(this)){var a=cc.instantiate(this.UserServerItem);a.parent=this.ServerListContent,a.active=!0,a.getComponent(u.default).UpdateData(e)}}.bind(this,e),a=new c.FrameTask(t,"ServerItem");a.forceInOneFrame=!0,c.FrameTaskManager.getInstance().addTask(a)},t.prototype.AddToggleItem=function(e){var t=function(t){if(l.default.verifyComponent(this)){var a=cc.instantiate(this.ToggleItem);a.parent=this.ToggleContainer,a.getComponent(cc.Toggle).isChecked=e==this.PageIndex,a.name=e.toString(),a.active=!0,a.getChildByName("label").getComponent(cc.Label).string=this.getToggleName(e)}}.bind(this,e),a=new c.FrameTask(t,"ServerItem");a.forceInOneFrame=!0,c.FrameTaskManager.getInstance().addTask(a)},t.prototype.getToggleName=function(e){var t=o.LOCAL.getText("100138");if(0==e)t=o.LOCAL.getText("100139");else if(e>0){var a=(10*(e-1)+1).toString()+"-"+(10*e).toString();t=o.LOCAL.getText("public105",a)}return t},t.prototype.onToggleClick=function(e,t){m.log("onToggleClick:"+e.node.name),this.PageIndex=parseInt(e.node.name)||0,this.UpdateServerList()},t.prototype.onServerItemClick=function(e){m.log("event.target.name:"+e.target.name);var t=parseInt(e.target.name);if(t==s.DATA.UserData.OriginServerId)return i.default.Instance().ShowTips(o.LOCAL.getText("110037")),void m.log("\u5f53\u524d\u5c31\u5728\u8fd9\u4e2a\u670d\u52a1\u5668\u4e86\u3002");for(var a="",n=0,r=s.DATA.UserData.UserServerList,l=0;l<r.length;l++)if(r[l].Id==t){n=r[l].Uid;break}var c=s.DATA.UserData.ServerList;for(l=0;l<c.length;l++)if(c[l].Id==t){a=c[l].Url,c[l].submitReport();break}""!=a?this.SendChangeServer(t,n,a):i.default.Instance().ShowTips(o.LOCAL.getText("110038"))},t.prototype.onUserServerItemClick=function(e){m.log("event.target.name:"+e.target.name);var t=e.target.parent.getComponent(u.default),a=t.ServerData.Id;a!=s.DATA.UserData.OriginServerId||t.ServerData.Uid!=s.DATA.UserData.UID?""!=t.ServerData.Url?this.SendChangeServer(a,t.ServerData.Uid,t.ServerData.Url):i.default.Instance().ShowTips(o.LOCAL.getText("110038")):i.default.Instance().ShowTips(o.LOCAL.getText("110039"))},t.prototype.SendChangeServer=function(e,t,a){var n=o.LOCAL.getText("110040",e.toString());0==t&&(n+=o.LOCAL.getText("110041")),d.default.ShowView(n,o.LOCAL.getText("110042"),this,function(){p.default.SendChangeServer(e,t,a)},null)},t.prototype.onCloseClick=function(){i.default.Instance().CloseUI(r.UIDataInfo.ServerListPanel)},__decorate([g(cc.Node)],t.prototype,"ToggleContainer",void 0),__decorate([g(cc.Node)],t.prototype,"ToggleItem",void 0),__decorate([g(cc.Node)],t.prototype,"ServerListContent",void 0),__decorate([g(cc.Node)],t.prototype,"ServerItem",void 0),__decorate([g(cc.Node)],t.prototype,"UserServerItem",void 0),t=__decorate([y],t)}(n.default);a.default=C,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../fws/utils/X":"X","../../Common/BaseUI":"BaseUI","../../Common/ConfirmPanel":"ConfirmPanel","../../Common/GM":"GM","../../Common/ListView/FrameTaskManager":"FrameTaskManager","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Tools/GameTools":"GameTools","../Item/UserServerItem":"UserServerItem","./ChooseServerPanel":"ChooseServerPanel"}],UserAuthor:[function(e,t,a){"use strict";cc._RF.push(t,"df04dJqevJPGqcnBtvfcX3B","UserAuthor"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Common/BaseUI"),n=e("../../Data/DataCenter"),i=e("../../Const/UIDataInfo"),r=e("../../Common/UIManager"),s=e("../../Common/BIManager"),l=e("../../../fws/utils/X"),c=e("../../../fws/platforms/PlatformCore"),d=cc._decorator,p=d.ccclass,u=d.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BtnSure=null,t.CallBack=null,t.ForceAuthor=!1,t}var a;return __extends(t,e),a=t,t.CheckAuthor=function(e,t){void 0===t&&(t=!1),l.log("CheckAuthor:"+n.DATA.UserData.PlayerInfoData.authorized),!n.DATA.UserData.PlayerInfoData.authorized&&c.instance.needUserAuthor()?a.UpdateAuthor(e,t):null!=e&&e.call(null)},t.UpdateAuthor=function(e,t){if(void 0===t&&(t=!1),c.instance.enabledUseOpenSetting)return l.log("PlatformCore.instance.enabledUseOpenSetting"),void c.instance.authorize({scope:"scope.userInfo",success:function(e){n.DATA.UserData.PlayerInfoData.getPlatformData()},fail:function(e){l.log(e),c.instance.openSetting({success:function(e){l.log("success",e),e.authSetting&&1==e.authSetting["scope.userInfo"]&&n.DATA.UserData.PlayerInfoData.getPlatformData()},fail:function(e){l.log("fail",e)}})}});r.default.Instance().OpenUI(i.UIDataInfo.UserAuthor,e,t)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),this.CallBack=t[0],this.ForceAuthor=t[1],this.cpnScheduleOnce(this,this.AddUserInfoBtn,.5)},t.prototype.OnSureClick=function(){},t.prototype.OnCancleClick=function(){this.CloseView(!1)},t.prototype.AddUserInfoBtn=function(){l.log("\u5f00\u59cb\u6dfb\u52a0\u5fae\u4fe1\u6388\u6743\u6309\u94ae\uff01\uff01\uff01\uff01\uff01");var e=this,t=cc.view.getVisibleSize(),o=cc.view.getFrameSize(),i=this.BtnSure.parent.convertToWorldSpaceAR(this.BtnSure.position),r=i.x*o.width/t.width,d=i.y*o.height/t.height;d=o.height-d;var p=this.BtnSure.width*o.width/t.width,u=this.BtnSure.height*o.height/t.height;a.WxBtn&&(a.WxBtn.hide(),a.WxBtn.destroy(),a.WxBtn=null),a.WxBtn=c.instance.createUserInfoButton({type:"text",text:"",style:{left:r-p/2,top:d-u/2,width:p,height:u,lineHeight:0,backgroundColor:"",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}),a.WxBtn.onTap(function(t){if(t){var a=!1;try{l.log("\u5fae\u4fe1\u6388\u6743\u7684\u56de\u8c03 ",t),t.userInfo?(n.DATA.UserData.PlayerInfoData.updatePlatformData(t.userInfo),a=!0,s.default.Instance.PostExtraAction("GrantRet",{ret:0})):(l.log("user get a sick, deny"),s.default.Instance.PostExtraAction("GrantRet",{ret:1}))}catch(e){l.error("GetUserInfoButton:onTap",e)}e.CloseView(a)}})},t.prototype.CloseView=function(e){a.WxBtn&&(a.WxBtn.hide(),a.WxBtn.destroy(),a.WxBtn=null),r.default.Instance().CloseUI(i.UIDataInfo.UserAuthor),0!=this.ForceAuthor&&1!=e||null!=this.CallBack&&this.CallBack.call(null)},t.WxBtn=null,__decorate([u(cc.Node)],t.prototype,"BtnSure",void 0),t=a=__decorate([p],t)}(o.default);a.default=h,cc._RF.pop()},{"../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/utils/X":"X","../../Common/BIManager":"BIManager","../../Common/BaseUI":"BaseUI","../../Common/UIManager":"UIManager","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter"}],WIAsyncPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"eab5cVUV6hI27vH2tW79iPp","WIAsyncPrefab"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../Tools/GameTools"),i=e("../../Common/LoadManager"),r=e("../../components/worldmap/WorldMapCommon"),s=e("../../../fws/utils/X"),l=cc._decorator.ccclass,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._currentPath=null,t._content=null,t._asyncOpManager=null,t._updateFunction=null,t}return __extends(t,e),t.prototype.reuse=function(){},t.prototype.unuse=function(){this._currentPath=null,this._asyncOpManager=null,this._updateFunction=null,this._content&&(this._content.destroy(),this._content=null)},t.prototype.cpnDestroy=function(){this._currentPath=null,this._asyncOpManager=null,this._updateFunction=null,this._content=null},t.prototype.bindAsyncOpManager=function(e){this._asyncOpManager=e},t.prototype.loadPrefab=function(e,t,a,o){if(void 0===a&&(a=!0),void 0===o&&(o=r.WorldMapFrameOperationQueue.LOW_PRIORITY),n.default.verifyComponent(this)&&this._asyncOpManager)if(this._currentPath===e)this._content?e?t&&t(this._content):(this._content.destroy(),this._content=null):this._updateFunction=t;else{if(this._content&&(this._content.destroy(),this._content=null),this._currentPath=e,this._updateFunction=t,!e)return;var l=this;i.LoadManager.loadPrefab(e,function(t,n){t?s.error(t):l._asyncOpManager&&l._currentPath===e&&(cc.assetReleaseChecker.lockAsset(n),l._asyncOpManager.appendFuncOperation(function(){if(cc.assetReleaseChecker.unlockAsset(n),l._asyncOpManager&&l._currentPath===e){var t=l._content=cc.instantiate(n);if(l.node.addChild(l._content),a&&t.setPosition(0,0),l._updateFunction){var o=l._updateFunction;l._updateFunction=null,o(t)||(s.log("\u5237\u65b0\u5185\u5bb9\u8282\u70b9\u51fa\u9519",e),t.destroy(),l._content=null)}}},function(){cc.assetReleaseChecker.unlockAsset(n)},o))},this)}},t=__decorate([l],t)}(o.default);a.default=c,cc._RF.pop()},{"../../../System/ComponentBase":"ComponentBase","../../../fws/utils/X":"X","../../Common/LoadManager":"LoadManager","../../Tools/GameTools":"GameTools","../../components/worldmap/WorldMapCommon":"WorldMapCommon"}],WICity:[function(e,t,a){"use strict";cc._RF.push(t,"f15c0t4Z1tAWrQ68NbHbT19","WICity"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../../Core/Common/TableManager"),i=e("../../../Core/Utils/UpdateSpriteFrame"),r=e("../../Common/LoadManager"),s=e("../../Tools/GameTools"),l=e("../../../Core/Event/EventCenter"),c=e("../../Const/EventId"),d=e("./WIAsyncPrefab"),p=e("../../Const/TableName"),u=cc._decorator,h=u.ccclass,m=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainPic=null,t.castleAnim=null,t.castleChangeAnimNode=null,t.castleEffect=null,t.UINode=null,t.OfficialIcon=null,t.extraEffectNode=null,t.leaderEffect=null,t.lastOfficial=-1,t._cityInfo=null,t._recycled=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"recycled",{get:function(){return this._recycled},enumerable:!0,configurable:!0}),t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),l.EVENT.on(c.EventId.POTION_USE_EFFECT,this.usePotion,this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),l.EVENT.off(c.EventId.POTION_USE_EFFECT,this.usePotion,this)},t.prototype.reuse=function(){var e;(this._recycled=!1,this.mainPic&&(this.mainPic.spriteFrame=null),this.castleAnim)&&((e=this.castleAnim.getComponent(d.default))&&e.reuse());this.castleEffect&&((e=this.castleEffect.getComponent(d.default))&&e.reuse())},t.prototype.unuse=function(){var e;(this._recycled=!0,this.castleAnim)&&((e=this.castleAnim.getComponent(d.default))&&e.unuse());this.castleEffect&&((e=this.castleEffect.getComponent(d.default))&&e.unuse());this.extraEffectNode&&this.extraEffectNode.safetyDestroyAllChildren(),this.castleChangeAnimNode&&this.castleChangeAnimNode.safetyDestroyAllChildren()},t.prototype.UpdateItem=function(e){this._cityInfo=e;var t=null;if(this.lastOfficial!=e.title)if(this.lastOfficial=e.title,e.title>0&&(t=n.TABLE.getTableDataById(p.TableName.THRONE_TITLE,e.title.toString())),null!=t){this.UINode.active=!0;var a="image/throne/"+t.icon;i.UpdateSpriteFrame(a,this.OfficialIcon);var o,r=!1;if(e.skinId>0&&null!=(o=n.TABLE.getTableDataById(p.TableName.SKIN,e.skinId.toString()))&&(r=!0),r){if(this.UINode.setPosition(0,140),o&&o.icon_pos){var s=o.icon_pos.split(",");2!=s.length||isNaN(s[0])||isNaN(s[1])||this.UINode.setPosition(s[0],s[1])}}else this.UINode.setPosition(0,90)}else this.UINode.active=!1},t.prototype.usePotion=function(e){var t=this;if(this._cityInfo&&e&&e.id&&e.param)if(10001==e.id)e.param.src&&e.param.src==this._cityInfo.pid&&this.PlayEffect("Effect_daodanfashejing");else if(10002==e.id)e.param.tgt&&e.param.tgt==this._cityInfo.pid&&this.PlayEffect("Effect_guowangpifu_shouji");else if(10003==e.id&&e.param.src&&e.param.src==this._cityInfo.pid){var a=this;if(e.param.old){var o=null;if(!(o=1==this._cityInfo.sskin&&"G123"===window.channel?n.TABLE.getTableDataById(p.TableName.SKIN_LIMITED,e.param.old.toString()):n.TABLE.getTableDataById(p.TableName.SKIN,e.param.old.toString()))||!o.change_effect)return;this.castleAnim.active=!1,this.PlayChangeSkinEffect(o.change_effect,function(e){s.default.verifyComponent(a)&&s.default.verifyNode(a.extraEffectNode)&&(a._recycled||(e.removeFromParent(),t.castleAnim.active=!0))})}}},t.prototype.PlayEffect=function(e){var t="effect/prefab/"+e,a=this;r.LoadManager.loadPrefab(t,function(e,t){if(t){if(!s.default.verifyComponent(a))return;if(!s.default.verifyNode(a.extraEffectNode))return;if(a._recycled)return;a.extraEffectNode.safetyDestroyAllChildren(),cc.instantiate(t).parent=a.extraEffectNode}},this)},t.prototype.PlayChangeSkinEffect=function(e,t){void 0===t&&(t=null);var a=e,o=this;r.LoadManager.loadPrefab(a,function(e,a){if(a){if(!s.default.verifyComponent(o))return;if(!s.default.verifyNode(o.castleChangeAnimNode))return;if(o._recycled)return;var n=cc.instantiate(a);n.parent=o.castleChangeAnimNode,n.scale=o.castleAnim.scale,n.x=o.castleAnim.x,n.y=o.castleAnim.y;var i=n.getComponent(cc.Animation);i&&t&&i.on("finished",function(e){t(n)},this,!0)}else this.castleAnim.active=!0},this)},__decorate([m(cc.Sprite)],t.prototype,"mainPic",void 0),__decorate([m(cc.Node)],t.prototype,"castleAnim",void 0),__decorate([m(cc.Node)],t.prototype,"castleChangeAnimNode",void 0),__decorate([m(cc.Node)],t.prototype,"castleEffect",void 0),__decorate([m(cc.Node)],t.prototype,"UINode",void 0),__decorate([m(cc.Sprite)],t.prototype,"OfficialIcon",void 0),__decorate([m(cc.Node)],t.prototype,"extraEffectNode",void 0),__decorate([m(cc.Node)],t.prototype,"leaderEffect",void 0),t=__decorate([h],t)}(o.default);a.default=f,cc._RF.pop()},{"../../../Core/Common/TableManager":"TableManager","../../../Core/Event/EventCenter":"EventCenter","../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../Common/LoadManager":"LoadManager","../../Const/EventId":"EventId","../../Const/TableName":"TableName","../../Tools/GameTools":"GameTools","./WIAsyncPrefab":"WIAsyncPrefab"}],WIResource:[function(e,t,a){"use strict";cc._RF.push(t,"6883dyANNxNK7X4MH0SNcUc","WIResource"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../components/worldmap/WorldMapCommon"),i=e("../../Tools/GameTools"),r=e("../../Data/DataCenter"),s=e("../../../Core/Utils/UpdateSpriteFrame"),l=e("../../battle/components/PrefabPlaceHolder"),c=cc._decorator,d=c.ccclass,p=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buildingPic=null,t.buildingPrefab=null,t.selfNode=null,t.enemyNode=null,t.friendNode=null,t.lastPrefabName="",t}return __extends(t,e),t.prototype.reuse=function(){if(this.buildingPic&&(this.buildingPic.spriteFrame=null),this.buildingPrefab){var e=this.buildingPrefab.getComponent(l.default);e&&e.reuse()}},t.prototype.unuse=function(){if(this.selfNode&&(this.selfNode.opacity=0),this.enemyNode&&(this.enemyNode.opacity=0),this.friendNode&&(this.friendNode.opacity=0),this.buildingPrefab){var e=this.buildingPrefab.getComponent(l.default);e&&e.unuse()}},t.prototype.UpdateItem=function(e,t){if(i.default.verifyComponent(this)){if(t.build_prefab>0){this.buildingPic.node.active=!1,this.buildingPrefab.active=!0;var a="ea_prefab/world/resource/"+t.model;if(a!=this.lastPrefabName){this.lastPrefabName=a;var o=this.buildingPrefab.getComponent(l.default);!o&&(o=this.buildingPrefab.addComponent(l.default)),o.prefabPath=a}}else if(this.buildingPrefab.active=!1,this.buildingPic.node.active=!0,i.default.verifyComponent(this.buildingPic)){s.UpdateSpriteFrame("image/world_unit/"+t.model,this.buildingPic);var r=this.buildingPic.node;r.x=t.offSet.x,r.y=t.offSet.y}e.type===n.WorldMapEntityType.Resource&&this.updateResInfo(e,t)}},t.prototype.updateResInfo=function(e,t){i.default.verifyComponent(this)&&e&&t&&(this.selfNode.opacity=t.ownerId===r.DATA.UserData.UID.toString()?255:0,this.enemyNode.opacity=void 0!==e.extData.aid&&e.extData.aid!==r.DATA.UserData.Alliance.Aid&&t.ownerId!==r.DATA.UserData.UID.toString()?255:0,this.friendNode.opacity=t.ownerId!==r.DATA.UserData.UID.toString()&&void 0!==e.extData.aid&&e.extData.aid===r.DATA.UserData.Alliance.Aid?255:0)},__decorate([p(cc.Sprite)],t.prototype,"buildingPic",void 0),__decorate([p(cc.Node)],t.prototype,"buildingPrefab",void 0),__decorate([p(cc.Node)],t.prototype,"selfNode",void 0),__decorate([p(cc.Node)],t.prototype,"enemyNode",void 0),__decorate([p(cc.Node)],t.prototype,"friendNode",void 0),t=__decorate([d],t)}(o.default);a.default=u,cc._RF.pop()},{"../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../Data/DataCenter":"DataCenter","../../Tools/GameTools":"GameTools","../../battle/components/PrefabPlaceHolder":"PrefabPlaceHolder","../../components/worldmap/WorldMapCommon":"WorldMapCommon"}],BaseProcedure:[function(e,t,a){"use strict";cc._RF.push(t,"d84e1QH7AdLy5gWwLuDYXCl","BaseProcedure"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Common/UIManager"),n=e("../Scene/SceneManager"),i=function(){function e(){this._useMaskAnimation=!0,this._prepared=!1}return e.prototype.warm=function(){this.doWarm()},e.prototype.prepareSwitch=function(e,t){if(this._prepared)t&&t();else{this._useMaskAnimation=!0,this._prepared=!0;var a=o.default.Instance().sceneTransition;a&&this.checkIfUseSceneTransition(e)?(this._useMaskAnimation=!1,a.showEffect(function(){t&&t()})):t&&t()}},Object.defineProperty(e.prototype,"sceneName",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.onSwitchStart=function(){if(this.sceneName){var e=this;if(n.default.Instance().preloadScene(this.sceneName,function(t){e.doSceneReload(t)},function(t){e.onLoaded(t)},this._useMaskAnimation,this.autoReleased),!this._useMaskAnimation){var t=cc.director.getScene().getChildByName("Canvas");t&&(t.opacity=0)}this.doSwitchStart()}},e.prototype.onLoaded=function(e){this.doSceneLoaded(function(){o.default.Instance().sceneTransition&&o.default.Instance().sceneTransition.hideEffect(),e&&e()})},e.prototype.onSwitchEnd=function(){this._prepared=!1,this.doSwitchEnd()},e.prototype.onSwitchReset=function(){this._prepared&&(this._prepared=!1,o.default.Instance().sceneTransition&&o.default.Instance().sceneTransition.hideEffect()),this.doSwitchReset()},e.prototype.doWarm=function(){},e.prototype.doSwitchStart=function(){},e.prototype.doSceneReload=function(e){var t=this;n.default.Instance().preloadScene(this.sceneName,function(e){t.doSceneReload(e)},function(e){t.onLoaded(e)},this._useMaskAnimation,this.autoReleased)},e.prototype.doSceneLoaded=function(e){},e.prototype.doSwitchEnd=function(){},e.prototype.doSwitchReset=function(){},e.prototype.checkIfUseSceneTransition=function(e){return!0},Object.defineProperty(e.prototype,"autoReleased",{get:function(){return!0},enumerable:!0,configurable:!0}),e}();a.BaseProcedure=i,cc._RF.pop()},{"../Common/UIManager":"UIManager","../Scene/SceneManager":"SceneManager"}],HomeOtherProcedure:[function(e,t,a){"use strict";cc._RF.push(t,"b645dBXhh5CUrOBS7QWrHiu","HomeOtherProcedure"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Const/SceneName"),n=e("../../Core/Common/SoundManager"),i=e("../Const/SoundPath"),r=e("./BaseProcedure"),s=e("../../fws/platforms/PlatformCore"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"sceneName",{get:function(){return o.SceneName.HOMEOTHER},enumerable:!0,configurable:!0}),t.prototype.checkIfUseSceneTransition=function(e){return s.instance.enableSceneTransition()},Object.defineProperty(t.prototype,"autoReleased",{get:function(){return!s.instance.enableSceneTransition()},enumerable:!0,configurable:!0}),t.prototype.doSwitchStart=function(){n.SOUND.playBg(i.SoundPath.CITY_BG)},t}(r.BaseProcedure);a.HomeOtherProcedure=l,cc._RF.pop()},{"../../Core/Common/SoundManager":"SoundManager","../../fws/platforms/PlatformCore":"PlatformCore","../Const/SceneName":"SceneName","../Const/SoundPath":"SoundPath","./BaseProcedure":"BaseProcedure"}],HomeProcedure:[function(e,t,a){"use strict";cc._RF.push(t,"a6a46Ry3h5NOJw9SVMS27bw","HomeProcedure"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Const/SceneName"),n=e("../../Core/Common/SoundManager"),i=e("../Const/SoundPath"),r=e("./BaseProcedure"),s=e("../../Core/Event/EventCenter"),l=e("../Const/EventId"),c=e("../../fws/platforms/PlatformCore"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"sceneName",{get:function(){return o.SceneName.HOME},enumerable:!0,configurable:!0}),t.prototype.checkIfUseSceneTransition=function(e){return c.instance.enableSceneTransition()&&e!==o.SceneName.LOGIN},Object.defineProperty(t.prototype,"autoReleased",{get:function(){return!c.instance.enableSceneTransition()},enumerable:!0,configurable:!0}),t.prototype.doSwitchStart=function(){n.SOUND.playBg(i.SoundPath.CITY_BG)},t.prototype.doSceneLoaded=function(e){t.loadOverCB=e},t.prototype.doSwitchEnd=function(){s.EVENT.emit(l.EventId.HomeSceneEnded)},t.loadOverCB=null,t}(r.BaseProcedure);a.HomeProcedure=d,cc._RF.pop()},{"../../Core/Common/SoundManager":"SoundManager","../../Core/Event/EventCenter":"EventCenter","../../fws/platforms/PlatformCore":"PlatformCore","../Const/EventId":"EventId","../Const/SceneName":"SceneName","../Const/SoundPath":"SoundPath","./BaseProcedure":"BaseProcedure"}],LoginProcedure:[function(e,t,a){"use strict";cc._RF.push(t,"519b9uLg/5PM7UzZtba4550","LoginProcedure"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Const/SceneName"),n=function(){function e(){}return Object.defineProperty(e.prototype,"sceneName",{get:function(){return o.SceneName.LOGIN},enumerable:!0,configurable:!0}),e.prototype.warm=function(){},e.prototype.prepareSwitch=function(e,t){t&&t()},e.prototype.onSwitchStart=function(){},e.prototype.onSwitchEnd=function(){},e.prototype.onSwitchReset=function(){},e}();a.LoginProcedure=n,cc._RF.pop()},{"../Const/SceneName":"SceneName"}],ProcedureManager:[function(e,t,a){"use strict";cc._RF.push(t,"72e49mzXlZNhYmEnTnVPERF","ProcedureManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./LoginProcedure"),n=e("./HomeProcedure"),i=e("./WorldProcedure"),r=e("./HomeOtherProcedure"),s=e("../../Core/Common/SoundManager"),l=function(){function e(){this.Login=new o.LoginProcedure,this.Home=new n.HomeProcedure,this.World=new i.WorldProcedure,this.HomeOther=new r.HomeOtherProcedure,this._session=e._increaseSession++}return e.getInst=function(){return e._inst||(e._inst=new e)},e.prototype.Warm=function(e){e&&e.warm()},e.prototype.Run=function(e){var t=this,a=this._lastProce?this._lastProce.sceneName:this.Login.sceneName;if(e&&e.sceneName!==a){s.SOUND.stopAll();var o=this._session;e.prepareSwitch(a,function(){o===t._session?(t._lastProce&&(t._lastProce.onSwitchEnd(),t._lastProce=null),e&&(t._lastProce=e,e.onSwitchStart())):e.onSwitchReset()})}},e.prototype.Purge=function(){this._session=e._increaseSession++,this._lastProce&&(this._lastProce.onSwitchReset(),this._lastProce=null)},e._increaseSession=0,e}();a.default=l,a.PROCE=l.getInst(),cc._RF.pop()},{"../../Core/Common/SoundManager":"SoundManager","./HomeOtherProcedure":"HomeOtherProcedure","./HomeProcedure":"HomeProcedure","./LoginProcedure":"LoginProcedure","./WorldProcedure":"WorldProcedure"}],WorldProcedure:[function(e,t,a){"use strict";cc._RF.push(t,"73634ZUdXhNILWPS2xf6xJv","WorldProcedure"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Const/SceneName"),n=e("../../System/JSWrap"),i=e("../components/worldmap/WorldMapModel"),r=e("../components/worldmap/WorldMapMsgs"),s=e("./BaseProcedure"),l=e("../components/worldmap/WorldMapDisplayPools"),c=e("../../fws/platforms/PlatformCore"),d=e("../Tools/GameTools"),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._sceneLoaded=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"sceneName",{get:function(){return o.SceneName.WORLD},enumerable:!0,configurable:!0}),t.prototype.doWarm=function(){var e=this;!l.getInstance().preloadWorldMapResources()&&this._sceneLoaded||cc.director.preloadScene(o.SceneName.WORLD,null,function(t,a){!t&&a&&(e._sceneLoaded=!0)})},t.prototype.checkIfUseSceneTransition=function(e){return c.instance.enableSceneTransition()&&l.isLoaded&&this._sceneLoaded},Object.defineProperty(t.prototype,"autoReleased",{get:function(){return!c.instance.enableSceneTransition()},enumerable:!0,configurable:!0}),t.prototype.doSwitchStart=function(){d.default.playWorldBGM()},t.prototype.doSceneLoaded=function(e){var t=this;i.getInstance().initMapState>0?e&&e():n.default.setTimeout(function(){t.doSceneLoaded(e)},50)},t.prototype.doSwitchEnd=function(){r.send(r.Names.WorldMapOnExit,null)},t}(s.BaseProcedure);a.WorldProcedure=p,cc._RF.pop()},{"../../System/JSWrap":"JSWrap","../../fws/platforms/PlatformCore":"PlatformCore","../Const/SceneName":"SceneName","../Tools/GameTools":"GameTools","../components/worldmap/WorldMapDisplayPools":"WorldMapDisplayPools","../components/worldmap/WorldMapModel":"WorldMapModel","../components/worldmap/WorldMapMsgs":"WorldMapMsgs","./BaseProcedure":"BaseProcedure"}],ProfessionController:[function(e,t,a){"use strict";cc._RF.push(t,"23b33SIJERL+Lh5ht8vktwa","ProfessionController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../../Core/Event/EventCenter"),i=e("../Const/EventId"),r=e("../Data/DataCenter"),s=e("../../Core/Net/NetMgr"),l=e("../Const/RequestId"),c=e("../Tools/GameTools"),d=e("../../fws/utils/X"),p=e("../Common/UIManager"),u=e("../../Core/Common/LocalManager"),h=e("../Const/GameDefine"),m=e("../Const/GameDefine"),f=e("../Const/TableName"),_=e("../../fws/utils/FWSTool"),y=e("../../Core/Common/SoundManager"),g=e("../Const/SoundPath"),C=e("../../fws/platforms/AIEventDefine"),v=function(){function e(){this._tabIndex=0,this.talentQueueNum=1,this._professionFocusTalentId=0,this._professionId=0,this._showCareerId=0,this._professionData=null,this._professionFocusTalentData=null,this._myProfessionData=null,this._allBaseData=[[],[],[]],this._baseTalentData=[{},{},{}],this._serverTalentData=[[],[],[]],this._learningTalentData=[],this._lineTalentData=[[],[],[]],this._talentNodeHeight=[0,0,0],this.initData(),this.registListener()}return Object.defineProperty(e,"Instance",{get:function(){return this._inst||(this._inst=new e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TabIndex",{get:function(){return this._tabIndex},set:function(e){this._tabIndex=e},enumerable:!0,configurable:!0}),e.prototype.setCareerId=function(e){if(e){var t=o.TABLE.getTableDataById(f.TableName.SELECTION,String(e));t&&t.branch?(this.ProfessionFocusTalentId=e,this.ProfessionId=t.branch):(this.ProfessionId=e,this._professionFocusTalentId=0),this._myProfessionData=t}},Object.defineProperty(e.prototype,"ProfessionFocusTalentId",{get:function(){return this._professionFocusTalentId},set:function(e){this._professionFocusTalentId=e,this.initTalentData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ProfessionId",{get:function(){return this._professionId},set:function(e){e!=this._professionId&&(this._professionId=e,this.initTalentData(),C.EventDataGenetor.ProfessionId=e,setTimeout(function(){n.EVENT.emit(i.EventId.PROFESSION_STATE_CHANGE,r.DATA.UserData.Level)},100))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ShowCareerId",{get:function(){return this._showCareerId},set:function(e){this._showCareerId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ProfessionData",{get:function(){return this._professionData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ProfessionFocusTalentData",{get:function(){return this._professionFocusTalentData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MyProfessionData",{get:function(){return this._myProfessionData},enumerable:!0,configurable:!0}),e.prototype.initData=function(){this._professionData=o.TABLE.getTableByKey("selection","type",1),this.initTalentData(),this.initLearnTalentData()},e.prototype.registListener=function(){},e.prototype.initLearnTalentData=function(e){var t=this;void 0===e&&(e=null);var a=this;s.NET.send(l.RequestId.GET_LEARN_TALENT_DATA,{},this,function(o){var n=c.default.JSON_PARSE(o.d);c.default.ObjIsEmpty(n)||(d.log(n),n.endowments&&(a._serverTalentData=n.endowments,C.EventDataGenetor.LatestProfessionId=a.getLatestTalentId()),n.endowmentStudy&&(t._learningTalentData=n.endowmentStudy),e&&e())})},e.prototype.getLatestTalentId=function(){for(var e=0,t=0;t<this._serverTalentData.length;t++)for(var a=this._serverTalentData[t],o=0;o<a.length;o++){var n=a[o];n>e&&(e=n)}return e},e.prototype.updateServerData=function(e){e.endowments&&(this._serverTalentData=e.endowments,C.EventDataGenetor.LatestProfessionId=this.getLatestTalentId()),e.endowmentStudy&&(this._learningTalentData=e.endowmentStudy),n.EVENT.emit(i.EventId.PROFESSION_LEARN_DATA_CHANGED)},e.prototype.getBaseTalentData=function(e){return this._baseTalentData[e]},e.prototype.getServerTalentData=function(e){return this._serverTalentData[e]},Object.defineProperty(e.prototype,"ServerTalentData",{get:function(){return this._serverTalentData},set:function(e){this._serverTalentData=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LearningTalentData",{get:function(){return this._learningTalentData},set:function(e){this._learningTalentData=e},enumerable:!0,configurable:!0}),e.prototype.judgeIsLearning=function(e){for(var t=0;t<this._learningTalentData.length;t++)if(e==this._learningTalentData[t].id)return!0;return!1},e.prototype.initTalentData=function(){this._allBaseData=[[],[],[]],this._baseTalentData=[{},{},{}],this._professionId&&this.initTabTalentData(0,this._professionId),this._professionFocusTalentId&&this.initTabTalentData(1,this._professionFocusTalentId),this.initTabTalentData(2,0),this.setTalentDataByLine()},e.prototype.initTabTalentData=function(e,t){var a=o.TABLE.getTableByKey("endowment","occupation",t);this._allBaseData[e]=a,this._baseTalentData[e]={};for(var n=0;n<a.length;n++)if(!a[n].switch||r.DATA.UserData.FunctionOn(a[n].switch)){var i=a[n].group;this._baseTalentData[e][i]||(this._baseTalentData[e][i]=[]),this._baseTalentData[e][i].push(a[n]);var s=a[n].position.split(";");this._talentNodeHeight[e]=Math.max(this._talentNodeHeight[e],Number(s[0]))}},e.prototype.getLineTalentData=function(e){return this._lineTalentData[e]},e.prototype.setTalentDataByLine=function(){this._lineTalentData=[[],[],[]];for(var e=0;e<this._baseTalentData.length;e++){var t=this._baseTalentData[e];for(var a in t){var o=t[a][0].position.split(";");this._lineTalentData[e][Number(o[0])-1]||(this._lineTalentData[e][Number(o[0])-1]=[]),this._lineTalentData[e][Number(o[0])-1].push(t[a])}}},e.prototype.getBaseNodeHeight=function(e){return 160*(this._talentNodeHeight[e]-1)+73+100},e.prototype.judgeIfCanLearnByRelation=function(e,t){if(!e||!e.relation)return!1;if(e.unlock&&r.DATA.UserData.Level<e.unlock)return!1;if("0"==e.relation)return!0;if(e.relation.indexOf("|")>-1){for(var a=e.relation.split("|"),o=0;o<a.length;o++)if(!this.judgeIfCanLearnById(a[o],t))return!1;return!0}if(e.relation.indexOf(",")>-1){for(a=e.relation.split(","),o=0;o<a.length;o++)if(this.judgeIfCanLearnById(a[o],t))return!0;return!1}return this.judgeIfCanLearnById(e.relation,t)},e.prototype.judgeIfCanLearnById=function(e,t){var a=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,e),n=this._baseTalentData[t][a.group];if(!n)return!1;for(var i=0;i<n.length;i++)if(a.talent_lv<=n[i].talent_lv&&this._serverTalentData[t].indexOf(n[i].id)>-1)return!0;return!1},e.prototype.judgeIfGroupCanLearnById=function(e,t){var a=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,e),n=this._baseTalentData[t][a.group];if(!n)return!1;for(var i=0;i<n.length;i++)if(this._serverTalentData[t].indexOf(n[i].id)>-1)return n[i];return!1},e.prototype.judgeIfLearnedById=function(e,t){if(this._learningTalentData.indexOf(e)>-1)return!1;var a=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,e),n=this._baseTalentData[t][a.group];if(!n)return!1;for(var i=0;i<n.length;i++)if(a.talent_lv<n[i].talent_lv&&this._serverTalentData[t].indexOf(n[i].id)>-1)return!0;return!1},e.prototype.judgeRelationIsOpen=function(e){if(!e)return!1;var t=this._tabIndex,a=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,e),n=this._baseTalentData[t][a.group];if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i].talent_lv>=a.talent_lv&&this._serverTalentData[t].indexOf(n[i].id)>-1){if(r.DATA.UserData.Level>=n[i].unlock)return!0;break}return!1},e.prototype.getRealRelation=function(e){var t=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,e);return this._baseTalentData[this._tabIndex][t.group][0].relation},e.prototype.getSpeedGoldNum=function(t){if(!e.Instance.LearningTalentData.length)return 0;var a=e.Instance.getProduceQueueById(t);if(!a)return 0;var n=a.id,i=a.time,s=r.DATA.ServerTime;return s>i?0:o.TABLE.getTableDataById(f.TableName.ENDOWMENT,n)?c.default.GetProfessionCDGold(i-s):0},e.prototype.speedUseGold=function(t,a){1==t&&(r.DATA.UserData.ConfirmCostGold=!1);var n=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,a+"");n&&s.NET.send(l.RequestId.PROFESSION_SPEED_LEARN,{isUseGold:1,items:[],id:n.group},this,function(t){var a=c.default.JSON_PARSE(t.d);y.SOUND.playClip(g.SoundPath.Talent_Research),c.default.ObjIsEmpty(a)||(d.log(a),e.Instance.updateServerData(a),p.default.Instance().ShowTips(u.LOCAL.getText("100310")))})},e.prototype.getTalentDetailByCfg=function(e){var t="";if(!e||!e.detail)return t;if(!e.para2||void 0!=e.formula&&1==e.formula)t=u.LOCAL.getText(e.detail);else{for(var a=e.para2.split("|"),n=e.para1.split("|"),i=0;i<a.length;i++)if(n[i]){var r=o.TABLE.getTableDataById(f.TableName.EFFECTBUFF,n[i]);r&&r.value_type>1&&(a[i]=Math.floor(a[i]/100))}t=u.LOCAL.getTextWithParas(e.detail,a)}return t},e.prototype.getBuffTowerDetailByCfg=function(e){var t="";if(!e)return t;if(e.value&&e.effect)for(var a=e.value.split("|"),n=e.effect.split("|"),i=0;i<a.length;i++)if(n[i]){var r=o.TABLE.getTableDataById(f.TableName.EFFECTBUFF,n[i]);r&&(r.value_type>1?(a[i]=Math.floor(a[i]/100),t+=u.LOCAL.getText(r.string)+a[i]+"%"):t+=u.LOCAL.getText(r.string)+a[i],i<a.length-1&&(t+=","))}return t},e.prototype.getMyProfessionMarkId=function(){if(!this.ProfessionId)return 0;if(0==this._serverTalentData[0].length&&0==this._serverTalentData[1].length)return this.ShowCareerId;for(var e=[],t=0;t<this._serverTalentData.length;t++)for(var a=0;a<this._serverTalentData[t].length;a++){var n=this._serverTalentData[t][a],i=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,n);i&&e.push(i)}return e.length>0?(e.sort(this.markSort),e[0].id):0},e.prototype.markSort=function(e,t){return void 0!=e.priority&&void 0!=t.priority?t.priority-e.priority:-1},e.prototype.getMyProfessionStarIds=function(){var e={},t=this.ProfessionId;this.ProfessionFocusTalentId&&(t=this.ProfessionFocusTalentId);for(var a=2;a<6;a++){var n=o.TABLE.getTableByKey(f.TableName.ENDOWMENT,"occupation",t,"star",a);n&&n.length>0&&(e[a]=n[0].id)}return e},e.prototype.getProfessionMarkIcon=function(){var e="",t=this.ProfessionId;if(0!=this.ProfessionFocusTalentId&&(t=this.ProfessionFocusTalentId),0!=t){var a=o.TABLE.getTableDataById(f.TableName.SELECTION,t.toString());a&&a.career_icon&&(e=a.career_icon)}return e},e.prototype.getProfessionStar=function(){if(!this.ProfessionId)return 0;if(0==this._serverTalentData[0].length&&0==this._serverTalentData[1].length)return 1;var e=this.ProfessionId;this.ProfessionFocusTalentId&&(e=this.ProfessionFocusTalentId);for(var t=[],a=0;a<this._serverTalentData.length;a++)for(var n=0;n<this._serverTalentData[a].length;n++){var i=this._serverTalentData[a][n],r=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,i);r&&r.star&&e==r.occupation&&t.push(r)}return t.length>0?(t.sort(this.markSort),t[0].star):1},e.prototype.BackResourcesAndItems=function(e){void 0===e&&(e=0);var t=[];t=e?this._serverTalentData[0].concat(this._serverTalentData[1]):this._serverTalentData[1];for(var a={resource:{coin:0,wood:0,oil:0,soil:0,gold:0},items:[],hasBack:!1},n={},i=0,r=0;r<t.length;r++){var s=o.TABLE.getTableDataById(f.TableName.ENDOWMENT,t[r]),l=o.TABLE.getTableDataByKeyValue(f.TableName.ENDOWMENT,"group",s.group);if(0!=l.length)for(var c=0;c<l.length;c++)if(l[c].talent_lv<s.talent_lv){if(i+=l[c].time_research,l[c].research_need)for(var d=l[c].research_need.split(","),p=0;p<d.length;p++){var u=d[p].split("|");switch(Number(u[0])){case h.ResourceType.Coin:a.resource.coin+=Number(u[1]),a.hasBack=!0;break;case h.ResourceType.Wood:a.resource.wood+=Number(u[1]),a.hasBack=!0;break;case h.ResourceType.Oil:case h.ResourceType.Oila:a.resource.oil+=Number(u[1]),a.hasBack=!0;break;case h.ResourceType.Gold:a.resource.gold+=Number(u[1]),a.hasBack=!0;break;case h.ResourceType.Soil:a.resource.soil+=Number(u[1]),a.hasBack=!0}}if(l[c].item_condition)for(var m=l[c].item_condition.split(","),_=0;_<m.length;_++){n[(u=m[_].split("|"))[0]]?n[u[0]].itemCount+=Number(u[1]):n[u[0]]={itemId:u[0],itemCount:Number(u[1])},a.hasBack=!0}}}var y=Math.floor(i/300);y>0&&(n[550001]={itemId:550001,itemCount:y});var g=[];for(var C in n)g.push(n[C]);return a.items=g,a},e.prototype.getTimeResearch=function(e){var t=0;return e&&e.time_research&&(t=Math.ceil(e.time_research*(1-r.DATA.UserData.Buff.getBuffPercentValue(m.BuffType.LearnTalentSpeedUp)))),t},e.prototype.getCanLearnTalentIdWithRes=function(){var e=0;if(!this.canLearnTalent())return 0;if(0!=(e=this.getPageCanLearnTalentId(0)))return e;if(this.ProfessionFocusTalentId&&0!=(e=this.getPageCanLearnTalentId(1)))return e;var t=c.default.getDataConfigData(61055);return r.DATA.UserData.Level>=Number(t)&&(e=this.getPageCanLearnTalentId(2)),e},e.prototype.getPageCanLearnTalentId=function(e){var t=this._baseTalentData[e];for(var a in t){var o=t[a].sort(function(e,t){return e.talent_lv-t.talent_lv});if(o.length>0)for(var n=o.length-1;n>=0&&!(this.ServerTalentData[e].indexOf(o[n].id)>-1);n--)if(this.judgeIfCanLearnByRelation(o[n],e)){var i=n;if(i>0&&i--,this.judgeResAndItemEnoughByTalentCfg(o[i]))return o[n].id}}return 0},e.prototype.judgeResAndItemEnoughByTalentCfg=function(e){if(!e)return!1;if(e.research_need)for(var t=e.research_need.split(","),a=0;a<t.length;a++){var o=t[a].split("|");if(o.length>1&&o[1]>r.DATA.UserData.Resource.getResource(o[0]))return!1}if(e.item_condition)for(var n=e.item_condition.split(","),i=0;i<n.length;i++){var s=n[i].split("|");if(s.length>1&&s[1]>r.DATA.UserData.getItemAmount(s[0]))return!1}return!0},e.prototype.restartGameCallBack=function(){this._tabIndex=0,this._professionFocusTalentId=0,this._professionId=0,this._showCareerId=0,this._professionData=null,this._professionFocusTalentData=null,this._myProfessionData=null,this._allBaseData=[[],[],[]],this._baseTalentData=[{},{},{}],this._serverTalentData=[[],[],[]],this._learningTalentData=[],this._lineTalentData=[[],[],[]],this._talentNodeHeight=[0,0,0],e._inst=null},e.isMakeSystemOpen=function(){if(r.DATA.UserData.FunctionOn(m.FunctionKey.trap_potion_switch)){var e=o.TABLE.getTableDataById(f.TableName.DATACONFIG,"61059"),t=_.Obj.getPropertyNumberByNames(e,0,"value");if(r.DATA.UserData.Level>=t)return!0}return!1},e.prototype.canLearnTalent=function(){if(this._learningTalentData.length<=0)return!0;var e=this.getLearnQueueNum();return this._learningTalentData.length<e},e.prototype.getLearnQueueNum=function(){return r.DATA.UserData.Buff.getValueWithBuff(this.talentQueueNum,m.BuffType.LearningTalentNum,!0)},e.prototype.getProduceQueueById=function(e){for(var t=0;t<this._learningTalentData.length;t++)if(this._learningTalentData[t].id==e)return this._learningTalentData[t];return null},e._inst=null,e}();a.default=v,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/SoundManager":"SoundManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/platforms/AIEventDefine":"AIEventDefine","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/SoundPath":"SoundPath","../Const/TableName":"TableName","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],ActivityStateResponse:[function(e,t,a){"use strict";cc._RF.push(t,"997dc9EKrhB9rcmM6ZJjgPI","ActivityStateResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../Tools/GameTools"),i=e("../controllers/ActivityController"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=n.default.JSON_PARSE(e.data);t&&(t.key&&"task"==t.key?i.ActivityController.Instance.activityTaskUpdate(t):i.ActivityController.Instance.activityStateUpdate(t))},t}(o.default);a.default=r,cc._RF.pop()},{"../../Core/Net/ResponseBase":"ResponseBase","../Tools/GameTools":"GameTools","../controllers/ActivityController":"ActivityController"}],AllianceResponse:[function(e,t,a){"use strict";cc._RF.push(t,"35596OJXbRDP5Yyt+pWVlQu","AllianceResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../Core/Net/ResponseBase"),i=e("../Data/DataCenter"),r=e("../Tools/GameTools"),s=e("../alliance/AllianceMsgs"),l=e("../alliance/AllianceController"),c=e("../Common/ConfirmPanel"),d=e("../Common/UIManager"),p=e("../Const/UIDataInfo"),u=e("../Data/AllianceData"),h=e("../../Core/Event/EventCenter"),m=e("../Const/EventId"),f=e("../Data/AllianceHelpData"),_=e("../alliance/AllianceScienceNet"),y=e("../alliance/AllianceShopNet"),g=e("../../fws/utils/FWSTool"),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&void 0!==t.allianceInfo&&i.DATA.UserData.UpdateAllianceInfo(t.allianceInfo)},t}(n.default);a.AllianceInfoResponse=C;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){null!==r.default.JSON_PARSE(e.data)&&(i.DATA.UserData.clearAllianceInfo(),s.send(s.Names.AllianceMsgCloseMainView,{}),s.send(s.Names.AllianceMsgCloseMemberView,{}),c.default.ShowView(o.LOCAL.getText("100037"),o.LOCAL.getText("101004"),this,null,null))},t}(n.default);a.AllianceKickedResponse=v;var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&void 0!==t.rank&&(i.DATA.UserData.Alliance.Rank=t.rank)},t}(n.default);a.AllianceRankChangeResponse=I;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&(void 0!==t.allianceInfo&&i.DATA.UserData.UpdateAllianceInfo(t.allianceInfo),s.send(s.Names.AllianceMsgRefreshMainView,{}))},t}(n.default);a.AllianceInfoChangeResponse=T;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&(void 0!==t.type&&(0===t.type||1===t.type?l.AllianceController.getInstance().applyCount--:3===t.type&&l.AllianceController.getInstance().applyCount++),s.send(s.Names.AllianceMsgRefreshApplyView,{}),s.send(s.Names.AllianceMsgRefreshMainView,{}),h.EVENT.emit(m.EventId.MainUI_Update))},t}(n.default);a.AllianceApplyChangeResponse=S;var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&(void 0!==t.allianceInfo&&(i.DATA.UserData.UpdateAllianceInfo(t.allianceInfo),(new u.default).UpdateData(t.allianceInfo),d.default.Instance().OpenUI(p.UIDataInfo.AllianceMainPanel)))},t}(n.default);a.AllianceApplyAcceptedResponse=A;var D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){},t}(n.default);a.AllianceHelpUpdateResponse=D;var N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&i.DATA.UserData.Alliance.AddAllianceHelpList(t)},t}(n.default);a.AllianceHelpAddResponse=N;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);if(null!==t){var a=t.uid,o=t.type,n=t.qid;if(null!=a&&null!=o&&null!=n){var s=f.default.GetAllianceHelpId(a.toString(),o,n.toString());i.DATA.UserData.Alliance.DeleteAllianceHelpData(s)}}},t}(n.default);a.AllianceHelpRemoveResponse=b;var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&i.DATA.UserData.Alliance.AddAlianceMemberDynamic(t)},t}(n.default);a.AllianceMemberDynamicResponse=L;var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&_.default.pushScienceData(t)},t}(n.default);a.AllianceScienceData=E;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&_.default.pushDiamondDonateNum(t)},t}(n.default);a.AllianceDiamondDonateNum=P;var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);null!==t&&y.default.pushShopData(t)},t}(n.default);a.AllianceShopUpdateResponse=w;var B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);g.Obj.isEmpty(t)||i.DATA.UserData.Alliance&&(i.DATA.UserData.Alliance.territoryData.handleSingleServerData(t),h.EVENT.emit(m.EventId.AllianceTerritoryDataUpdate))},t}(n.default);a.AllianceBuildingChangeResponse=B;var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);g.Obj.isEmpty(t)||s.send(s.Names.AllianceMsgBossInfoChange,t)},t}(n.default);a.AllianceBossResponse=M,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../../fws/utils/FWSTool":"FWSTool","../Common/ConfirmPanel":"ConfirmPanel","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/UIDataInfo":"UIDataInfo","../Data/AllianceData":"AllianceData","../Data/AllianceHelpData":"AllianceHelpData","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools","../alliance/AllianceController":"AllianceController","../alliance/AllianceMsgs":"AllianceMsgs","../alliance/AllianceScienceNet":"AllianceScienceNet","../alliance/AllianceShopNet":"AllianceShopNet"}],ArmyResponse:[function(e,t,a){"use strict";cc._RF.push(t,"e5951ZBTd5E9ZVLDhwO7ApN","ArmyResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(e){function t(t){var a=e.call(this)||this;return a.CommandId=t,a}return __extends(t,e),t.prototype.Handler=function(e){},t}(e("../../Core/Net/ResponseBase").default);a.default=o,cc._RF.pop()},{"../../Core/Net/ResponseBase":"ResponseBase"}],BuildingResponse:[function(e,t,a){"use strict";cc._RF.push(t,"db674ftyO5ARIQ6qoLP5cIG","BuildingResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=function(e){function t(t){var a=e.call(this)||this;return a.CommandId=t,a}return __extends(t,e),t.prototype.Handler=function(e){},t}(e("../../Core/Net/ResponseBase").default);a.default=o,cc._RF.pop()},{"../../Core/Net/ResponseBase":"ResponseBase"}],CommonResponse:[function(e,t,a){"use strict";cc._RF.push(t,"3762bxe04dKhqrECw6arlpQ","CommonResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Event/EventCenter"),n=e("../Const/EventId"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){o.EVENT.emit(n.EventId.GetOrderResponse)},t}(e("../../Core/Net/ResponseBase").default);a.GetOrderResponse=i,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../Const/EventId":"EventId"}],FriendResponse:[function(e,t,a){"use strict";cc._RF.push(t,"1ecf909RBRJVr5LCT7nDXHS","FriendResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Data/DataCenter"),n=e("../../Core/Net/ResponseBase"),i=e("../../Core/Event/EventCenter"),r=e("../Const/EventId"),s=e("../Tools/GameTools"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=s.default.JSON_PARSE(e.data);t&&(o.DATA.UserData.UpdateFriend(t),i.EVENT.emit(r.EventId.Friend_Update,t))},t}(n.default);a.FriendUpdateResponse=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=s.default.JSON_PARSE(e.data);t&&(o.DATA.UserData.DelFriend(t),i.EVENT.emit(r.EventId.Friend_Del,t))},t}(n.default);a.FriendDelResponse=c;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=s.default.JSON_PARSE(e.data);t&&(o.DATA.UserData.UpdateFriending(t),i.EVENT.emit(r.EventId.Friending_Update,t))},t}(n.default);a.PushFriendingResponse=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=s.default.JSON_PARSE(e.data);t&&(o.DATA.UserData.DelFriending(t),i.EVENT.emit(r.EventId.Friending_Del,t))},t}(n.default);a.PushFriendingDelResponse=p,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../Const/EventId":"EventId","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],GrowthFundResponse:[function(e,t,a){"use strict";cc._RF.push(t,"89515N+8oFNZrLs5efNVKaS","GrowthFundResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../Data/DataCenter"),i=e("../Tools/GameTools"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=i.default.JSON_PARSE(e.data);null!==t&&n.DATA.UserData.updateGrowthFund(t)},t}(o.default);a.GrowthFundResponse=r,cc._RF.pop()},{"../../Core/Net/ResponseBase":"ResponseBase","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],LoginResponse:[function(e,t,a){"use strict";cc._RF.push(t,"eda42BFc+VG2KuTiyrPBah8","LoginResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../Core/Net/ResponseBase"),i=e("../Data/DataCenter"),r=e("../../Core/Net/NetMgr"),s=e("../Const/RequestId"),l=e("../Procedure/ProcedureManager"),c=e("../Common/BIManager"),d=e("../Common/UIManager"),p=e("../Common/PFOpenData"),u=e("../Data/GuideData"),h=e("../Tools/GameTools"),m=e("../msgs/MvcMsgs"),f=e("../Const/UIDataInfo"),_=e("../Data/GlobalData"),y=e("../Module/UI/ChooseServerPanel"),g=e("../../fws/utils/LocalStorageUtils"),C=e("../../System/ErrorUtils"),v=e("../../fws/utils/ErrorReport"),I=e("../../fws/platforms/PlatformCore"),T=e("../controllers/RGShareSDKController"),S=e("../../fws/utils/X"),A=e("../Common/ConfirmPanel"),D=e("../Const/GameDefine"),N=e("../Scene/SceneManager"),b=e("../Const/SceneName"),L=e("../Common/GM"),E=e("../controllers/ScienceController"),P=e("../Eightcountry/ECStrongestLeaderController"),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.firstLogined=!1,t.TEST_LOGIN_DEAL_DATA_TABLE=[],t}return __extends(t,e),t.prototype.tryRedirectServer=function(e){if(!e)return!1;var t=e.isCross,a=e.wsurl||"",o=e.sid||0;return 1==t&&(_.GLOBAL.game_ip=h.default.gameIpCombineAccLines(a,e),v.trace({resp:"\u767b\u5f55\u63a5\u53e3\u8fd4\u56de\u91cd\u5b9a\u5411\u670d\u52a1",serverid:o,wsurl:a},"close_socket"),S.info("(LOGIN) \u9700\u8981\u91cd\u5b9a\u5411\u5230\u65b0\u7684\u670d\u52a1 serverId=%d, serverUrl=%s",o,a),r.NET.dispose(),r.NET.connectWithOption(h.default.getGameWsConnectOption(_.GLOBAL.game_ip,_.GLOBAL.GameFallbackDomain)),!0)},t.prototype.onLoginFail=function(e){var t=0,a="",n=o.LOCAL.getText("100127"),s=o.LOCAL.getText("102252"),l=o.LOCAL.getText("102085"),d=null;if(e){null!==(d=e.status)&&void 0!==d||(d=e.s);var p=e.data;if(e.data=h.default.JSON_PARSE(p),this.tryRedirectServer(e.data))return!0;switch(0!=d?(r.NET.setAutoReconnectOnClose(!1),r.NET.dispose(),v.login(d,JSON.stringify(e),r.NET.connectHost),c.default.Instance.PostAction("GameServerLoginFail")):(D.launchOrReconnectReport("\u767b\u5f55\u6210\u529f",_.GLOBAL.inLaunch,_.GLOBAL.newbieLaunch),r.NET.checkHistoryPacksAfterLogin(e.data.gameUid)),d){case D.LoginResponseStatus.USER_ALREADY_LOGIN:case D.LoginResponseStatus.TOKEN_TIME_OVERDUE:case D.LoginResponseStatus.USER_NOT_BELONG_SERVER:case D.LoginResponseStatus.INVALID_LOGIN_INFO:d==D.LoginResponseStatus.USER_NOT_BELONG_SERVER&&(_.GLOBAL.JumpServer=!1,_.GLOBAL.changeServerId=_.GLOBAL.changeServerIp=null);var u=window.ResetGame;return u&&u.doResetGame(!1),!0}if(0==d&&e.data)return!1;switch(0!=d&&(m.send(m.Names.MVC_SET_LOADING_TEXT,e.status+o.LOCAL.getText("100036")),c.default.Instance.PostExtraAction("GameServerLoginErr",{errCode:e.status})),d){case D.LoginResponseStatus.USER_BANNED:case D.LoginResponseStatus.DEVICE_BANNED:a=o.LOCAL.getText("pubilc901"),t=1;break;case D.LoginResponseStatus.GM_KICK:a=o.LOCAL.getText("pubilc902"),t=1;break;case D.LoginResponseStatus.SERVER_MAINTAIN:a=o.LOCAL.getText("pubilc903"),t=1;break;case D.LoginResponseStatus.VERSION_TOO_OLD:if(a=o.LOCAL.getText("system_notice001"),t=1,I.instance.tryForceUpdate())return;break;case D.LoginResponseStatus.IDC_IP_NOT_LOGIN:case D.LoginResponseStatus.SIMULATOR_LOGIN_AUTO_FAIL:a=o.LOCAL.getText("100001"),t=1;break;default:a=o.LOCAL.getText("pubilc904")}}else S.error("(onLoginFail) \u6574\u4e2a\u6570\u636e\u5305\u4e3a\u7a7a, \u6d88\u606f\u5934\u90fd\u6ca1\u6709");return h.default.CustomerServiceSwitchOn()?A.default.ShowView(a,n,this,function(){return 1==t?(I.instance.exitMiniProgram({}),!0):(m.send(m.Names.RELOGIN,null),!1)},function(){var e=i.DATA.UserData.getSessionFromData();return I.instance.openCustomerServiceConversation({sessionFrom:e}),!0},s,l,!1,!1,0,!0,!1):A.default.ShowView(a,n,this,function(){return 1==t?(I.instance.exitMiniProgram({}),!0):(m.send(m.Names.RELOGIN,null),!1)},null,s,"",!1,!1,0,!0,!1),!0},t.prototype.Handler=function(e){if(m.send(m.Names.LOGIN_RETURN,null),!this.onLoginFail(e)){var t=e.data;try{0==e.status&&(S.log("login server ok"),i.DATA.UpdateServerTime(t.serverTime),this.loginDeal(t),_.GLOBAL.JumpServer=!1,_.GLOBAL.changeServerId=_.GLOBAL.changeServerIp=null,m.send(m.Names.LOGIN_DataInitFinish,null))}catch(t){var a=new C.ErrorInfo;a.errMsgInfo=t,a.funcName="LoginResponse$Handler",a.customInfo=JSON.stringify(e),C.ErrorUtils.errorMessage(a)}}},t.prototype.TEST_LOGIN_DEAL_DATA=function(e){},t.prototype.loginDeal=function(e){if(this.TEST_LOGIN_DEAL_DATA(e),S.log("loginDeal",e),i.DATA.UserData.UpdateData(e),E.default.Instance.initScienceStaticData(),L.update(e),T.default.rg_doShareSDkInit(),c.default.Instance.BIupdate(i.DATA.UserData.UID.toString(),i.DATA.UserData.OpenId,_.GLOBAL.GameVersion,i.DATA.UserData.OriginServerId.toString(),p.default.Instance.UnionId||""),c.default.Instance.PostAction("GameServerLoginSaveInfo"),c.default.updateBIInfo({uid:i.DATA.UserData.UID.toString(),device_id:i.DATA.UserData.OpenId,sid:i.DATA.UserData.OriginServerId,app_version:_.GLOBAL.GameVersion,unionid:p.default.Instance.UnionId||""}),g.set("lastLoginUid",i.DATA.UserData.UID.toString(),!1),g.set("lastLoginSid",i.DATA.UserData.ServerId.toString(),!1),u.default.getInst().initCurGuideStep(e.guide_info),!e.forceConfigVer||!h.default.checkConfigForceUpdate(e.forceConfigVer)){if(this.firstLogined)N.default.Instance().curSceneName==b.SceneName.LOGIN&&(d.default.Instance().CloseUI(f.UIDataInfo.RestartGame),l.PROCE.Run(l.PROCE.Home));else{this.firstLogined=!0;var t=e.isRegister;D.launchReport("\u767b\u5f55\u4fe1\u606f\u5904\u7406\u5b8c\u6210",_.GLOBAL.newbieLaunch);var a=i.DATA.UserData.Alliance&&i.DATA.UserData.Alliance.Aid||0;c.default.Instance.PostActionWithTime("GameServerLoginRet",3,{allianceId:a}),c.default.postBI("login",{isNew:t?1:0,reg_time:i.DATA.UserData.RegTime||0,user_level:i.DATA.UserData.Level||0}),null!=t&&(I.instance.onFirstLogin(t),I.instance.uploadUserInfo({type:"CreateRole"})),d.default.Instance().CloseUI(f.UIDataInfo.RestartGame),I.instance.uploadUserInfo({type:"EnterServer"}),h.default.getLaunchTowerData(),y.default.PostChangeServerData(),m.send(m.Names.FIRST_LOGIN_SERVER_COMPLETE,null)}r.NET.send(s.RequestId.PlatformActivityState,{activity:p.default.Instance.Activity},this,function(e){if(S.log("RequestId.PlatformActivityState:",e),null!=e.d&&""!=e.d&&0==e.s){var t=h.default.JSON_PARSE(e.d);p.default.Instance.Activity=t&&t.activity?t.activity:"",S.log("PFOpenData.Instance.Activity:",p.default.Instance.Activity)}}),m.send(m.Names.LOGIN_SUCCESS,null),i.DATA.UserData.UserDevicePushTokenSync(),r.NET.send(s.RequestId.LOGIN_OVER,{}),i.DATA.UserData.FunctionOn(D.FunctionKey.login_request_opt)?i.DATA.UserData.Level>1&&h.default.getUserDataAftherLogin():h.default.getUserDataAftherLogin(),P.default.Instance.askECStrongestLeaderData()}},t}(n.default);a.default=w,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Net/NetMgr":"NetMgr","../../Core/Net/ResponseBase":"ResponseBase","../../System/ErrorUtils":"ErrorUtils","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/ConfirmPanel":"ConfirmPanel","../Common/GM":"GM","../Common/PFOpenData":"PFOpenData","../Common/UIManager":"UIManager","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/SceneName":"SceneName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Data/GlobalData":"GlobalData","../Data/GuideData":"GuideData","../Eightcountry/ECStrongestLeaderController":"ECStrongestLeaderController","../Module/UI/ChooseServerPanel":"ChooseServerPanel","../Procedure/ProcedureManager":"ProcedureManager","../Scene/SceneManager":"SceneManager","../Tools/GameTools":"GameTools","../controllers/RGShareSDKController":"RGShareSDKController","../controllers/ScienceController":"ScienceController","../msgs/MvcMsgs":"MvcMsgs"}],MailResponse:[function(e,t,a){"use strict";cc._RF.push(t,"fe35c7WWkZJxpzz7nnORLK7","MailResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Data/DataCenter"),n=e("../../Core/Net/ResponseBase"),i=e("../../Core/Event/EventCenter"),r=e("../Const/EventId"),s=e("../Tools/GameTools"),l=e("../../fws/utils/X"),c=e("../controllers/MailController"),d=e("../Data/MailData"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){try{var t=s.default.JSON_PARSE(e.data);if(t){if(d.USE_NEW_MAIL_MODEL)return void d.mailManager.parseMailArray(t);o.DATA.UserData.UpdateMailList(t),l.table(t.mails),c.MailController.Instance.updateMailUnReadNum()}}catch(e){l.log(e+".. MailHander")}},t}(n.default);a.MailResponse=p;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){try{var t=s.default.JSON_PARSE(e.data);t&&i.EVENT.emit(r.EventId.UpdateUnReadMailNum,t)}catch(e){l.log(e+".. MailHander")}},t}(n.default);a.MailUNREADResponse=u,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../../fws/utils/X":"X","../Const/EventId":"EventId","../Data/DataCenter":"DataCenter","../Data/MailData":"MailData","../Tools/GameTools":"GameTools","../controllers/MailController":"MailController"}],ObstacleResponse:[function(e,t,a){"use strict";cc._RF.push(t,"d9b7eMcGmVDIoF4au6FPSCF","ObstacleResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../../Core/Event/EventCenter"),i=e("../Const/EventId"),r=e("../Tools/GameTools"),s=e("../../fws/utils/X"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=r.default.JSON_PARSE(e.data);if(t){s.log("ObstacleResponse:"+t.data[0]);var a=t.data[0];n.EVENT.emit(i.EventId.RemoveHomeObstacle,a)}},t}(o.default);a.ObstacleResponse=l,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../../fws/utils/X":"X","../Const/EventId":"EventId","../Tools/GameTools":"GameTools"}],PVEResponse:[function(e,t,a){"use strict";cc._RF.push(t,"1ad427mEORHNa3GVaA7EHHg","PVEResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Data/DataCenter"),n=e("../../Core/Net/ResponseBase"),i=e("../Tools/GameTools"),r=function(e){function t(t){var a=e.call(this)||this;return a.CommandId=t,a}return __extends(t,e),t.prototype.Handler=function(e){var t=i.default.JSON_PARSE(e.data);t&&(t.adventure&&o.DATA.UserData.UpdatePVESingleData(t.adventure),t.nextAdventure&&o.DATA.UserData.UpdatePVESingleData(t.nextAdventure))},t}(n.default);a.default=r,cc._RF.pop()},{"../../Core/Net/ResponseBase":"ResponseBase","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],PlunderResponse:[function(e,t,a){"use strict";cc._RF.push(t,"c1975YGPY1GGo6Y8Gb6AFO0","PlunderResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../../Core/Event/EventCenter"),i=e("../Const/EventId"),r=e("../Common/UIManager"),s=e("../battle/NBattleMsgs"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){try{var t=JSON.parse(e.data);s.send(s.Names.NBattle_StartAdventure,{type:s.NBattleMsgsReplayDataType.PVE_OBSTACLE,data:t},""),t&&n.EVENT.emit(i.EventId.STARTADVENTURE,t)}catch(t){r.default.Instance().ShowTips(e.data)}},t}(o.default);a.STARTADVENTUREResponse=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){try{var t=JSON.parse(e.data);s.send(s.Names.NBattle_ClickAdventure,{type:s.NBattleMsgsReplayDataType.PVE_OBSTACLE,data:t},""),t&&n.EVENT.emit(i.EventId.ADVENTURECLICK,t)}catch(t){r.default.Instance().ShowTips(e.data)}},t}(o.default);a.ADVENTURECLICKResponse=c,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../battle/NBattleMsgs":"NBattleMsgs"}],PushResponse:[function(e,t,a){"use strict";cc._RF.push(t,"b4adcO0Y2tOKrmhL5u9CmCF","PushResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./../../Core/Event/EventCenter"),n=e("../../Core/Common/LocalManager"),i=e("../../Core/Net/ResponseBase"),r=e("../Const/EventId"),s=e("../Data/DataCenter"),l=e("../Common/UIManager"),c=e("../Tools/GameTools"),d=e("../components/worldmap/controllers/WorldMapController"),p=e("../msgs/MvcMsgs"),u=e("../controllers/WelcomeRewardController"),h=e("../Common/ConfirmPanel"),m=e("../../Core/Net/NetMgr"),f=e("../Const/RequestId"),_=e("../Common/BIManager"),y=e("../../Core/Common/TableManager"),g=e("../controllers/ExchangeController"),C=e("../../fws/utils/FWSTool"),v=e("../Const/GameDefine"),I=e("../components/cointree/CoinTreeComponent"),T=e("../controllers/MailController"),S=e("../../fws/utils/X"),A=e("../../fws/platforms/PlatformCore"),D=e("../Tools/SubPackMsgs"),N=e("../Scene/SceneManager"),b=e("../Const/SceneName"),L=e("../Const/UIDataInfo"),E=e("../Start/ResetGame"),P=e("../controllers/ActivityController"),w=e("../Tools/EventTool"),B=e("../components/worldmap/WorldMapMsgs"),M=e("../Const/GameDefine"),U=e("../../fws/utils/ErrorReport"),R=e("../Profession/ProfessionController"),G=e("../../fws/display/MsgBox"),O=e("../Common/GM"),k=e("../Data/GlobalData"),x=e("../components/worldmap/WorldMapModel"),F=e("../Data/MailData"),V=e("../controllers/ArmyEquipController"),H=e("../Const/TableName"),W=e("../Data/UserStaticData"),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=c.default.getPosIdByMapPos(t.x,t.y);s.DATA.UserData.UpdateBuilding(t,a),o.EVENT.emit(r.EventId.Building_Update,t.id)}},t}(i.default);a.PushBuilding=j;var q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=t.buildings;s.DATA.UserData.UpdateBuildings(a)}},t}(i.default);a.PushBuildings=q;var K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t&&t.updateBuilds&&!(t.updateBuilds.length<=0))for(var a=t.updateBuilds,n=0;n<a.length;n++)s.DATA.UserData.UpdateBuilding(a[n]),o.EVENT.emit(r.EventId.Building_Update,a[n].id)},t}(i.default);a.PushMergeBuildings=K;var Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateResource(t),w.emit(r.EventId.Resource_Update))},t}(i.default);a.PushResource=Y;var X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=e.data;t&&l.default.Instance()&&l.default.Instance().ShowTips(n.LOCAL.getNetMsgText(t))},t}(i.default);a.PUSHSTRTIPS=X;var J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.pushUpdateDailyQuest(t)},t}(i.default);a.PUSH_DAILY_QUEST_INFO=J;var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.pushUpdateDailyQuestArray(t)},t}(i.default);a.PUSH_BOUNTY_QUEST_INFO=z;var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.pushResetDailyQuests(t)},t}(i.default);a.PUSH_ALL_DAILY_QUEST_INFO=Q;var Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateWorldTreasureData(t),o.EVENT.emit(r.EventId.WorldTreasureDataUpdate))},t}(i.default);a.PushWorldTreasureQuest=Z;var $=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=t.type;if(2!=a){var i=n.LOCAL.getText("treasure_activity_020"),s="";if(1==a)s="treasure_activity_021";else if(3==a)s="treasure_activity_023";else{if(4!=a)return;s="treasure_activity_024"}s=n.LOCAL.getText(s),o.EVENT.emit(r.EventId.CommonMailTipsShow,{title:i,content:s})}}},t}(i.default);a.PushWorldTreasureResult=$;var ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdatePower(t),w.emit(r.EventId.Power_UPDATE))},t}(i.default);a.PowerResponse=ee;var te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){if(null!=t.bx&&void 0!=t.by&&2!==t.state)s.DATA.UserData.UpdateArmy(t),o.EVENT.emit(r.EventId.Army_Move,t);else{var a=c.default.getPosIdByMapPos(t.x,t.y);s.DATA.UserData.UpdateArmy(t,a),o.EVENT.emit(r.EventId.Army_Update,t.id)}o.EVENT.emit(r.EventId.Armys_Update)}},t}(i.default);a.PushArmy=te;var ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t&&t.updateArmys&&!(t.updateArmys.length<=0)){for(var a=t.updateArmys,n=0;n<a.length;n++){var i=a[n];if(null!=i.bx&&void 0!=i.by&&2!==i.state)s.DATA.UserData.UpdateArmy(i),o.EVENT.emit(r.EventId.Army_Move,i);else{var l=c.default.getPosIdByMapPos(i.x,i.y);s.DATA.UserData.UpdateArmy(i,l),o.EVENT.emit(r.EventId.Army_Update,i.id)}}o.EVENT.emit(r.EventId.Armys_Update)}},t}(i.default);a.PushMergeArmyList=ae;var oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.DeleteArmy(t),o.EVENT.emit(r.EventId.Army_Drop,t),o.EVENT.emit(r.EventId.Armys_Update))},t}(i.default);a.DeleteArmy=oe;var ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t&&t.delArmys&&!(t.delArmys.length<=0)){for(var a=t.delArmys,n=0;n<a.length;n++)s.DATA.UserData.DeleteArmy(a[n]),o.EVENT.emit(r.EventId.Army_Drop,a[n]);o.EVENT.emit(r.EventId.Armys_Update)}},t}(i.default);a.DeleteArmyList=ne;var ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateEnergy(t),[v.EnergyType.ALLIANCE_DONATE_NUM,v.EnergyType.ALLIANCE_BUILDING_DONATE_GOLD_NUM].indexOf(t.type)>-1&&o.EVENT.emit(r.EventId.Energy_AllianceCoinDonateRemainNum),w.emit(r.EventId.ENERGY_UPDATE,t))},t}(i.default);a.PushEnergy=ie;var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateLevelAndExp(t),w.emit(r.EventId.Exp_Update))},t}(i.default);a.PushExp=re;var se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.AddArea(t),o.EVENT.emit(r.EventId.Area_Update,t.areaId))},t}(i.default);a.PushArea=se;var le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.interTimer=1e3,t}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMainQuestData(t),w.emit(r.EventId.Quest_Update))},t}(i.default);a.PushQuest=le;var ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMainQuestDatas(t),w.emit(r.EventId.Quest_Update))},t}(i.default);a.PushQuests=ce;var de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdataSingleArmyBox(t),o.EVENT.emit(r.EventId.ArmyBox_Update))},t}(i.default);a.PushArmyBox=de;var pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdataSingleBuildBox(t)},t}(i.default);a.PushBuildBox=pe;var ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t&&(s.DATA.UserData.UpdateAllianceMoveInviteData(t),0==t.login)){if(s.DATA.UserData.ServerState==M.ServerState.Ready||s.DATA.UserData.ServerState==M.ServerState.Fight)return;s.DATA.UserData.MoveInviteData.Uid>0&&(N.default.Instance().CurSceneName!==b.SceneName.HOME&&N.default.Instance().CurSceneName!==b.SceneName.WORLD||l.default.Instance().OpenUI(L.UIDataInfo.AllianceInvitePanel)),o.EVENT.emit(r.EventId.AllianceMoveInviteUpdate)}},t}(i.default);a.PushAllianceMoveInvite=ue;var he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.addInviteMemberData(t),o.EVENT.emit(r.EventId.AllianceMemberInviteUpdate))},t}(i.default);a.PushAllianceMemberInviteAdd=he;var me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)&&(s.DATA.UserData.initInviteMemberData([]),o.EVENT.emit(r.EventId.AllianceMemberInviteUpdate))},t}(i.default);a.PushAllianceMemberInviteDeleteAll=me;var fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.deleteInviteMemberData([t]),o.EVENT.emit(r.EventId.AllianceMemberInviteUpdate))},t}(i.default);a.PushAllianceMemberInviteDelete=fe;var _e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&t.forceConfigVer&&c.default.checkConfigForceUpdate(t.forceConfigVer)},t}(i.default);a.PushForceConfigUpdate=_e;var ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){l.default.Instance().hideWaitAnim();var t=c.default.JSON_PARSE(e.data);t&&(0===t.status?(t.serverInfoToken&&t.serverInfoToken.length>0&&A.instance.saveServerToken(t.serverInfoToken,t),t.userInfo&&s.DATA.UserData.UpdatePlayerInfoData(t.userInfo),t.hasBindRole&&1===t.hasBindRole?(l.default.Instance().OpenUI(L.UIDataInfo.ChooseServerPanel),l.default.Instance().ShowTips(n.LOCAL.getText("APP008"))):l.default.Instance().ShowTips(n.LOCAL.getText("APP009"))):5===t.status?t.serverInfoToken&&t.serverInfoToken.length>0?h.default.ShowView(n.LOCAL.getText("public123"),n.LOCAL.getText("100142"),this,function(){A.instance.saveServerToken(t.serverInfoToken,t),E.default.doResetGame(!0)},function(){}):A.instance.updateServerToken(function(){},this):l.default.Instance().ShowTips(n.LOCAL.getText("public120")),D.send(D.Names.SUBPACK_BIND_ACCOUNT_AFTER_PUSH,t))},t}(i.default);a.PushBindAccount=ye;var ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)},t}(i.default);a.PushSetAppPlayerInfo=ge;var Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)},t}(i.default);a.PushPayment=Ce;var ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);S.log(e.data),t&&1===t.ret&&p.send(p.Names.MVC_PAY_CHECK_NOT_ENOUGH,t)},t}(i.default);a.PayCheckNotEnoughResponse=ve;var Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMapDatas(t.data),w.emit(r.EventId.MapPoint_Update))},t}(i.default);a.PushMapPoint=Ie;var Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdatePeople(t),o.EVENT.emit(r.EventId.People_Update))},t}(i.default);a.PushPeople=Te;var Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){if(0===e.status){var t=c.default.JSON_PARSE(e.data);null!==t&&void 0!==t&&(s.DATA.UserData.DeleteBuilding(t),o.EVENT.emit(r.EventId.Building_Drop,t.id))}},t}(i.default);a.DropBuilding=Se;var Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t&&t.delBuilds&&!(t.delBuilds.length<=0))for(var a=t.delBuilds,n=0;n<a.length;n++)s.DATA.UserData.DeleteBuilding(a[n]),o.EVENT.emit(r.EventId.Building_Drop,a[n].id)},t}(i.default);a.DropBuildingList=Ae;var De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateItem(t,!0),o.EVENT.emit(r.EventId.Item_Update))},t}(i.default);a.PushTool=De;var Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);null!=t&&(s.DATA.UserData.UpdateItems(t.items,!0),o.EVENT.emit(r.EventId.Items_Update))},t}(i.default);a.PushItems=Ne;var be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=u.WelcomeRewardController.Instance.isHaveWelcomeRewardShareBox();s.DATA.UserData.UpdateShareBoxList(t.shareBoxs,!1),u.WelcomeRewardController.Instance.checkWelcomeReward(a)}},t}(i.default);a.PushShareBox=be;var Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateTimeDowns(t.timeDowns)},t}(i.default);a.PushTimeDowns=Le;var Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)},t}(i.default);a.PushClearObstacle=Ee;var Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){t.nowAreaWar.ani=!0,s.DATA.UserData.UpdateTilePveCell(t.nowAreaWar);var a=t.nowAreaWar.areaId;if(o.EVENT.emit(r.EventId.TilePVEPush,{tid:a}),2==t.msgType&&null!=t.nowAreaWar.pve_node){var n=t.nowAreaWar.pve_node.armyList;if(null==n||0==n.length)return;o.EVENT.emit(r.EventId.AreaBattleComplete,t),_.default.postBI("unlock_tile",{home_area_id:a})}}},t}(i.default);a.PushTilePveData=Pe;var we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=t.buildings;s.DATA.UserData.UpdateBuildings(a),o.EVENT.emit(r.EventId.Buildings_Update,a);var n=t.collect;o.EVENT.emit(r.EventId.Auto_Collect,n)}},t}(i.default);a.PushAutoCollect=we;var Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushMarchInfo(e.data)},t}(i.default);a.PushMarchInfo=Be;var Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushUserMarchInfo(e.data)},t}(i.default);a.PushUserMarchInfo=Me;var Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushMarchAttackMonsterFinish(e.data)},t}(i.default);a.PushMarchAttackMonsterFinish=Ue;var Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushMarchAttackBossFinish(e.data)},t}(i.default);a.PushMarchAttackBossFinish=Re;var Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);null!==t&&t.armyInfos.forEach(function(e){s.DATA.UserData.UpdateArmy(e);var t=e.id;t&&o.EVENT.emit(r.EventId.Army_Update,t)})},t}(i.default);a.PushUserArmyMarchState=Ge;var Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushWorldMapTileInfo(e.data)},t}(i.default);a.PushWorldMapTileInfo=Oe;var ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushWorldMapEnemyRefresh(e.data)},t}(i.default);a.PushWorldMapEnemyRefresh=ke;var xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t)switch(t.type){case 1:c.default.playG123SoundPathByName("crosswar_win");break;case 2:c.default.playG123SoundPathByName("kingwar_win")}},t}(i.default);a.PushSystemSound=xe;var Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){s.DATA.UserData.updateAttackArmies(c.default.JSON_PARSE(e.data)),o.EVENT.emit(r.EventId.AttackingMarchUpdate)},t}(i.default);a.PushAttackArmies=Fe;var Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushTerritoryInfo(e.data)},t}(i.default);a.PushTerritoryInfo=Ve;var He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){if(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=y.TABLE.getTableDataById(H.TableName.ITEM,t.item_id);if(a){var o=a.para2;o&&"0"!==o||(o="effect/prefab/Effect_chunjie_texiao.prefab");var n={effect:o,tilex:t.x,tiley:t.y,count:t.c};d.getInstance().PushWorldMapUseEffectItem(n)}}}},t}(i.default);a.PushWorldMapUseEffectItem=He;var We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){if(e){U.trace({resp:"PushNotice",data:e.data});var t=c.default.JSON_PARSE(e.data),a=C.Obj.getPropertyNumberByNames(t,-1,"type"),o="",n="",i=C.Obj.getPropertyByNames(t,null,"params");if(i&&(o=C.Obj.getPropertyStringByNames(i,"","fromPlayerInfo"),n=C.Obj.getPropertyStringByNames(i,"","toPlayerInfo")),null!=t&&null!=t.msg&&""!=t.msg&&null!=l.default.Instance()){var r=new v.SystemNoticeData(t.msg,t.rolltimes,a,o,n);l.default.Instance().AddSystemNotice(r)}}},t}(i.default);a.PushNotice=We;var je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){if(e){U.trace({resp:"PushNoticePara",data:e.data});for(var t=c.default.JSON_PARSE(e.data),a=new Array,o=t.p,i=0;i<o.length;i++){var r=o[i];1==r.t?a.push(n.LOCAL.getText(r.v)):a.push(r.v)}var s=n.LOCAL.getTextWithParas(t.m,a),d=new v.SystemNoticeData(s,1,-1,"","");null!=l.default.Instance()&&l.default.Instance().AddSystemNotice(d)}},t}(i.default);a.PushNoticePara=je;var qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.GameNoticeData.PushNoticeId=t.id)},t}(i.default);a.PushGameNotice=qe;var Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){for(var t=c.default.JSON_PARSE(e.data),a=new Array,o=t.p,i=0;i<o.length;i++){var r=o[i];1==r.t?a.push(n.LOCAL.getText(r.v)):a.push(r.v)}var s=n.LOCAL.getTextWithParas(t.m,a);null!=l.default.Instance()&&l.default.Instance().ShowTips(s)},t}(i.default);a.PushMessageCommon=Ke;var Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.table(t),g.ExchangeController.Instance.serverExchangeListPush(t),p.send(p.Names.MVC_EXCHANGE_LIST_UPDATE,null),o.EVENT.emit(r.EventId.Exchange_Update))},t}(i.default);a.PushExchange=Ye;var Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.table(t),g.ExchangeController.Instance.updateOrderedExchangeIds(t),p.send(p.Names.MVC_EXCHANGE_LIST_UPDATE,null),o.EVENT.emit(r.EventId.Exchange_Update))},t}(i.default);a.PushOrderedExchange=Xe;var Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateCollectorSelfMultipleLevelUp(t)},t}(i.default);a.PushCollectorSelfMultiple=Je;var ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)},t}(i.default);a.PushWorldChat=ze;var Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateSingleMail(t),F.USE_NEW_MAIL_MODEL||T.MailController.Instance.updateMailUnReadNum())},t}(i.default);a.PushSingleMail=Qe;var Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateFreeCoin(t),o.EVENT.emit(r.EventId.FreeCoinUpdate))},t}(i.default);a.PushFreeCoin=Ze;var $e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateThroneTimeData(t)},t}(i.default);a.PushThroneBattleTime=$e;var et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdatePresetMarchData(t.userPreMarch),o.EVENT.emit(r.EventId.PresetMarchUpdate))},t}(i.default);a.PushPresetMarchData=et;var tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){d.getInstance().PushWorldMapMyPointChange(e.data)},t}(i.default);a.PushOWNER_WORLD_POINT_INFO=tt;var at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=this;if(s.DATA.UserData.ServerId==s.DATA.UserData.OriginServerId||c.default.isKVK()){var a=c.default.JSON_PARSE(e.data),o=n.LOCAL.getText("101173"),i=n.LOCAL.getText("101057");a&&a.merge&&(o=n.LOCAL.getText("merge_002"),i=n.LOCAL.getText("merge_001")),a&&2==a.type&&(i=n.LOCAL.getText("alliance_territory_01")),h.default.ShowForceConfirm(i,o,this,function(){m.NET.send(f.RequestId.WORLD_DESSTORYED_CONFIRM,{},t,function(e){var t=c.default.JSON_PARSE(e.d);c.default.ObjIsEmpty(t)||c.default.ObjIsEmpty(t.point)||d.getInstance().PushWorldMapMyPointChange(JSON.stringify(t.point))})})}},t}(i.default);a.PushOWNER_WORLD_DESTORYED=at;var ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateUnlockOcean(t)},t}(i.default);a.PUSH_UNLockOREAN=ot;var nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateUserCommonData(t),o.EVENT.emit(r.EventId.UserData_Update))},t}(i.default);a.PushUserDataCommon=nt;var it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){s.DATA.UserData.UpdateBuff(t);var a=t.id;o.EVENT.emit(r.EventId.Buff_Update,a)}},t}(i.default);a.PushBuff=it;var rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateState(t),o.EVENT.emit(r.EventId.Buff_Update))},t}(i.default);a.PushState=rt;var st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateBuffs(t.buffs),o.EVENT.emit(r.EventId.Buff_Update))},t}(i.default);a.PUSHALLIANCEBUFF=st;var lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateMaxItem(t.shareTips)},t}(i.default);a.PushMaxItem=lt;var ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){110==(e.status||0)&&(U.trace({resp:"PushUserDisconnect"},"close_socket"),m.NET.setAutoReconnectOnClose(!1),m.NET.dispose(),h.default.ShowView(n.LOCAL.getText("pubilc902"),n.LOCAL.getText("100127"),this,function(){A.instance.exitMiniProgram({})}))},t}(i.default);a.PushUserDisconnect=ct;var dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){U.trace({resp:"PushKickOut"},"close_socket"),m.NET.dispose(),_.default.Instance.PostAction("ServerKickOut");var a="100028";null!==t.data&&void 0!==t.data&&(a=t.data),t.type&&1===t.type?c.default.CustomerServiceSwitchOn()?h.default.ShowView(n.LOCAL.getText(a),n.LOCAL.getText("102295"),this,function(){A.instance.exitMiniProgram({})},function(){var e="";s.DATA&&s.DATA.UserData&&(e=s.DATA.UserData.getSessionFromData()),A.instance.openCustomerServiceConversation({sessionFrom:e})},n.LOCAL.getText("101003"),n.LOCAL.getText("102085")):h.default.ShowView(n.LOCAL.getText(a),n.LOCAL.getText("102295"),this,function(){A.instance.exitMiniProgram({})},null,n.LOCAL.getText("101003"),""):h.default.ShowForceConfirm(n.LOCAL.getText(a),n.LOCAL.getText("102295"),this,function(){A.instance.exitMiniProgram({})})}},t}(i.default);a.PushKickOut=dt;var pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)&&(S.log("PushMigrationRole pushdata:",e.data),A.instance.updateServerToken(function(){S.log("\u6e05\u9664serverinfotoken")},this),G.alert(n.LOCAL.getText("transfercode023"),n.LOCAL.getText("transfercode014"),this,function(){A.instance.exitMiniProgram({})}))},t}(i.default);a.PushMigrationRole=pt;var ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateOrderQueue(t)},t}(i.default);a.PushORDER_QUEUE_INFO=ut;var ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateOrderQueues(t.orderQueues)},t}(i.default);a.PushORDER_QUEUES_BATCH_INFO=ht;var mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateArmyEquip(t)},t}(i.default);a.PushARMY_EQUIP_INFO_PUSH=mt;var ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&V.ArmyEquipController.getInstance().updateEquipData(t)},t}(i.default);a.PushARMY_GROUP_EQUIP_INFO_PUSH=ft;var _t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)&&(o.EVENT.emit(r.EventId.ScienceShareGetNewUser),l.default.Instance().ShowTips(n.LOCAL.getText("100030")))},t}(i.default);a.PushScienceShareGetUser=_t;var yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)&&(o.EVENT.emit(r.EventId.ScienceShareGetNewUser),l.default.Instance().ShowTips(n.LOCAL.getText("100031")))},t}(i.default);a.PushScienceShareGetNewUser=yt;var gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&D.send(D.Names.SUBPACK_CHAT_CONTROLLER_CALL,{name:"roomChatChange",args:[t]})},t}(i.default);a.PushCHAT_ROOM_CHANGE=gt;var Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t)if(15005==t.shareId)if(t.armyid){var a={serverReward:{resource:{gold:0,oil:0,voucher:0,honor:0,metal:0,coal:0,wood:0,soil:0,military:0,expedition_coin:0,jungong:0,coin:0},build:[],armys:[{itemId:t.armyid,itemCount:1}],hero:[],exp:0,giftExp:0,items:[],herosplit:[],giftKey:0,energy:0},isPay:!1,detail:n.LOCAL.getText("100032")};l.default.Instance().OpenUI(L.UIDataInfo.CommonRewardPanel,a)}else l.default.Instance().ShowTips(n.LOCAL.getText("100032"));else 16004==t.shareId?(t.common&&t.common.moneyTree&&t.common.moneyTree.name?l.default.Instance().ShowTips(n.LOCAL.getText("100033",t.common.moneyTree.name)):l.default.Instance().ShowTips(n.LOCAL.getText("100034")),I.default.GetSharkMoneyTreeData()):16008==t.shareId&&l.default.Instance().ShowTips(n.LOCAL.getText("100035"))},t}(i.default);a.PushShare=Ct;var vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateTreasureBoxTime(t.time),w.emit(r.EventId.TreasureBoxUpdate))},t}(i.default);a.PushTreasureBoxTime=vt;var It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMyCastleFace(t),p.send(p.Names.MVC_CASTLE_FACE_VIEW_REFRESH,{}))},t}(i.default);a.PushCastleFace=It;var Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMyCastleEffect(t),p.send(p.Names.MVC_CASTLE_EFFECT_VIEW_REFRESH,{}))},t}(i.default);a.PushCastleEffect=Tt;var St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMyCastleNameplate(t),p.send(p.Names.MVC_CASTLE_NAMEPLATE_VIEW_REFRESH,{}))},t}(i.default);a.PushCastleNameplate=St;var At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMyArmyLineFace(t),p.send(p.Names.MVC_CASTLE_ARMYLINE_VIEW_REFRESH,{}))},t}(i.default);a.PushArmyLineSkins=At;var Dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateMyHeadFrames(t),p.send(p.Names.MVC_HEADFRAMES_VIEW_REFRESH,{}))},t}(i.default);a.PushHeadFrames=Dt;var Nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)&&(W.default.Instance().HaveNewTreasurePieceLog=!0,o.EVENT.emit(r.EventId.TreasurePieceLogUpdate))},t}(i.default);a.PushNewTreasurePieceLog=Nt;var bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.CountryBossData.UpdateData(t),o.EVENT.emit(r.EventId.CountryBossDataUpdate))},t}(i.default);a.PushCountryBossData=bt;var Lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateHeros(t)},t}(i.default);a.PushHeroInfo=Lt;var Et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.DeleteHero(t)},t}(i.default);a.PushDeleteHeroInfo=Et;var Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),s.DATA.UserData.addHeroSkin(t))},t}(i.default);a.PushHeroSkin=Pt;var wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),s.DATA.UserData.heroSkinChange(t),p.send(p.Names.MVC_HERO_SKIN_REFRESH,t))},t}(i.default);a.PushHeroSkinChange=wt;var Bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),s.DATA.UserData.onHeroActiveSkillChange(t))},t}(i.default);a.PushHeroActiveSkillChange=Bt;var Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=t.pointId;s.DATA.UserData.UpdateWorldSite(t,s.DATA.UserData.ServerId),o.EVENT.emit(r.EventId.WorldSite_Update,a)}},t}(i.default);a.PushWorldSite=Mt;var Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateWorldSites(t.worldWonders,s.DATA.UserData.ServerId),o.EVENT.emit(r.EventId.WorldSite_Update,-1))},t}(i.default);a.PushWorldSites=Ut;var Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=t.pointId;s.DATA.UserData.UpdateWorldMarch(t),o.EVENT.emit(r.EventId.WorldPointMarch_Update,a)}},t}(i.default);a.PushWorldPointMarch=Rt;var Gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateSingleAlliacneAssemlyData(t)},t}(i.default);a.PushAllianceAssemblyChange=Gt;var Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.DelSingleAlliacneAssemlyData(t.teamId)},t}(i.default);a.PushAllianceAssemblyDel=Ot;var kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateSingleAlliacneAssemlyData(t)},t}(i.default);a.PushAllianceAssemblyArrival=kt;var xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(c.default.playG123SoundPathByName("start_rally"),s.DATA.UserData.CreateAlliacneAssemlyData(t))},t}(i.default);a.PushAllianceAssemblyCreate=xt;var Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=t;a.leaderUid!=s.DATA.UserData.UID.toString()&&s.DATA.UserData.Alliance.isInAlliance()&&a.targetAid===s.DATA.UserData.Alliance.Aid&&p.send(p.Names.MVC_SHOW_Assembly_MAIL_TIPS,a)}},t}(i.default);a.PushAllianceAssemblyed=Ft;var Vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateShieldTime(t.shieldTime)},t}(i.default);a.PushShieldTime=Vt;var Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)&&o.EVENT.emit(r.EventId.PushLuckyDraw)},t}(i.default);a.PushLuckyDrawReset=Ht;var Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateThroneData(t),o.EVENT.emit(r.EventId.ThroneDataUpdate))},t}(i.default);a.PushThroneInfo=Wt;var jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log("PushThroneAttackPushThroneAttackPushThroneAttack:"+JSON.stringify(t)),o.EVENT.emit(r.EventId.ThroneTowerAttack,t))},t}(i.default);a.PushThroneAttack=jt;var qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateThroneKingGift(t),o.EVENT.emit(r.EventId.ThroneKingGiftUpdate))},t}(i.default);a.PushThroneKingGiftData=qt;var Kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateDarkPortalData(t.crossTeleporters),o.EVENT.emit(r.EventId.DarkPortalUpdate))},t}(i.default);a.PushDarkPortalData=Kt;var Yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&M.currentWorldMapCrossServerModel.parse(t.crossServer)},t}(i.default);a.PushFightServerData=Yt;var Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateServerState(t.state)},t}(i.default);a.PushServerState=Xt;var Jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateAirPlaneData(t),o.EVENT.emit(r.EventId.WorldAirPlaneUpdate))},t}(i.default);a.PushAirDropAriPlane=Jt;var zt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateAirDropDropData(t),o.EVENT.emit(r.EventId.WorldAirDropUpdate,t))},t}(i.default);a.PushAirDropDropChange=zt;var Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateVoteTimeData(t)},t}(i.default);a.PushAirDropVoteTimeData=Qt;var Zt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=t.op;s.DATA.UserData.Alliance.UpdateOneChatReward(t.info,a),o.EVENT.emit(r.EventId.AllianceChatRewardUpdate)}},t}(i.default);a.PushAllianceChatReward=Zt;var $t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(P.ActivityController.Instance.UpdateActivityData(t),o.EVENT.emit(r.EventId.ACTIVITY_ONE_UPDATE,t),o.EVENT.emit(r.EventId.ACTIVITY_ICON_UPDATE))},t}(i.default);a.PushOneActivity=$t;var ea=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(P.ActivityController.Instance.UpdateActivityExtraData(t),o.EVENT.emit(r.EventId.ACTIVITY_EXTRA_UPDATE,t.aid))},t}(i.default);a.PushOneActivityExtra=ea;var ta=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(P.ActivityController.Instance.UpdateActivityAllianceBPPoint(t),o.EVENT.emit(r.EventId.ACTIVITY_EXTRA_UPDATE,t.aid))},t}(i.default);a.PushActivity_AllianceBP_Point=ta;var aa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&D.send(D.Names.SUBPACK_ACTIVITY_EVERYDAY_UPDATE,t)},t}(i.default);a.EverydayRewardUpdate=aa;var oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateVipData(t)},t}(i.default);a.Push_VIP_CHANGE=oa;var na=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){o.EVENT.emit("LIMIT_TIME_GIFT_CHAGNE")},t}(i.default);a.PUSH_LIMIT_GIFT=na;var ia=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&t.dubbingpacks&&s.DATA.UserData.updateDubbingPacks(t.dubbingpacks)},t}(i.default);a.PushDubbingInfo=ia;var ra=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&t.bgmpacks&&s.DATA.UserData.updateSystemBGMPacks(t.bgmpacks)},t}(i.default);a.PushSystemBGMusic=ra;var sa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateFirstChargeBenefitData(t)},t}(i.default);a.Push_FIRST_CHARGE_CHANGE=sa;var la=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.SetStrengthenData(t)},t}(i.default);a.Push_MINE_INFO=la;var ca=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.table(t),s.DATA.UserData.allianceExchangesDatas.push(t),p.send(p.Names.MVC_StrengthenItemExchangeAdd,t))},t}(i.default);a.Push_ALLIANCE_EXCHANGE_ADD=ca;var da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){S.table(t);for(var a=-1,o=0;o<s.DATA.UserData.allianceExchangesDatas.length;o++){var n=s.DATA.UserData.allianceExchangesDatas[o];if(n.uid==t.uid&&n.requestTime==t.requestTime){a=o;break}}a>=0&&(s.DATA.UserData.allianceExchangesDatas[a]=t,p.send(p.Names.MVC_StrengthenItemExchangeUpdate,t))}},t}(i.default);a.Push_ALLIANCE_EXCHANGE_CANCELED=da;var pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t&&(S.table(t),t.allianceExchange)){for(var a=0;a<s.DATA.UserData.allianceExchangesDatas.length;a++){var o=s.DATA.UserData.allianceExchangesDatas[a];if(o.uid==t.allianceExchange.uid&&o.requestTime==t.allianceExchange.requestTime){s.DATA.UserData.allianceExchangesDatas[a]=t.allianceExchange,p.send(p.Names.MVC_StrengthenItemExchangeUpdate,t);break}}if(t.allianceExchange.uid==String(s.DATA.UserData.UID)){var i="";if(!C.Ary.isEmpty(t.allianceExchange.goalItems))i=(r=y.TABLE.getTableDataById(H.TableName.ITEM,String(t.allianceExchange.goalItems[0].itemId)))?r.name:i;var r,d="";if(!C.Ary.isEmpty(t.allianceExchange.items))d=(r=y.TABLE.getTableDataById(H.TableName.ITEM,String(t.allianceExchange.items[0].itemId)))?r.name:d;l.default.Instance().ShowTips(n.LOCAL.getText("mining018",t.helperName,n.LOCAL.getText(d),n.LOCAL.getText(i)))}}},t}(i.default);a.Push_ALLIANCE_EXCHANGE_HELPED=pa;var ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t&&(S.table(t),t.uid))for(var a=s.DATA.UserData.allianceExchangesDatas.length-1;a>=0;a--){if(s.DATA.UserData.allianceExchangesDatas[a].uid==t.uid){s.DATA.UserData.allianceExchangesDatas[a].state=2,p.send(p.Names.MVC_StrengthenItemExchangeUpdate,s.DATA.UserData.allianceExchangesDatas[a]),s.DATA.UserData.allianceExchangesDatas.splice(a,1);break}}},t}(i.default);a.Push_ALLIANCE_EXCHANGE_REMOVE=ua;var ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.table(t),c.default.ObjIsEmpty(t.x)||c.default.ObjIsEmpty(t.y)||B.send(B.Names.WorldMapJumpToTile,cc.v2(t.x,t.y)))},t}(i.default);a.PUSH_FIND_REFUGEECAMP=ha;var ma=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.table(t),c.default.ObjIsEmpty(t.x)||c.default.ObjIsEmpty(t.y)||B.send(B.Names.WorldMapJumpToTile,cc.v2(t.x,t.y)))},t}(i.default);a.PUSH_ITEM_GET_MONSTER=ma;var fa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateGrowRoad(t)},t}(i.default);a.PUSH_GROW_ROAD_INFO=fa;var _a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateGrowRoadSuperFlag(t)},t}(i.default);a.PUSH_GROW_ROAD_SUPER_FLAG=_a;var ya=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updataAllGrowRoadTasks(t)},t}(i.default);a.PUSH_GROW_ROAD_ALL_TASK_INFO=ya;var ga=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updataGrowRoadTasks(t)},t}(i.default);a.PUSH_GROW_ROAD_UPDATED_TASK_INFO=ga;var Ca=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updatePayCNYTotal(t)},t}(i.default);a.PUSH_FIRST_PAY_CNY=Ca;var va=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),p.send(p.Names.MVC_ACTIVITY_SUMMER_LOTTERY_INFO,t))},t}(i.default);a.Push_ACTIVITY_SUMMER_LOTTERY_INFO=va;var Ia=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)},t}(i.default);a.Push_REALNAME_STATE=Ia;var Ta=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){U.trace({resp:"\u670d\u52a1\u5668\u63a8\u9001\uff0c\u91cd\u542f\u5ba2\u6237\u7aef"});var t=c.default.JSON_PARSE(e.data);if(!t)return k.GLOBAL.JumpServer=!1,k.GLOBAL.changeServerId=k.GLOBAL.changeServerIp=null,void E.default.doResetGame(!0);S.log(t),1===t.type?G.alert(n.LOCAL.getText("cross_server_system_032"),"TIP",this,function(){k.GLOBAL.JumpServer=!1,k.GLOBAL.changeServerId=k.GLOBAL.changeServerIp=null,E.default.doResetGame(!0)}):2===t.type?G.alert(n.LOCAL.getText("cross_server_system_031"),"TIP",this,function(){k.GLOBAL.JumpServer=!1,k.GLOBAL.changeServerId=k.GLOBAL.changeServerIp=null,E.default.doResetGame(!0)}):(k.GLOBAL.JumpServer=!1,k.GLOBAL.changeServerId=k.GLOBAL.changeServerIp=null,E.default.doResetGame(!0))},t}(i.default);a.Push_RestartGame=Ta;var Sa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.AtiIndulgedData.UpdateData(t),o.EVENT.emit(r.EventId.AtiIndulgedUpdate),c.default.CheckAtiIndulgedGameEnable())},t}(i.default);a.PushProtectData=Sa;var Aa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.ProductingData.ProductComplete(t.op,t.state,!1)},t}(i.default);a.PushProductComplete=Aa;var Da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),p.send(p.Names.MVC_ACTIVITY_REVERSE_CARD_INFO,t))},t}(i.default);a.Push_ACTIVITY_REVERSE_CARD=Da;var Na=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&R.default.Instance.updateServerData(t)},t}(i.default);a.Push_PROFESSON_DATA_CHANGED=Na;var ba=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.Alliance.UpdateAllianceGiftData(t),o.EVENT.emit(r.EventId.AllianceGiftUpdate))},t}(i.default);a.Push_AllianceGiftData=ba;var La=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.PveTowerData.UpdateData(t),o.EVENT.emit(r.EventId.PveTowerUpdate))},t}(i.default);a.Push_PveTowerData=La;var Ea=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),s.DATA.UserData.updateDefenseArmyCandidateInfo(t))},t}(i.default);a.Push_DEF_ARMY_CANDIDATE_INFO=Ea;var Pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.Alliance.UpdateSelfHelpList(t.selfHelps,!1),o.EVENT.emit(r.EventId.AllianceHelpUpdate))},t}(i.default);a.PushAllianceSelfHelpList=Pa;var wa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(P.ActivityController.Instance.upDataShopPointById(t),o.EVENT.emit(r.EventId.ActivityShop_Refesh))},t}(i.default);a.PushShopPointActivity=wa;var Ba=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),s.DATA.UserData.UpdateOneProfessionalTower(t))},t}(i.default);a.PushMyProfessionalTowers=Ba;var Ma=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=P.ActivityController.Instance.getActivityByActivityId(130);t.userMonsterSiege&&(a.userMonsterSiege=t.userMonsterSiege),o.EVENT.emit(r.EventId.UPDATE_USER_MONSTER_SIEGE,t),p.send(p.Names.checkMonsterDefenderIsBegin,null),x.getInstance().addMonsterDefenderMarchData()}},t}(i.default);a.PushUserMonsterSiege=Ma;var Ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);if(t){var a=P.ActivityController.Instance.getActivityByActivityId(153);a?(t.alMonsterSiege&&(a.alMonsterSiege=t.alMonsterSiege),o.EVENT.emit(r.EventId.UPDATE_ALLIANCE_MONSTER_SIEGE,t),x.getInstance().addMonsterDefenderMarchData()):P.ActivityController.Instance.requestActivityData()}},t}(i.default);a.PushAllianceMonsterSiege=Ua;var Ra=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.updateBountyData(t.militaryRank),p.send(p.Names.MVC_UPDATE_BOUNTY_QUEST,null))},t}(i.default);a.PushMilitaryUpdate=Ra;var Ga=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.updateBountyData(t.militaryRank),p.send(p.Names.MVC_UPDATE_BOUNTY_SHOP,null))},t}(i.default);a.PushMilitaryShopUpdate=Ga;var Oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&O.updateMod(t)},t}(i.default);a.PushModChange=Oa;var ka=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateWbScore(t)},t}(i.default);a.PushWORLDBATTLESCORChange=ka;var xa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateSaleBuyNum(t)},t}(i.default);a.PushSaleNumChange=xa;var Fa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&t.group&&(D.send(D.Names.SUBPACK_CHAT_CONTROLLER_CALL,{name:"updateGroupMember",args:[t]}),o.EVENT.emit(r.EventId.ChatGroupListRefresh),o.EVENT.emit(r.EventId.ChatGroupMemberChange,t.group))},t}(i.default);a.GROUP_CHAT_MEMBER_CHANGE=Fa;var Va=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&t.group&&(D.send(D.Names.SUBPACK_CHAT_CONTROLLER_CALL,{name:"updateGroupNameAndRed",args:[t]}),o.EVENT.emit(r.EventId.ChatGroupNameChange,t))},t}(i.default);a.GROUP_CHAT_CFG_CHANGE=Va;var Ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&t.id&&(s.DATA.UserData.ProductingData.ProductComplete(t.op,t.state,!0),o.EVENT.emit(r.EventId.FORMULA_MAKE_COMPLETE,t.id))},t}(i.default);a.Push_FORMULA_MAKE_COMPLETE=Ha;var Wa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&t.trapsSlotInfo&&(S.log(t),s.DATA.UserData.updateTrapsSlotInfo(t.trapsSlotInfo),o.EVENT.emit(r.EventId.DEF_TRAPS_SLOTS_INFO))},t}(i.default);a.Push_DEF_TRAPS_SLOTS_INFO=Wa;var ja=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),o.EVENT.emit(r.EventId.POTION_USE_EFFECT,t))},t}(i.default);a.Push_POTION_USE_EFFECT=ja;var qa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.DECORATE_STOREHOUSE_CHANGE,t)},t}(i.default);a.Push_DECORATE_STOREHOUSE_CHANGE=qa;var Ka=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.EIGHT_COUNTRY_STATUS_PUSH,t)},t}(i.default);a.Push_EIGHT_COUNTRY_STATUS=Ka;var Ya=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateAdventureData(t)},t}(i.default);a.Push_AdventureData=Ya;var Xa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.KVK_ALLIANCE_BUILDING_STATUS_CHANGE,t)},t}(i.default);a.Push_KVK_ALLIANCE_BUILDING_STATUS_CHANGE=Xa;var Ja=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.KVK_COUNTRY_INFO_CHANGE,t)},t}(i.default);a.Push_KVK_COUNTRY_INFO_CHANGE=Ja;var za=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.KVK_ALLIANCE_INFO_CHANGE,t)},t}(i.default);a.Push_KVK_ALLIANCE_INFO_CHANGE=za;var Qa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updatelaunchTowerData(t)},t}(i.default);a.Push_GUN_FIGHT_INFO=Qa;var Za=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateAllianceRedDot(t)},t}(i.default);a.ALLIANCE_BADGE_AND_TASK_RED_DOT=Za;var $a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.KVK_INFO_CHANGE,t)},t}(i.default);a.Push_KVK_INFO_CHANGE=$a;var eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),o.EVENT.emit(r.EventId.Push_KVK_ACHEVEMENT_CHANGE,t))},t}(i.default);a.Push_KVK_ACHEVEMENT_CHANGE=eo;var to=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(S.log(t),o.EVENT.emit(r.EventId.Push_KVK_EXPEDITION_FINISH_CHANGE,t))},t}(i.default);a.Push_KVK_EXPEDITION_FINISH_CHANGE=to;var ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){c.default.JSON_PARSE(e.data)},t}(i.default);a.Push_KVK_PROGRESS_CHANGE=ao;var oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.Push_KVK_FINISH_CHANGE,t)},t}(i.default);a.Push_KVK_FINISH_CHANGE=oo;var no=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateStatusBuffData(t.sBuffs)},t}(i.default);a.Push_Status_Buff=no;var io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&p.send(p.Names.MVC_EC_PREPARE_INFO_DATA,t)},t}(i.default);a.Push_EC_PREPARE_INFO=io;var ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.AddTreasureData(t)},t}(i.default);a.Push_Treasure_Record=ro;var so=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.TreasureThemeData.UpdateOneThemeData(t),o.EVENT.emit(r.EventId.TreasureThemeDataUpdate))},t}(i.default);a.Push_Treasure_Info=so;var lo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&(s.DATA.UserData.UpdateDecorationSuitData(t),o.EVENT.emit(r.EventId.DecorationSuitUpdate))},t}(i.default);a.Push_Decoration_Suit=lo;var co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateChapterTaskData(t.treasureChapter)},t}(i.default);a.Push_Chapter_Task=co;var po=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.UpdateChapterTaskListData(t)},t}(i.default);a.Push_Chapter_Task_List=po;var uo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&p.send(p.Names.MVC_DIM_INFO_UPDATE,t)},t}(i.default);a.PUSH_DEGENERATOR_INFO=uo;var ho=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&p.send(p.Names.MVC_DIM_MAIL_UPDATE,t)},t}(i.default);a.PUSH_DEGENERATOR_MAIL=ho;var mo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){p.send(p.Names.MVC_DIM_REFRESH,null)},t}(i.default);a.Push_DEGENERATOR_REFRESH_PUSH=mo;var fo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&D.send(D.Names.Push_AREAN_CONFIG_PUSH,t)},t}(i.default);a.Push_AREAN_CONFIG_PUSH=fo;var _o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&s.DATA.UserData.updateKingMarkMsg(t)},t}(i.default);a.Push_KING_MARK_PUSH=_o;var yo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.TREASURE_MAP_DATA_REMOVE,t)},t}(i.default);a.Push_TREASURE_MAP_DATA_REMOVE=yo;var go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.TREASURE_MAP_DATA_ADD,t)},t}(i.default);a.Push_TREASURE_MAP_DATA_ADD=go;var Co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.TREASURE_MAP_DATA_UPDATE,t)},t}(i.default);a.Push_TREASURE_MAP_DATA_UPDATE=Co;var vo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.TREASURE_MAP_TASKS_UPDATE,t)},t}(i.default);a.Push_TREASURE_MAP_TASKS=vo;var Io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&o.EVENT.emit(r.EventId.EXPLORE_SEA_LEGEND_BOX_NOTICE,t)},t}(i.default);a.Push_EXPLORE_SEA_LEGEND_BOX_NOTICE=Io;var To=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=c.default.JSON_PARSE(e.data);t&&D.send(D.Names.SUBPACK_EIGHT_COUNTRY_STRONGEST_LEADER,t)},t}(i.default);a.Push_EIGHT_COUNTRY_STRONGEST_LEADER=To;var So=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){D.send(D.Names.SUBPACK_EIGHT_COUNTRY_CHANGE_TASK,{})},t}(i.default);a.Push_EIGHT_COUNTRY_CHANGE_TASK=So,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Net/NetMgr":"NetMgr","../../Core/Net/ResponseBase":"ResponseBase","../../fws/display/MsgBox":"MsgBox","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/ConfirmPanel":"ConfirmPanel","../Common/GM":"GM","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/SceneName":"SceneName","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Data/GlobalData":"GlobalData","../Data/MailData":"MailData","../Data/UserStaticData":"UserStaticData","../Profession/ProfessionController":"ProfessionController","../Scene/SceneManager":"SceneManager","../Start/ResetGame":"ResetGame","../Tools/EventTool":"EventTool","../Tools/GameTools":"GameTools","../Tools/SubPackMsgs":"SubPackMsgs","../components/cointree/CoinTreeComponent":"CoinTreeComponent","../components/worldmap/WorldMapModel":"WorldMapModel","../components/worldmap/WorldMapMsgs":"WorldMapMsgs","../components/worldmap/controllers/WorldMapController":"WorldMapController","../controllers/ActivityController":"ActivityController","../controllers/ArmyEquipController":"ArmyEquipController","../controllers/ExchangeController":"ExchangeController","../controllers/MailController":"MailController","../controllers/WelcomeRewardController":"WelcomeRewardController","../msgs/MvcMsgs":"MvcMsgs","./../../Core/Event/EventCenter":"EventCenter"}],ResponseRegister:[function(e,t,a){"use strict";cc._RF.push(t,"769b2uk0rRBtrSqLDYFZsCq","ResponseRegister"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./LoginResponse"),n=e("../../Core/Net/ReciverBase"),i=e("./PushResponse"),r=e("./BuildingResponse"),s=e("./ArmyResponse"),l=e("./PlunderResponse"),c=e("./PVEResponse"),d=e("./CommonResponse"),p=e("./FriendResponse"),u=e("./ObstacleResponse"),h=e("./MailResponse"),m=e("./TimeCardsResponse"),f=e("./WelcomeRewardStateResponse"),_=e("./GrowthFundResponse"),y=e("./ShopBuyLimitResponse"),g=e("./AllianceResponse"),C=e("../alliance/CountryNotifyResponse"),v=e("../alliance/PayToServerResponse"),I=e("./ActivityStateResponse"),T=e("../Const/ResponseId"),S=e("../Const/RequestId"),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Regist=function(){this.Add(T.ResponseId.LOGIN,new o.default),this.Add(T.ResponseId.USER_DISCONNECT,new i.PushUserDisconnect),this.Add(T.ResponseId.PUSH_KICK_OUT,new i.PushKickOut),this.Add(T.ResponseId.PUSH_MigrationRole,new i.PushMigrationRole),this.Add(T.ResponseId.PUSH_USER_DATA_COMMON,new i.PushUserDataCommon),this.Add(T.ResponseId.PUSH_BUILDING,new i.PushBuilding),this.Add(T.ResponseId.PUSH_BUILDINGS,new i.PushBuildings),this.Add(T.ResponseId.BUILDING_INFO_LIST,new i.PushMergeBuildings),this.Add(T.ResponseId.DROP_BUILDING_LIST,new i.DropBuildingList),this.Add(T.ResponseId.PUSH_RESOURCE,new i.PushResource),this.Add(T.ResponseId.PUSH_STRTIPS,new i.PUSHSTRTIPS),this.Add(T.ResponseId.PUSH_DAILY_QUEST_INFO,new i.PUSH_DAILY_QUEST_INFO),this.Add(T.ResponseId.PUSH_DAILY_QUEST_ALL_INFO,new i.PUSH_ALL_DAILY_QUEST_INFO),this.Add(T.ResponseId.PUSH_UPDATA_DAILY_REQUEST,new i.PUSH_BOUNTY_QUEST_INFO),this.Add(T.ResponseId.PUSH_WORLD_TREASURE_QUEST,new i.PushWorldTreasureQuest),this.Add(T.ResponseId.PUSH_STAR,new i.PowerResponse),this.Add(T.ResponseId.PUSH_ARMY,new i.PushArmy),this.Add(T.ResponseId.ARMY_INFO_LIST,new i.PushMergeArmyList),this.Add(T.ResponseId.DELETE_ARMY,new i.DeleteArmy),this.Add(T.ResponseId.ARMY_DROP_LIST,new i.DeleteArmyList),this.Add(T.ResponseId.PUSH_ENERGY,new i.PushEnergy),this.Add(T.ResponseId.PUSH_EXP,new i.PushExp),this.Add(T.ResponseId.PUSH_AREA,new i.PushArea),this.Add(T.ResponseId.PUSH_QUEST,new i.PushQuest),this.Add(T.ResponseId.PUSH_QUESTS,new i.PushQuests),this.Add(T.ResponseId.PUSH_ArmyBox,new i.PushArmyBox),this.Add(T.ResponseId.PUSH_BUILDING_BOX,new i.PushBuildBox),this.Add(T.ResponseId.PUSH_POINT,new i.PushMapPoint),this.Add(T.ResponseId.PUSH_OWNER_WORLD_POINT_INFO,new i.PushOWNER_WORLD_POINT_INFO),this.Add(T.ResponseId.PUSH_WORLD_DESTORYED,new i.PushOWNER_WORLD_DESTORYED),this.Add(T.ResponseId.PUSH_UNLOCK_OCEAN,new i.PUSH_UNLockOREAN),this.Add(T.ResponseId.PUSH_BUFF,new i.PushBuff),this.Add(T.ResponseId.PUSH_STATE,new i.PushState),this.Add(T.ResponseId.PUSH_ALLIANCE_BUFF,new i.PUSHALLIANCEBUFF),this.Add(T.ResponseId.PUSH_TREASURE_TIME,new i.PushTreasureBoxTime),this.Add(T.ResponseId.PUSH_MAX_ITEM,new i.PushMaxItem),this.Add(T.ResponseId.PUSH_REALNAME,new i.Push_REALNAME_STATE),this.Add(T.ResponseId.PUSH_TERRITORY_INFO,new i.PushTerritoryInfo),this.Add(T.ResponseId.PUSH_USE_WORLD_EFFECT_ITEM,new i.PushWorldMapUseEffectItem),this.Add(T.ResponseId.PUSH_PEOPLE,new i.PushPeople),this.Add(T.ResponseId.DROP_BUILDING,new i.DropBuilding),this.Add(T.ResponseId.PUSH_TOOL,new i.PushTool),this.Add(T.ResponseId.PUSH_ITEMS,new i.PushItems),this.Add(T.ResponseId.PUSH_SHAREBOX,new i.PushShareBox),this.Add(T.ResponseId.PUSH_TimeDowns,new i.PushTimeDowns),this.Add(T.ResponseId.PUSH_AutoCollect,new i.PushAutoCollect),this.Add(T.ResponseId.PUSH_REMOVE_OBSTALCE,new u.ObstacleResponse),this.Add(S.RequestId.BUILD_BUILDING,new r.default(S.RequestId.BUILD_BUILDING)),this.Add(S.RequestId.BUILD_STATE_UP,new r.default(S.RequestId.BUILD_STATE_UP)),this.Add(S.RequestId.ARMY_UNLOCK,new s.default(S.RequestId.ARMY_UNLOCK)),this.Add(S.RequestId.ARMY_LEVELUP,new s.default(S.RequestId.ARMY_LEVELUP)),this.Add(S.RequestId.ADVENTURE,new c.default(S.RequestId.ADVENTURE)),this.Add(S.RequestId.GET_ORDER,new d.GetOrderResponse),this.Add(T.ResponseId.PUSH_AddFriend,new p.FriendUpdateResponse),this.Add(T.ResponseId.PUSH_DelFriend,new p.FriendDelResponse),this.Add(T.ResponseId.PUSH_ADDFriending,new p.PushFriendingResponse),this.Add(T.ResponseId.PUSH_CANCELADDFriending,new p.PushFriendingDelResponse),this.Add(S.RequestId.STARTADVENTURE,new l.STARTADVENTUREResponse),this.Add(S.RequestId.ADVENTURECLICK,new l.ADVENTURECLICKResponse),this.Add(T.ResponseId.PUSH_CLEAROBSTACLE,new i.PushClearObstacle),this.Add(S.RequestId.STARTA_PVE_OBSTACLE,new l.STARTADVENTUREResponse),this.Add(S.RequestId.STARTA_PVE_OBSTACLE_ATTACK,new l.ADVENTURECLICKResponse),this.Add(T.ResponseId.PUSH_TILE_PVE,new i.PushTilePveData),this.Add(T.ResponseId.MARCH_INFO,new i.PushMarchInfo),this.Add(T.ResponseId.USER_MARCH_INFO,new i.PushUserMarchInfo),this.Add(T.ResponseId.MARCH_ATTACKMONSTER_FINISH,new i.PushMarchAttackMonsterFinish),this.Add(T.ResponseId.MARCH_ATTACKBOSS_FINISH,new i.PushMarchAttackBossFinish),this.Add(T.ResponseId.USERARMY_MARCHSTATE,new i.PushUserArmyMarchState),this.Add(T.ResponseId.PUSH_TILEINFO,new i.PushWorldMapTileInfo),this.Add(T.ResponseId.PUSH_ENEMYREFRESH,new i.PushWorldMapEnemyRefresh),this.Add(T.ResponseId.PUSH_ATTACK_ARMIES,new i.PushAttackArmies),this.Add(T.ResponseId.PUSH_SYSTEM_SOUND_PLAY,new i.PushSystemSound),this.Add(T.ResponseId.PUSH_NOTICE,new i.PushNotice),this.Add(T.ResponseId.PUSH_NOTICE_PARA,new i.PushNoticePara),this.Add(T.ResponseId.PUSH_COMMON_MESSAGE,new i.PushMessageCommon),this.Add(T.ResponseId.PUSH_GAME_NOTICE,new i.PushGameNotice),this.Add(T.ResponseId.PUSH_EXCHANGE,new i.PushExchange),this.Add(T.ResponseId.PUSH_EXCHANGE_ORDERED,new i.PushOrderedExchange),this.Add(T.ResponseId.PUSH_ACChargeLevel,new i.PushCollectorSelfMultiple),this.Add(S.RequestId.MAIL_GET_LIST,new h.MailResponse),this.Add(S.RequestId.MAIL_UNREAD,new h.MailUNREADResponse),this.Add(T.ResponseId.PUSH_SINGLE_MAIL,new i.PushSingleMail),this.Add(T.ResponseId.PUSH_WORLD_CHAT,new i.PushWorldChat),this.Add(T.ResponseId.PUSH_FreeCoin,new i.PushFreeCoin),this.Add(T.ResponseId.PUSH_TIME_CARDS,new m.TimeCardsResponse),this.Add(T.ResponseId.WELCOME_REWARD_STATE,new f.WelcomeRewardStateResponse),this.Add(T.ResponseId.PUSH_GROWTH_FUND,new _.GrowthFundResponse),this.Add(T.ResponseId.PUSH_SHOP_BUY_LIMIT,new y.ShopBuyLimitResponse),this.Add(T.ResponseId.PUSH_SHOP_BUY_LIMIT_TIME,new y.ShopBuyLimitTimeResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_INFO,new g.AllianceInfoResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_KICKED,new g.AllianceKickedResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_RANK_CHANGE,new g.AllianceRankChangeResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_INFO_CHANGE,new g.AllianceInfoChangeResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_APPLY_CHANGE,new g.AllianceApplyChangeResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_APPLY_ACCEPTED,new g.AllianceApplyAcceptedResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_HELP_DATA,new g.AllianceHelpUpdateResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_HELP_ADD,new g.AllianceHelpAddResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_HELP_REMOVE,new g.AllianceHelpRemoveResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_MEMBER_DYNAMIC,new g.AllianceMemberDynamicResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_SCIENCEDATA,new g.AllianceScienceData),this.Add(T.ResponseId.PUSH_ALLIANCE_DIAMOND_DONATE_NUM,new g.AllianceDiamondDonateNum),this.Add(T.ResponseId.PUSH_ALLIANCE_SHOP,new g.AllianceShopUpdateResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_BUILDING_CHANGE,new g.AllianceBuildingChangeResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_BOSS,new g.AllianceBossResponse),this.Add(T.ResponseId.PUSH_COUNTRY_NOTICE_INFO,new C.default),this.Add(T.ResponseId.PUSH_PAY_TO_SERVER,new v.default),this.Add(T.ResponseId.PUSH_PAY_CHECK_NOT_ENOUGH,new i.PayCheckNotEnoughResponse),this.Add(T.ResponseId.PUSH_ALLIANCE_GIFT_INFO,new i.Push_AllianceGiftData),this.Add(T.ResponseId.PushAllianceSelfHelpList,new i.PushAllianceSelfHelpList),this.Add(T.ResponseId.ORDER_QUEUE_INFO,new i.PushORDER_QUEUE_INFO),this.Add(T.ResponseId.ORDER_QUEUES_BATCH_INFO,new i.PushORDER_QUEUES_BATCH_INFO),this.Add(T.ResponseId.ARMY_EQUIP_INFO_PUSH,new i.PushARMY_EQUIP_INFO_PUSH),this.Add(T.ResponseId.ARMY_GROUP_EQUIP_INFO_PUSH,new i.PushARMY_GROUP_EQUIP_INFO_PUSH),this.Add(T.ResponseId.PUSH_CHATROOM_CHANGE,new i.PushCHAT_ROOM_CHANGE),this.Add(T.ResponseId.SCIENCE_SHARE_NEWUSER,new i.PushScienceShareGetNewUser),this.Add(T.ResponseId.SCIENCE_SHARE_USER,new i.PushScienceShareGetUser),this.Add(T.ResponseId.SHARE_PUSH,new i.PushShare),this.Add(T.ResponseId.PUSH_ACTIVITY_STATE,new I.default),this.Add(T.ResponseId.PUSH_ALLIANCE_Assembly,new i.PushAllianceAssemblyChange),this.Add(T.ResponseId.PUSH_ALLIANCE_Assembly_Success,new i.PushAllianceAssemblyArrival),this.Add(T.ResponseId.PUSH_ALLIANCE_Assembly_Created,new i.PushAllianceAssemblyCreate),this.Add(T.ResponseId.PUSH_ALLIANCE_Assembly_DEL,new i.PushAllianceAssemblyDel),this.Add(T.ResponseId.PUSH_ALLIANCE_Assemblyed,new i.PushAllianceAssemblyed),this.Add(T.ResponseId.PUSH_CASTLE_FACE_CHANGE,new i.PushCastleFace),this.Add(T.ResponseId.PUSH_CASTLE_EFFECT_CHANGE,new i.PushCastleEffect),this.Add(T.ResponseId.PUSH_CASTLE_NAMEPLATE_CHANGE,new i.PushCastleNameplate),this.Add(T.ResponseId.PUSH_CASTLE_ARMYLINE_CHANGE,new i.PushArmyLineSkins),this.Add(T.ResponseId.PUSH_HEADFRAMES_CHANGE,new i.PushHeadFrames),this.Add(T.ResponseId.PUSH_HERO_INFO,new i.PushHeroInfo),this.Add(T.ResponseId.PUSH_HERO_DELETE,new i.PushDeleteHeroInfo),this.Add(T.ResponseId.PUSH_HERO_SKIN_GET,new i.PushHeroSkin),this.Add(T.ResponseId.PUSH_HERO_SKIN_CHANGE,new i.PushHeroSkinChange),this.Add(T.ResponseId.PUSH_HERO_ACTIVE_SKILL_INFO,new i.PushHeroActiveSkillChange),this.Add(T.ResponseId.WORLD_SITE_PUSH,new i.PushWorldSite),this.Add(T.ResponseId.WORLD_SITES_PUSH,new i.PushWorldSites),this.Add(T.ResponseId.WORLD_POINT_MARCH_PUSH,new i.PushWorldPointMarch),this.Add(T.ResponseId.EVERYDAYREWARD_UPDATE_PUSH,new i.EverydayRewardUpdate),this.Add(T.ResponseId.USER_SHIELD_PUSH,new i.PushShieldTime),this.Add(T.ResponseId.PUSH_THRONE_INFO,new i.PushThroneInfo),this.Add(T.ResponseId.PUSH_THRONE_KING_GIFT,new i.PushThroneKingGiftData),this.Add(T.ResponseId.PUSH_THRONE_TOWER_ATTACK,new i.PushThroneAttack),this.Add(T.ResponseId.PUSH_AIRDROP_AIRPLANE,new i.PushAirDropAriPlane),this.Add(T.ResponseId.PUSH_AIRDROP_DROP_CHANGE,new i.PushAirDropDropChange),this.Add(T.ResponseId.PUSH_AIRDROP_VOTE_TIME,new i.PushAirDropVoteTimeData),this.Add(T.ResponseId.PUSH_COUNTRY_BOSS_DATA,new i.PushCountryBossData),this.Add(T.ResponseId.PUSH_PRODUCT_COMPLETE,new i.PushProductComplete),this.Add(T.ResponseId.PUSH_CROSS_TELEPORTER_INFO_,new i.PushDarkPortalData),this.Add(T.ResponseId.PUSH_SERVER_STATE,new i.PushServerState),this.Add(T.ResponseId.PUSH_FORCE_CONFIG_UPDATE,new i.PushForceConfigUpdate),this.Add(T.ResponseId.PUSH_BIND_ACCOUNT,new i.PushBindAccount),this.Add(T.ResponseId.PUSH_ALLIANCE_MOVE_INVITE,new i.PushAllianceMoveInvite),this.Add(T.ResponseId.PUSH_ALLIANCE_MEMBER_INVITE_ADD,new i.PushAllianceMemberInviteAdd),this.Add(T.ResponseId.PUSH_ALLIANCE_MEMBER_INVITE_DELETE,new i.PushAllianceMemberInviteDelete),this.Add(T.ResponseId.PUSH_ALLIANCE_MEMBER_INVITE_DELETEALL,new i.PushAllianceMemberInviteDeleteAll),this.Add(T.ResponseId.PUSH_ONE_ACTIVITY,new i.PushOneActivity),this.Add(T.ResponseId.PUSH_ONE_ACTIVITYEXTRA,new i.PushOneActivityExtra),this.Add(T.ResponseId.PUSH_ALLIANCEBP_ACTIVITYPOINT,new i.PushActivity_AllianceBP_Point),this.Add(T.ResponseId.PUSH_SET_APP_PLAYERINFO,new i.PushSetAppPlayerInfo),this.Add(T.ResponseId.PUSH_CROSS_FIGHT_SERVER_INFO,new i.PushFightServerData),this.Add(T.ResponseId.Push_AdventureData,new i.Push_AdventureData),this.Add(T.ResponseId.PUSH_VIP_CHANGE,new i.Push_VIP_CHANGE),this.Add(T.ResponseId.PUSH_FIRST_CHARGE_BENEFIT_CHANGE,new i.Push_FIRST_CHARGE_CHANGE),this.Add(T.ResponseId.MINE_INFO,new i.Push_MINE_INFO),this.Add(T.ResponseId.DUBBING_INFO,new i.PushDubbingInfo),this.Add(T.ResponseId.WORLD_BGM_INFO,new i.PushSystemBGMusic),this.Add(T.ResponseId.Push_WorldTreasure_Result,new i.PushWorldTreasureResult),this.Add(T.ResponseId.ALLIANCE_EXCHANGE_ADD,new i.Push_ALLIANCE_EXCHANGE_ADD),this.Add(T.ResponseId.ALLIANCE_EXCHANGE_CANCELED,new i.Push_ALLIANCE_EXCHANGE_CANCELED),this.Add(T.ResponseId.ALLIANCE_EXCHANGE_HELPED,new i.Push_ALLIANCE_EXCHANGE_HELPED),this.Add(T.ResponseId.ALLIANCE_EXCHANGE_REMOVE,new i.Push_ALLIANCE_EXCHANGE_REMOVE),this.Add(T.ResponseId.ALLIANCE_CHAT_REWARD_PUSH,new i.PushAllianceChatReward),this.Add(T.ResponseId.LIMIT_GIFT_POP,new i.PUSH_LIMIT_GIFT),this.Add(T.ResponseId.PUSH_FIND_REFUGEECAMP,new i.PUSH_FIND_REFUGEECAMP),this.Add(T.ResponseId.PUSH_ITEM_GET_MONSTER,new i.PUSH_ITEM_GET_MONSTER),this.Add(T.ResponseId.PUSH_RESTART_GAME,new i.Push_RestartGame),this.Add(T.ResponseId.Push_PresetMarchData,new i.PushPresetMarchData),this.Add(T.ResponseId.GROW_ROAD_INFO,new i.PUSH_GROW_ROAD_INFO),this.Add(T.ResponseId.GROW_ROAD_SUPER_FLAG,new i.PUSH_GROW_ROAD_SUPER_FLAG),this.Add(T.ResponseId.GROW_ROAD_ALL_TASK_INFO,new i.PUSH_GROW_ROAD_ALL_TASK_INFO),this.Add(T.ResponseId.GROW_ROAD_UPDATED_TASK_INFO,new i.PUSH_GROW_ROAD_UPDATED_TASK_INFO),this.Add(T.ResponseId.FIRST_PAY_CNY,new i.PUSH_FIRST_PAY_CNY),this.Add(T.ResponseId.ACTIVITY_SUMMER_LOTTERY_INFO,new i.Push_ACTIVITY_SUMMER_LOTTERY_INFO),this.Add(T.ResponseId.ACTIVITY_REVERSE_CARD,new i.Push_ACTIVITY_REVERSE_CARD),this.Add(T.ResponseId.PROFESSION_CHANGED_PUSH,new i.Push_PROFESSON_DATA_CHANGED),this.Add(T.ResponseId.PUSH_PVE_TOWER_DATA,new i.Push_PveTowerData),this.Add(T.ResponseId.ACTIVITY_LUCKY_DRAW_RESET,new i.PushLuckyDrawReset),this.Add(T.ResponseId.PUSH_SHOPPOINT_ACTIVITY,new i.PushShopPointActivity),this.Add(T.ResponseId.DEF_ARMY_CANDIDATE_INFO,new i.Push_DEF_ARMY_CANDIDATE_INFO),this.Add(T.ResponseId.PUSH_MY_PROFESSIONAL_TOWERS,new i.PushMyProfessionalTowers),this.Add(T.ResponseId.USER_MONSTER_SIEGE_INFO,new i.PushUserMonsterSiege),this.Add(T.ResponseId.ALLIANCE_MONSTER_SIEGE_INFO,new i.PushAllianceMonsterSiege),this.Add(T.ResponseId.PUSH_MILITARY_RANK,new i.PushMilitaryUpdate),this.Add(T.ResponseId.MILITARY_RANK_SHOPS,new i.PushMilitaryShopUpdate),this.Add(T.ResponseId.PUSH_MOD_CHANGE,new i.PushModChange),this.Add(T.ResponseId.WORLDBATTLE_SCORE_PUSH,new i.PushWORLDBATTLESCORChange),this.Add(T.ResponseId.Push_Protect_Data,new i.PushProtectData),this.Add(T.ResponseId.PUSH_THRONE_BATTLE_TIME,new i.PushThroneBattleTime),this.Add(T.ResponseId.GROUP_CHAT_CFG_CHANGE,new i.GROUP_CHAT_CFG_CHANGE),this.Add(T.ResponseId.GROUP_CHAT_MEMBER_CHANGE,new i.GROUP_CHAT_MEMBER_CHANGE),this.Add(T.ResponseId.PUSH_SALE_NUM_CHANGE,new i.PushSaleNumChange),this.Add(T.ResponseId.FORMULA_MAKE_COMPLETE,new i.Push_FORMULA_MAKE_COMPLETE),this.Add(T.ResponseId.DEF_TRAPS_SLOTS_INFO,new i.Push_DEF_TRAPS_SLOTS_INFO),this.Add(T.ResponseId.POTION_USE_EFFECT,new i.Push_POTION_USE_EFFECT),this.Add(T.ResponseId.EIGHT_COUNTRY_STATUS,new i.Push_EIGHT_COUNTRY_STATUS),this.Add(T.ResponseId.KVK_ALLIANCE_BUILDING_STATUS_CHANGE,new i.Push_KVK_ALLIANCE_BUILDING_STATUS_CHANGE),this.Add(T.ResponseId.KVK_ALLIANCE_INFO_CHANGE,new i.Push_KVK_ALLIANCE_INFO_CHANGE),this.Add(T.ResponseId.KVK_COUNTRY_INFO_CHANGE,new i.Push_KVK_COUNTRY_INFO_CHANGE),this.Add(T.ResponseId.KVK_INFO_CHANGE,new i.Push_KVK_INFO_CHANGE),this.Add(T.ResponseId.KVK_ACHEVEMENT_CHANGE,new i.Push_KVK_ACHEVEMENT_CHANGE),this.Add(T.ResponseId.KVK_PROGRESS_CHANGE,new i.Push_KVK_PROGRESS_CHANGE),this.Add(T.ResponseId.KVK_EXPEDITION_FINISH_CHANGE,new i.Push_KVK_EXPEDITION_FINISH_CHANGE),this.Add(T.ResponseId.KVK_FINISH_CHANGE,new i.Push_KVK_FINISH_CHANGE),this.Add(T.ResponseId.Push_Status_Buff,new i.Push_Status_Buff),this.Add(T.ResponseId.EC_PREPARE_INFO_PUSH,new i.Push_EC_PREPARE_INFO),this.Add(T.ResponseId.DECORATE_STOREHOUSE_CHANGE,new i.Push_DECORATE_STOREHOUSE_CHANGE),this.Add(T.ResponseId.GUN_FIGHT_INFO,new i.Push_GUN_FIGHT_INFO),this.Add(T.ResponseId.ALLIANCE_BADGE_AND_TASK_RED_DOT,new i.ALLIANCE_BADGE_AND_TASK_RED_DOT),this.Add(T.ResponseId.Treasure_Record_Push,new i.Push_Treasure_Record),this.Add(T.ResponseId.Push_Treasure_Info,new i.Push_Treasure_Info),this.Add(T.ResponseId.Push_Decoration_Suit,new i.Push_Decoration_Suit),this.Add(T.ResponseId.Push_Chapter_Task,new i.Push_Chapter_Task),this.Add(T.ResponseId.Push_Chapter_Task_List,new i.Push_Chapter_Task_List),this.Add(T.ResponseId.DEGENERATOR_INFO_PUSH,new i.PUSH_DEGENERATOR_INFO),this.Add(T.ResponseId.DEGENERATOR_MAIL_PUSH,new i.PUSH_DEGENERATOR_MAIL),this.Add(T.ResponseId.DEGENERATOR_REFRESH_PUSH,new i.Push_DEGENERATOR_REFRESH_PUSH),this.Add(T.ResponseId.AREAN_CONFIG_PUSH,new i.Push_AREAN_CONFIG_PUSH),this.Add(T.ResponseId.TREASURE_MAP_DATA_REMOVE,new i.Push_TREASURE_MAP_DATA_REMOVE),this.Add(T.ResponseId.TREASURE_MAP_DATA_ADD,new i.Push_TREASURE_MAP_DATA_ADD),this.Add(T.ResponseId.TREASURE_MAP_DATA_UPDATE,new i.Push_TREASURE_MAP_DATA_UPDATE),this.Add(T.ResponseId.TREASURE_MAP_TASKS,new i.Push_TREASURE_MAP_TASKS),this.Add(T.ResponseId.KING_MARK_PUSH,new i.Push_KING_MARK_PUSH),this.Add(T.ResponseId.EXPLORE_SEA_LEGEND_BOX_NOTICE,new i.Push_EXPLORE_SEA_LEGEND_BOX_NOTICE),this.Add(T.ResponseId.EIGHT_COUNTRY_STRONGEST_LEADER,new i.Push_EIGHT_COUNTRY_STRONGEST_LEADER),this.Add(T.ResponseId.EIGHT_COUNTRY_CHANGE_TASK,new i.Push_EIGHT_COUNTRY_CHANGE_TASK),this.Add(T.ResponseId.Push_New_Treasure_Piece_Log,new i.PushNewTreasurePieceLog)},t}(n.ReciverBase);a.ResponseRegister=A,cc._RF.pop()},{"../../Core/Net/ReciverBase":"ReciverBase","../Const/RequestId":"RequestId","../Const/ResponseId":"ResponseId","../alliance/CountryNotifyResponse":"CountryNotifyResponse","../alliance/PayToServerResponse":"PayToServerResponse","./ActivityStateResponse":"ActivityStateResponse","./AllianceResponse":"AllianceResponse","./ArmyResponse":"ArmyResponse","./BuildingResponse":"BuildingResponse","./CommonResponse":"CommonResponse","./FriendResponse":"FriendResponse","./GrowthFundResponse":"GrowthFundResponse","./LoginResponse":"LoginResponse","./MailResponse":"MailResponse","./ObstacleResponse":"ObstacleResponse","./PVEResponse":"PVEResponse","./PlunderResponse":"PlunderResponse","./PushResponse":"PushResponse","./ShopBuyLimitResponse":"ShopBuyLimitResponse","./TimeCardsResponse":"TimeCardsResponse","./WelcomeRewardStateResponse":"WelcomeRewardStateResponse"}],ShopBuyLimitResponse:[function(e,t,a){"use strict";cc._RF.push(t,"a35e8wLqo5OybnPCL3YKBgx","ShopBuyLimitResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../Data/DataCenter"),i=e("../Tools/GameTools"),r=e("../../fws/utils/FWSTool"),s=e("../msgs/MvcMsgs"),l=e("../../Core/Event/EventCenter"),c=e("../Const/EventId"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=i.default.JSON_PARSE(e.data);if(null!==t){var a=r.Obj.getPropertyByNames(t,[],"shoplimit");n.DATA.UserData.updateShopBuyLimit(a),s.send(s.Names.MVC_SHOP_BUY_LIMIT_UPDATE,null)}},t}(o.default);a.ShopBuyLimitResponse=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=i.default.JSON_PARSE(e.data);null!==t&&(n.DATA.UserData.UpdateLimitedShopData(t),l.EVENT.emit(c.EventId.LimitedShopUpdate))},t}(o.default);a.ShopBuyLimitTimeResponse=p,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../../fws/utils/FWSTool":"FWSTool","../Const/EventId":"EventId","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs"}],TimeCardsResponse:[function(e,t,a){"use strict";cc._RF.push(t,"fa6b6Xs9LtB04M/WXO9SKmD","TimeCardsResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../Data/DataCenter"),i=e("../Tools/GameTools"),r=e("../../fws/utils/FWSTool"),s=e("../msgs/MvcMsgs"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=i.default.JSON_PARSE(e.data);if(null!==t){var a=t.timecards;r.Obj.isEmpty(a)||(n.DATA.UserData.updateTimeCards(a),s.send(s.Names.MVC_TIME_CARDS_UPDATE,null))}},t}(o.default);a.TimeCardsResponse=l,cc._RF.pop()},{"../../Core/Net/ResponseBase":"ResponseBase","../../fws/utils/FWSTool":"FWSTool","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs"}],WelcomeRewardStateResponse:[function(e,t,a){"use strict";cc._RF.push(t,"03427PADJ9N9rn6CmGVHJE1","WelcomeRewardStateResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../Data/DataCenter"),i=e("../Tools/GameTools"),r=e("../../Core/Event/EventCenter"),s=e("../Const/EventId"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=i.default.JSON_PARSE(e.data);if(null!==t){var a=t.isGetMunitions;n.DATA.UserData.updateGetMunitions(a),r.EVENT.emit(s.EventId.ReloadWelcomeRewardBuilding)}},t}(o.default);a.WelcomeRewardStateResponse=l,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/ResponseBase":"ResponseBase","../Const/EventId":"EventId","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],SceneManager:[function(e,t,a){"use strict";cc._RF.push(t,"5a7c6unTD1C4aflvFXuPj33","SceneManager"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("./SceneSwitchAnim"),i=e("../Const/EventId"),r=e("../../Core/Event/EventCenter"),s=e("../Const/SceneName"),l=e("../Common/UIManagerLoaders"),c=e("../Const/GameDefine"),d=cc._decorator.ccclass,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lastSceneName=s.SceneName.LOGIN,t.swtichStartTime=0,t._useMaskAnimation=!0,t.curSceneName=s.SceneName.LOGIN,t}var a;return __extends(t,e),a=t,t.prototype.cpnLoad=function(){this.sceneSwitchAnim=this.node.getComponent(n.default),a._instance=this},t.Instance=function(){return null!=this._instance?this._instance:null},Object.defineProperty(t.prototype,"CurSceneName",{get:function(){return this._lastSceneName},enumerable:!0,configurable:!0}),t.prototype.preloadScene=function(e,t,a,o,n){void 0===t&&(t=null),void 0===a&&(a=null),void 0===o&&(o=!0),void 0===n&&(n=!0),this.swtichStartTime=performance.now(),this._lastSceneName!=e?(l.clear(),c.UIMANAGER&&c.UIMANAGER.CloseAllUI(),this._lastSceneName=e,this._useMaskAnimation=o,null!=this.sceneSwitchAnim&&o?this.sceneSwitchAnim.Close(function(){this.loadScene(e,t,a,n)},this):this.loadScene(e,t,a,n)):this.loadScene(e,t,a,n)},t.prototype.loadScene=function(e,t,a,o){void 0===t&&(t=null),void 0===a&&(a=null),void 0===o&&(o=!0);var n=this;this.curSceneName=e,cc.director.preloadScene(n.curSceneName,function(e){e?null!=t&&t(e):cc.director.loadScene(n.curSceneName,function(e){e?null!=t&&(console.error("load error reload "+e),t(e)):(cc.director.getScene().autoReleaseAssets=o,null!=a?a(n.loadSceneEnd):n.loadSceneEnd())})})},t.prototype.loadSceneEnd=function(){a.Instance()._useMaskAnimation&&null!=a.Instance().sceneSwitchAnim&&a.Instance().sceneSwitchAnim.Open(function(){},a.Instance(),a.Instance().curSceneName),r.EVENT.emit(i.EventId.CHANGE_SCENE,{name:a.Instance().curSceneName})},t=a=__decorate([d],t)}(o.default);a.default=p,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../System/ComponentBase":"ComponentBase","../Common/UIManagerLoaders":"UIManagerLoaders","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/SceneName":"SceneName","./SceneSwitchAnim":"SceneSwitchAnim"}],SceneSwitchAnim:[function(e,t,a){"use strict";cc._RF.push(t,"c6b54I+8f9D2q4qmB8UDtVI","SceneSwitchAnim"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=e("../Common/UIManager"),i=e("../controllers/G123IPContentProvider"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cloudAnimation=null,t.mask=null,t.time_door=.5,t}return __extends(t,e),t.prototype.cpnLoad=function(){this.mask.addComponent(cc.BlockInputEvents),this.mask.active=!1},t.prototype.Open=function(e,t,a){var o=this;this.cloudAnimation.setCompleteListener(function(){e&&e.call(t),o.mask.active=!1,o.cloudAnimation.setCompleteListener(null),o.cloudAnimation.node.active=!1,n.default.Instance().showLandscapeMask(!1)}),this.cloudAnimation.setAnimation(1,"clouddropout",!1)},t.prototype.Close=function(e,t){this.cloudAnimation.node.active=!0,this.mask.active=!0;var a=i.default.Instance.getPCBg();n.default.Instance().showLandscapeMask(!0,a);var o=this;this.cloudAnimation.setCompleteListener(function(){e&&e.call(t),o.cloudAnimation.setCompleteListener(null)}),this.cloudAnimation.setAnimation(1,"cloudenter",!1),this.cloudAnimation.timeScale=2},__decorate([l(sp.Skeleton)],t.prototype,"cloudAnimation",void 0),__decorate([l(cc.Node)],t.prototype,"mask",void 0),t=__decorate([s],t)}(o.default);a.default=c,cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase","../Common/UIManager":"UIManager","../controllers/G123IPContentProvider":"G123IPContentProvider"}],RGShareCore:[function(e,t,a){"use strict";var o;cc._RF.push(t,"eced0KbcexDdop1o4QmCM9k","RGShareCore"),function(e){(function(e){e[e.shareType_None=0]="shareType_None",e[e.shareType_Share=1]="shareType_Share",e[e.shareType_watchAd=2]="shareType_watchAd"})(e.IShareType||(e.IShareType={})),function(e){e[e.canUse_ShareOrWatchAd=0]="canUse_ShareOrWatchAd",e[e.canUse_Share=1]="canUse_Share",e[e.canUse_WatchAd=2]="canUse_WatchAd"}(e.ICanUseShareType||(e.ICanUseShareType={})),function(e){e.share="share",e.ad="ad",e.adOvering="adOvering",e.over="over"}(e.IShareSeverType||(e.IShareSeverType={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],RGShareInterface:[function(e,t,a){"use strict";cc._RF.push(t,"3b03e4fHSpNRrrTv0iT57uJ","RGShareInterface"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./SDKInner/RGShareRegisterFunc"),n=e("./SDKInner/RGShareMg"),i=e("../Tools/GameTools"),r=e("../Const/GameDefine");a.RGShareSDkAppId="102",a.RGSharePoint={SP_RightTopButton:950,SP_UnLockItemPanelBuilding:15002,SP_HeroGetNew:16009,SP_ArmyRepair:14001,SP_UnLockItemPanelArmy:15005,SP_SevenDayReward:16001,SP_CatchCapture:16006,SP_NewFriendShare:900,SP_AutoCollectTile:12002,SP_WelcomeReward:15003,SP_ShareRewardBox:15004,SP_ActivityFriendInviteShare:16007,SP_ActivityShareBox:16008,SP_ActivityEveryReward:16010,SP_Activity_Task:16011,SP_Activity_Task_Auto:16013,SP_Share_MassCall:17001,SP_ActivityShareBoxNew:20001,SP_FreeDiamondVideo:99901,SP_PassBattleVideo:99903,SP_FreeDiamondLeftVideo:99904,SP_TreatSoldierVideo:99905,SP_ShopFreeDiamondVideo:99906,SP_FreeGoldVideo:99907,SP_AutoCollectTileVideo:99908,SP_AllianceFakeGiftVideo:99909,SP_ActivityLotteryVideo:99910};var s,l=function(){function e(){}return e.RGShareSDKInit=function(e){n.RGSHAREMG.rg_shareInit({RGShareServerId:e.serverId,RGShareAppId:e.appId,RGShareShareImgPath:e.shareImgPath,RGShareTargetRelease:e.targetRelease,RGShareInitFinishCB:e.initFinishCB,RGSharePlatform:e.platform,RGShareSystem:e.system,RGShareCountry:e.country})},e.RGShareSDKGetOnShareMessage=function(e){return n.RGSHAREMG.rg_shareGetOnshareMessage(e)},e.RGShareSDKUserInfoUpdate=function(e){n.RGSHAREMG.rg_shareUserInfoUpdate({RGShareUserLevel:e.userLevel,RGShareUserName:e.userName,RGShareUserAvatarUrl:e.userAvatarUrl,RGShareUserSex:e.userSex,RGShareUserRegTime:e.userRegTime,RGShareUserPayCNYTotal:e.userPayCNYTotal,RGShareUserSeverId:e.userSeverId,RGShareUserId:e.userId})},e.RGShareSDKGetShareType=function(e,t,a,o){var i=Number(t);n.RGSHAREMG.rg_shareGetShareType(e,i,a,function(e){var t=Number(e);o&&o(t)})},e.RGShareSDKGetShareData=function(e,t){var a=n.RGSHAREMG.rg_shareGetShareData(e);t&&t(a)},e.RGShareSDKDoAction=function(e,t,a,o){t==s.shartype_watchAd&&i.default.CheckArrearGold(r.GameOperation.WatchVideo)||n.RGSHAREMG.rg_shareDoAction(e,t,a,o)},e.RGCheckAllAd=function(){n.RGSHAREMG.rg_checkAllAd()},e.RGShareSDK_GetShareCfgById=function(e){return n.RGSHAREMG.rg_getShareCfg(e)},e.rg_shareframeSync1000MS=function(e){n.RGSHAREMG.rg_shareframeSync1000MS(e)},e.RGShareSDK_registFunc_canUseShareSDK=function(e){o.default.getInstance().registerFunc_canUseSDK(function(){return e()})},e.RGShareSDK_registFunc_canShare=function(e){o.default.getInstance().registerFunc_canShare(function(){return e()})},e.RGShareSDK_registFunc_canWatchAd=function(e){o.default.getInstance().registerFunc_canWatchAd(function(){return e()})},e.RGShareSDK_registFunc_doMd5=function(e){o.default.getInstance().registerFunc_doMD5(function(t){return e(t)})},e.RGShareSDK_registFunc_doShare=function(e){o.default.getInstance().registerFunc_doShare(function(t){e(t)})},e.RGShareSDK_registFunc_doWatchAdMob=function(e){o.default.getInstance().registerFunc_doWatchAdMob(function(t){e(t)})},e.RGShareSDK_registFunc_doBI=function(e){o.default.getInstance().registerFunc_doBI(function(t){e(t)})},e.RGShareSDK_registFunc_doErrorReport=function(e){o.default.getInstance().registerFunc_doErrorReport(function(t){e(t)})},e.RGShareSDK_registFunc_doGet=function(e){o.default.getInstance().registerFunc_doGet(function(t){e(t)})},e.RGShareSDK_registFunc_checkHasAd=function(e){o.default.getInstance().registerFunc_checkHasAd(function(t){e(t)})},e.RGShareSDK_registFunc_loadLocalStorage=function(e){o.default.getInstance().registerFunc_syncLoadLocalStorage(function(t){return e({itemKey:t})})},e.RGShareSDK_registFunc_saveLocalStorage=function(e){o.default.getInstance().registerFunc_syncSaveLocalStorage(function(t,a){return e({itemKey:t,itemValue:a})})},e.RGShareSDK_registerFunc_LangFunc=function(e){o.default.getInstance().registerFunc_LangFunc(function(t){return e(t)})},e}();a.default=l,function(e){e[e.sharetype_None=0]="sharetype_None",e[e.sharetype_Share=1]="sharetype_Share",e[e.shartype_watchAd=2]="shartype_watchAd"}(s=a.IRGShareType||(a.IRGShareType={})),function(e){e[e.canUse_ShareOrWatchAd=0]="canUse_ShareOrWatchAd",e[e.canUse_Share=1]="canUse_Share",e[e.canUse_WatchAd=2]="canUse_WatchAd"}(a.IRGCanUseShareType||(a.IRGCanUseShareType={})),function(e){e[e.Share_Sucess=0]="Share_Sucess",e[e.Share_Fail_ToOtherGroup=1]="Share_Fail_ToOtherGroup",e[e.Share_Fail_Retry=2]="Share_Fail_Retry",e[e.Share_Fail_CancalSeeVideo=3]="Share_Fail_CancalSeeVideo",e[e.Share_Fail_SeeVideoFail=4]="Share_Fail_SeeVideoFail"}(a.IShareErrorCode||(a.IShareErrorCode={})),cc._RF.pop()},{"../Const/GameDefine":"GameDefine","../Tools/GameTools":"GameTools","./SDKInner/RGShareMg":"RGShareMg","./SDKInner/RGShareRegisterFunc":"RGShareRegisterFunc"}],RGShareCommon:[function(e,t,a){"use strict";cc._RF.push(t,"704e0orYfNCT4A9hdTPSN0i","RGShareCommon"),Object.defineProperty(a,"__esModule",{value:!0});for(var o=e("./RGSharePlatformTarget"),n=(e("./RGSharePlatformWeb"),e("../../../fws/utils/X")),i=(new o.default).getAPIs(),r={},s=["canUseShareSDK","canWatchAd","canShare","call_md5","call_doGet","call_checkHasAd","call_syncSaveLocalStorage","call_syncLoadLocalStorage","call_shareAppMsg","call_watchAdMob","call_BI","call_ErrorReport","call_LangFunc"],l=0;l<s.length;l++){var c=s[l];r[c]=function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return i&&i[e]?i[e].apply(i,t):void n.warn("\u63a5\u53e3<"+e+">\u4e0d\u5b58\u5728")}}(c)}a.RGShareCommon=r,cc._RF.pop()},{"../../../fws/utils/X":"X","./RGSharePlatformTarget":"RGSharePlatformTarget","./RGSharePlatformWeb":"RGSharePlatformWeb"}],RGShareMg:[function(e,t,a){"use strict";cc._RF.push(t,"8ac85qMT+NIb6I1haysHcS4","RGShareMg"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./SDKModel/RGShareData"),n=e("../RGShareCore"),i=e("../RGShareInterface"),r=e("./RGShareUtils"),s=e("./RGShareCommon"),l=e("./SDKModel/RGShareModel"),c=e("../../../fws/utils/X"),d=function(){function e(){this.rg_sharingMap={},this.onshareMsgPoint=0}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.purge=function(){e._instance=null},e.prototype.rg_shareInit=function(e){o.RGSHAREDATA.RGShareAppId=e.RGShareAppId,o.RGSHAREDATA.RGShareEnvRelease=e.RGShareTargetRelease,o.RGSHAREDATA.RGShareImgPath=e.RGShareShareImgPath,o.RGSHAREDATA.RGShareUserServerId=e.RGShareServerId,o.RGSHAREDATA.RGSharePlatform=e.RGSharePlatform,o.RGSHAREDATA.RGShareSystem=e.RGShareSystem,o.RGSHAREDATA.RGShareCountry=e.RGShareCountry,o.RGSHAREDATA.rg_sdkDataInit(function(){e.RGShareInitFinishCB&&e.RGShareInitFinishCB()})},e.prototype.rg_shareGetOnshareMessage=function(e){this.onshareMsgPoint=e;var t=l.default.getNewShareModel(o.RGSHAREDATA.configData.sharePointListData[this.onshareMsgPoint]);return t.rg_cusParams={type:"3"},t.update_formatShareInfoQueryParams(),t.rg_shareType=n.IShareType.shareType_Share,{title:t.rg_shareInfo.share_text||"",imageUrl:t.rg_shareInfo.share_ImgUrl||"",query:t.rg_shareInfo.share_query||"",imageUrlId:"",success:function(){},fail:function(){}}},e.prototype.rg_shareUserInfoUpdate=function(e){o.RGSHAREDATA.RGShareUserInfo=e},e.prototype.rg_shareGetShareType=function(e,t,a,i){0!=o.RGSHAREDATA.RGShareServerSwitch&&0!=o.RGSHAREDATA.RGShareServerConfigLoadFinish&&(0!=o.RGSHAREDATA.RGShareOpen||0!=o.RGSHAREDATA.RGShareWatchAdOpen)?r.default.rg_getShareType(e,t,function(t){if(n.IShareType.shareType_Share==t){var r=0;o.RGSHAREDATA.configData.sharePointListData[e]&&(r=o.RGSHAREDATA.configData.sharePointListData[e].share_type),s.RGShareCommon.call_BI({name:"WXShareAppMessagePre",params:{ShareID:e,ShareOpenType:r,shareType:r}})}else if(n.IShareType.shareType_watchAd==t){var l="notdefine";a&&(l=a.adtype||"notdefine"),s.RGShareCommon.call_BI({name:"SeeVideoPre",params:{type:"sdk"+e,SharePoint:e,ShareOpenType:t,channel:l}})}i&&i(t)}):i&&i(n.IShareType.shareType_None)},e.prototype.rg_shareGetShareData=function(e){var t=l.default.getNewShareModel(o.RGSHAREDATA.configData.sharePointListData[e]);return{title:t.rg_shareInfo.share_text,imageUrl:t.rg_shareInfo.share_ImgUrl,query:t.rg_shareInfo.share_query}},e.prototype.rg_shareDoAction=function(e,t,a,n){if(t!=i.IRGShareType.sharetype_None){var d=t+"_"+e;if(this.rg_sharingMap[d]){var p=1e4;i.IRGShareType.sharetype_Share==t&&(p=5e3);var u=this.rg_sharingMap[d];if(u&&r.default.rg_getSystemTimeStamp()-u.rg_startTime<p)return}var h=l.default.getNewShareModel(o.RGSHAREDATA.configData.sharePointListData[e]);h.rg_success=n.success,h.rg_fail=n.fail,h.rg_cusParams=a||{},h.rg_shareType=Number(t),h.update_formatShareInfoQueryParams(),this.rg_sharingMap[d]=h,c.log("shareModel:",h);var m=this;if(t==i.IRGShareType.sharetype_Share)s.RGShareCommon.call_BI({name:"WXShareAppMessage",params:{shareId:h.rg_sharePoint,shareLogId:h.rg_uniqueId,shareGroupId:h.rg_shareInfo.share_SharePointInfo.sharegroupid,shareType:h.rg_shareInfo.share_SharePointInfo.share_type}}),s.RGShareCommon.call_shareAppMsg({title:h.rg_shareInfo.share_text||"",imageUrl:h.rg_shareInfo.share_ImgUrl||"",query:h.rg_shareInfo.share_query||"",imageUrlId:"",success:function(e){void 0===e&&(e=!1),m.doActionFinish(h,i.IShareErrorCode.Share_Sucess,e)},fail:function(e){m.doActionFinish(h,e)}});else if(t==i.IRGShareType.shartype_watchAd){if(!o.RGSHAREDATA.RGShareWatchAdOpen)return void m.doActionFinish(h,i.IShareErrorCode.Share_Fail_SeeVideoFail,!1);var f="notdefine";a&&(f=a.adtype||"notdefine");var _=r.default.checkWatchingAdPop(h.rg_sharePoint);s.RGShareCommon.call_BI({name:"SeeVideo",params:{type:"sdk"+h.rg_sharePoint,SharePoint:h.rg_sharePoint,ShareOpenType:h.rg_shareType,channel:f}}),s.RGShareCommon.call_ErrorReport({name:"start",params:{videoId:h.rg_sharePoint}}),s.RGShareCommon.call_watchAdMob({adid:h.rg_shareInfo.share_SharePointInfo.adunit,popTime:_,success:function(e){s.RGShareCommon.call_ErrorReport({name:"finish",params:{videoId:h.rg_sharePoint}}),m.doActionFinish(h,i.IShareErrorCode.Share_Sucess,!1,e,_),c.log("is_download  success",e)},fail:function(e,t){s.RGShareCommon.call_ErrorReport({name:"fail",params:{videoId:h.rg_sharePoint}}),c.log("is_download  fail",t),m.doActionFinish(h,e,!1,t,_)}})}}else c.error("\u4f20\u5165\u7684doAction \u7c7b\u578b\u4e0d\u5408\u6cd5 == sharetype_None")},e.prototype.doActionFinish=function(e,t,a,o,l){if(void 0===a&&(a=!1),void 0===o&&(o=!1),void 0===l&&(l=-1),e.rg_shareType==n.IShareType.shareType_Share)i.IShareErrorCode.Share_Sucess==t?a?this.checkFalseSharingResult(e):(r.default.setActionData(e.rg_sharePoint,e.rg_shareType),e.rg_success&&e.rg_success()):e.rg_fail&&e.rg_fail(t),s.RGShareCommon.call_BI({name:"WXShareAppMessageRet",params:{shareId:e.rg_sharePoint,shareLogId:e.rg_uniqueId,shareGroupId:e.rg_shareInfo.share_SharePointInfo.sharegroupid,shareType:e.rg_shareInfo.share_SharePointInfo.share_type}});else if(e.rg_shareType==n.IShareType.shareType_watchAd){var c,d="notdefine";if(e.rg_cusParams&&(d=e.rg_cusParams.adtype||"notdefine"),i.IShareErrorCode.Share_Sucess==t)s.RGShareCommon.call_BI({name:"SeeVideoRet",params:{type:"sdk"+e.rg_sharePoint,SharePoint:e.rg_sharePoint,ShareOpenType:e.rg_shareType,ret:0,channel:d}}),r.default.setActionData(e.rg_sharePoint,e.rg_shareType),e.rg_success&&e.rg_success(o,l),(c=e.rg_shareInfo.share_SharePointInfo.adunit)&&r.default.addAdTask(c);else if(-1!=l&&o&&r.default.setActionData(e.rg_sharePoint,e.rg_shareType),e.rg_fail&&e.rg_fail(t,o,l),s.RGShareCommon.call_BI({name:"SeeVideoRet",params:{type:"sdk"+e.rg_sharePoint,SharePoint:e.rg_sharePoint,ShareOpenType:e.rg_shareType,ret:1,channel:d}}),i.IShareErrorCode.Share_Fail_CancalSeeVideo==t)(c=e.rg_shareInfo.share_SharePointInfo.adunit)&&r.default.addAdTask(c)}var p=e.rg_shareType+"_"+e.rg_sharePoint;delete this.rg_sharingMap[p]},e.prototype.checkFalseSharingResult=function(e){if(e.rg_shareInfo.share_SharePointInfo.share_true){var t=r.default.checkShareSuccess(e.rg_sharePoint,e.rg_startTime);if(i.IShareErrorCode.Share_Sucess!=t)return void(e.rg_fail&&e.rg_fail(t))}r.default.setActionData(e.rg_sharePoint,e.rg_shareType),e.rg_success&&e.rg_success()},e.prototype.rg_checkAllAd=function(){r.default.checkAllAd()},e.prototype.rg_shareframeSync1000MS=function(e){r.default.checkAdTask()},e.prototype.rg_getShareCfg=function(e){return o.RGSHAREDATA.configData.sharePointListData[e]?o.RGSHAREDATA.configData.sharePointListData[e]:null},e}();a.default=d,a.RGSHAREMG=d.getInstance(),cc._RF.pop()},{"../../../fws/utils/X":"X","../RGShareCore":"RGShareCore","../RGShareInterface":"RGShareInterface","./RGShareCommon":"RGShareCommon","./RGShareUtils":"RGShareUtils","./SDKModel/RGShareData":"RGShareData","./SDKModel/RGShareModel":"RGShareModel"}],RGSharePlatformTarget:[function(e,t,a){"use strict";cc._RF.push(t,"28815lkhpdDP6itatk155x1","RGSharePlatformTarget"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./RGShareRegisterFunc"),n=function(){function e(){}return e.prototype.getAPIs=function(){var e={canUseShareSDK:function(){return o.default.getInstance().call_canUseSDK()},canWatchAd:function(){return o.default.getInstance().call_canWatchAd()},canShare:function(){return o.default.getInstance().call_canShare()},call_md5:function(e){return o.default.getInstance().call_md5(e)},call_doGet:function(e){o.default.getInstance().call_doGet(e)},call_checkHasAd:function(e){o.default.getInstance().call_checkHasAd(e)},call_syncSaveLocalStorage:function(e,t){return o.default.getInstance().call_syncSaveLocalStorage(e,t)},call_syncLoadLocalStorage:function(e){return o.default.getInstance().call_syncLoadLocalStorage(e)},call_shareAppMsg:function(e){o.default.getInstance().call_share(e)},call_watchAdMob:function(e){o.default.getInstance().call_watchAdMob(e)},call_BI:function(e){o.default.getInstance().call_BI(e)},call_ErrorReport:function(e){o.default.getInstance().call_ErrorReport(e)},call_LangFunc:function(e){return o.default.getInstance().call_LangFunc(e)}};return e},e}();a.default=n,cc._RF.pop()},{"./RGShareRegisterFunc":"RGShareRegisterFunc"}],RGSharePlatformWeb:[function(e,t,a){"use strict";cc._RF.push(t,"be159ynF6BBnbiQhRp26TTA","RGSharePlatformWeb"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Net/WebClient"),n=e("../../../fws/utils/X"),i=e("../../Tools/GameTools"),r=function(){function e(){}return e.prototype.getAPIs=function(){var e={canUseShareSDK:function(){return!0},canWatchAd:function(){return!0},canShare:function(){return!0},call_md5:function(e){return i.default.doMd5(e)},call_doGet:function(e){o.get(e.url,{},this,function(t){var a=t.responseText;e.success&&e.success(JSON.parse(a))},function(t){e.fail&&e.fail()})},call_checkHasAd:function(e){e.complete&&e.complete(!0)},call_syncSaveLocalStorage:function(e,t){return localStorage.setItem(e,t),!0},call_syncLoadLocalStorage:function(e){return localStorage.getItem(e)},call_shareAppMsg:function(e){e.success&&e.success()},call_watchAdMob:function(e){e.success&&e.success()},call_BI:function(e){n.log("RGSharePlatformWeb   call_BI ")},call_ErrorReport:function(e){n.log("RGSharePlatformWeb   call_ErrorReport")},call_LangFunc:function(e){return n.log("RGSharePlatformWeb   call_LangFunc "),e}};return e},e}();a.default=r,cc._RF.pop()},{"../../../Core/Net/WebClient":"WebClient","../../../fws/utils/X":"X","../../Tools/GameTools":"GameTools"}],RGShareRegisterFunc:[function(e,t,a){"use strict";cc._RF.push(t,"a31famSD7NLFqJccNGL3kG3","RGShareRegisterFunc"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../fws/utils/X"),n=function(){function e(){this.func_canUseSDK=null,this.func_canShare=null,this.func_canWatchAd=null,this.func_doMd5=null,this.func_doShare=null,this.func_doWatchAdMob=null,this.func_doBI=null,this.func_doErrorReport=null,this.func_doGetRequest=null,this.func_checkHasAd=null,this.func_syncSaveLocalStorage=null,this.func_syncLoadLocalStorage=null,this._LangFunc=null}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.registerFunc_canUseSDK=function(e){this.func_canUseSDK=e},e.prototype.call_canUseSDK=function(){return this.func_canUseSDK()},e.prototype.registerFunc_canShare=function(e){this.func_canShare=e},e.prototype.call_canShare=function(){return this.func_canShare()},e.prototype.registerFunc_canWatchAd=function(e){this.func_canWatchAd=e},e.prototype.call_canWatchAd=function(){return this.func_canWatchAd()},e.prototype.registerFunc_doMD5=function(e){this.func_doMd5=e},e.prototype.call_md5=function(e){return this.func_doMd5?this.func_doMd5(e):(o.error("registerFunc_doMD5 \u672a\u5b9e\u73b0"),"")},e.prototype.registerFunc_doShare=function(e){this.func_doShare=e},e.prototype.call_share=function(e){this.func_doShare?this.func_doShare(e):o.error("registerFunc_doShare \u672a\u5b9e\u73b0")},e.prototype.registerFunc_doWatchAdMob=function(e){this.func_doWatchAdMob=e},e.prototype.call_watchAdMob=function(e){this.func_doWatchAdMob?this.func_doWatchAdMob(e):o.error("registerFunc_doWatchAdMob \u672a\u5b9e\u73b0")},e.prototype.registerFunc_doBI=function(e){this.func_doBI=e},e.prototype.call_BI=function(e){this.func_doBI?this.func_doBI(e):o.error("registerFunc_doBI \u672a\u5b9e\u73b0")},e.prototype.registerFunc_doErrorReport=function(e){this.func_doErrorReport=e},e.prototype.call_ErrorReport=function(e){this.func_doErrorReport?this.func_doErrorReport(e):o.error("registerFunc_doErrorReport \u672a\u5b9e\u73b0")},e.prototype.registerFunc_doGet=function(e){this.func_doGetRequest=e},e.prototype.call_doGet=function(e){this.func_doGetRequest?this.func_doGetRequest(e):o.error("registerFunc_doGet \u672a\u5b9e\u73b0")},e.prototype.registerFunc_checkHasAd=function(e){this.func_checkHasAd=e},e.prototype.call_checkHasAd=function(e){this.func_checkHasAd?this.func_checkHasAd(e):o.error("registerFunc_checkHasAd \u672a\u5b9e\u73b0")},e.prototype.registerFunc_syncSaveLocalStorage=function(e){this.func_syncSaveLocalStorage=e},e.prototype.call_syncSaveLocalStorage=function(e,t){if(this.func_doMd5)return this.func_syncSaveLocalStorage(e,t);o.error("registerFunc_syncSaveLocalStorage \u672a\u5b9e\u73b0")},e.prototype.registerFunc_syncLoadLocalStorage=function(e){this.func_syncLoadLocalStorage=e},e.prototype.call_syncLoadLocalStorage=function(e){if(this.func_doMd5)return this.func_syncLoadLocalStorage(e);o.error("registerFunc_syncLoadLocalStorage \u672a\u5b9e\u73b0")},e.prototype.registerFunc_LangFunc=function(e){e&&(this._LangFunc=e)},e.prototype.call_LangFunc=function(e){return this._LangFunc?this._LangFunc(e):(o.log("\u5206\u4eabsdk\u521d\u59cb\u5316\u672a\u6210\u529f"),e)},e}();a.default=n,cc._RF.pop()},{"../../../fws/utils/X":"X"}],RGShareUtils:[function(e,t,a){"use strict";cc._RF.push(t,"4cb0cC2osZKGqgqdkQ85v3w","RGShareUtils"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../RGShareCore"),n=e("./SDKModel/RGShareData"),i=e("./RGShareCommon"),r=e("../RGShareInterface"),s=e("../../../fws/utils/X"),l=function(){function e(){}return e.rg_getSystemTimeStamp=function(){return Date.now()},e.rg_isSameDayStamp=function(e,t){t||(t=this.rg_getSystemTimeStamp());var a=new Date(e),o=new Date(t);return a.getFullYear()==o.getFullYear()&&a.getMonth()==o.getMonth()&&a.getDate()==o.getDate()},e.rg_getShareType=function(e,t,a){var r=function(e){s.log("\u884c\u4e3a\u7c7b\u578b",e),a&&a(e)};this._nowtime=new Date,this._shareid=e,this._actionIndex=-1;var l=n.RGSHAREDATA.configData.sharePointListData[e];if(l){var c=n.RGSHAREDATA.configData.configs[e];c&&c.list&&c.list.length?n.RGSHAREDATA.RGShareOpen&&n.RGSHAREDATA.RGShareWatchAdOpen?o.ICanUseShareType.canUse_Share==t?this.rg_checkShare(c,l,r):o.ICanUseShareType.canUse_WatchAd==t?this.rg_checkWatchAd(c,l,r):this.rg_checkAll(c,l,r):!n.RGSHAREDATA.RGShareOpen||o.ICanUseShareType.canUse_Share!=t&&o.ICanUseShareType.canUse_ShareOrWatchAd!=t?!n.RGSHAREDATA.RGShareWatchAdOpen||o.ICanUseShareType.canUse_WatchAd!=t&&o.ICanUseShareType.canUse_ShareOrWatchAd!=t?r(o.IShareType.shareType_None):this.rg_checkWatchAd(c,l,r):this.rg_checkShare(c,l,r):o.ICanUseShareType.canUse_WatchAd==t||o.ICanUseShareType.canUse_ShareOrWatchAd==t&&!n.RGSHAREDATA.RGShareOpen?n.RGSHAREDATA.RGShareWatchAdOpen?i.RGShareCommon.call_checkHasAd({adid:l.adunit,complete:function(e){r(e?o.IShareType.shareType_watchAd:o.IShareType.shareType_None)}}):r(o.IShareType.shareType_None):n.RGSHAREDATA.RGShareOpen?r(o.IShareType.shareType_Share):r(o.IShareType.shareType_None)}else r(o.IShareType.shareType_None)},e.rg_checkAll=function(e,t,a){for(var n=this,r=e.list,s=function(s,c){var d=l.rg_getActionTypeAll(r[s],e.global,s);if(d!=o.IShareSeverType.over)return d==o.IShareSeverType.share?(l._shareMap[l._shareid]={type:d,listIndex:s,actionIndex:l._actionIndex},a(o.IShareType.shareType_Share)):i.RGShareCommon.call_checkHasAd({adid:t.adunit,complete:function(e){e?(n._shareMap[n._shareid]={type:d,listIndex:s,actionIndex:n._actionIndex},a(o.IShareType.shareType_watchAd)):d==o.IShareSeverType.ad?(n._shareMap[n._shareid]={type:d,listIndex:s,actionIndex:n._actionIndex},a(o.IShareType.shareType_Share)):a(o.IShareType.shareType_None)}}),{value:void 0}},l=this,c=0,d=r.length;c<d;c++){var p=s(c);if("object"==typeof p)return p.value}a(o.IShareType.shareType_None)},e.rg_checkWatchAd=function(e,t,a){for(var n=this,r=e.list,s=function(s,c){var d=l.rg_getActionTypeVideo(r[s],e.global,s);if(d==o.IShareSeverType.ad||d==o.IShareSeverType.adOvering)return i.RGShareCommon.call_checkHasAd({adid:t.adunit,complete:function(e){e?(n._shareMap[n._shareid]={type:d,listIndex:s,actionIndex:n._actionIndex},a(o.IShareType.shareType_watchAd)):d==o.IShareSeverType.ad?(n._shareMap[n._shareid]={type:d,listIndex:s,actionIndex:n._actionIndex},a(o.IShareType.shareType_Share)):a(o.IShareType.shareType_None)}}),{value:void 0}},l=this,c=0,d=r.length;c<d;c++){var p=s(c);if("object"==typeof p)return p.value}a(o.IShareType.shareType_None)},e.rg_checkShare=function(e,t,a){for(var n=e.list,i=0,r=n.length;i<r;i++){var s=this.rg_getActionTypeShare(n[i],e.global,i);if(s==o.IShareSeverType.share)return this._shareMap[this._shareid]={type:s,listIndex:i,actionIndex:this._actionIndex},void a(o.IShareType.shareType_Share)}a(o.IShareType.shareType_None)},e.rg_getActionTypeAll=function(e,t,a){if(0==e.action.length)return o.IShareSeverType.over;if(this.rg_isInCondition(e.condition)){if(t){var n=i.RGShareCommon.call_syncLoadLocalStorage(this._localGlobalDataStr),r=void 0;try{r=JSON.parse(n)}catch(e){}if(r){if(this.rg_isSameDayStamp(Number(r.date))){for(var s=0,l=0,c=0,d=e.action.length;c<d;c++){if(-1==(p=e.action[c]).times)return this._actionIndex=c,p.type;if(p.type==o.IShareSeverType.share){if(s+=p.times,r.shareNum<s)return this._actionIndex=c,o.IShareSeverType.share}else if(l+=p.times,r.adNum<l)return this._actionIndex=c,c==d-1?o.IShareSeverType.adOvering:o.IShareSeverType.ad}return o.IShareSeverType.over}return this.rg_getTypeWithoutLocalData(e)}return this.rg_getTypeWithoutLocalData(e)}n=i.RGShareCommon.call_syncLoadLocalStorage(this._localDataStr+this._shareid),r=void 0;try{r=JSON.parse(n)}catch(e){}if(r){if(this.rg_isSameDayStamp(Number(r.date))){for(c=0,d=e.action.length;c<d;c++){var p;if(-1===(p=e.action[c]).times)return this._actionIndex=c,p.type;if(void 0===r.num[a]||void 0===r.num[a][c]||r.num[a][c]<p.times)return this._actionIndex=c,c==d-1&&p.type==o.IShareSeverType.ad?o.IShareSeverType.adOvering:p.type}return o.IShareSeverType.over}return this.rg_getTypeWithoutLocalData(e)}return this.rg_getTypeWithoutLocalData(e)}return o.IShareSeverType.over},e.rg_getActionTypeShare=function(e,t,a){if(0==e.action.length)return o.IShareSeverType.over;if(this.rg_isInCondition(e.condition)){if(t){var n=i.RGShareCommon.call_syncLoadLocalStorage(this._localGlobalDataStr),r=void 0;try{r=JSON.parse(n)}catch(e){}if(r){if(this.rg_isSameDayStamp(Number(r.date))){for(var s=0,l=0,c=e.action.length;l<c;l++){if((d=e.action[l]).type==o.IShareSeverType.share){if(-1==d.times)return this._actionIndex=l,d.type;if(s+=d.times,r.shareNum<s)return this._actionIndex=l,d.type}}return o.IShareSeverType.over}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.share)}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.share)}n=i.RGShareCommon.call_syncLoadLocalStorage(this._localDataStr+this._shareid),r=void 0;try{r=JSON.parse(n)}catch(e){}if(r){if(this.rg_isSameDayStamp(Number(r.date))){for(l=0,c=e.action.length;l<c;l++){var d;if((d=e.action[l]).type==o.IShareSeverType.share){if(-1===d.times)return this._actionIndex=l,d.type;if(void 0===r.num[a]||void 0===r.num[a][l]||r.num[a][l]<d.times)return this._actionIndex=l,d.type}}return o.IShareSeverType.over}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.share)}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.share)}return o.IShareSeverType.over},e.rg_getActionTypeVideo=function(e,t,a){if(0==e.action.length)return o.IShareSeverType.over;if(this.rg_isInCondition(e.condition)){if(t){var n=i.RGShareCommon.call_syncLoadLocalStorage(this._localGlobalDataStr),r=void 0;try{r=JSON.parse(n)}catch(e){}if(r){if(this.rg_isSameDayStamp(Number(r.date))){for(var s=0,l=0,c=e.action.length;l<c;l++){if((d=e.action[l]).type==o.IShareSeverType.ad){if(-1==d.times)return this._actionIndex=l,d.type;if(s+=d.times,r.adNum<s)return this._actionIndex=l,l==c-1?o.IShareSeverType.adOvering:d.type}}return o.IShareSeverType.over}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.ad)}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.ad)}n=i.RGShareCommon.call_syncLoadLocalStorage(this._localDataStr+this._shareid),r=void 0;try{r=JSON.parse(n)}catch(e){}if(r){if(this.rg_isSameDayStamp(Number(r.date))){for(l=0,c=e.action.length;l<c;l++){var d;if((d=e.action[l]).type==o.IShareSeverType.ad){if(-1===d.times)return this._actionIndex=l,d.type;if(void 0===r.num[a]||void 0===r.num[a][l]||r.num[a][l]<d.times)return this._actionIndex=l,l==c-1?o.IShareSeverType.adOvering:d.type}}return o.IShareSeverType.over}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.ad)}return this.rg_getTypeWithoutLocalDataHasSwitch(e,o.IShareSeverType.ad)}return o.IShareSeverType.over},e.rg_getTypeWithoutLocalData=function(e){this._actionIndex=0;var t=e.action[0];return o.IShareSeverType.ad==t.type&&-1!=t.times&&1==e.action.length?o.IShareSeverType.adOvering:e.action[0].type},e.rg_getTypeWithoutLocalDataHasSwitch=function(e,t){for(var a=0,n=e.action.length;a<n;a++){var i=e.action[a];if(i.type==t){this._actionIndex=0;var r=e.action[0];return o.IShareSeverType.ad==r.type&&-1!=r.times&&1==e.action.length?o.IShareSeverType.adOvering:i.type}}return o.IShareSeverType.over},e.rg_isInCondition=function(e){if(void 0!==e.pfs&&!this.rg_isInPlatforms(e.pfs))return!1;if(void 0!==e.sys&&""!==n.RGSHAREDATA.RGShareSystem&&!this.rg_isInSystems(e.sys))return!1;if(void 0!==e.server&&null!==e.server&&""!==e.server&&0!=n.RGSHAREDATA.RGShareUserServerId&&!this.rg_isInServers(e.server))return!1;if(void 0!==e.gender){var t=n.RGSHAREDATA.RGShareUserInfo.RGShareUserSex;if(e.gender!==t)return!1}var a=n.RGSHAREDATA.RGShareUserInfo.RGShareUserLevel;if(void 0!==e.maxlevel&&a>=e.maxlevel)return!1;if(void 0!==e.minlevel&&a<e.minlevel)return!1;if(void 0!==e.newuser&&this.rg_getSystemTimeStamp()/1e3-n.RGSHAREDATA.RGShareUserInfo.RGShareUserRegTime>86400!==e.newuser)return!1;if(void 0!=e.ispay){if(e.ispay&&n.RGSHAREDATA.RGShareUserInfo.RGShareUserPayCNYTotal<=0)return!1;if(!e.ispay&&n.RGSHAREDATA.RGShareUserInfo.RGShareUserPayCNYTotal>0)return!1}if(void 0!==e.bsgs){var o=n.RGSHAREDATA.configData.properties.bsgs;if(e.bsgs!==o){if(void 0===e.provinces)return!1;if(!this.rg_isInProvinces(e.provinces))return!1}}else if(void 0!==e.provinces&&!this.rg_isInProvinces(e.provinces))return!1;return!(e.since&&e.until&&!this.rg_isInActionTime(e.since,e.until))},e.rg_isInProvinces=function(e){for(var t=n.RGSHAREDATA.configData.properties.province,a=0,o=e.length;a<o;a++)if(t==e[a])return!0;return!1},e.rg_isInPlatforms=function(e){for(var t=n.RGSHAREDATA.RGSharePlatform,a=0,o=e.length;a<o;a++)if(t==e[a])return!0;return!1},e.rg_isInSystems=function(e){for(var t=n.RGSHAREDATA.RGShareSystem,a=0,o=e.length;a<o;a++)if(t==e[a])return!0;return!1},e.rg_isInServers=function(e){var t=n.RGSHAREDATA.RGShareUserServerId;if(e.indexOf("-")>=0){var a=e.split("-");if(a.length>1&&t>=Number(a[0])&&t<=Number(a[1]))return!0}else if(t==Number(e))return!0;return!1},e.rg_isInActionTime=function(e,t){var a={y:0,m:0,d:0,h:0,i:0,s:0},o={y:0,m:0,d:0,h:0,i:0,s:0};if(this.rg_isQualifiedTime(e.y,t.y))a.y=e.y,o.y=t.y;else{var n=this._nowtime.getFullYear();a.y=n,o.y=n}if(this.rg_isQualifiedTime(e.m,t.m))a.m=e.m-1,o.m=t.m-1;else{var i=this._nowtime.getMonth();a.m=i,o.m=i}if(this.rg_isQualifiedTime(e.d,t.d))a.d=e.d,o.d=t.d;else if(void 0!=e.w&&void 0!=t.w){var r=this._nowtime.getDay(),s=this._nowtime.getDate();0===r&&(r=7);var l=t.w;0==l&&(l=7);var c=e.w;0==c&&(c=7);var d=s-r;a.d=d+c,o.d=d+l}else{s=this._nowtime.getDate();a.d=s,o.d=s}if(this.rg_isQualifiedTime(e.h,t.h))a.h=e.h,o.h=t.h;else{var p=this._nowtime.getHours();a.h=p,o.h=p}if(this.rg_isQualifiedTime(e.i,t.i))a.i=e.i,o.i=t.i;else{var u=this._nowtime.getMinutes();a.i=u,o.i=u}if(this.rg_isQualifiedTime(e.s,t.s))a.s=e.s,o.s=t.s;else{var h=this._nowtime.getSeconds();a.s=h,o.s=h}var m=new Date(a.y,a.m,a.d,a.h,a.i,a.s).getTime(),f=new Date(o.y,o.m,o.d,o.h,o.i,o.s).getTime(),_=this._nowtime.getTime();return _>=m&&_<f},e.rg_isQualifiedTime=function(e,t){return void 0!=e&&!isNaN(e)&&void 0!=t&&!isNaN(t)},e.setActionData=function(e,t){if(this.setGlobalActionData(t),this._shareMap[e]){var a=this._shareMap[e];if(a.listIndex<0||a.actionIndex<0||a.type==o.IShareSeverType.over)s.log("Share_Utils    shareid:"+e+"  listIndex:"+a.listIndex+"   actionIndex:"+a.actionIndex+"  type:"+a.type);else{var n=this.rg_getSystemTimeStamp(),r=null,l={date:n,num:{},shareNum:0,adNum:0,isShareSuccess:!1},c=i.RGShareCommon.call_syncLoadLocalStorage(this._localDataStr+e);s.log("setActionData  get",c);try{r=JSON.parse(c)}catch(e){}r?this.rg_isSameDayStamp(Number(r.date),n)?(l=r,r.adNum||(r.adNum=0),t==o.IShareType.shareType_Share?l.shareNum+=1:t==o.IShareType.shareType_watchAd&&(l.adNum+=1),void 0!==l.num[a.listIndex]?void 0!==l.num[a.listIndex][a.actionIndex]?l.num[a.listIndex][a.actionIndex]+=1:l.num[a.listIndex][a.actionIndex]=1:(l.num[a.listIndex]={},l.num[a.listIndex][a.actionIndex]=1)):(l.num[a.listIndex]={},l.num[a.listIndex][a.actionIndex]=1):(t==o.IShareType.shareType_Share?l.shareNum+=1:t==o.IShareType.shareType_watchAd&&(l.adNum+=1),l.num[a.listIndex]={},l.num[a.listIndex][a.actionIndex]=1),s.log("setActionData  set",l),i.RGShareCommon.call_syncSaveLocalStorage(this._localDataStr+e,JSON.stringify(l))}}else s.log("Share_Utils   map\u65e0\u76f8\u5e94\u6570\u636e   shareid:"+e)},e.setGlobalActionData=function(e){var t=this.rg_getSystemTimeStamp(),a=null,n={date:t,shareNum:0,adNum:0},r=i.RGShareCommon.call_syncLoadLocalStorage(this._localGlobalDataStr);try{a=JSON.parse(r)}catch(e){}a&&this.rg_isSameDayStamp(Number(a.date),t)&&(n=a),e==o.IShareType.shareType_Share?n.shareNum+=1:e==o.IShareType.shareType_watchAd&&(n.adNum+=1),i.RGShareCommon.call_syncSaveLocalStorage(this._localGlobalDataStr,JSON.stringify(n))},e.checkShareSuccess=function(e,t){s.log("checkShareSuccess");var a,o=i.RGShareCommon.call_syncLoadLocalStorage(this._localDataStr+e),l={date:this.rg_getSystemTimeStamp(),num:{},shareNum:0,adNum:0,isShareSuccess:!1};if(o){var c=JSON.parse(o);this.rg_isSameDayStamp(c.date)&&(l=JSON.parse(o))}a=l.shareNum;var d=n.RGSHAREDATA.configData.fakeList;if(d&&d.length>0)for(var p=0,u=d.length;p<u;p++)if(this.rg_isInCondition(d[p].condition)){for(var h=0,m=d[p].fakes.split("|"),f=0,_=m.length;f<_;f++){if("-1"==m[f]&&0!==f){h=Number(m[f-1]);break}if(Number(m[f])>=0&&a==f){h=Number(m[f]);break}}var y=this.rg_getSystemTimeStamp();if(s.log("ShareFailByTime open, endTime ="+y+",shareStartTime="+t+",shareCheckTime="+d[p].time),y-t<1e3*d[p].time)return s.log("time interval ="+(y-t)),r.IShareErrorCode.Share_Fail_Retry;if(h>0){var g=100*Math.random();if(s.log("checkShareSuccess random="+g+"   value:"+h),g<h&&(l.isShareSuccess||0==a))return l.isShareSuccess=!1,l.shareNum+=1,i.RGShareCommon.call_syncSaveLocalStorage(this._localDataStr+e,JSON.stringify(l)),r.IShareErrorCode.Share_Fail_ToOtherGroup}return l.isShareSuccess=!0,i.RGShareCommon.call_syncSaveLocalStorage(this._localDataStr+e,JSON.stringify(l)),s.log("Share_Sucess"),r.IShareErrorCode.Share_Sucess}return l.isShareSuccess=!0,i.RGShareCommon.call_syncSaveLocalStorage(this._localDataStr+e,JSON.stringify(l)),s.log("Share_Sucess"),r.IShareErrorCode.Share_Sucess},e.checkAllAd=function(){if(n.RGSHAREDATA.RGShareWatchAdOpen){var e={},t=n.RGSHAREDATA.configData.sharePointListData;for(var a in t){var o=t[a].adunit;o&&!e[o]&&(e[o]=1,this.addAdTask(o))}}},e.checkAdTask=function(){var e=this;if(this.adLoadingStatus)s.log("\u4e0a\u4e2a\u89c6\u9891\u4efb\u52a1\u8fd8\u5728\u52a0\u8f7d");else if(this.adTask.length>0){var t=this.adTask.shift();this.adLoadingStatus=!0,i.RGShareCommon.call_checkHasAd({adid:t,complete:function(a){s.log("checkAllAd   adid:  "+t+"  \u662f\u5426\u6709\u5e7f\u544a\uff1a"+a),e.adLoadingStatus=!1}})}},e.addAdTask=function(e){e&&this.adTask.push(e)},e.checkWatchingAdPop=function(e){var t=0,a=n.RGSHAREDATA.configData.videos[e];if(s.log("videocfg",a),a&&a.length>0){if(this._shareMap[e]&&this._shareMap[e].type!=o.IShareSeverType.ad&&this._shareMap[e].type!=o.IShareSeverType.adOvering)return-1;var r=i.RGShareCommon.call_syncLoadLocalStorage(this._localDataStr+e);if(s.log(r),s.log("checkWatchingAdPop",r,e,this._localDataStr+e),r){var l=JSON.parse(r);void 0!=l.adNum&&this.rg_isSameDayStamp(Number(l.date))&&(t=l.adNum)}s.log("videoTime",t);for(var c=0,d=a.length;c<d;c++){var p=a[c];if(p.action.length>0&&this.rg_isInCondition(p.condition)){var u=null;if(p.action[t]&&(u=p.action[t])&&u.p>0){var h=100*Math.random();if(s.log("videopop",h,u.p),h<u.p)return u.t}}}}return-1},e._localDataStr="ShareUtils",e._localGlobalDataStr="ShareUtilsGlobal",e._shareid=0,e._nowtime=new Date,e._actionIndex=-1,e._shareMap={},e.adTask=[],e.adLoadingStatus=!1,e}();a.default=l,cc._RF.pop()},{"../../../fws/utils/X":"X","../RGShareCore":"RGShareCore","../RGShareInterface":"RGShareInterface","./RGShareCommon":"RGShareCommon","./SDKModel/RGShareData":"RGShareData"}],RGShareData:[function(e,t,a){"use strict";cc._RF.push(t,"212d66zPvVMv6LEoRXI2NZU","RGShareData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../RGShareUtils"),n=e("../RGShareCommon"),i=e("../../../../fws/utils/X"),r=function(){function e(){this.RGShareServerConfigLoadFinish=!1,this.RGShareUserServerId=0,this.RGShareUserInfo={RGShareUserLevel:0,RGShareUserName:"",RGShareUserAvatarUrl:"",RGShareUserRegTime:0,RGShareUserSex:0,RGShareUserPayCNYTotal:0,RGShareUserSeverId:0,RGShareUserId:""},this.RGShareServerSwitch=!0,this.RGShareEnvRelease=!1,this.RGShareAppId="",this.RGShareOpen=!0,this.RGShareWatchAdOpen=!0,this.RGShareImgPath="",this.RGSharePlatform="",this.RGShareSystem="",this.RGShareCountry="CN",this.RGShareDailySum={},this.configData={configs:{},fakeList:[],videos:{},sharePointListData:{},properties:{bsgs:!0,city:"",gender:0,province:""}}}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.rg_sdkDataInit=function(e){this.getServerConfigData(e),this.RGShareOpen=n.RGShareCommon.canShare(),this.RGShareWatchAdOpen=n.RGShareCommon.canWatchAd()},e.prototype.getServerConfigData=function(e){var t=this.RGShareAppId,a=o.default.rg_getSystemTimeStamp(),r="appId"+t+"time"+a+a,s=n.RGShareCommon.call_md5(r);i.log(s);var l=this.getConfigUrl()+"?appId="+t+"&time="+a+"&sign="+s;i.log("shareSDK initServerConfigData url:",l);var c=this;n.RGShareCommon.call_doGet({url:l,success:function(t){if(i.log("shareSDK serverData:",t),1==t.code){var a=t.data.configs;c.configData.configs=a,c.configData.properties=t.data.properties,c.configData.fakeList=t.data.fakeList,c.configData.videos=t.data.videos,t.data.list.forEach(function(e){c.configData.sharePointListData[e.id]=e}),c.RGShareServerConfigLoadFinish=n.RGShareCommon.canUseShareSDK(),e&&e()}i.log("RGShareData:",c)},fail:function(){i.error("getServerConfigError")}})},e.prototype.getConfigUrl=function(){return this.RGShareEnvRelease?"https://platformapi-jp.rivergame.net/share/getConfigs":"https://platformapi-jp.rivergame.net/share/getConfigs/debug"},e}();a.default=r,a.RGSHAREDATA=r.getInstance(),cc._RF.pop()},{"../../../../fws/utils/X":"X","../RGShareCommon":"RGShareCommon","../RGShareUtils":"RGShareUtils"}],RGShareModel:[function(e,t,a){"use strict";cc._RF.push(t,"fe3eaklCDtOTqDfplfT9R6N","RGShareModel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./RGShareData"),n=e("../RGShareUtils"),i=e("../../RGShareCore"),r=e("../RGShareCommon"),s=function(){function e(){this.rg_sharePoint=0,this.rg_uniqueId="",this.rg_success=null,this.rg_fail=null,this.rg_cusParams={},this.rg_shareType=i.IShareType.shareType_None,this.rg_startTime=0,this.rg_endTime=0,this.rg_shareInfo={share_text:"",share_ImgUrl:"",share_query:"",share_SharePointInfo:{id:0,share_type:0,share_des:"",share_icon:"",item_id:0,item_num:0,item_limit:0,mail_dialog:0,comment:"",sharegroupid:0,daily_count:0,inspect_id:0,adunit:"",share_box_id:0,group:[],share_true:0},share_queryParams:{}}}return e.getNewShareModel=function(t){var a=new e;return a.rg_sharePoint=t.id,a.rg_shareInfo.share_SharePointInfo=t,a.rg_startTime=n.default.rg_getSystemTimeStamp(),a.rg_uniqueId=a.getShareUuid(),a.shareParseShareGroup(),a.update_shareInfoBaseData(),a},e.prototype.shareParseShareGroup=function(){var e={id:this.rg_shareInfo.share_SharePointInfo.id,weight:0,text:this.rg_shareInfo.share_SharePointInfo.mail_dialog.toString(),icon:this.rg_shareInfo.share_SharePointInfo.share_icon},t=this.rg_shareInfo.share_SharePointInfo.group;if(t&&t.length>0){for(var a=0,n=[],i=0;i<t.length;i++)a+=t[i].weight,n.push(a);var s=-1,l=Math.floor(Math.random()*a);for(i=0;i<n.length;i++)if(l<=n[i]){s=i;break}if(s>-1)e=t[s];var c=e.text,d=o.RGSHAREDATA.RGShareImgPath+e.icon+".jpg";this.rg_shareInfo.share_text=c,this.rg_shareInfo.share_ImgUrl=d}this.rg_shareInfo.share_text=r.RGShareCommon.call_LangFunc(this.rg_shareInfo.share_text)},e.prototype.update_shareInfoBaseData=function(){this.rg_shareInfo.share_queryParams.shareOpenid=o.RGSHAREDATA.RGShareUserInfo.RGShareUserId||"",this.rg_shareInfo.share_queryParams.uid=o.RGSHAREDATA.RGShareUserInfo.RGShareUserId||"",this.rg_shareInfo.share_queryParams.nickname=o.RGSHAREDATA.RGShareUserInfo.RGShareUserName||"",this.rg_shareInfo.share_queryParams.avatarUrl=o.RGSHAREDATA.RGShareUserInfo.RGShareUserAvatarUrl||"",this.rg_shareInfo.share_queryParams.shareid=this.rg_uniqueId,this.rg_shareInfo.share_queryParams.doShareTime=this.rg_startTime,this.rg_shareInfo.share_queryParams.sharetype=this.rg_shareInfo.share_SharePointInfo.id||"",this.rg_shareInfo.share_queryParams.shareboxid=this.rg_shareInfo.share_SharePointInfo.share_box_id||"",this.rg_shareInfo.share_queryParams.shareserverid=o.RGSHAREDATA.RGShareUserServerId||"",this.rg_shareInfo.share_queryParams.userShareSDK=1},e.prototype.update_formatShareInfoQueryParams=function(){var e=this.rg_shareInfo.share_queryParams;if(e){for(var t in this.rg_cusParams)if(this.rg_cusParams.hasOwnProperty(t)){var a=this.rg_cusParams[t];e[t]=a}this.rg_shareInfo.share_queryParams=e}this.set_formatShareInfoQuery()},e.prototype.set_formatShareInfoQuery=function(){var e=this.rg_shareInfo.share_queryParams,t="";for(var a in e)e[a]instanceof Function||(t+=a+"="+e[a]+"&");this.rg_shareInfo.share_query=t},e.prototype.getShareUuid=function(){return this.rg_startTime+o.RGSHAREDATA.RGShareUserInfo.RGShareUserId+"_"+this.rg_sharePoint+"_"+e.shareTid++},e.shareTid=0,e}();a.default=s,cc._RF.pop()},{"../../RGShareCore":"RGShareCore","../RGShareCommon":"RGShareCommon","../RGShareUtils":"RGShareUtils","./RGShareData":"RGShareData"}],AppConfigTask:[function(e,t,a){"use strict";cc._RF.push(t,"51cfdBkb75GZJW0Y3BAB9En","AppConfigTask");var o=e("../../fws/utils/X"),n=e("../Data/GlobalData"),i=e("../../fws/task/FWSTask"),r=e("../../Core/Net/WebClient"),s=e("../../fws/utils/HttpUtils"),l=e("../Tools/GameTools"),c=e("../../fws/utils/LocalStorageUtils"),d=e("../../fws/platforms/PlatformCore"),p=e("../Const/GameDefine"),u=e("../../fws/utils/FWSTool"),h=e("../../fws/mvc/FWSMvc"),m=e("../msgs/MvcMsgs"),f=e("../../fws/utils/ErrorReport"),_=e("../../Core/Utils/CDNSwitcher"),y=function(e){function t(a,o,i){void 0===o&&(o=0),void 0===i&&(i=!1);var r=e.call(this,"AppConfigTask")||this;return r.NEW_CONFIG=!0,r.url="",r.debug_res_ver=null,r.req_params={},r.errorCount=0,r.preServerFlag=!1,r.appConfigUrls=null,r._racingMode=!1,r.mvcDelegate=new h.FMessageConnectionDelegate(r),r.mvcDelegate.connect(),t.allErrCount=0,r.appConfigUrls=n.GLOBAL.GetAppConfigUrl.split("|"),r._racingMode=i,r.NEW_CONFIG||i?(r.url=r.appConfigUrls[o],window.OnlineServer?r.req_params={platform:d.instance.platformSID,version:n.GLOBAL.GameVersion}:r.req_params={platform:"TEST",version:n.GLOBAL.GameVersion}):r.changeToOldMethod(),"4001"===a&&(r.preServerFlag=!0),r}return __extends(t,e),t.prototype.changeToOldMethod=function(){window.OnlineServer?this.url=n.GLOBAL.ResourceUrl+"/DynRes/knight_app_config.json":this.url=n.GLOBAL.ResourceUrl+"/DynRes/knight_app_config_test.json"},t.prototype.begin=function(){var a=this;e.prototype.begin.call(this);var i=this.url,l=this.req_params;try{var d=c.get("GM_ConfigType");d&&(this.NEW_CONFIG?l={platform:d,version:n.GLOBAL.GameVersion}:i="4001"===d?n.GLOBAL.ResourceUrl+"/DynRes/knight_app_config_4001.json":"TEST"===d?n.GLOBAL.ResourceUrl+"/DynRes/knight_app_config_test.json":"LOCAL"===d?n.GLOBAL.ResourceUrl+"/DynRes/knight_app_config_local.json":n.GLOBAL.ResourceUrl+"/DynRes/knight_app_config.json"),this.preServerFlag&&(this.NEW_CONFIG?l={platform:"4001",version:n.GLOBAL.GameVersion}:i=n.GLOBAL.ResourceUrl+"/DynRes/knight_app_config_4001.json")}catch(e){}this._reqUrl=i,i=s.addTimespan(i),this.useUrl=i,this._req=r.get(i,l,this,function(e){if(t.completed)o.warn("AppConfig has been processed!");else{var i=a._racingMode?{}:n.GLOBAL;try{if(!a.parse(e.responseText,i))return void a.doOnError("APP CONFIG RESPONSE DATA ERROR!")}catch(e){return o.warn("APP CONFIG PARSE ERROR!"),console.log(e),void a.doOnError("APP CONFIG PARSE ERROR!")}if(!i.DynResVer||!i.LangVer)return o.warn("APP CONFIG CONTENT ERROR!"),void a.doOnError("APP CONFIG CONTENT ERROR! JSON:"+e.responseText);o.log("APP CONFIG DONE!"),t.completed=!0,a.switchServerlistUrl(),m.send(m.Names.AppConfigProcessOK,!0)}},function(e,n){t.completed?o.warn("AppConfig has been processed!"):(o.warn("APP CONFIG REQUEST ERROR!"),a.doOnError("APP CONFIG REQUEST ERROR!",n))},!0,15e3)},t.prototype.doOnError=function(e,a){void 0===a&&(a=!1),this.NEW_CONFIG||this._racingMode?(this.callListener(this.onError),this._racingMode||(p.customReport("GetConfigError",{resp:e,host:this.useUrl}),this.errorCount++,this.errorCount<=3&&(t.allErrCount++,t.allErrCount>=3*this.appConfigUrls.length&&(this.NEW_CONFIG=!1,this.changeToOldMethod(),p.customReport("ChangeConfigOld",{resp:e,host:this.useUrl}))))):(this._req&&_.notify(this._reqUrl,a),this.callListener(this.onError),f.trace({resp:"\u5207\u6362cdn",uri:n.GLOBAL.ResourceUrl}))},t.prototype.parse=function(e,t){o.log("AppConfig",e);var a=l.default.JSON_PARSE(e);if(!a)return p.customReport("GetConfigDataError",{resp:e,host:this.useUrl}),!1;a.SW&&(t.SwitchStr=a.SW);var n=d.instance.getPFConfigKey();if(n){var i="UPV_"+n;if(a[i]){o.log("UPDATE CONFIG VALUE:",a[i]);var r=a[i].split("|");r.length>=1&&(t.UpdateVer=r)}var s="RVV_"+n;if(a[s]){o.log("REVIEW CONFIG VALUE:",a[s]);var c=d.instance.getPlatformVer();t.IsReviewVersion=c&&u.Str.versionCompare(a[s],c)<=0}}return t.Regions=a.HUR||"",t.HotUpdateVersion=a.HUV||"",t.ForceGameUpdateVer=a.FGV||"1.0.0",a.RVH&&(t.ConfigPatchVers=a.RVH.split("|")||[]),t.DynResVer=this.debug_res_ver||a.ResVer,t.LangVer=a.LangVer||this.debug_res_ver||a.ResVer,!0},t.prototype.onFMessage_AppConfigProcessOK=function(e){return e.data&&(this.callListener(this.onCompleted),this.mvcDelegate.disconnect()),!0},t.prototype.switchServerlistUrl=function(){if(!(this.appConfigUrls.length<=1||!this.NEW_CONFIG&&!this._racingMode))try{for(var e=0;e<this.appConfigUrls.length;e++)if(this.appConfigUrls[e]!=this.url){var t=this.appConfigUrls[e].split("/frontconfigget")[0],a=this.url.split("/frontconfigget")[0];if(0==n.GLOBAL.GetServerListUrl.indexOf(t)){o.warn("\u5207\u6362GETSERVERLIST (\u539f)Url:",n.GLOBAL.GetServerListUrl),n.GLOBAL.GetServerListUrl=n.GLOBAL.GetServerListUrl.replace(t,a),n.GLOBAL.GetAllServerDataUrl=n.GLOBAL.GetAllServerDataUrl.replace(t,a),n.GLOBAL.GameBestDomain=a.split("://")[1],o.warn("\u5207\u6362GETSERVERLIST (\u65b0)Url:",n.GLOBAL.GetServerListUrl);break}}}catch(e){}},t.completed=!1,t.allErrCount=0,t}(i.Task);t.exports=y,cc._RF.pop()},{"../../Core/Net/WebClient":"WebClient","../../Core/Utils/CDNSwitcher":"CDNSwitcher","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/task/FWSTask":"FWSTask","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/HttpUtils":"HttpUtils","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Const/GameDefine":"GameDefine","../Data/GlobalData":"GlobalData","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs"}],ClientUpdateTask:[function(e,t,a){"use strict";cc._RF.push(t,"8e5df4nmqhBQbYyDULXvbuQ","ClientUpdateTask");var o=e("../../fws/task/FWSTask"),n=e("../../fws/platforms/PlatformCore"),i=e("../../Core/Common/LocalManager"),r=function(e){function t(){var t=e.call(this,"ClientUpdateTask")||this;return t.url="",t}return __extends(t,e),t.prototype.begin=function(){e.prototype.begin.call(this),i.LOCAL.firstSetLanguage(n.instance.defaultLanguage||"zh_cn");var t=n.instance.checkNeedClientUpdate();if(t){var a=this;1===t?n.instance.doClientUpdate(function(){a.callListener(a.onCompleted)}):2===t?n.instance.doClientUpdate():this.callListener(this.onCompleted)}else this.callListener(this.onCompleted)},t}(o.Task);t.exports=r,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/task/FWSTask":"FWSTask"}],GStartReportTask:[function(e,t,a){"use strict";cc._RF.push(t,"125f5C779pLXZe0b8ZziILd","GStartReportTask"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/task/FWSTask"),n=e("../Data/GlobalData"),i=e("../Const/GameDefine"),r=function(e){function t(t){var a=e.call(this)||this;return a._preTaskName="",a._preTaskName=t,a}return __extends(t,e),t.prototype.begin=function(){e.prototype.begin.call(this),this._alreadyBegin||this._alreadyCompoleted||(this._alreadyBegin=!0,this._alreadyCompoleted=!1,i.launchReport(this._preTaskName+"_finish",n.GLOBAL.newbieLaunch),this.callListener(this.onCompleted))},t.prototype.cancel=function(){e.prototype.cancel.call(this)},t.prototype.reset=function(){e.prototype.reset.call(this)},t}(o.Task);a.default=r,cc._RF.pop()},{"../../fws/task/FWSTask":"FWSTask","../Const/GameDefine":"GameDefine","../Data/GlobalData":"GlobalData"}],GameServerRacingTask:[function(e,t,a){"use strict";cc._RF.push(t,"57925vh5chP5LBxQFZFh03B","GameServerRacingTask"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/task/FWSTask"),n=e("../../Core/Net/NetMgr"),i=e("../../Core/Net/WebClient"),r=e("../../fws/utils/HttpUtils"),s=e("../../fws/utils/ErrorReport"),l=function(e){function t(t,a){var o=e.call(this,"GameServerRacingTask")||this;return o._host=null,o._hostIpAccLineMap={},o._requests=[],o._errorCount=0,o._host=t,o._hostIpAccLineMap=a,o.customOverTime=1e4,o}return __extends(t,e),t.prototype.begin=function(){if(!this._alreadyBegin)if(e.prototype.begin.call(this),n.NET.getAccAddress(this._host))this.callListener(this.onCompleted);else{this.clearRequests(),this._errorCount=0;var t=[];for(var a in this._hostIpAccLineMap)t.push(a);if(0!==t.length){if(1===t.length){var o=this._hostIpAccLineMap[t[0]];return o&&n.NET.setAccAddress(this._host,o),void this.callListener(this.onCompleted)}for(var i=0,r=t.length;i<r;++i)this._requests.push(this.sendRequest(t[i]))}else this.callListener(this.onCompleted)}},t.prototype.clearRequests=function(){for(var e=0;e<this._requests.length;++e)this._requests[e].abort();this._requests.length=0},t.prototype.sendRequest=function(e){var t=this,a="https://"+e+"/frontconfigget",o=this;return i.get(r.addTimespan(a),null,this,function(t){o.OnRacingOver(e)},function(e,a){++o._errorCount,o._errorCount==t._requests.length&&t.callListener(t.onCompleted)})},t.prototype.OnRacingOver=function(e){if(!this._alreadyCompoleted){this.clearRequests();var t=this._hostIpAccLineMap[e];t&&n.NET.setAccAddress(this._host,t),s.custom("GameServerRaceResult",{resp:e,uri:t}),this.callListener(this.onCompleted)}},t}(o.Task);a.default=l,cc._RF.pop()},{"../../Core/Net/NetMgr":"NetMgr","../../Core/Net/WebClient":"WebClient","../../fws/task/FWSTask":"FWSTask","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/HttpUtils":"HttpUtils"}],GameStart:[function(e,t,a){"use strict";cc._RF.push(t,"9eff0EH7yVE2IaZ5UH4LLlj","GameStart"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Response/ResponseRegister"),n=e("../../fws/display/FWSComponent"),i=e("../../System/ErrorUtils"),r=e("../Common/BIManager"),s=e("../Data/GlobalData"),l=e("../../System/CocosWrap"),c=e("./AppConfigTask"),d=e("../../fws/task/FWSTask"),p=e("../../fws/platforms/PlatformCore"),u=e("../Tools/GameTools"),h=e("../../fws/utils/ErrorReport"),m=e("../../Core/Net/NetReciver"),f=e("../../fws/FWSEnv"),_=e("../Const/GameDefine"),y=e("../controllers/DevConfigController"),g=e("../Common/ErrorMsgPanel"),C=e("../../fws/utils/SubpackLoaderTask"),v=e("./PlatformInitTask"),I=e("../Const/GameDefine"),T=e("../../fws/utils/ErrorReportMethods"),S=e("../../fws/display/factory/LocalAssertLoader"),A=e("../../fws/display/factory/FWSAssertCaches"),D=e("../../Core/Utils/UpdateSpriteFrame"),N=e("./ClientUpdateTask"),b=e("../../Core/Utils/CDNSwitcher"),L=e("../../Core/Net/NetMgr"),E=e("../../Core/Net/SocketCore"),P=e("../../fws/utils/LocalStorageUtils"),w=e("../../fws/utils/IntervalReleaseManager"),B=e("../../Core/Common/UAfingerprintCore"),M=e("../../fws/platforms/PlatformCommon"),U=e("./GStartReportTask"),R=e("../controllers/G123IPContentProvider"),G=cc._decorator,O=G.ccclass,k=G.property,x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.DEBUG_RES_VER="1.0.0",t.bgNode=null,t.logoEnNode=null,t.noNetNode=null,t.errorCount=0,t.accUrlCount=1,t.isFirstStart=!0,t}var a;return __extends(t,e),a=t,t.prototype.cpnStart=function(){if(this.checkLoadingPic(),M.PlatformCommon.isLandscape()){var e=cc.director.getScene().getChildByName("Canvas");if(e)e.getComponent(cc.Canvas).fitHeight=!0}r.default.postBI("load_start"),s.GLOBAL.launchStatus=null==P.get("lastLoginUid",!1)?1:0,T.launch("1_cpnStart",s.GLOBAL.newbieLaunch),r.default.Instance.PostAction("GameStartCpnStart");try{var t=a.firstStart;t&&(a.firstStart=!1,p.instance.onEnterGame()),this.checkEngineCompatibility(t),p.instance.isForeign()&&this.logoEnNode&&(this.logoEnNode.opacity=255),p.instance.isPad()&&(this.bgNode.scaleY=u.default.getPadRatio())}catch(e){h.error(e,"GameStart:cpnStart","\u542f\u52a8\u903b\u8f91\u5f02\u5e38",!0)}p.instance.initServerAddress(),B.initUAFingerprint(),I.launchReport("2_initServerAddress",s.GLOBAL.newbieLaunch),r.default.Instance.PostAction("GameStartInitServerAddress"),this.doInitialize(),I.launchReport("3_doInitialize",s.GLOBAL.newbieLaunch)},t.prototype.checkLoadingPic=function(){var e=R.default.Instance.getPCBg(),t=R.default.Instance.getLoadingBg();if(this.bgNode&&(o=this.bgNode.getComponent(cc.Sprite))){var a=this.bgNode;this.bgNode.opacity=0,D.UpdateSpriteFrame(t,o,function(){a.runAction(cc.fadeIn(.2))})}var o,n=this.node.children[3];if(n&&(o=n.getComponent(cc.Sprite))){var i=n;n.opacity=0,D.UpdateSpriteFrame(e,o,function(){i.runAction(cc.fadeIn(.2))})}var r=this.node.children[4];if(r){var s=r.getComponent(cc.Sprite);if(s){var l=r;r.opacity=0,D.UpdateSpriteFrame(e,s,function(){l.runAction(cc.fadeIn(.2))})}}},t.prototype.checkEngineCompatibility=function(e){var t=function(t){var a=cc.Material.getBuiltinMaterial;a&&(a(t)||h.error(new Error("Cant find builtin material, firstStart: "+e),"GameStart:checkEngineCompatibility",t,!0))};if(t("2d-sprite"),t("2d-gray-sprite"),t("unlit"),t("clear-stencil"),t("2d-spine"),e){if(cc.SpriteFrame.noneRefCheckInterval=9e3,"2.1.2"===cc.ENGINE_VERSION){var a=cc.renderer._forward._programLib.getTemplate("4c10e7ec534d3f65baabc458cc91fd8dfe66821a283acb75aea070ac");a&&(a.vert="\n#define _IS_VERT_SHADER 1\n\nprecision highp float;\n\nuniform mat4 cc_matViewProj;\nattribute vec3 a_position;\nattribute mediump vec2 a_uv0;\nattribute lowp vec4 a_color;\nvarying mediump vec2 v_uv0;\nvarying lowp vec4 v_color;\n\nvoid main () {\n  gl_Position = cc_matViewProj * vec4(a_position, 1);\n  v_uv0 = a_uv0;\n  v_color = a_color;\n}\n\n\n",a.frag="\n#define _IS_FRAG_SHADER 1\n\nprecision highp float;\n\nuniform sampler2D texture;\nvarying mediump vec2 v_uv0;\nvarying lowp vec4 v_color;\n\nvoid main () {\n  vec4 color = v_color * texture2D(texture, v_uv0);\n  #if _USE_ETC1_TEXTURE\n      color.a *= texture2D(texture, v_uv0 + vec2(0, 0.5)).r;\n  #endif\n  float gray = 0.2126*color.r + 0.7152*color.g + 0.0722*color.b;\n  gl_FragColor = vec4(gray, gray, gray, color.a);\n}\n\n\n")}if(cc.renderer.jyCustom){var o=!1;if(cc.Texture2D.enableBigTexProfiler){var n=P.get("lastLoginUid",!1);o="73910779977"===n||"291395904021"===n||"283099124214"===n,cc.Texture2D.enableBigTexProfiler(o)}try{localStorage.setItem("VIVID_MULTI_LINE_FLAG","1");window.OnlineServer?localStorage.setItem("VIVID_MULTI_LINE_DOMAIN","https://knight-g123-cdn.akamaized.net/worldbattlerelease/"):localStorage.setItem("VIVID_MULTI_LINE_DOMAIN","https://knight-g123-cdn.akamaized.net/worldbattle/")}catch(e){}0,cc._BaseNode.prototype.safetyDestroyAllChildren||(cc._BaseNode.prototype.safetyDestroyAllChildren=cc._BaseNode.prototype.removeAllChildren),cc.dynamicAtlasManager.enabled=!0,cc.dynamicAtlasManager.maxAtlasCount=1,cc.dynamicAtlasManager.maxFrameSize=1024,(p=cc.assetReleaseChecker)&&(p.releaseCallback=function(e,t,a){t>0&&h.custom("AutoRelease",{time:e,custom:t,func:a,data:o?JSON.stringify(cc.Texture2D.getBigTexMap()):null,value:cc.gfx.getTextureMemory?cc.gfx.getTextureMemory():-1})})}else if(cc.dynamicAtlasManager.enabled=!1,"2.1.2"===cc.ENGINE_VERSION){var i=cc.Button.prototype.__preload;cc.Button.prototype.__preload=function(){i.apply(this,arguments);var e=null!=this._sprite?this._sprite.node:null;e&&!e._renderComponent&&(e._renderFlag&=~cc.RenderFlow.FLAG_UPDATE_RENDER_DATA,e._renderFlag&=~cc.RenderFlow.FLAG_RENDER)},cc.Sprite.prototype.getState=function(){return this._state},cc.Sprite.prototype.setState=function(e){this._state!==e&&(this._state=e,e==cc.Sprite.State.GRAY?this.setMaterial(0,cc.Material.getInstantiatedBuiltinMaterial("2d-gray-sprite",this)):this.setMaterial(0,cc.Material.getInstantiatedBuiltinMaterial("2d-sprite",this)))};var r=cc.SpriteFrame.prototype._deserialize;cc.SpriteFrame.prototype._deserialize=function(e,t){var a=e.vertices;if(a){var o=a.triangles,n=o.length;if(-1==o[n-1]){var i=n-2*a.x.length-1;a.triangles=o.slice(0,i)}}r.call(this,e,t)},sp.Skeleton.prototype.setAnimation=function(e,t,a){if(this._playTimes=a?0:1,this._animationName=t,this.isAnimationCached()){0!==e&&cc.warn("Track index can not greater than 0 in cached mode.");var o=this._skeletonCache.getAnimationCache(this.skeletonData._uuid,t);o||(o=this._skeletonCache.initAnimationCache(this.skeletonData._uuid,t)).begin(),o&&(this._isAniComplete=!1,this._accTime=0,this._playCount=0,this._frameCache=o,this._curFrame=this._frameCache.frames[0])}else if(this._skeleton){var n=this._skeleton.data.findAnimation(t);return n?this._state.setAnimationWith(e,n,a):(cc.logID(7509,t),null)}return null},cc.loader.loadResSync=cc.loader.getRes}if(f.DEBUG){var s=cc._BaseNode.prototype.removeAllChildren;if(cc._BaseNode.prototype.removeAllChildren=function(e){if(void 0===e)throw new Error("\u4e0d\u5e26\u53c2\u6570\u7684removeAllChildren\u4e0d\u8981\u968f\u4fbf\u8c03\u7528\u4e86, \u8bf7\u7528safetyDestroyAllChildren\u66ff\u4ee3, \u5982\u6709\u7279\u6b8a\u9700\u6c42\u8bf7\u627edj");s.call(this,e)},!cc.renderer.jyCustom){cc._BaseNode.prototype._instantiate=function(e){return e||(e=cc.instantiate._clone(this,this)),e._instRoot=e._id,e._parent=null,e._onBatchRestored(),e},cc._BaseNode.prototype.safetyDestroyAllChildren=function(){for(var e=this._weekReferenceNodes,t=this._children,a=t.length-1;a>=0;--a){var o=t[a];o._instRoot===this._instRoot?(o.cleanup(),o.parent=null,(e=e||[])[e.length]=o):t[a].destroy()}};var l=cc._BaseNode.prototype._onPreDestroy;cc._BaseNode.prototype._onPreDestroy=function(){var e=this._weekReferenceNodes;if(e){for(var t=0,a=e.length;t<a;++t)e[t]._destroyImmediate();e.length=0}l.call(this)};var c=cc._BaseNode.prototype._onBatchCreated;cc._BaseNode.prototype._onBatchCreated=function(){for(var e=this._children,t=0,a=e.length;t<a;t++){e[t]._instRoot=this._instRoot}c.call(this)};var d=cc._BaseNode.prototype._onBatchRestored;cc._BaseNode.prototype._onBatchRestored=function(){for(var e=this._children,t=0,a=e.length;t<a;t++){e[t]._instRoot=this._instRoot}d.call(this)};var p={lockAsset:function(e){},unlockAsset:function(e){}};cc.assetReleaseChecker=p}}}},t.prototype.onStartTaskComplete=function(e,t){this.noNetNode.active=!1,this.gameStart()},t.prototype.onStartTaskError=function(e,t){if(t instanceof c||t instanceof C.default||t instanceof S.LocalAssertLoader){var a=0;this.accUrlCount>1&&(a=3*(this.accUrlCount-1)),this.errorCount++,this.errorCount>7+a&&(this.noNetNode.active=!0,t instanceof C.default&&h.error(new Error("Load gssubpack failed"),"GameStart:OnStartTaskError","\u542f\u52a8\u903b\u8f91\u5f02\u5e38",!0),t instanceof S.LocalAssertLoader&&b.notify("res:"+t.key,t.isOvertime)),t.reset(),this.cpnSetTimeout(function(){t.begin()},2e3),h.trace({resp:"retry task",uri:t.toString(),desc:t.getDebugInfo()},"GameStart")}},t.prototype.doInitialize=function(){var e=this;r.default.Instance.PostActionWithTime("LoadingStartPre",1),a.firstStart?h.custom("AutoRelease",{time:0,custom:1,func:"startMemReport",value:cc.gfx.getTextureMemory?cc.gfx.getTextureMemory():-1}):h.custom("AutoRelease",{time:0,custom:1,func:"startMemReport_SS",value:cc.gfx.getTextureMemory?cc.gfx.getTextureMemory():-1}),this.startTaskList=new d.TaskList("GameStartTask"),this.startTaskList.onError={target:this,handler:this.onStartTaskError},this.startTaskList.onCompleted={target:this,handler:this.onStartTaskComplete};var t=new d.TaskList("PlatformAndConfigInitTask"),o=new d.TaskList("appConfigTaskList");o.asyncMode=!0,c.completed=!1;var n=s.GLOBAL.GetAppConfigUrl.split("|");this.accUrlCount=n.length;var i=new c(this.DEBUG_RES_VER);if(o.add(i),this.accUrlCount>1)for(var l=1;l<this.accUrlCount;l++)o.add(new c(this.DEBUG_RES_VER,l));t.add(o),t.add(new U.default("APPConfigTask")),t.add(new N),t.add(new U.default("ClientUpdateTask"));var p=new v.default;t.add(p),t.add(new U.default("PlatformInitTask"));var u=new d.TaskList("asyncTaskList");u.asyncMode=!0,u.add(t);var m=new d.TaskList("SubpackTaskList"),f=new C.default("gssubpack");m.add(f),m.add(new U.default("SubpackLoaderTask")),u.add(m),this.startTaskList.add(u),this.startTaskList.add(new d.FunctionTask(function(){e.initGame()})),this.startTaskList.add(new U.default("initGame")),this.startTaskList.add(new S.LocalAssertLoader("ea_prefab/ui/Loading",cc.Prefab)),this.startTaskList.add(new U.default("LoadingUI")),this.startTaskList.begin(),this.setupErrorSystem()},t.prototype.clickNoNetRetry=function(){this.noNetNode.active&&(this.noNetNode.active=!1,this.errorCount=0)},t.prototype.clickNoNetClose=function(){this.noNetNode.active&&p.instance.exitMiniProgram({})},t.prototype.gameStart=function(){I.launchReport("4_gameStart",s.GLOBAL.newbieLaunch),r.default.Instance.PostAction("GameStartUp"),this.LoadLoading()},t.prototype.LoadLoading=function(){var e=A.getPrefab("ea_prefab/ui/Loading"),t=cc.instantiate(e);this.node.addChild(t)},t.prototype.initGame=function(){if(m.getInstance().init(new o.ResponseRegister),cc.renderer.jyCustom){0===u.default.GlobalSwitchIntVal(_.SwitchType.enableIntervalRelease)&&(w.enabled=!1,w.reset());var e=u.default.GlobalSwitchIntVal(_.SwitchType.memOptim),t=cc.assetReleaseChecker||{};0===e?(t.enabled=!1,A.PrefabCaches.enabledAutoRelease=!1):t.forceReleaseAll&&(A.PrefabCaches.releaseAllDeadPrefab(),t.forceReleaseAll())}else w.enabled=!1,A.PrefabCaches.enabledAutoRelease=!1;var a=1===u.default.GlobalSwitchIntVal(_.SwitchType.g123NewHeartbeatCheck);if(p.instance.enableNewHeartbeatMode){a?L.NET.enbaleNewHeartbeatMode():L.NET.disableNewHeartbeatMode();var n=u.default.GlobalSwitchIntVal(_.SwitchType.g123NewHeartbeatTimeout);n>0&&(E.IDLE_OVER=n)}},t.prototype.setupErrorSystem=function(){l.default.bindEditorEvent(),i.ErrorUtils.setupFunction(function(e){try{s.GLOBAL&&(e.playerUid=s.GLOBAL.accountId,e.gameVer=s.GLOBAL.GameVersion),window&&window.systemInfo&&(e.wxVer=window.systemInfo.version,e.system=window.systemInfo.system)}catch(e){}},function(e){try{if(h.error(e.errMsgInfo,e.funcName,e.customInfo),y.DevConfigController.Instance.isDevServer()){var t=e.errMsgInfo,a=t.stack;a=(a=a.replace(/\(\S*$/gm,"")).substr(0,400);var o=e.customInfo||"";o=o.substr(0,100);var n="\u51fd\u6570:"+e.funcName+"\n\u9519\u8bef:"+t.message+"\n\u5907\u6ce8:"+o+"\n\u5806\u6808:"+a;g.default.ShowView(n)}}catch(e){}})},t.firstStart=!0,__decorate([k(cc.Node)],t.prototype,"bgNode",void 0),__decorate([k(cc.Node)],t.prototype,"logoEnNode",void 0),__decorate([k(cc.Node)],t.prototype,"noNetNode",void 0),t=a=__decorate([O],t)}(n.default);a.default=x,cc._RF.pop()},{"../../Core/Common/UAfingerprintCore":"UAfingerprintCore","../../Core/Net/NetMgr":"NetMgr","../../Core/Net/NetReciver":"NetReciver","../../Core/Net/SocketCore":"SocketCore","../../Core/Utils/CDNSwitcher":"CDNSwitcher","../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../System/CocosWrap":"CocosWrap","../../System/ErrorUtils":"ErrorUtils","../../fws/FWSEnv":"FWSEnv","../../fws/display/FWSComponent":"FWSComponent","../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../fws/display/factory/LocalAssertLoader":"LocalAssertLoader","../../fws/platforms/PlatformCommon":"PlatformCommon","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/task/FWSTask":"FWSTask","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/ErrorReportMethods":"ErrorReportMethods","../../fws/utils/IntervalReleaseManager":"IntervalReleaseManager","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/SubpackLoaderTask":"SubpackLoaderTask","../Common/BIManager":"BIManager","../Common/ErrorMsgPanel":"ErrorMsgPanel","../Const/GameDefine":"GameDefine","../Data/GlobalData":"GlobalData","../Response/ResponseRegister":"ResponseRegister","../Tools/GameTools":"GameTools","../controllers/DevConfigController":"DevConfigController","../controllers/G123IPContentProvider":"G123IPContentProvider","./AppConfigTask":"AppConfigTask","./ClientUpdateTask":"ClientUpdateTask","./GStartReportTask":"GStartReportTask","./PlatformInitTask":"PlatformInitTask"}],LoginFlowOptions:[function(e,t,a){"use strict";var o;cc._RF.push(t,"c140eh82fhFtLFiW2Z9PpX/","LoginFlowOptions"),function(e){e.debugLoginRetStatus=null,e.alreadyUseDevLoginPanel=!1,e.showDevServer=!1,e.isOnlineServer=function(){return window.OnlineServer},e.LoginFlowArgs={errCode:"",errCodeMsg:"",serverInfoToken:void 0,serverId:void 0},e.platforms=[{text:"\u5fae\u4fe1\u5c0f\u6e38\u620f",id:"wx"},{text:"QQ\u5c0f\u6e38\u620f",id:"qqmini"},{text:"\u65e5\u672cH5",id:"g123"},{text:"\u4fc4\u7f57\u65afH5",id:"esprit"}],e.Hosts=[{text:"\u6b63\u5f0f\u670d",list:"https://serverlist-knight.rivergame.net/serverList"},{text:"\u6b63\u5f0f\u670d(us)",list:"http://knight-us-sh.rivergame.net/serverList"},{text:"\u8c37\u6b4c\u4e91",list:"https://knight-gcp.topwargame.com/serverList"},{text:"4080",list:"https://serverlist-knight.rivergame.net/serverList4080"},{text:"4090",list:"https://serverlist-knight.rivergame.net/serverList4090"},{text:"4094",list:"https://serverlist-knight-4094.rivergame.net/serverList"},{text:"\u6d4b\u8bd5\u670d",ip:"wss://server-knight.rivergame.net/stest",serverId:1},{text:"\u7b56\u5212\u914d\u7f6e",ip:"wss://server-knight.rivergame.net/stest2",serverId:4},{text:"4073",ip:"ws://39.102.49.159:8801",serverId:4073},{text:"4074",ip:"ws://39.102.49.92:8801",serverId:4074},{text:"4075",ip:"ws://39.102.46.184:8801",serverId:4075},{text:"4076",ip:"ws://39.102.50.111:8801",serverId:4076},{text:"4077",ip:"ws://39.102.47.107:8801",serverId:4077},{text:"4078",ip:"ws://39.102.52.18:8801",serverId:4078},{text:"4079",ip:"ws://39.102.49.15:8801",serverId:4079},{text:"4001",ip:"wss://server-knight.rivergame.net/s4001",serverId:4001},{text:"4080",ip:"wss://server-knight-s40.rivergame.net/s4080",serverId:1},{text:"4090",ip:"wss://server-knight-s80.rivergame.net/s4090",serverId:4090},{text:"4092",ip:"wss://server-knight.rivergame.net/s4092",serverId:4092},{text:"IP\u8054\u52a8\u6d4b\u8bd5\u670d",ip:"wss://knight-us.topwargame.com/s4093",serverId:4093},{text:"14",ip:"wss://server-knight-s40.rivergame.net/s4081",serverId:14},{text:"IP\u8054\u52a8\u6d4b\u8bd5\u670d",ip:"wss://knight-us-global.rivergameapp.com/s4093",serverId:4093},{text:"\u59dc\u6d77\u6ce2",ip:"ws://192.168.80.64:8801",serverId:1,dev:!0},{text:"\u51af\u6d77\u5b87",ip:"ws://192.168.80.146:8801",serverId:1,dev:!0},{text:"\u738b\u9a8f",ip:"ws://192.168.50.84:8801",serverId:1,dev:!0},{text:"\u9c81\u514b",ip:"ws://192.168.50.73:8801",serverId:1,dev:!0},{text:"\u8d75\u806a\u6167",ip:"ws://192.168.80.68:8801",serverId:1,dev:!0},{text:"\u8096\u6590",ip:"ws://192.168.80.75:8801",serverId:1,dev:!0},{text:"\u623f\u77b3",ip:"ws://192.168.50.166:8801",serverId:1,dev:!0},{text:"\u8463\u6587\u5f3a#1\u670d",ip:"ws://192.168.80.72:8801",serverId:1,dev:!0},{text:"\u8001\u7f57",ip:"ws://192.168.80.87:8801",serverId:1,dev:!0},{text:"\u8463\u6587\u5f3a#2\u670d",ip:"ws://192.168.80.72:8803",serverId:2,dev:!0}]}(o||(o={})),t.exports=o,cc._RF.pop()},{}],LoginTasks:[function(e,t,a){"use strict";cc._RF.push(t,"7cef8H/jiRJbr/cI0VciJ4E","LoginTasks");var o,n=e("../../fws/task/FWSTask"),i=e("../../fws/platforms/PlatformCore"),r=e("../Data/GlobalData"),s=e("./LoginFlowOptions"),l=e("../Common/PFOpenData"),c=e("../Common/BIManager"),d=e("../../Core/Net/WebClient"),p=e("../../fws/utils/HttpUtils"),u=e("../Tools/GameTools"),h=e("../../fws/utils/X"),m=e("../../Core/Common/LocalManager"),f=e("../msgs/MvcMsgs"),_=e("../../fws/utils/FWSTool"),y=e("../../Core/Net/NetMgr"),g=e("../Const/GameDefine"),C=e("../../fws/utils/ErrorReport"),v=e("../Common/UIManager"),I=e("../../fws/display/MsgBox");(function(e){var t=function(e){function t(t,a){void 0===a&&(a=1);var o=e.call(this,t)||this;return o._step=a,o}return __extends(t,e),t.prototype.begin=function(){e.prototype.begin.call(this),h.log("(LoginTask) \u767b\u5f55\u5e73\u53f0"),g.launchOrReconnectReport("\u8bf7\u6c42\u5e73\u53f0\u767b\u5f55",r.GLOBAL.inLaunch,r.GLOBAL.newbieLaunch),c.default.Instance.PostAction("PFLogin"),c.default.postBI("platform_login");var t=this;i.instance.login({step:this._step,timeout:15e3,success:function(e){if(i.instance.checkLoginResultError(e))return g.TraceReport({resp:"\u5e73\u53f0\u767b\u5f55\u8fd4\u56de_checkLoginResultError"}),c.default.Instance.PostAction("PFLoginFail"),void t.callListener(t.onError);r.GLOBAL.token=e.code,h.log("(LoginTask) \u5e73\u53f0\u767b\u5f55\u5b8c\u6210",r.GLOBAL.token),g.launchOrReconnectReport("\u5e73\u53f0\u767b\u5f55\u8fd4\u56de",r.GLOBAL.inLaunch,r.GLOBAL.newbieLaunch,{data:r.GLOBAL.token}),c.default.Instance.PostAction("PFLoginRet"),t.callListener(t.onCompleted)},fail:function(e){h.log("(LoginTask) \u5e73\u53f0\u767b\u5f55\u5931\u8d25"),g.TraceReport({resp:"\u5e73\u53f0\u767b\u5f55\u8fd4\u56de\u5931\u8d25"}),c.default.Instance.PostAction("PFLoginFail"),i.instance.needAuthLogin?I.confirm(m.LOCAL.getText("public946"),m.LOCAL.getText("system_131845"),t,function(){t.callListener(t.onError)},function(){i.instance.exitMiniProgram({})},m.LOCAL.getText("public947"),m.LOCAL.getText("101003")):t.callListener(t.onError)}})},t}(n.Task);e.PlatformLoginTask=t;var a=function(e){function t(t,a){void 0===t&&(t="Task"),void 0===a&&(a=!1);var o=e.call(this,t)||this;return o._useFallbackDomain=!1,o.needRestartGame=!1,o.needResetToken=!1,o._useFallbackDomain=a,o}return __extends(t,e),t.prototype.begin=function(){e.prototype.begin.call(this),this.doSendRequest("\u8bf7\u6c42serverlist","GetServerList")},t.prototype.doSendRequest=function(e,t){this.needRestartGame=!1,this.needResetToken=!1;var a={};s.loginFlowOptionsData&&s.loginFlowOptionsData.list&&s.loginFlowOptionsData.deviceId?a.device_id=s.loginFlowOptionsData.deviceId:a.token=r.GLOBAL.token,a.pf=l.default.Instance.Platform,a.platform=i.instance.platformSID,s.loginFlowOptionsData&&s.loginFlowOptionsData.sid&&(a.platform=s.loginFlowOptionsData.sid),l.default.Instance.ShareServerId>0&&(a.fromServer=l.default.Instance.ShareServerId),l.default.Instance.Channel&&l.default.Instance.Channel.length>0&&(a.channel=l.default.Instance.Channel),a.appVersion=r.GLOBAL.GameVersion,a.tag="1",i.instance.setServerListParam(a),c.default.postBI("serverlist");var o=r.GLOBAL.GetServerListUrl;this._useFallbackDomain&&r.GLOBAL.ServerlistFallbackDomain&&r.GLOBAL.GameBestDomain&&o.indexOf(r.GLOBAL.GameBestDomain)>=0&&(o=o.replace(r.GLOBAL.GameBestDomain,r.GLOBAL.ServerlistFallbackDomain)),h.log("(LoginTask)(ServerList) \u8bf7\u6c42",o,a),d.get(p.addTimespan(o,!0,1),a,this,this.onHttpSuccess,this.onHttpFail),g.launchOrReconnectReport(e,r.GLOBAL.inLaunch,r.GLOBAL.newbieLaunch,{data:JSON.stringify(a)}),c.default.Instance.PostAction(t)},t.prototype.onHttpSuccess=function(e){h.log("(LoginTask)(ServerList) \u8fd4\u56de",e.responseText);var t=u.default.JSON_PARSE(e.responseText);if(t){var a=parseInt(t.status+"");this.tryServerStopFromServerList(t)?this.reset():0==a?(this.onServerListSuccess(t),c.default.Instance.PostAction("GetServerListRet")):(this.onServerListFail(a),c.default.Instance.PostAction("GetServerListFail"))}else this.onHttpFail(e,!1)},t.prototype.onHttpFail=function(e,t){h.log("(LoginTask)(ServerList) \u8bf7\u6c42\u5931\u8d25",e.status,e.statusText),this.callListener(this.onError),C.trace({resp:"serverlist\u52a0\u8f7d"+(t?"\u8d85\u65f6":"\u5931\u8d25"),data:e.responseText},"serverlisthttp")},t.prototype.onServerListSuccess=function(e){f.send(f.Names.UPDATE_PROGRESS,.98),r.GLOBAL.game_ip=u.default.processWsGameIp(u.default.gameIpCombineAccLines(e.url,e)),r.GLOBAL.serverRegion=e.region||g.GameServerRegion.China,s.LoginFlowArgs.serverInfoToken=e.serverInfoToken,i.instance.saveServerToken(e.serverInfoToken,e),null!==e.serverId&&void 0!==e.serverId&&(s.LoginFlowArgs.serverId=e.serverId),g.launchOrReconnectReport("serverlist \u6b63\u5e38\u8fd4\u56de",r.GLOBAL.inLaunch,r.GLOBAL.newbieLaunch,{gameip:r.GLOBAL.game_ip,serverid:s.LoginFlowArgs.serverId});this.callListener(this.onCompleted)},t.prototype.onServerListFail=function(e){var t=this;switch(e){case g.ServerListResponseStatus.SERVER_STOP:I.alert(m.LOCAL.getText("100425"),m.LOCAL.getText("101041"),this,function(){i.instance.exitMiniProgram({})}),this.reset(),this.sendErrorReport(e,"Server Stopped");break;case g.ServerListResponseStatus.FILTER_SERVER_FAILED:case g.ServerListResponseStatus.CLIENT_SEND_PLATFORM_NOT_FOUND:I.alert(m.LOCAL.getText("100001"),m.LOCAL.getText("101041"),this,function(){i.instance.exitMiniProgram({})}),this.reset(),this.sendErrorReport(e,"Error");break;default:this.sendErrorReport(e,"Fail");i.instance.updateServerToken(function(){t.needResetToken=!0,t.callListener(t.onError)},this)}},t.prototype.tryServerStopFromServerList=function(e){var t=e.now,a=e.stop_start_time,o=e.stop_end_time;if(_.Obj.isNumber(t)&&_.Obj.isNumber(a)&&_.Obj.isNumber(o)&&t>=a&&t<=o){var n=m.LOCAL.getText("system_131845"),r=m.LOCAL.getText("system_131847",u.default.GetTimeShow(a),u.default.GetTimeShow(o));return v.default.Instance()&&v.default.Instance().setWaitStatus(!1),I.alert(r,n,this,function(){i.instance.exitMiniProgram({})}),!0}if(0==e.server_status){n=m.LOCAL.getText("system_131845"),r=m.LOCAL.getText("system_131846");return v.default.Instance()&&v.default.Instance().setWaitStatus(!1),I.alert(r,n,this,function(){i.instance.exitMiniProgram({})}),!0}return!1},t.prototype.sendErrorReport=function(e,t){g.customReport&&g.customReport("serverlist",{resp:"ServerList\u8fd4\u56de\u5f02\u5e38",status:e,desc:t})},t}(n.Task);e.ServerListTask=a;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.begin=function(){h.log("(LoginTask) \u51c6\u5907\u8fde\u63a5\u670d\u52a1\u5668"),y.NET.connectWithOption(u.default.getGameWsConnectOption(r.GLOBAL.game_ip,r.GLOBAL.GameFallbackDomain)),this.callListener(this.onCompleted)},t}(n.Task);e.ConnectServerTask=o})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Net/NetMgr":"NetMgr","../../Core/Net/WebClient":"WebClient","../../fws/display/MsgBox":"MsgBox","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/task/FWSTask":"FWSTask","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/HttpUtils":"HttpUtils","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/PFOpenData":"PFOpenData","../Common/UIManager":"UIManager","../Const/GameDefine":"GameDefine","../Data/GlobalData":"GlobalData","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs","./LoginFlowOptions":"LoginFlowOptions"}],PlatformInitTask:[function(e,t,a){"use strict";cc._RF.push(t,"ea964E1OfxD05SHURYiE68C","PlatformInitTask"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/task/FWSTask"),n=e("../../fws/mvc/FWSMvc"),i=e("../../fws/platforms/PlatformCore"),r=function(e){function t(){var t=e.call(this)||this;return t.mvcDelegate=new n.FMessageConnectionDelegate(t),t}return __extends(t,e),t.prototype.begin=function(){e.prototype.begin.call(this),this._alreadyBegin||this._alreadyCompoleted||(this._alreadyBegin=!0,this._alreadyCompoleted=!1,i.instance.needPlatformInitTask?(this.mvcDelegate.connect(),i.instance.initPlatformAPIs()):this.callListener(this.onCompleted))},t.prototype.cancel=function(){this.mvcDelegate.disconnect(),e.prototype.cancel.call(this)},t.prototype.reset=function(){this.mvcDelegate.disconnect(),e.prototype.reset.call(this)},t.prototype.onFMessage_PLATFROM_INITED=function(e){this.mvcDelegate.disconnect(),this.callListener(this.onCompleted)},t}(o.Task);a.default=r,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/task/FWSTask":"FWSTask"}],ResetGame:[function(e,t,a){"use strict";cc._RF.push(t,"de4a6/dAstBU7ChtsQ2NrRY","ResetGame"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/NetMgr"),n=e("../Common/UIManager"),i=e("../Data/DataCenter"),r=e("../components/worldmap/WorldMapModel"),s=e("../Common/BIManager"),l=e("../controllers/ExchangeController"),c=e("../controllers/ActivityController"),d=e("../alliance/AllianceController"),p=e("../components/worldmap/controllers/WorldMapController"),u=e("../Common/PFOpenData"),h=e("../Common/ListView/FrameTaskManager"),m=e("../components/worldmap/controllers/WorldMapTodoController"),f=e("../controllers/GrowthFundController"),_=e("../controllers/WelcomeRewardController"),y=e("../components/worldmap/controllers/WorldMarchController"),g=e("../controllers/ItemMergeController"),C=e("../controllers/WorkerController"),v=e("../Module/Home/ResFlyCompent"),I=e("../Data/GuideData"),T=e("../hero/HeroController"),S=e("../Tools/SubPackMsgs"),A=e("../ShareSDK/SDKInner/RGShareMg"),D=e("../../fws/utils/X"),N=e("../Const/GameDefine"),b=e("../../fws/platforms/PlatformCore"),L=e("../../System/JSWrap"),E=e("../../fws/utils/ErrorReport"),P=e("../../fws/display/MsgBox"),w=e("../Profession/ProfessionController"),B=e("../components/worldmap/worldmapui/WorldMapMonsterSearchComponent"),M=e("../Data/MailData"),U=e("../Procedure/ProcedureManager"),R=e("../controllers/ArmyEquipController"),G=e("../Data/UserStaticData"),O=e("../Tools/GameTools"),k=function(){function e(){}return e.doResetGame=function(t,a){if(void 0===a&&(a=!0),w.default.Instance.restartGameCallBack(),a&&b.instance.doReloadGame())return E.trace({resp:"ResetGame@doReloadGame"},"close_socket"),void o.NET.dispose();cc.director.pause(),E.trace({resp:"doResetGame"},"close_socket"),o.NET.dispose(),cc.game.removePersistRootNode(n.default.Instance().node),n.default.Instance().CloseAllUI(),n.default.Instance().node.destroy(),n.default.Instance().clearPool(null),L.default.clearTimeoutAll(),U.PROCE.Purge(),G.USData.Purge(),e.stoHandler&&clearTimeout(e.stoHandler),e.stoHandler=setTimeout(function(){e.purgeData(),cc.director.loadScene("Login",function(e){e?D.log("load login scene error!!!"):cc.director.resume()})},0),E.trace({resp:"ResetGame@\u8f6f\u91cd\u542f"})},e.purgeData=function(){i.DATA.purge(),P.clear(),O.default.GotOtherData=!1,N.HomeMap_LOGIN_OVER=!1,N.MessagePulled=!1,u.default.Instance.purge(),s.default.Instance.purge(),r.getInstance().purge(),p.getInstance().purge(),m.getInstance().purge(),y.Instance.purge(),l.ExchangeController.Instance.purge(),c.ActivityController.Instance.purge(),f.GrowthFundController.Instance.purge(),_.WelcomeRewardController.Instance.purge(),g.ItemMergeController.Instance.purge(),C.WorkerController.Instance.purge(),A.default.getInstance().purge(),d.AllianceController.getInstance().purge(),T.HeroController.getInstance().purge(),h.FrameTaskManager.getInstance().purge(),v.default.purge(),I.default.purge(),b.instance.triggerGC(),B.default.purge(),M.mailManager.clear(),S.send(S.Names.SUBPACK_CHAT_CONTROLLER_CALL,{name:"purge",args:[]}),B.default.monsterList=[],B.default.assembleMonsterList=[],B.default.isInitConfig=!1,R.ArmyEquipController.getInstance().purge(),B.default.resList=[],S.send(S.Names.SUBPACK_PURGE,{})},e.stoHandler=null,e}();a.default=k,window.ResetGame=k,cc._RF.pop()},{"../../Core/Net/NetMgr":"NetMgr","../../System/JSWrap":"JSWrap","../../fws/display/MsgBox":"MsgBox","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/ListView/FrameTaskManager":"FrameTaskManager","../Common/PFOpenData":"PFOpenData","../Common/UIManager":"UIManager","../Const/GameDefine":"GameDefine","../Data/DataCenter":"DataCenter","../Data/GuideData":"GuideData","../Data/MailData":"MailData","../Data/UserStaticData":"UserStaticData","../Module/Home/ResFlyCompent":"ResFlyCompent","../Procedure/ProcedureManager":"ProcedureManager","../Profession/ProfessionController":"ProfessionController","../ShareSDK/SDKInner/RGShareMg":"RGShareMg","../Tools/GameTools":"GameTools","../Tools/SubPackMsgs":"SubPackMsgs","../alliance/AllianceController":"AllianceController","../components/worldmap/WorldMapModel":"WorldMapModel","../components/worldmap/controllers/WorldMapController":"WorldMapController","../components/worldmap/controllers/WorldMapTodoController":"WorldMapTodoController","../components/worldmap/controllers/WorldMarchController":"WorldMarchController","../components/worldmap/worldmapui/WorldMapMonsterSearchComponent":"WorldMapMonsterSearchComponent","../controllers/ActivityController":"ActivityController","../controllers/ArmyEquipController":"ArmyEquipController","../controllers/ExchangeController":"ExchangeController","../controllers/GrowthFundController":"GrowthFundController","../controllers/ItemMergeController":"ItemMergeController","../controllers/WelcomeRewardController":"WelcomeRewardController","../controllers/WorkerController":"WorkerController","../hero/HeroController":"HeroController"}],EventTool:[function(e,t,a){"use strict";cc._RF.push(t,"4e255WREc1B2pA9xVpSlwkr","EventTool");var o,n=e("../../Core/Event/EventCenter"),i=e("../Const/EventId"),r=e("../../fws/utils/X");(function(e){var t={},a=!1;e.emit=function(e){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];a||(a=!0,t[i.EventId.Exp_Update]={inter:1e3},t[i.EventId.Resource_Update]={inter:1e3},t[i.EventId.MapPoint_Update]={inter:1e3},t[i.EventId.Power_UPDATE]={inter:1e3},t[i.EventId.TreasureBoxUpdate]={inter:1e3},t[i.EventId.Quest_Update]={inter:1e3});var l=n.EVENT.emit,c=o.slice(0);c.splice(0,0,e);try{var d=t[e];d&&d.inter>0?(clearTimeout(d.id),d.id=setTimeout(function(){l.apply(n.EVENT,c)},d.inter)):l.apply(n.EVENT,c)}catch(e){r.error(e)}}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../fws/utils/X":"X","../Const/EventId":"EventId"}],GameTools:[function(e,t,a){"use strict";cc._RF.push(t,"67e2394vaNAgbYiLOgRon8Z","GameTools"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../Const/GameDefine"),i=e("../Data/DataCenter"),r=e("../../Core/Utils/GetCompentToAdd"),s=e("../Data/GameConst"),l=e("../../Core/Common/TableManager"),c=e("../Const/TableName"),d=e("../Module/Home/ResFly"),p=e("../../Core/Event/EventCenter"),u=e("../Const/EventId"),h=e("../../fws/utils/FWSTool"),m=e("../../Core/Net/NetMgr"),f=e("../Const/RequestId"),_=e("../Common/UIManager"),y=e("../Scene/SceneManager"),g=e("../Const/SceneName"),C=e("../components/worldmap/WorldMapMsgs"),v=e("../Procedure/ProcedureManager"),I=e("../../Core/Utils/UpdateSpriteFrame"),T=e("../Data/GuideData"),S=e("../Common/LoadManager"),A=e("../../System/CocosWrap"),D=e("../alliance/AllianceWelfarePanel"),N=e("../../fws/display/factory/FWSAssertCaches"),b=e("../Module/Item/PropItem"),L=e("../../fws/utils/LocalStorageUtils"),E=e("../components/worldmap/WorldMapCommon"),P=e("../components/worldmap/controllers/WorldMapController"),w=e("../alliance/AllianceCommon"),B=e("../alliance/AllianceShopNet"),M=e("../../fws/platforms/PlatformCore"),U=e("../Data/BattleData"),R=e("../Const/UIDataInfo"),G=e("../controllers/ExchangeController"),O=e("../Common/ConfirmPanel"),k=e("../Common/BIManager"),x=e("../controllers/ActivityController"),F=e("../Data/GlobalData"),V=e("../Const/GameDefine"),H=e("../Data/PlayerInfo"),W=e("../Common/ListView/FrameTaskManager"),j=e("./PlayerInfoTool"),q=e("../alliance/AllianceController"),K=e("../../fws/utils/X"),Y=e("../Start/ResetGame"),X=e("../components/worldmap/WorldMapModel"),J=e("../components/cointree/CoinTreeComponent"),z=e("../../Core/Common/SoundManager"),Q=e("../Const/SoundPath"),Z=e("../Common/TaskGuide"),$=e("../Profession/ProfessionController"),ee=e("../../fws/display/MsgBox"),te=e("../controllers/QuestController"),ae=e("../../fws/FWSEnv"),oe=(e("../controllers/BuildingController"),e("../Common/icon/IconTool")),ne=e("../Common/icon/IconSystemCommon"),ie=e("../controllers/ThroneController"),re=e("../battleReport/NBattleReportCommon"),se=e("../../Core/Net/NetChatClient"),le=e("./SubPackMsgs"),ce=e("../hero/HeroController"),de=e("../../fws/utils/ErrorReport"),pe=e("../../Core/Utils/Random"),ue=e("../Const/HomeMapCommon"),he=e("../Common/biz/DiffBizTool"),me=e("../controllers/ArmyEquipController"),fe=e("../Module/UI/PropDetailPanel"),_e=e("../Data/UserStaticData"),ye=e("../controllers/ScienceController"),ge=e("../alliance/AllianceScienceNet"),Ce=function(){function e(){}return e.getFloatPercent=function(e,t,a){if(void 0===a&&(a=1),t<=0)return 0;var o=e/t;return a>0&&o>a&&(o=a),o},e.ObjIsEmpty=function(e){return null===e||void 0===e||0==e.length},e.getResourceIcon=function(e){var t="image/Res/";if(e==n.ResourceType.Gold)t+="img_res_xunzhang";else if(e==n.ResourceType.Wood)t+="img_res_mutou";else if(e==n.ResourceType.Oil)t+="img_res_shiyou";else if(e==n.ResourceType.Coin)t+="img_res_jinbi";else if(e==n.ResourceType.Oila)t+="img_res_shiyou";else if(e==n.ResourceType.Metal)t+="img_res_jinshu";else if(e==n.ResourceType.Soil)t+="img_res_xitu";else if(e==n.ResourceType.Coal)t+="img_res_mei";else if(e==n.ResourceType.Energy)t+="img_tili";else if(e==n.ResourceType.Exp)t+="img_jingyan";else if(e==n.ResourceType.Power){t="image/mainui/icon_junxian_1";var a=i.DATA.UserData.getPowerRankData();a&&(t="image/mainui/"+a.icon)}else e==n.ResourceType.Honor?t+="img_res_alliancehonor":e==n.ResourceType.Military?t+="img_res_junxianbi":e==n.ResourceType.islandPoint?t+="img_res_island":e==n.ResourceType.AGExp?t+="img_res_ag_exp":e==n.ResourceType.AGKey?t+="img_res_ag_key":e==n.ResourceType.Voucher?t+="icon_voucher":e==n.ResourceType.BountyCount?t="image/item/item_military_ticket":e==n.ResourceType.AdventureRewardBox?t+="img_rewardbox":e==n.ResourceType.AdventureCoin?t+="img_res_adventure":e==n.ResourceType.kvk_res?t="image/EightCountry/icon_coin_EightCountry":e==n.ResourceType.kvk_honor?t="image/EightCountry/kvk_personal_honor":t+="img_res_jinbi";return t},e.getResourceName=function(t){return o.LOCAL.getText(e.getResourceNameKey(t))},e.getResourceNameKey=function(e){return e==n.ResourceType.Gold?"100017":e==n.ResourceType.Wood?"100018":e==n.ResourceType.Oil?"100019":e==n.ResourceType.Coin?"100020":e==n.ResourceType.Energy?"resource_energy":e==n.ResourceType.Exp?"100492":e==n.ResourceType.Honor?"100021":e==n.ResourceType.Power?"100022":e==n.ResourceType.Oila?"110118":e==n.ResourceType.Metal?"110120":e==n.ResourceType.Soil?"110121":e==n.ResourceType.Coal?"110122":e==n.ResourceType.AdventureCoin?"adventure118":""},e.getColorByQuality=function(e,t){void 0===t&&(t=0);var a=t,o=t,n=t;return 2==e?(a=200,o=118,n=0):3==e?(a=1,o=81,n=180):4==e?(a=208,o=65,n=255):e>=5&&(a=216,o=127,n=0),cc.color(a,o,n)},e.getColorByQualityBlackLine=function(e,t){void 0===t&&(t=255);var a=t,o=t,n=t;return 2==e?(a=143,o=204,n=82):3==e?(a=102,o=152,n=255):4==e?(a=174,o=127,n=237):5==e?(a=243,o=153,n=92):e>=6&&(a=250,o=88,n=43),cc.color(a,o,n)},e.setSpriteFrame=function(t,a,o){void 0===o&&(o=null),""!=t&&S.LoadManager.loadSpriteFrame(t,function(n,i){if(null!=n)K.log(n+" path:"+t);else try{if(!e.verifyComponent(a))return;a.spriteFrame=i,o&&o()}catch(e){K.log(e)}},null)},e.setSpriteFrameFromAtlas=function(t,a,o,n){void 0===n&&(n=null),S.LoadManager.loadResource("setSpriteFrameFromAtlas",t,cc.SpriteAtlas,function(i,r){null!=i?K.log(i+" path:"+t):e.verifyComponent(o)&&(o.spriteFrame=r.getSpriteFrame(a),n&&n())})},e.SetTimeScale=function(e){cc.director.getScheduler().setTimeScale(e)},e.getMapPosList=function(t,a,o,n){for(var i=new Array,r=0;r<n;r++)for(var s=0;s<o;s++){var l=t-r+s,c=a+r+s,d=e.getPosIdByMapPos(l,c);i.push(d)}return i},e.getMapVecPosList=function(e,t,a,o){for(var n=new Array,i=0;i<o;i++)for(var r=0;r<a;r++){var s=e-i+r,l=t+i+r,c=new cc.Vec2(s,l);n.push(c)}return n},e.getAreaIdByPos=function(e,t){if((e+t)%2==0){for(var a=cc.v2(e,t);!((a.x+a.y)%4==0&&(a.x+a.y)%8!=0||(a.x--,a.y--,a.x<0||a.y<0)););for(;a.x%4!=0&&a.y%4!=0&&(a.x++,a.y--,!(a.y<0)););var o,n=l.TABLE.getTableDataByKeyValue(c.TableName.AREA,"pos_x",a.x);for(var i in n)if(n[i].pos_y==a.y){o=n[i];break}return o?o.id:-1}},e.visitAndCheckMapPosList=function(t,a,o,n,i,r){for(var s=0;s<n;s++)for(var l=0;l<o;l++){var c=t-s+l,d=a+s+l;if(!i(e.getPosIdByMapPos(c,d),r))return!1}return!0},e.getWorldPosByServerPointId=function(e){var t=(255&(e-=1))<<1,a=e>>8;return(1&a)>0&&(t+=1),new cc.Vec2(t,a)},e.getMapPosByPosId=function(e){return new cc.Vec2(Math.floor(e/1e3),e%1e3)},e.getPosIdByMapPos=function(e,t){return 1e3*Math.floor(e)+Math.floor(t)},e.checkPosIdIsInCurrentPosId=function(e,t,a,o){var n=~~(e/1e3),i=e%1e3;return this.checkMapPosIsInCurrentPosId(n,i,t,a,o)},e.checkMapPosIsInCurrentPosId=function(e,t,a,o,n){var i=~~(a/1e3),r=a%1e3;return this.checkMapPosIsInCurrentPos(e,t,i,r,o,n)},e.checkMapPosIsInCurrentPos=function(e,t,a,o,n,i){var r=e-a,s=(r+(t-o))/2,l=s-r;return l>=0&&l<i&&s>=0&&s<n},e.setNodeGray=function(e,t){var a=e.getComponentsInChildren(cc.Sprite);if(a)for(var o=0;o<a.length;o++)t?a[o].setState(cc.Sprite.State.GRAY):a[o].setState(cc.Sprite.State.NORMAL)},e.isShowInPlat=function(e){if(!e)return!0;for(var t=e.split("|"),a=0;a<t.length;a++){if("g123"===M.instance.platformSID&&"G123"===t[a])return!0;if(t[a]==M.instance.platformSID)return!0}return!1},e.setNodeColor=function(e,t){var a=e.getComponentsInChildren(cc.Sprite);if(a)for(var o=0;o<a.length;o++)a[o].node.color=t},e.ChangeStrTimeToNumTime=function(e){if(!e)return 0;var t=e.split("-");if(6!=t.length)return 0;var a=t[0]+"/"+t[1]+"/"+t[2]+" "+t[3]+":"+t[4]+":"+t[5];return new Date(a).getTime()/1e3},e.getSimpleTimeShow=function(e,t){if(void 0===t&&(t=!1),e<=0)return"";e=Math.ceil(e);var a=Math.floor(e/3600),n=Math.floor(e%3600/60),i=e%60,r="";if(t&&a>=24){var s=Math.floor(a/24);a%=24,r=s.toString()+" "+o.LOCAL.getText("100004")+"  "}var l=a.toString(),c=n.toString(),d=i.toString();return a<10&&(l="0"+l),n<10&&(c="0"+c),i<10&&(d="0"+d),r+l+":"+c+":"+d},e.getShortTimeShow=function(e){e=Math.ceil(e);var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60,i=Math.floor(t/24);t%=24;var r="";return i>0?(r=i.toString()+o.LOCAL.getText("100004")+"  ",t>0&&(r=r+t.toString()+o.LOCAL.getText("100023"))):t>0?(r=t.toString()+o.LOCAL.getText("100023"),a>0&&(r=r+a.toString()+o.LOCAL.getText("100006"))):a>0?(r=a.toString()+o.LOCAL.getText("100006"),n>0&&(r=r+n.toString()+o.LOCAL.getText("100007"))):r=n.toString()+o.LOCAL.getText("100007"),r},e.getTimeShowWord=function(e){e=Math.ceil(e);var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=Math.floor(t/24),i=e%60;t%=24;var r="";return n>0&&(r=n.toString()+o.LOCAL.getText("100004")+"  "),t>0&&(r=r+t.toString()+o.LOCAL.getText("100023")),a>0&&(r=r+a.toString()+o.LOCAL.getText("100006")),i>0&&(r=r+i.toString()+o.LOCAL.getText("100007")),r},e.getTimeShow=function(e){if(e<=0)return"";e=Math.ceil(e);var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60,i=Math.floor(t/24);t%=24;return i>=30?Math.floor(i/30)+o.LOCAL.getText("100024"):i>0?i.toString()+o.LOCAL.getText("100004")+"  ":t>0?t.toString()+o.LOCAL.getText("100005"):a>0?a.toString()+o.LOCAL.getText("100006"):n.toString()+o.LOCAL.getText("100007")},e.getShortTimeShowSingle=function(e){e=Math.ceil(e);var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60,i=Math.floor(t/24);t%=24;return i>0?i.toString()+o.LOCAL.getText("100004")+"  ":t>0?t.toString()+o.LOCAL.getText("100023"):a>0?a.toString()+o.LOCAL.getText("100006"):n.toString()+o.LOCAL.getText("100007")},e.getShortTimeShowSingleNew=function(e){e=Math.ceil(e);var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60;return t>0?t.toString()+o.LOCAL.getText("100023"):a>0?a.toString()+o.LOCAL.getText("100006"):n.toString()+o.LOCAL.getText("100007")},e.GetTimeShow=function(e,t){void 0===t&&(t=!1);var a=new Date(1e3*e);return"zh_cn"==o.LOCAL.getLanguage()?t?h.Str.dateTimeFormat(a,"M\u6708dd\u65e5\nhh:mm:ss"):h.Str.dateTimeFormat(a,"M\u6708dd\u65e5 hh:mm:ss"):t?h.Str.dateTimeFormat(a,"M-dd\nhh:mm:ss"):h.Str.dateTimeFormat(a,"M-dd hh:mm:ss")},e.GetTimeShowMonthAndDay=function(e,t){void 0===t&&(t=!1);var a=new Date(1e3*e);return"zh_cn"==o.LOCAL.getLanguage()?h.Str.dateTimeFormat(a,"M\u6708dd\u65e5",t):h.Str.dateTimeFormat(a,"M-dd",t)},e.GetTimeShowMonthDayHour=function(e){var t=new Date(1e3*e);return"zh_cn"==o.LOCAL.getLanguage()?h.Str.dateTimeFormat(t,"M\u6708dd\u65e5hh\u65f6"):h.Str.dateTimeFormat(t,"M-dd-hh")},e.GetTimeShowOnlyDay=function(e){var t=new Date(1e3*e);return h.Str.dateTimeFormat(t,"hh:mm:ss")},e.GetTimeShow_Day=function(e,t){void 0===t&&(t=!1);var a=new Date(1e3*e);return"zh_cn"!=o.LOCAL.getLanguage()||t?h.Str.dateTimeFormat(a,"yyyy-MM-dd"):h.Str.dateTimeFormat(a,"yyyy\u5e74MM\u6708dd\u65e5")},e.GetTimeShow_Day2=function(e){var t=new Date(1e3*e);return h.Str.dateTimeFormat(t,"yyyy/MM/dd")},e.isSameDayStampS=function(e,t){var a=new Date(1e3*e);t||(t=i.DATA.ServerTime);var o=new Date(1e3*t);return a.getFullYear()==o.getFullYear()&&a.getMonth()==o.getMonth()&&a.getDate()==o.getDate()},e.checkConfigForceUpdate=function(e){return!(i.DATA&&i.DATA.UserData&&!i.DATA.UserData.FunctionOn(n.FunctionKey.CONFIG_FORCE_UPDATE))&&(!L.get("GM_ConfigType")&&(!!window.OnlineServer&&(!(i.DATA&&i.DATA.UserData&&i.DATA.UserData.Level<5)&&(!!(e&&h.Str.versionCompare(F.GLOBAL.DynResVer,e)<0)&&(de.custom("ConfigForceUpdate",{resp:"ForceUpdateVer:"+e+",curVer:"+F.GLOBAL.DynResVer}),ee.alert(o.LOCAL.getText("client_updata_tips"),o.LOCAL.getText("system_131845"),this,function(){Y.default.doResetGame(!0)}),!0)))))},e.checkHomeBoxLegal=function(t,a,o,n,i,r,s){void 0===s&&(s=-1);for(var l=e.getMapPosList(t,a,o,n),c=!0,d=0;d<l.length;d++){var p=l[d];if(i==V.BaseItemType.Army){if(!e.checkArmyLegalInPoint(r,p)){c=!1;break}}else if(i==V.BaseItemType.Building&&!e.checkBuildingLegalInPoint(r,p,s)){c=!1;break}}return c},e.checkBuildingLegalInPoint=function(e,t,a){void 0===a&&(a=-1);var o=ue.HomeMapTileBlockTypeTable[t];if(-1!=a&&o!=a)return!1;switch(o){case ue.HomeMapTileBlockType.LimitBuildingAndAllArmy:var n=l.TABLE.getTableDataById(c.TableName.BUILDING,String(e));if(n&&ue.HomeMapTileBlockType1_BuildingTypes.indexOf(n.type)>=0)return!1}return!0},e.checkArmyLegalInPoint=function(e,t){switch(ue.HomeMapTileBlockTypeTable[t]){case ue.HomeMapTileBlockType.LimitBuildingAndAllArmy:return!1}return!0},e.checkArmyLegalInAreea=function(e,t){var a=l.TABLE.getTableDataById(c.TableName.AREA,String(t));return!a||a.block_type!=ue.HomeMapTileBlockType.LimitBuildingAndAllArmy},e.checkBoxLegal=function(t,a,o,n,i){return void 0===i&&(i=-1),e.visitAndCheckMapPosList(t,a,o,n,e.checkPointLegal,i)},e.checkPointLegal=function(e,t){void 0===t&&(t=-1);var a=i.DATA.UserData.HomeFreePoints,o=i.DATA.UserData.HomeItemPoints,r=i.DATA.UserData.HomeObstaclePoints,s=i.DATA.UserData.GroundPoints,l=!1;if(void 0!=o[e]&&null!=o[e]){var c=o[e].itemType;-1!=c&&c!=t&&(l=!0)}var d=!1;t!=n.MapPointType.Board&&(d=1==s[e]);var p=1==a[e],u=1==r[e];return 0==l&&1==p&&0==u&&0==d},e.CheckFreenPoints=function(e){return 1==i.DATA.UserData.HomeFreePoints[e]},e.checkBoxTypeLegal=function(t,a,o,n,i){for(var r=!0,s=e.getMapPosList(t,a,o,n),l=0;l<s.length;l++)if(0==e.checkPointTypeLegal(s[l],i)){r=!1;break}return r},e.checkPointTypeLegal=function(e,t){var a=i.DATA.UserData.MapPoints,o=0;return null!=a[e]&&void 0!=a[e]&&(o=a[e]),o==t},e.getHomePointType=function(e,t){var a=0;return null!=t[e]&&void 0!=t[e]&&(a=t[e]),a},e.SortQuestList=function(t){t.sort(e.QuestSort)},e.QuestSort=function(e,t){return e.Order>t.Order?1:e.Order<t.Order?-1:e.Id-t.Id},e.DestoryNode=function(e,t){if(void 0===t&&(t=0),e){var a=r.GetCompentToAdd(e,"EffectPlay");a.cpnScheduleOnce(a,a.PlayEnd,t)}},e.getRandomNum=function(e,t){var a=Math.floor(1e3*Math.random());return a=a%(t-e+1)+e},e.convertStringToTwoDimensionalArray=function(e){for(var t=[],a=e.split("|"),o=0;o<a.length;++o){var n=a[o].split(",");t.push(n)}return t},e.convertStringToArray=function(e){for(var t=[],a=e.split("|"),o=0;o<a.length;++o){var n=a[o];t.push(n)}return t},e.PlayClickAni=function(t){if(e.verifyNode(t)){var a=cc.jumpBy(.2,cc.v2(0,0),10,1);a.easing(cc.easeSineOut()),t.runAction(a)}},e.getBaseItemZIndexByMapPos=function(e,t){void 0===t&&(t=0);var a=10*e.y;return t>0&&(a+=10*t),a},e.getMapPos=function(e){var t=s.default.BW*s.default.MS,a=s.default.BH*s.default.MS,o=2*Math.floor(e.x/t),n=2*Math.floor(-e.y/a),i=new cc.Vec2(e.x-o*t/2,-e.y-n*a/2);if(i.x<t/2){var r=(t/2-i.x)*(a/t);i.y<r?(o-=1,n-=1):i.y>a-r&&(o-=1,n+=1)}else{r=(i.x-t/2)*(a/t);i.y<r?(o+=1,n-=1):i.y>a-r&&(o+=1,n+=1)}return new cc.Vec2(o,n)},e.getNodePos=function(e){var t=s.default.BW*s.default.MS,a=s.default.BH*s.default.MS,o=-a/2,n=t/2+e.x*t/2,i=o-e.y*a/2;return new cc.Vec2(n,i)},e.JSON_PARSE=function(e){var t=null;if(null===e||void 0===e)return t;if("string"!=typeof e)return t;if(e.length<=0)return t;try{t=JSON.parse(e)}catch(t){K.warn("JSON_PARSE error json string = ",e)}return t},e.deleteNode=function(e,t){void 0===t&&(t=!0),cc.isValid(e)&&(t?e.destroy():e.removeFromParent(!1))},e.deleteAllChildren=function(e,t){void 0===t&&(t=!0),cc.isValid(e)&&(t?e.destroyAllChildren():e.removeAllChildren(!1))},e.deleteAllChildrenExcept=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(cc.isValid(e)){if(t.length>0)for(var o=0,n=t.length;o<n;++o)t[o].parent==e&&t[o].removeFromParent();e.safetyDestroyAllChildren()}},e.BuildBuildingCheck=function(t){var a="",o=l.TABLE.getTableDataById(c.TableName.BUILDING,t.toString());if(null==o)return"";for(var r=0,s=i.DATA.UserData.Buildings,d=0;d<s.length;d++)s[d].BuildingId==o.id&&r++;return""==(a=e.CheckResourceEnough(n.ResourceType.Coin,o.build_coin,r))&&(a=e.CheckResourceEnough(n.ResourceType.Wood,null,r)),""==a&&(a=e.CheckResourceEnough(n.ResourceType.Oil,o.build_oli,r)),a},e.CheckResourceEnough=function(t,a,n){var r="";if(null!=a){var s=a.toString().split(",",9999),l=n;l>=s.length&&(l=s.length-1);var c=parseInt(s[l]);if(c<=0)return r;i.DATA.UserData.Resource.getResource(t)<c&&(r=e.getResourceName(t)+o.LOCAL.getText("100279"))}return r},e.GetLargeNumberShow=function(e){if(h.Obj.isEmpty(e))return"";if(e<=0)return"0";var t="",a=new Array;a.push("K"),a.push("M"),a.push("B"),a.push("T"),a.push("aa"),a.push("bb"),a.push("cc"),a.push("dd"),a.push("ee"),a.push("ff"),a.push("gg"),a.push("hh"),a.push("ii"),a.push("jj"),a.push("kk"),a.push("ll"),a.push("mm"),a.push("nn"),a.push("oo"),a.push("pp"),a.push("qq"),a.push("rr"),a.push("ss"),a.push("tt"),a.push("uu"),a.push("vv"),a.push("ww"),a.push("xx"),a.push("yy"),a.push("zz");for(var o=0;o<a.length;o++){for(var n=1e3,i=o+1;i<a.length;i++)n*=1e3;if(e>=n){var r=2;e>100*n?r=0:e>10*n&&(r=1),t=(e/n).toFixed(r)+a[a.length-o-1];break}}return""==t&&(t=e.toString()),t},e.getHomeItemFakerPowerByLevel=function(e){if(e<=10)return 1;var t=-.3005*Math.pow(e,3)+42.431*Math.pow(e,2)-809.6*e+4249;return(t=Math.floor(t))<1&&(t=1),t},e.AddCoinCostExp=function(t,a){var o=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"2004").value,n=Math.floor(t/o);n>0&&(p.EVENT.emit(u.EventId.Exp_Lock),y.default.Instance().CurSceneName==g.SceneName.HOME&&null!==_.default.Instance().HomeMap?d.default.FlyFromPos(_.default.Instance().HomeMap.convertContainerToWorldPos(a.position),{exp:n},1,0,null,e.ResFlyCallBack):d.default.Fly(a,{exp:n},1,0,null,e.ResFlyCallBack,_.default.Instance().flyLayer))},e.AddCoinCostExpByPos=function(t,a){var o=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"2004").value,n=Math.floor(t/o);n>0&&(p.EVENT.emit(u.EventId.Exp_Lock),y.default.Instance().CurSceneName==g.SceneName.HOME&&null!==_.default.Instance().HomeMap&&d.default.FlyFromPos(_.default.Instance().HomeMap.convertContainerToWorldPos(a),{exp:n},1,0,null,e.ResFlyCallBack))},e.AddHomeItemPowerAddFly=function(t,a){t>0&&(y.default.Instance().CurSceneName==g.SceneName.HOME&&null!==_.default.Instance().HomeMap?d.default.FlyFromPos(_.default.Instance().HomeMap.convertContainerToWorldPos(a.position),{power:t}):d.default.Fly(a,{power:t},1,0,null,e.ResFlyCallBack,_.default.Instance().flyLayer))},e.AddCoinCostExpByPosInUI=function(t,a,o){void 0===o&&(o=null);var n=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"2004").value,i=Math.floor(t/n);i>0&&(p.EVENT.emit(u.EventId.Exp_Lock),d.default.FlyFromPos(a,{exp:i},1,0,o,e.ResFlyCallBack,_.default.Instance().flyLayer))},e.ResFlyCallBack=function(){p.EVENT.emit(u.EventId.Exp_UnLock)},e.FilterText=function(e){return e.replace(/\<[^\>]*\>/g,"")},e.canPay=function(){var e=this._PlayformPayEnable;return null!==e&&void 0!==e||(this._PlayformPayEnable=e=M.instance.canPay()),i.DATA.UserData.FunctionOn(n.FunctionKey.vip2_show_gift)&&i.DATA.UserData.VipLevel>=2?e:!!i.DATA.UserData.FunctionOn(n.FunctionKey.Pay)&&e},e.getProvinceByWorldId=function(e){var t="",a=l.TABLE.getTableDataById(c.TableName.PROVINCE,e);return t=h.Obj.getPropertyByNames(a,"","name"),0===(t=o.LOCAL.getText(t)).length&&(t=o.LOCAL.getText("101056")),t},e.CheckBuildingNumMax=function(e){if(0==e.build_count)return!1;for(var t=0,a=i.DATA.UserData.Buildings,o=0;o<a.length;o++)a[o].Data&&a[o].Data.type==n.MapPointType.Headquarters?a[o].Data.group==e.group&&t++:a[o].BuildingId==e.id&&t++;var r=e.build_count;return 16==e.type?r+=i.DATA.UserData.Buff.getBuffAddValue(V.BuffType.AddWareHouseBuild,"ArmyType",101):17==e.type?r+=i.DATA.UserData.Buff.getBuffAddValue(V.BuffType.AddWareHouseBuild,"ArmyType",201):18==e.type&&(r+=i.DATA.UserData.Buff.getBuffAddValue(V.BuffType.AddWareHouseBuild,"ArmyType",301)),t>=r},e.CheckScienceLevelUpEnable=function(t){return null!=t&&(0!=e.CheckScienceLevelUpConditionEnough(t)&&i.DATA.UserData.getItemAmount(t.item_id)>=t.item_amount)},e.CheckScienceLevelUpConditionEnough=function(e){if(null==e)return!1;if(e.unlock_level>i.DATA.UserData.Level)return!1;if(0!=e.condition_science)for(var t=(e.condition_science+"").split(","),a=0;a<t.length;a++){var o=l.TABLE.getTableDataById(i.DATA.UserData.scienceTableName,t[a]);if(void 0!=o){var n=i.DATA.UserData.getScienceByGroupId(o.group_id);if(h.Obj.getPropertyByNames(n,0,"Data","level")<o.level)return!1}}return!0},e.HaveLevelUpEnableScience=function(t){void 0===t&&(t=1);var a=l.TABLE.getTableGroup(i.DATA.UserData.scienceTableName),o={};for(var n in a){var r=a[n];if(-1==t||r.tree_type==t){var s=r.group_id;if(null==o[s]){var c=i.DATA.UserData.getScienceByGroupId(s);null!=c?c.ScienceId<r.id&&(o[s]=r):o[s]=r}}}var d=!1;for(var n in o){r=o[n];if(1==e.CheckScienceLevelUpEnable(r)){d=!0;break}}return d},e.VisitPlayer=function(t,a){if(void 0===a&&(a=null),0!=i.DATA.UserData.CheckIsMyFriend(t)){if(1!=e.VisitLock){e.VisitLock=!0;var n={uid:t};m.NET.send(f.RequestId.VISIT,n,this,function(t){var o=e.JSON_PARSE(t.d);e.VisitLock=!1,o&&(_.default.Instance().CloseAllUI(),i.DATA.UserData.UpdateVisitData(o),i.DATA.UserData.VisitClientData={fromScene:y.default.Instance().CurSceneName,fromPanel:a},v.PROCE.Run(v.PROCE.HomeOther))})}}else _.default.Instance().ShowTips(o.LOCAL.getText("100026"))},e.ItemUse=function(t,a,n){if(i.DATA.UserData.getItemAmount(t)<a)_.default.Instance().ShowTips(o.LOCAL.getText("100112"));else{var r={itemid:t,amount:a};m.NET.send(f.RequestId.ITEM_USE,r,this,function(t){if(0==t.s&&n){z.SOUND.playClip(Q.SoundPath.Open_Box);var a=e.JSON_PARSE(t.d),o={serverReward:a.box?a.box:a};_.default.Instance().OpenUI(R.UIDataInfo.CommonRewardPanel,o)}})}},e.createSpriteNode=function(){var e=(new cc.Node).addComponent(cc.Sprite);return e.trim=!1,e.sizeMode=cc.Sprite.SizeMode.RAW,e},e.UpdatePropIcon=function(e,t){var a=l.TABLE.getTableDataById(c.TableName.ITEM,e.toString());if(a)if(a.type===V.ItemType.HeroPatch||a.type===V.ItemType.CastleFacePatch||a.type===V.ItemType.ArmyLineSkinPatch){I.UpdateSpriteFrame(a.icon,t);var o=t.node.getChildByName("patch");o&&I.UpdateSpriteFrame("image/hero/hero_chip_old_"+a.quality,o.getComponent(cc.Sprite))}else I.UpdateSpriteFrame(a.icon,t)},e.UpdateBuildingIcon=function(e,t,a){if(void 0===a&&(a=null),e){var o=e;oe.updateBuildingIcon(t.node,o,ne.IconSize.MEDIUM)}},e.UpdateArmyIcon=function(e,t,a,o,n){void 0===a&&(a=null),void 0===o&&(o=-1),void 0===n&&(n=!1);var i=null;if(e){var r=o;r<0&&(r=$.default.Instance.ProfessionId);var s=e.orign_model;r>0&&e.pro_model&&ae.USE_PROFESS_MODEL&&(s=e.pro_model),i=l.TABLE.getTableDataById(c.TableName.MODEL,s.toString())}oe.updateModelIcon(t.node,i,ne.IconSize.MEDIUM)},e.getBuildingBuffDesc=function(t){var a=l.TABLE.getTableDataById(c.TableName.BUILDING,t.toString());if(!a)return"";if(a.treasure_buffdisplay)return o.LOCAL.getText(a.treasure_buffdisplay);var n={},i=a.buff_id;if(null==i||""==i)return"";for(var r=i.split(","),s=0;s<r.length;s++){var d=r[s].split("|"),p=parseInt(d[0]),u=parseInt(d[1]),h=0;null!=n[p]&&void 0!=n[p]&&(h=n[p]),n[p]=h+u}var m="";for(var f in n){var _=l.TABLE.getTableDataById(c.TableName.EFFECTBUFF,f.toString()),y=o.LOCAL.getText(_.string.toString()),g=e.getBuffValueShow(n[f],_.value_type),C=" ";1==_.is_minus?C=" - ":0==_.is_minus&&(C=" + "),m=y+C+g;break}return m},e.getArmyName=function(e,t){void 0===t&&(t=-1);var a=l.TABLE.getTableDataById(c.TableName.ARMY,String(e));if(!a)return"";var n=t;-1==t&&(n=$.default.Instance.ProfessionId);var i=a.name;n>0&&a.new_name&&(i=a.new_name);var r=a.orign_model;n>0&&a.pro_model&&(r=a.pro_model);var s=l.TABLE.getTableDataById(c.TableName.MODEL,String(r));return s&&s.name&&(i=s.name),o.LOCAL.getText(i)},e.getArmyDataByTypeAndLevel=function(e,t){var a=null,o=l.TABLE.getTableGroup(c.TableName.ARMY);for(var n in o){var i=o[n];if(i.type==e&&i.level==t){a=i;break}}return a},e.getItemName=function(e){if(!e)return"";if(e.treasurekey_para){var t=e.treasurekey_para.split("|");if(2==t.length)return o.LOCAL.getText(t[0])+t[1]}return o.LOCAL.getText(e.name)},e.ItemMoveTo=function(e,t,a,o,n){if(void 0===o&&(o=.8),void 0===n&&(n=null),null!=_.default.Instance()&&null!=t){var i=_.default.Instance().flyLayer;e.parent=i;var r=new cc.Vec2(0,0),s=t.convertToWorldSpaceAR(r);s=i.convertToNodeSpaceAR(s),e.position=s;var l=a.convertToWorldSpaceAR(r);l=i.convertToNodeSpaceAR(l);var c,d=cc.moveTo(o,l),p=A.default.callFunc(function(){e.destroy()},this);c=null==n?cc.sequence(d,p):cc.sequence(n,d,p),e.runAction(c)}},e.ReceiveArmyAnime=function(t,a,o){if(null!=_.default.Instance()&&null!=_.default.Instance().MainUINode){var n=l.TABLE.getTableDataById(c.TableName.ARMY,t.toString());if(null!=n&&e.verifyComponent(_.default.Instance().MainUI)){var i=_.default.Instance().MainUI.bagNode,r=cc.instantiate(a),s=r.getComponent("ArmyItem");s.IsPlayClickAni=!0,s.UpdateItem(n,this),s.MergeEnable=!1,s.SetBuildingItem(null),s.SimplifyItem(),e.ItemMoveTo(r,o,i,.8)}}},e.PopupWelcomeUI=function(){1!=T.default.getInst().IsInGuide()&&e.CheckAtiIndulgedGameEnable()&&(e.CheckUnlockNewAreaGuide()||1!=e.WelcomeUIShowed&&(e.WelcomeUIShowed=!0,i.DATA.UserData.Level<6||1!=G.ExchangeController.AutoPopupView2()&&(e.PopupIosAppPanel(-1)||x.ActivityController.Instance.checkPopUpSevenDayReward()||D.default.AutoPupupView())))},e.PopupIosAppPanel=function(t){if(0==i.DATA.UserData.FunctionOn(n.FunctionKey.Download_Appios))return!1;if(!M.instance.isIos()||Boolean(_.default.Instance().MainUI.checkIsBind())||M.instance.disablePopGoToApp)return!1;var a=parseInt(e.getDataConfigData(23112)),o=parseInt(e.getDataConfigData(23205)),r=!1;return t>0?t!=a&&t!=o||(r=!0,_.default.Instance().OpenUI(R.UIDataInfo.GoToAppPanel,{})):i.DATA.UserData.Level>=o&&(r=!0,_.default.Instance().OpenUI(R.UIDataInfo.GoToAppPanel,{})),r},e.CheckUnlockNewAreaGuide=function(){if(!i.DATA.UserData.FunctionOn(n.FunctionKey.city_extra))return!1;if(1==i.DATA.UserData.getLocalData(V.LocalDataKey.NewAreaGuide,0))return!1;var t=parseInt(e.getDataConfigData(132112));if(i.DATA.UserData.myLandAreasCount<t)return!1;var a=_.default.Instance().HomeMap;return!(!a||null==a.getUnLockArea(!0,1308))&&(Z.default.Instance.StartSpecialGuide(6501,0),i.DATA.UserData.setLocalData(V.LocalDataKey.NewAreaGuide,1),!0)},e.DelayPullMessage=function(){1!=V.MessagePulled&&(V.MessagePulled=!0,e.PullAllianceHelpMessage(),e.PullAllianceShopData(),e.PullMyCastleFaceData(),e.PullMyProfessionalTowersData(),e.PullMyArmyEquipData())},e.PullAllianceHelpMessage=function(){0!=i.DATA.UserData.FunctionOn(n.FunctionKey.AllianceHelp)&&0!=i.DATA.UserData.Alliance.isInAlliance()&&m.NET.send(f.RequestId.ALLIANCE_GET_HELPLIST,null,this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.Alliance.UpdateAllianceHelpData(a,!0)}})},e.PullAllianceShopData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.AllianceShop)&&i.DATA.UserData.Alliance.isInAlliance()&&B.default.getShopData()},e.PullMyCastleFaceData=function(){var t=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"19102");t&&(i.DATA.UserData.Level<t.value||m.NET.send(f.RequestId.GET_MY_CASTLE_FACE,null,this,function(t){var a=e.JSON_PARSE(t.d);e.ObjIsEmpty(a)||i.DATA.UserData.UpdateMyCastleFace(a)}))},e.canGetVideoDiamondByMonthlyCard=function(){return i.DATA.UserData.FunctionOn(n.FunctionKey.monthly_card_video_diamond)&&(G.ExchangeController.Instance.isMonthlyCardInTime(G.ExchangeController.MONTHLYCARD_SHIT_ID_2)||G.ExchangeController.Instance.isMonthlyCardInTime(G.ExchangeController.ADVANCE_MONTHLYCARD_SHIT_ID_2)||G.ExchangeController.Instance.isMonthlyCardInTime(G.ExchangeController.MONTHLYCARD_SHIT_ID_NEW))},e.PullMyArmyEquipData=function(){me.ArmyEquipController.getArmyGroupData()},e.checkSkinHaveSpecialSkin=function(e){if(i.DATA.UserData.FunctionOn(n.FunctionKey.SpecialCastleSkin)){var t=i.DATA.UserData.MyCastleFace[e];if(t&&(t.specialEndTime<0||t.specialEndTime>i.DATA.ServerTime))return!0}return!1},e.PullMyProfessionalTowersData=function(){var t=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"61001");t&&(i.DATA.UserData.Level<t.value||m.NET.send(f.RequestId.GET_TOWER_LIST,null,this,function(t){var a=e.JSON_PARSE(t.d);e.ObjIsEmpty(a)||i.DATA.UserData.UpdateMyProfessionalTowers(a)}))},e.getDataConfigData=function(e){var t="",a=l.TABLE.getTableDataById(c.TableName.DATACONFIG,e.toString());return h.Obj.isEmpty(a)||(t=a.value.toString()),t},e.GetGoldVideoShowMaxCount=function(){var t=10,a=e.getDataConfigData(132100);return""!=a&&(t=Number(a)),t},e.CheckGoldVideoShowMax=function(t){void 0===t&&(t=!0);var a=e.GetGoldVideoShowMaxCount();if(i.DATA.UserData.GoldVideoCount>=a){if(t){var n=o.LOCAL.getText("100027")+i.DATA.UserData.GoldVideoCount.toString()+"/"+a.toString()+o.LOCAL.getText("101002");_.default.Instance().ShowTips(n)}return!0}return!1},e.GetVideoShowMaxCount=function(){var t=10,a=e.getDataConfigData(132101);return""!=a&&(t=Number(a)),t},e.CheckVideoShowMax=function(t){if(void 0===t&&(t=!0),!i.DATA.UserData.FunctionOn(n.FunctionKey.freevideo_timeschange))return!1;var a=e.GetVideoShowMaxCount();if(i.DATA.UserData.FunctionVideoCount>=a){if(t){var r=o.LOCAL.getText("100027")+i.DATA.UserData.FunctionVideoCount.toString()+"/"+a.toString()+o.LOCAL.getText("101002");_.default.Instance().ShowTips(r)}return!0}return!1},e.VideoRewardGet=function(t,a,o,n,r,s,l){if(void 0===a&&(a=""),void 0===o&&(o=""),void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=!0),t==V.VideoRewardType.NewGetDiamond){if(this.CheckGoldVideoShowMax())return!1}else if(this.CheckVideoShowMax())return!1;var c={type:t,param1:a,param2:o};return de.trace({resp:"requestServer",data:JSON.stringify({para:c,c:f.RequestId.VideoRewardGet})},"video"),m.NET.send(f.RequestId.VideoRewardGet,c,this,function(t){if(0==t.s&&null!=t.d){de.trace({resp:"serverResponse",data:JSON.stringify({c:f.RequestId.VideoRewardGet})},"video");var a=e.JSON_PARSE(t.d),o=h.Obj.getPropertyByNames(a,null,"dayGoldVideoCount");void 0!=o&&i.DATA.UserData.updateDayGoldVideoCount(o);var c=h.Obj.getPropertyByNames(a,null,"dayFunctionVideoCount");if(void 0!=c&&i.DATA.UserData.updateDayFunctionVideoCount(c),1==l){var p=h.Obj.getPropertyByNames(a,null,"resource");if(null!=p){var u=_.default.Instance().flyLayer;e.verifyNode(n)&&(u=n),d.default.Fly(u,p,1,0,null,null,_.default.Instance().flyLayer)}}}s.call(r,t)},!0),!0},e.GetTimeOfDay=function(){var e=new Date;return 31*e.getMonth()+e.getDate()},e.getEquipExchangeGiftConfig=function(t){var a=null,o=G.ExchangeController.Instance.getCanPayExchangeConfigArrayByType(V.GiftType.EQUIP_GIFT);if((-1==t||t>i.DATA.ServerTime)&&o.length>0)a=o[0];else{o=G.ExchangeController.Instance.getCanPayExchangeConfigArrayByType(V.GiftType.PREFERENTIAL_GIFT);var n=e.getDataConfigData(130063).split(",");if(o.length>0)for(var r=0;r<n.length;r++){for(var s=parseInt(n[r]),l=0;l<o.length;l++)if(s==o[l].id){a=o[l];break}if(null!=a)break}}return a},e.getItemDesc=function(e){var t=l.TABLE.getTableDataById(c.TableName.ITEM,e.toString());if(!t)return"";var a="";if(t.type===V.ItemType.PowerItem){var n=t.desc,r=0,s=0,d=l.TABLE.getTableDataById(c.TableName.ENHANCE,t.id.toString()),p=i.DATA.UserData.getSameGroupItemIdByLv(t.group,t.level+1),u=l.TABLE.getTableDataById(c.TableName.ITEM,p.toString()),h=l.TABLE.getTableDataById(c.TableName.ENHANCE,p.toString()),m=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"11101");if(d){var f=l.TABLE.getTableDataById(c.TableName.EFFECTBUFF,d.buff_land.toString());if(f&&(r=Math.ceil(d.para/f.value_type*100)),n=o.LOCAL.getText(t.desc,r.toString())+o.LOCAL.getText("100515"),u&&h&&m){var _=l.TABLE.getTableDataById(c.TableName.EFFECTBUFF,h.buff_land.toString());_&&(s=Math.ceil(h.para/_.value_type*100)),n+=o.LOCAL.getText("100516",m.value),n+=o.LOCAL.getText("enhance_item_desc_01",s-r+"%")}}a=n}else if(42==t.type){var y=l.TABLE.getTableDataById(c.TableName.HEROSKILL,t.para1);a=1e4==l.TABLE.getTableDataById(c.TableName.EFFECTBUFF,y.effect).value_type?o.LOCAL.getText(t.desc,String((Number(y.para)+ce.HeroController.getInstance().getSkillBuff(y.para_equip_skill,t.level))/100)):o.LOCAL.getText(t.desc,String(Number(y.para)+ce.HeroController.getInstance().getSkillBuff(y.para_equip_skill,t.level)))}else if(72==t.type){a=(g=t.para1.split("|")).length>1?o.LOCAL.getText(t.desc,String(g[1]/100)):o.LOCAL.getText(t.desc)}else if(73==t.type){var g;a=(g=t.para1.split("|")).length>2?o.LOCAL.getText(t.desc,String(g[1]/60),String(g[2]/60)):o.LOCAL.getText(t.desc)}else if(75==t.type){var C=l.TABLE.getTableDataById(c.TableName.TRAPS_EFFECT,t.para1);a=C&&void 0!=C.para1?o.LOCAL.getText(t.desc,String(C.para1/100)):o.LOCAL.getText(t.desc)}else{if(t.type==V.ItemType.MakeEnemyBuffTowerItem)return t.para1?o.LOCAL.getText(t.desc,String(t.para1/60)):o.LOCAL.getText(t.desc);a=o.LOCAL.getText(t.desc)}return a},e.verifyComponent=function(e){return void 0!==e&&null!==e&&(!!e.isValid&&(!!e.node&&!!e.node.isValid))},e.verifyNode=function(e){return void 0!==e&&null!==e&&e.isValid},e.checkCanBatchMerge=function(){return!(i.DATA.UserData.Level<8)&&(0!=i.DATA.UserData.FunctionOn(n.FunctionKey.BatchMerge)&&0!=i.DATA.UserData.ABFunctionOn("BatchMerge"))},e.isiPhoneX=function(){if("undefined"!=typeof window&&window){var e=window.devicePixelRatio,t=window.screen,a=t.width,o=t.height;return[{devicePixelRatio:3,width:375,height:812},{devicePixelRatio:3,width:414,height:896},{devicePixelRatio:2,width:414,height:896},{devicePixelRatio:3,width:392,height:800}].some(function(t){return t.devicePixelRatio===e&&t.width===a&&t.height===o})}return!1},e.AutoFixPanelForIphoneX=function(e){var t=e.getComponent(cc.Widget);if(null!=t&&0==t.top&&0==t.bottom){var a=cc.view.getVisibleSize();a.height/a.width>2&&(t.top=65280/1125,t.bottom=0)}},e.AddItemNodeToParent=function(e,t,a){void 0===a&&(a=1);var o=cc.instantiate(t);return o.active=!0,o.setScale(a),o.parent=e,o.position=cc.Vec2.ZERO,o},e.AddPropItemToParent=function(e,t,a,o,n){void 0===o&&(o=!0),void 0===n&&(n=1);var i=cc.instantiate(N.getPrefab("ea_prefab/item/PropItem"));i.setScale(n),i.parent=e;var r=i.getComponent(b.default);r.UpdateItem(t,a),r.SetClick(o)},e.AddPropItemToNode=function(e){var t=cc.instantiate(N.getPrefab("ea_prefab/item/PropItem"));return t.parent=e,t.getComponent(b.default)},e.AddRewardToNode=function(t,a,o,n,i,r,s){if(void 0===o&&(o=0),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===r&&(r=!0),a){var d=l.TABLE.getTableDataById(c.TableName.REWARD,a.toString());if(null!=d)for(var p=e.ParseRewardToRewardItemList(d),u=0;u<p.length&&!(o>0&&u>=o);u++){var h=p[u];e.addOnePropItemToTargetNode(h,t,i,n,r,s)}}},e.ParseRewardToRewardItemList=function(t){var a=new Array;return e.ParseRewardItem(n.ResourceType.Building,t.building.toString(),t.building_num.toString(),a),e.ParseRewardItem(n.ResourceType.Army,t.army_id.toString(),t.army_num.toString(),a),e.ParseRewardItem(n.ResourceType.Item,t.item.toString(),t.num.toString(),a),e.ParseRewardResource(n.ResourceType.Gold,t.gold,a),e.ParseRewardResource(n.ResourceType.Coin,t.coin,a),e.ParseRewardResource(n.ResourceType.Energy,t.energy,a),a},e.AddServerRewardToNode=function(t,a,o,i,r){if(void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===r&&(r=!0),a){var s=new Array;e.ParseServerRewardItemData(n.ResourceType.Item,a.items,s),a.resource?(e.ParseRewardResource(n.ResourceType.Gold,a.resource.gold,s),e.ParseRewardResource(n.ResourceType.Coin,a.resource.coin,s),e.ParseRewardResource(n.ResourceType.AdventureCoin,a.resource.expedition_coin,s)):e.ParseRewardResource(n.ResourceType.Exp,a.exp,s);for(var l=0;l<s.length;l++){var c=s[l];e.addOnePropItemToTargetNode(c,t,i,o,r)}}},e.ParseServerRewardItemData=function(e,t,a){if(t&&0!=t.length)for(var o=0;o<t.length;o++){var i=new n.RewardItemData(e,t[o].itemCount,t[o].itemId);Number.isNaN(i.Count)||i.Count<=0||a.push(i)}},e.CutStringInMaxLength=function(e,t){var a=e,o=a.split("\\n");a=(a=o[0]).replace(/\s+/g," ");var n=!1;if(o.length>1&&(n=!0),a.length>t){for(var i=a.length,r=0,s=0;s<a.length;s++)if(a.charCodeAt(s)>255?r+=1:r+=.6,r>t){i=s;break}i<a.length&&(a=a.substr(0,i),n=!0)}return n&&(a+="..."),a},e.addOnePropItemToTargetNode=function(t,a,o,i,r,s){var l=function(){if(e.verifyNode(a)){var r=cc.instantiate(N.getPrefab("ea_prefab/item/PropItem")),l=r.getComponent(b.default);r.parent=a;var c=t.Count;0==o&&(c=0),t.Type==n.ResourceType.Building?l.UpdateBuildingItem(t.ItemId,c):t.Type==n.ResourceType.Army?l.UpdateArmyItem(t.ItemId,c):t.Type==n.ResourceType.Item?l.UpdateItem(t.ItemId,c):l.UpdateRes(t.Type,t.Count),s&&l.setExtraData({exchangeId:s}),l.SetClick(i)}}.bind(this);if(r)l();else{var c=new W.FrameTask(l,"AddPropItem");W.FrameTaskManager.getInstance().addTask(c)}},e.ParseRewardItem=function(e,t,a,o){if(""!=t&&""!=a){var i=t.split("|"),r=a.split("|");if(!(0==i.length||i.length>r.length))for(var s=0;s<i.length;s++){var l=new n.RewardItemData(e,parseInt(r[s]),parseInt(i[s]));if(Number.isNaN(l.Count)||l.Count<=0)return;o.push(l)}}},e.ParseRewardResource=function(e,t,a){if(!(t<0)&&t){var o=new n.RewardItemData(e,t,0);Number.isNaN(o.Count)||o.Count<=0||a.push(o)}},e.ParseMessageStringWithPara=function(e){for(var t=new Array,a=e.p,n=0;n<a.length;n++){var i=a[n];1==i.t?t.push(o.LOCAL.getText(i.v)):t.push(i.v)}return o.LOCAL.getTextWithParas(e.m,t)},e.GetCDGold=function(t,a){if(void 0===a&&(a=!1),0===this._A){var o=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"5030");if(!e.ObjIsEmpty(o)){var n=o.value.split("|");e.ObjIsEmpty(n)||(n.length>0&&(this._A=parseFloat(n[0])),n.length>1&&(this._B=parseFloat(n[1])),n.length>2&&(this._C=parseFloat(n[2])))}}if(0===this._A_Hospital){o=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"5031");if(!e.ObjIsEmpty(o)){n=o.value.split("|");e.ObjIsEmpty(n)||(n.length>0&&(this._A_Hospital=parseFloat(n[0])),n.length>1&&(this._B_Hospital=parseFloat(n[1])),n.length>2&&(this._C_Hospital=parseFloat(n[2])))}}var i=0,r=0,s=0;a?(i=e._A_Hospital,r=e._B_Hospital,s=e._C_Hospital):(i=e._A,r=e._B,s=e._C);var d=t/60,p=0;return p=d<60?d*i:d<1440?60*i+(d-60)*r:60*i+1380*r+(d-1440)*s,p=Math.ceil(p),p=Math.max(1,p),p=Math.min(1e3,p)},e.GetProfessionCDGold=function(t){var a=0,o=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"61017");e.ObjIsEmpty(o)||(a=o.value);var n=0;return n=t/60*a,n=Math.ceil(n),n=Math.max(1,n)},e.showMiniProTip=function(t){if(M.instance.canShowMiniProTip()){if("1"!==L.get("IsFavWx")&&0===i.DATA.UserData.FavWxReward&&e.verifyNode(t)&&!t.getChildByName("miniProTip")){S.LoadManager.loadPrefabSync("ea_prefab/ui/prefabMiniProTip",function(e,a){if(a){var o=cc.instantiate(a);o&&(o.name="miniProTip",t.addChild(o))}},null)}}},e.getMarchIdByPos=function(e,t,a){var o="",n=P.getInstance().myMarch,i=P.model.march;for(var r in n){var s=i[r];if(s&&(s.marchState==E.MarchState.OCCUPY&&s.target_tx==e&&s.target_ty==t)){o=s.marchId;break}}return o},e.getAllianceTerritoryName=function(e){if(null==e||null==e.extData)return"";var t=e.extData,a="alliance_building";[E.WorldMapEntityType.KVK_ALLIANCE_FORTRESS,E.WorldMapEntityType.KVK_ALLIANCE_FLAG].indexOf(e.type)>=0&&(a="kvk_building");var n=l.TABLE.getTableDataById(a,t.bid.toString());if(null==n)return"";var i="";t.st===w.AllianceTerritoryBuildStatus.Building&&(i=o.LOCAL.getText("alliance_120557"));var r=o.LOCAL.getText(n.name),s=t.a_tag;return null!=s&&""!=s&&(r="["+s+"]"+r),""!=i&&(r=r+"("+i+")"),r},e.getAllianceColorByColorId=function(e){var t,a,o=0;switch(e){case 1:t=227,a=67,o=115;break;case 2:t=245,a=128,o=237;break;case 3:t=65,a=238,o=225;break;case 4:t=92,a=177,o=72;break;case 5:t=231,a=215,o=65;break;case 6:t=255,a=128,o=128;break;case 7:t=194,a=94,o=237;break;case 8:t=65,a=201,o=255;break;case 9:t=151,a=233,o=65;break;case 10:t=246,a=162,o=65;break;default:t=227,a=67,o=115}return cc.color(t,a,o)},e.getUserDataAftherLogin=function(){ge.default.getScienceData(),i.DATA.UserData.ServerId==i.DATA.UserData.OriginServerId&&1==i.DATA.UserData.Alliance.isInAlliance()&&(m.NET.send(f.RequestId.Get_Alliance_Chat_Reward_List,{},this,function(t){if(0==t.s&&null!=t.d){var a=e.JSON_PARSE(t.d);i.DATA.UserData.Alliance.UpdateChatRewardList(a.list)}}),q.AllianceController.getInstance().getTerritoryInfo(),q.AllianceController.getInstance().getAllianceGiftData(),q.AllianceController.getInstance().getAllianceBossDonateData()),e.getQuestData(),e.getAirDropData(),e.getDarkPortalData(),e.getWorldSitesData(i.DATA.UserData.ServerId),J.default.GetSharkMoneyTreeData(),i.DATA.UserData.FunctionOn(n.FunctionKey.key_novice_adjustments)&&i.DATA.UserData.getCollectionMachineInfo(),e.getPveTowerData(),e.getCountryBossData(),e.getThroneBattleTimeData(),e.getWorldTreasureData(),e.getAirDropTimeData(),e.canUseMultiSNSBind()&&e.getSNSInfoCMD(),-1!=e.CrossTargetId&&(_.default.Instance().ShowTips(o.LOCAL.getText("cross_server_018",e.CrossTargetId.toString())),e.CrossTargetId=-1),e.getProductionFactoryData(),e.getGameNoticeData(),e.getTreasureThemeData(),e.getDecorationSuitsData(),e.getAllianceDefenderData(),e.getKingMarkData(),!window.OnlineServer&&console.log("getdataXXXXX"),e.GotOtherData=!0},e.getDecorationSuitsData=function(){m.NET.send(f.RequestId.GET_DECORATION_SUITS,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateDecorationSuits(a),p.EVENT.emit(u.EventId.DecorationSuitUpdate)}})},e.getTreasureThemeData=function(){m.NET.send(f.RequestId.Get_Treasure_Theme_Data,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.TreasureThemeData.UpdateThemeData(a.treasureThemes)}})},e.getDimMineData=function(){m.NET.send(f.RequestId.Get_Treasure_Theme_Data,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.TreasureThemeData.UpdateThemeData(a.treasureThemes)}})},e.getQuestData=function(){m.NET.send(f.RequestId.GET_QUEST_DATA,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateQuests(a.quests),p.EVENT.emit(u.EventId.Quest_Update)}})},e.getGameNoticeData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.GameNotice)&&0!=i.DATA.UserData.getBuildingMaxLevel(3500)&&m.NET.send(f.RequestId.GET_GAME_NOTICE,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateGameNoticeData(a),p.EVENT.emit(u.EventId.GameNoticeDataUpdate)}})},e.getAdventureData=function(t){void 0===t&&(t=!0),i.DATA.UserData.FunctionOn(n.FunctionKey.Adventure)&&0!=i.DATA.UserData.getBuildingMaxLevel(3800)&&(i.DATA.UserData.Level<parseInt(e.getDataConfigData(130095))||m.NET.send(f.RequestId.Get_Adventure_Data,{},this,function(a){if(0==a.s){var o=e.JSON_PARSE(a.d);i.DATA.UserData.UpdateAdventureData(o,t)}}))},e.getAirDropTimeData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.AirDrop)&&i.DATA.UserData.FunctionOn(n.FunctionKey.AirDropVote)&&m.NET.send(f.RequestId.GET_VOTE_TIME_DATA,{func:2},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateVoteTimeData(a)}})},e.getThroneBattleTimeData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.ThroneBattle_Vote)&&m.NET.send(f.RequestId.GET_THRONE_BATTLE_VOTE_DATA,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateThroneTimeData(a)}})},e.getThroneBattleTimeStateStr=function(e){if(void 0===e&&(e=!1),!i.DATA.UserData.FunctionOn(n.FunctionKey.ThroneBattle_Vote))return"";var t="",a=i.DATA.UserData.ThroneTimeData;return 1==a.ChoiceEnded?"":(a.Type>0&&-1==a.TimeIndex&&(t=1==a.Type?e?o.LOCAL.getText("wonder_vote_026"):o.LOCAL.getText("wonder_vote_013"):e?o.LOCAL.getText("wonder_vote_027"):o.LOCAL.getText("wonder_vote_014")),t)},e.getVoteTimeStateStr=function(e){var t=i.DATA.UserData.getVoteTimeData(e);if(!t)return"";var a="";return 1==t.ChoiceEnded?"":(t.Type>0&&-1==t.TimeIndex&&(a=1==t.Type?o.LOCAL.getText("airdrop_vote_002"):o.LOCAL.getText("airdrop_vote_003")),a)},e.getWorldTreasureData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.WorldTreasure)&&!i.DATA.UserData.FunctionOn(n.FunctionKey.treasure_map_s2)&&m.NET.send(f.RequestId.GET_WORLD_TREASURE_QUEST,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateWorldTreasureData(a),p.EVENT.emit(u.EventId.WorldTreasureDataUpdate)}})},e.getLaunchTowerData=function(){m.NET.send(f.RequestId.GET_GUN_FIGHT_INFO,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.updatelaunchTowerData(a,!0)}})},e.getAllianceDefenderData=function(){i.DATA.UserData.ServerId==i.DATA.UserData.OriginServerId&&m.NET.send(f.RequestId.GET_ALLIANCE_DISPLAY_TIME,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateAllianceDefenderData(a)}})},e.getWorldSiteTextColorByState=function(e){var t,a,o=255;return e==n.WorldSiteState.CLOSE?(t=117,a=234,o=255):e==n.WorldSiteState.PEACE?(t=137,a=235,o=106):e==n.WorldSiteState.FIGHT&&(t=250,a=88,o=43),cc.color(t,a,o)},e.getWorldSitesData=function(t,a){void 0===a&&(a=null),m.NET.send(f.RequestId.GET_WORLD_SITE_DATA,{worldId:t},this,function(t){if(0==t.s){var o=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateWorldSites(o.worldWonders,o.worldId),p.EVENT.emit(u.EventId.WorldSiteUpdate),a&&a()}})},e.getWorldSiteColor=function(t){return null==t||0==t.ServerType?V.ServerColor.Blue:e.getServerColor(t.ServerType)},Object.defineProperty(e,"ThroneCenterAreas",{get:function(){return null==e._ThroneCenterAreas&&(e._ThroneCenterAreas=e.getDataConfigData(70023).split("|")),e._ThroneCenterAreas},enumerable:!0,configurable:!0}),e.CheckInThroneCenterAreas=function(t){for(var a=!1,o=0;o<e.ThroneCenterAreas.length;o++)if(parseInt(e.ThroneCenterAreas[o])==t){a=!0;break}return a},Object.defineProperty(e,"BlastedAreas",{get:function(){return le.send(le.Names.SUBPACK_EIGHT_COUNTRY_SERVER_TYPE,null).data?[]:(null==e._BlastedAreas&&(e._BlastedAreas=e.getDataConfigData(70002).split("|")),e._BlastedAreas)},enumerable:!0,configurable:!0}),e.CheckInBlastedAreas=function(t){for(var a=!1,o=0;o<e.BlastedAreas.length;o++)if(parseInt(e.BlastedAreas[o])==t){a=!0;break}return a},e.CheckAreaBelongToMe=function(t){for(var a=0;a<e.BlastedAreas.length;a++)if(parseInt(e.BlastedAreas[a])==t){var o=i.DATA.UserData.getDarkPortalByAreaId(t);if(null!=o)return e.CheckServerTypeBelongToMe(o.ServerType)}if(i.DATA.UserData.ServerId==i.DATA.UserData.OriginServerId&&e.ThroneCenterAreas.indexOf(String(t))>=0)return!0;var n=i.DATA.UserData.getWorldSiteByDistrictId(t,i.DATA.UserData.ServerId);return null!=n&&0!=n.ServerType&&e.CheckWorldSiteBelongToMe(n)},e.CheckWorldSiteBelongToMe=function(t){return null!=t&&(0==t.ServerType?i.DATA.UserData.Alliance.Aid>0&&t.Owner.Aid==i.DATA.UserData.Alliance.Aid:e.CheckServerTypeBelongToMe(t.ServerType))},e.CheckWorldSiteBelongToMeNow=function(t){if(null==t)return!1;var a=t.CurrServerType;return 0==a&&(a=t.ServerType),0==a?i.DATA.UserData.Alliance.Aid>0&&t.Owner.Aid==i.DATA.UserData.Alliance.Aid:e.CheckServerTypeBelongToMe(a)},e.CheckServerTypeBelongToMe=function(e){return-1==e?i.DATA.UserData.OriginServerId==i.DATA.UserData.ServerId:-2==e&&i.DATA.UserData.OriginServerId!=i.DATA.UserData.ServerId},e.CheckDisplayIdBelongToMe=function(t){for(var a=0;a<e.BlastedAreas.length;a++){var o=l.TABLE.getTableDataById(c.TableName.DISTRICT,e.BlastedAreas[a]);if(null!=o&&o.display_id==t){var n=i.DATA.UserData.getDarkPortalByAreaId(o.id);if(null!=n)return e.CheckServerTypeBelongToMe(n.ServerType)}}var r=i.DATA.UserData.getWorldSiteByDisplayId(t,i.DATA.UserData.ServerId);return null==r||0==r.ServerType?i.DATA.UserData.ServerId==i.DATA.UserData.OriginServerId:e.CheckWorldSiteBelongToMe(r)},e.CheckAreaAroundToMe=function(t){var a=!1,o=l.TABLE.getTableDataById(c.TableName.DISTRICT,t.toString());if(null==o)return!1;var n=e.getNeighborAreas(o.display_id);-1==o.display_id&&o.adjacent_area&&(n=o.adjacent_area.split(","));for(var i=0;i<n.length;i++)if(e.CheckDisplayIdBelongToMe(Number(n[i]))){a=!0;break}return a},e.CheckPointBelongToMe=function(t,a,o){var n=X.getInstance().getAreaIdByCoord(t,a);return e.CheckAreaBelongToMe(n)},e.CheckThroneAttackEnable=function(t){var a=l.TABLE.getTableDataById(c.TableName.THRONE,t.toString());if(null==a)return!1;for(var o=!1,n=a.cross_server_area_requirement.split(","),i=0;i<n.length;i++)if(e.CheckAreaBelongToMe(parseInt(n[i]))){o=!0;break}return o},e.getDarkPortalData=function(){m.NET.send(f.RequestId.GET_WORLD_CROSS_TELEPORTERS,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateDarkPortalData(a.crossTeleporters)}})},e.getServerColor=function(e){return-1==e?i.DATA.UserData.ServerColor:(i.DATA.UserData.ServerColor+1)%2},e.getAirDropData=function(){m.NET.send(f.RequestId.GET_AIRDROP_INFO,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateAirDropData(a)}})},e.AirDropMarchIntercept=function(e){var t={targetPos:new cc.Vec2(0,0),marchId:e},a=new Array;if(i.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&a.push(new U.BattleArmyData(e.ArmyId,e.Id))}),0!=a.length){var n=o.LOCAL.getText("103005"),r=new U.BattleItemData(i.DATA.UserData.UID,i.DATA.UserData.Name,0,null,i.DATA.UserData.ICONURL,a),s=new U.BattleItemData(0,n,1,"",null,null);i.DATA.CurBattleData=new U.BattleData(U.BattleType.AIR_DROP_Intercept,r,s,t),_.default.Instance().OpenUI(R.UIDataInfo.BattleMainPanel)}else _.default.Instance().ShowTips(o.LOCAL.getText("100272"))},e.DarkPortalDonateMarch=function(t,a,n){var r=a.toString()+"|"+n.toString(),s=e.getWorldPosByServerPointId(t),l={targetPos:new cc.Vec2(s.x,s.y),itemData:r},c=new Array;if(i.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&c.push(new U.BattleArmyData(e.ArmyId,e.Id))}),0!=c.length){var d=new U.BattleItemData(i.DATA.UserData.UID,i.DATA.UserData.Name,0,null,i.DATA.UserData.ICONURL,c),p=new U.BattleItemData(0,"",1,"",null,null);i.DATA.CurBattleData=new U.BattleData(U.BattleType.DarkPortal_Donate,d,p,l),_.default.Instance().OpenUI(R.UIDataInfo.BattleMainPanel)}else _.default.Instance().ShowTips(o.LOCAL.getText("100272"))},e.CheckMarchNumEnough=function(){return!(P.getInstance().myMarchNum>=P.getInstance().myMarchNumMAX)||(G.ExchangeController.Instance.isMonthlyCardCanBuy()?O.default.ShowView(o.LOCAL.getText("100271"),o.LOCAL.getText("101031"),this,function(){k.default.Instance.PostAction("ExMarchMonthlyCard"),G.ExchangeController.Instance.buyMonthlyCard()},null,o.LOCAL.getText("101032")):_.default.Instance().ShowTips(o.LOCAL.getText("101145")),!1)},e.getWorldSiteStateText=function(e){var t="";return e==n.WorldSiteState.CLOSE?t=o.LOCAL.getText("alliance_120548"):e==n.WorldSiteState.FIGHT?t=o.LOCAL.getText("100415"):e==n.WorldSiteState.PEACE&&(t=o.LOCAL.getText("100414")),t},e.WorldSiteMarch=function(t){var a=this;null!=t&&0!=e.CheckMarchNumEnough()&&(t.State==n.WorldSiteState.FIGHT&&i.DATA.UserData.ShieldTime>i.DATA.ServerTime?O.default.ShowView(o.LOCAL.getText("101143"),o.LOCAL.getText("101073"),this,function(){e.checkWarFever(a,function(){e.SureSendWorldSiteMarch(t,!0)})}):e.checkWarFever(this,function(){e.SureSendWorldSiteMarch(t,!1)}))},e.SureSendWorldSiteMarch=function(e,t){var a={targetPos:new cc.Vec2(e.X,e.Y),siteId:e.PointId,breakAttack:t},n=new Array;if(i.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&n.push(new U.BattleArmyData(e.ArmyId,e.Id))}),0!=n.length){var r=o.LOCAL.getText("103005"),s=new U.BattleItemData(i.DATA.UserData.UID,i.DATA.UserData.Name,0,null,i.DATA.UserData.ICONURL,n),l=new U.BattleItemData(0,r,1,"",null,null);i.DATA.CurBattleData=new U.BattleData(U.BattleType.WorldSite,s,l,a),_.default.Instance().OpenUI(R.UIDataInfo.BattleMainPanel)}else _.default.Instance().ShowTips(o.LOCAL.getText("100272"))},e.ThroneAttack=function(t,a){var n=this;i.DATA.UserData.ShieldTime>i.DATA.ServerTime?O.default.ShowView(o.LOCAL.getText("101143"),o.LOCAL.getText("101073"),this,function(){e.checkWarFever(n,function(){ie.ThroneController.getInstance().doAttack(t,a)})}):e.checkWarFever(this,function(){ie.ThroneController.getInstance().doAttack(t,a)})},e.AirDropMarch=function(e){var t={targetPos:new cc.Vec2(e.tileX,e.tileY)},a=new Array;if(i.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&a.push(new U.BattleArmyData(e.ArmyId,e.Id))}),0!=a.length){var n=o.LOCAL.getText("103005"),r=new U.BattleItemData(i.DATA.UserData.UID,i.DATA.UserData.Name,0,null,i.DATA.UserData.ICONURL,a),s=new U.BattleItemData(0,n,1,"",null,null);i.DATA.CurBattleData=new U.BattleData(U.BattleType.AIR_DROP,r,s,t),_.default.Instance().OpenUI(R.UIDataInfo.BattleMainPanel)}else _.default.Instance().ShowTips(o.LOCAL.getText("100272"))},e.getNeighborAreas=function(e){var t=e%8-1,a=Math.floor(e/8);e%8==0&&(t=7,a-=1);var o=new Array;return this.addNeighborPoints(t-1,a,8,o),this.addNeighborPoints(t+1,a,8,o),this.addNeighborPoints(t,a-1,8,o),this.addNeighborPoints(t,a+1,8,o),o},e.addNeighborPoints=function(e,t,a,o){if(!(e<0||e>a-1||t<0||t>a-1)){var n=t*a+e+1;o.push(n)}},e.getWorldSiteMaxNum=function(){var t=9953;i.DATA.UserData.FunctionOn(n.FunctionKey.WorldSiteMaxNum)&&(t=9959);var a=parseInt(e.getDataConfigData(t));return i.DATA.UserData.Buff.getBuffAddValue(n.BuffType.WorldSiteNum)+a},e.UpdateItemIcon=function(e,t){if(null!=e){var a=l.TABLE.getTableDataById(c.TableName.ITEM,e.toString());a&&I.UpdateSpriteFrame(a.icon,t)}},e.getBuildingDesc=function(t){var a=l.TABLE.getTableDataById(c.TableName.BUILDING,t),n="";if(null!=a)if(a.type===V.BuildingType.Ornament||a.type===V.BuildingType.OrnamentFloor){var i=a.buff_id.split("|"),r="";if(i.length>1&&(r=e.GetLargeNumberShow(i[1])),i[0]){var s=l.TABLE.getTableDataById(c.TableName.EFFECTBUFF,i[0]);s.value_type&&1e4==s.value_type&&(r=(Number(i[1])/100).toFixed(2))}n=o.LOCAL.getText(a.desc).indexOf("{1}")<0?o.LOCAL.getText(a.desc,a.buff_max_num):o.LOCAL.getText(a.desc,r,a.buff_max_num)}else n=a.desc;return n},e.getBuildingOpenLevel=function(t){if(!t)return 0;if(0==e._buildingLevelSpConfig.length)for(var a=e.getDataConfigData(950007).split("|"),o=0;o<a.length;o++){var n=a[o].split(",");3==n.length&&e._buildingLevelSpConfig.push(n)}var r=t.player_level;for(o=0;o<e._buildingLevelSpConfig.length;o++){var s=e._buildingLevelSpConfig[o];if(3==s.length&&s[0]==t.group){i.DATA.UserData.FunctionOn(s[1])&&(r=parseInt(s[2]));break}}return r},e.SendMessageToServer=function(e,t){m.NET.send(e,t,this,function(){})},e.UseWorldTreasureItem=function(t){if(i.DATA.UserData.ServerState!=V.ServerState.Ready&&i.DATA.UserData.ServerState!=V.ServerState.Fight){var a=this;m.NET.send(f.RequestId.GET_WORLD_TREASURE,{item:t},this,function(n){if(0==n.s){var i=e.JSON_PARSE(n.d);if(i){var r=i.x,s=i.y,d=o.LOCAL.getText("treasure_activity_008",r,s),p=l.TABLE.getTableDataById(c.TableName.ITEM,t.toString());p&&(d=o.LOCAL.getText(p.name)+"\n\n"+d),O.default.ShowView(d,o.LOCAL.getText("treasure_activity_007"),a,function(){e.WorldTreasureMarch(t,r,s)},null,o.LOCAL.getText("treasure_activity_010"))}}})}else _.default.Instance().ShowTips(o.LOCAL.getText("treasure_activity_019"))},e.WorldTreasureMarch=function(t,a,n){if(0!=e.CheckMarchNumEnough()){var r={targetPos:new cc.Vec2(a,n),itemId:t,battleName:o.LOCAL.getText("consignment_046")},s=new Array;if(i.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&s.push(new U.BattleArmyData(e.ArmyId,e.Id))}),0!=s.length){var l=new U.BattleItemData(i.DATA.UserData.UID,i.DATA.UserData.Name,0,null,i.DATA.UserData.ICONURL,s),c=new U.BattleItemData(0,"",1,"",null,null);i.DATA.CurBattleData=new U.BattleData(U.BattleType.WorldTreasure_March,l,c,r),_.default.Instance().OpenUI(R.UIDataInfo.BattleMainPanel),_.default.Instance().CloseUI(R.UIDataInfo.ActivityPanel),_.default.Instance().CloseUI(R.UIDataInfo.BagPanel)}else _.default.Instance().ShowTips(o.LOCAL.getText("100272"))}},e.WorldTreasureFightMarch=function(t){if(t){var a=P.model.getEnemyInfoByTileId(t.id);if(a&&0!=e.CheckMarchNumEnough()){var n=cc.v2(t.tileX,t.tileY),r=a.monsterLevel.toString(),s={targetPos:n,levelId:r,enemyInfo:a,marchType:E.MarchType.WORLD_TREASURE_FIGHT},d=new Array;i.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&d.push(new U.BattleArmyData(e.ArmyId,e.Id))});var p=l.TABLE.getTableDataById(c.TableName.PVE_MONSTER,r.toString()),u=new Array;if(301!=a.groupId&&p)for(var h=p.enemy_config.split(","),m=0;m<h.length;m++){var f=h[m];u.push(new U.BattleArmyData(parseInt(f)))}if(0!=d.length){var y=o.LOCAL.getText("treasure_activity_001"),g=new U.BattleItemData(i.DATA.UserData.UID,i.DATA.UserData.Name,0,null,i.DATA.UserData.ICONURL,d),C=new U.BattleItemData(0,y,1,"",null,u);i.DATA.CurBattleData=new U.BattleData(U.BattleType.WorldTreasure_Fight,g,C,s),_.default.Instance().OpenUI(R.UIDataInfo.BattleMainPanel)}else _.default.Instance().ShowTips(o.LOCAL.getText("100272"))}}},e.removeEmptyAllianceName=function(e){return e?e.replace(/\s*\[\s*\]\s*/g,""):e},e.getPopUpUIPos=function(e,t,a){if(void 0===a&&(a=0),e){var o=e.height,n=e.width,i=e.getChildByName("arrow");if(e.parent){i&&(i.active=!0);var r=e.parent.convertToNodeSpaceAR(t);return Math.abs(r.y)<cc.winSize.height/2-o/2&&Math.abs(r.x)>n+160-cc.winSize.width/2?r.x<cc.winSize.width/2-n-160?(i&&(i.y=a/2,i.x=-n/2- -14.5,i.angle=270),r.x=r.x+80+n/2):r.x>n+160-cc.winSize.width/2&&(i&&(i.y=a/2,i.x=n/2-14.5,i.angle=90),r.x=r.x-80-n/2):(r.y>0?(r.y=r.y-80-o/2,i&&(i.y=o/2-14.5,i.x=0,r.x<-(cc.winSize.width-n)/2?i.x=r.x-(-cc.winSize.width/2+n/2+40):r.x>(cc.winSize.width-n)/2&&(i.x=r.x-(cc.winSize.width/2-n/2-40)),i.angle=180)):(r.y=r.y+80+o/2,i&&(i.y=-o/2- -14.5+a,i.x=0,r.x<-(cc.winSize.width-n)/2?i.x=r.x-(-cc.winSize.width/2+n/2+40):r.x>(cc.winSize.width-n)/2&&(i.x=r.x-(cc.winSize.width/2-n/2-40)),i.angle=0)),r.x<-(cc.winSize.width-n)/2?r.x=-cc.winSize.width/2+n/2+40:r.x>(cc.winSize.width-n)/2&&(r.x=cc.winSize.width/2-n/2-40),!i||0!=i.rotation&&180!=i.rotation&&-180!=i.rotation||(i.x<-n/2+46?i.x=-n/2+46:i.x>n/2-46&&(i.x=n/2-46))),r}return i&&(i.active=!1),cc.v2(0,0)}return cc.v2(0,0)},e.AcceptAllianceMoveInvite=function(){var t=e.getAllianceMoveInviteItem(),a=parseInt(e.getDataConfigData(9957)),o=new Array;o.push(t),_.default.Instance().OpenUI(R.UIDataInfo.UseItemCommonPanel,o,function(o){t==a?e.SendAcceptAllianceMoveInvite(1):e.SendAcceptAllianceMoveInvite(2)},this,function(t){e.SendAcceptAllianceMoveInvite(3)},this,this)},e.SendAcceptAllianceMoveInvite=function(e){m.NET.send(f.RequestId.ALLIANCE_MOVE_ACCEPT,{type:e},this,function(e){0==e.s&&(C.send(C.Names.WorldMapJumpToTile,cc.v2(i.DATA.UserData.WorldCoord.x,i.DATA.UserData.WorldCoord.y)),_.default.Instance().ShowTips(o.LOCAL.getText("101152")))})},e.RefuseAllianceMoveInvite=function(){m.NET.send(f.RequestId.ALLIANCE_MOVE_REFUSE,{},this,function(e){0==e.s&&_.default.Instance().ShowTips(o.LOCAL.getText("league_move_013"))})},e.getAllianceMoveInviteItem=function(){var t=parseInt(e.getDataConfigData(9957));return i.DATA.UserData.getItemAmount(t)<=0&&(t=parseInt(e.getDataConfigData(9958))),t},e.getBuffValueShow=function(t,a){var o=t,n="";o<0&&(n="-",o=-o);var i="";return 1e4==a?o>0?i=(o/100).toFixed(1)+"%":0==o&&(i="0%"):i=e.GetLargeNumberShow(o).toString(),n+i},e.getTextWithKeyAndPara=function(e,t){if(null==t||""==t)return o.LOCAL.getText(e);for(var a=t.split(","),n=[],i=0;i<a.length;i++){var r=a[i].split("|");2==r.length&&("1"==r[0]?n.push(o.LOCAL.getText(r[1])):n.push(r[1]))}return o.LOCAL.getTextWithParas(e,n)},e.getCountdownToZero=function(){var e=new Date(1e3*i.DATA.ServerFloatTime),t="00"+(23-e.getHours()),a="00"+(59-e.getMinutes()),o="00"+(59-e.getSeconds());return t.substr(t.length-2,2)+":"+a.substr(a.length-2,2)+":"+o.substr(o.length-2,2)},e.isTimeZero=function(){var e=new Date(1e3*i.DATA.ServerFloatTime),t=e.getHours(),a=e.getMinutes(),o=e.getSeconds();return 0==23-t&&0==59-a&&0==59-o},e.GetIconURL=function(e){if(M.instance.ignoreOtherPlatformHeaderIcons){0==e.indexOf("hero_icon")&&e.indexOf("_global")<0&&(e="icon_felman01_0")}return F.GLOBAL.ResourceUrl+"/DynRes/images/headpic/"+e+".png"},e.fixIconUrl=function(t){if(t.length<4||"http"!=t.substr(0,4))return t;for(var a=M.instance.getHeadFileNames(),o=0;o<a.length;o++){var n=a[o];if(t.indexOf("/assets/images/headpic/"+n)>=0)return e.GetIconURL(n)}return t},e.GetIconSex=function(e){return"_"==e.substr(-2,1)?parseInt(e.substr(-1,1)):-1},e.getZeroTimeByTime=function(e){var t=new Date(1e3*e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),Math.floor(t.valueOf()/1e3)},e.getStringResizeByLength=function(e,t,a,o){for(var n=0,i=0;i<e.length;i++)e.charCodeAt(i)>255?n+=1:n+=.6;var r=Math.ceil(n/Math.ceil(o/t));return[r*a,r]},e.getPadRatio=function(){var e=1,t=cc.winSize;return t.height/t.width<1.77&&(e=t.height/t.width/1.778),e<.75&&(e=.75),e},e.SavePresetMarchData=function(e,t,a){void 0===t&&(t=null),void 0===a&&(a=null);for(var n=e.armyInfo,i=!1,r=0;r<n.length;r++)if(n[r].armyId>0){i=!0;break}if(i){var s=e.index;m.NET.send(f.RequestId.SavePreMarch,e,this,function(e){0==e.s&&(_.default.Instance().ShowTips(o.LOCAL.getText("march_queue_presets_012")),t&&a&&a.call(t),p.EVENT.emit(u.EventId.PresetMarchSaveSuccess,s))})}else _.default.Instance().ShowTips(o.LOCAL.getText("march_queue_presets_007"))},e.CheckHaveBattleCenter=function(e){return void 0===e&&(e=!1),0!=i.DATA.UserData.getBuildingArrayByBuildingGroup(2500).length||(e&&_.default.Instance().ShowTips(o.LOCAL.getText("assembly_buildinghelpinfo")),!1)},e.getProductionFactoryData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.ProductFactory)&&(m.NET.send(f.RequestId.getStrengthenMakingData,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateProductingData(a,!0,!1)}}),m.NET.send(f.RequestId.ProductionListGet,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);i.DATA.UserData.UpdateProductingData(a,!1)}}))},e.GlobalSwitch=function(e){var t="";if(F.GLOBAL.SwitchStr){var a=F.GLOBAL.SwitchStr.split("|");e<a.length&&(t=a[e])}return t},e.GlobalSwitchIntVal=function(t){return parseInt(e.GlobalSwitch(t))},e.getStringResizeHeightSyn=function(e,t,a,o){var n,i=new cc.Node;i.width=o;var r=i.addComponent(cc.Label);r.fontSize=t,r.lineHeight=a,r.overflow=cc.Label.Overflow.RESIZE_HEIGHT,r.string=e;var s=r,l=a;if(s._updateRenderData&&s._updateRenderData(!0),s._assembler){var c=s._assembler;c._updateFontFamily&&c._updateProperties&&c._calculateLabelFont&&c._calculateSplitedStrings&&c._updateLabelDimensions&&(c._updateFontFamily(r),c._updateProperties(r),c._calculateLabelFont(),c._calculateSplitedStrings(),c._updateLabelDimensions()),c._getLineHeight&&(l=c._getLineHeight())}return n=i.height,i.destroy(),[n,n/l]},e.getPlayerDisplayName=function(e,t){return void 0===t&&(t=""),e?e instanceof H.default?e.getDisplayName(t):j.getNameFromTPlayerInfo(e):t},e.updateNearstTerritoryMarchTime=function(){_e.default.Instance().NoticePlayerMoveToTerritoryAround||m.NET.send(f.RequestId.GET_NEARST_TERRITORY_MARCH_TIME,{},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);_e.default.Instance().MarchToNearstTerritoryTime=a.marchTime}})},e.checkSelfAroundTerritory=function(){return!!(_e.default.Instance().NoticePlayerMoveToTerritoryAround||i.DATA.UserData.Level>parseInt(e.getDataConfigData(950017)))||_e.default.Instance().MarchToNearstTerritoryTime<=parseInt(e.getDataConfigData(950015))},e.SET_TEST_BUILDING_LEVEL=function(t){e.TEST_BUILDING_LEVEL=t,K.log("\u6d4b\u8bd5\u5efa\u7b51\u7b49\u7ea7\u8bbe\u7f6e\u6210\u529f\uff0c\u8bbe\u7f6e\u4e3a\uff1a"+t)},e.DUMP_BUILDING=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];var n=l.TABLE.getTableGroup(c.TableName.BUILDING),i=[];for(var r in n){var s=n[r];e&&e(s);var d={};for(var p in d.id=s.id,d.name=o.LOCAL.getText(s.name),d.level=s.level,d._data_=s,s)t.indexOf(p)>=0&&(d[p]=s[p]);i.push(d)}K.table(i)},e.updateVipHeadIconBg=function(e,t){if(e&&e.node.safetyDestroyAllChildren(),e&&void 0!=t&&0!=t){var a=l.TABLE.getTableDataById(c.TableName.DRESS_HEADFRAME,t.toString());a&&(a.res_type&&2==a.res_type?(e.spriteFrame=null,a.prefab&&S.LoadManager.loadPrefab(a.prefab,function(t,a){if(a&&e&&e.node){var o=cc.instantiate(a);o&&(o.parent=e.node,e.node.active=!0)}})):a.pic&&I.UpdateSpriteFrame(a.pic,e,function(){e.node.active=!0}))}},e.getDefaultAvatarByGender=function(e){return"headIcon_1_1"},e.CustomAvatarOn=function(){return i.DATA.UserData.FunctionOn(n.FunctionKey.UploadHeadImage)&&M.instance.canUploadHeaderPicture},e.UploadHeadPicToServer=function(t){K.log("\u56fe\u7247\u4e0a\u4f20\u6210\u529f\uff0c\u56fe\u7247\u683c\u5f0f\u662f\uff1a"+t);var a={ext:t};m.NET.send(f.RequestId.UploadUserHeadImage,a,this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);a&&a.userInfo&&(i.DATA.UserData.UpdatePlayerInfoData(a.userInfo),p.EVENT.emit(u.EventId.PlayerInfo_Update),_.default.Instance().ShowTips(o.LOCAL.getText("pubilc909")),p.EVENT.emit(u.EventId.UploadHeadIconSuccess))}})},e.resetUploadHeadBtn=function(){p.EVENT.emit(u.EventId.ResetUploadbtns)},e.CrossServer=function(t,a){void 0===t&&(t=0),void 0===a&&(a=-1),e.isInMonsterDefenderActivity()?O.default.ShowView(o.LOCAL.getText("defend_myself_02"),"",this,function(){e.sureCrossServer(t,a)}):e.sureCrossServer(t,a)},e.sureCrossServer=function(t,a){var n=this;void 0===t&&(t=0),void 0===a&&(a=-1);var r=i.DATA.UserData.FightServerId;i.DATA.UserData.ServerId!=i.DATA.UserData.OriginServerId&&(r=i.DATA.UserData.OriginServerId),O.default.ShowView(o.LOCAL.getText("cross_server_017",r.toString()),"",this,function(){m.NET.send(f.RequestId.CROSS_SERVER,{hurtback:t,tPointId:a},n,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d),o=a.wsurl;F.GLOBAL.changeServerIp=e.gameIpCombineAccLines(o,a),F.GLOBAL.changeServerId=a.sid,F.GLOBAL.JumpServer=!0,e.CrossTargetId=r,Y.default.doResetGame(!0,!1)}})},function(){})},e.isInMonsterDefenderActivity=function(){var t=parseInt(e.getDataConfigData(133201)),a=x.ActivityController.Instance.getActivityByActivityId(t);return!(!a||!a.userMonsterSiege||1==a.userMonsterSiege.isEnd)},e.eightCountryEnterCrossServer=function(){e.isInMonsterDefenderActivity()?O.default.ShowView(o.LOCAL.getText("defend_myself_02"),"",this,function(){e.sureEightCountryEnterCrossServer()}):e.sureEightCountryEnterCrossServer()},e.sureEightCountryEnterCrossServer=function(){var t=this;O.default.ShowView(o.LOCAL.getText("kvk_info_023"),"",this,function(){m.NET.send(f.RequestId.GS_TO_KVK,{},t,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d),o=a.wsurl;F.GLOBAL.changeServerIp=e.gameIpCombineAccLines(o,a),F.GLOBAL.changeServerId=a.sid,F.GLOBAL.JumpServer=!0,e.CrossTargetId=a.targetServerId,Y.default.doResetGame(!0,!1)}})},function(){})},e.eightCountryBackCrossServer=function(){var t=this;O.default.ShowView(o.LOCAL.getText("kvk_info_025"),"",this,function(){m.NET.send(f.RequestId.KVK_TO_GS,{},t,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d),o=a.wsurl;F.GLOBAL.changeServerIp=e.gameIpCombineAccLines(o,a),F.GLOBAL.changeServerId=a.sid,F.GLOBAL.JumpServer=!0,Y.default.doResetGame(!0,!1)}})},function(){})},e.getKvkStarNum=function(t){if(!e.starConfig){e.starConfig=[];for(var a=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"910032"),o=h.Obj.getProperty(a,"value","1,1,20|2,21,40|3,41,60|4,61,80|5,81,100").split("|"),n=0;n<o.length;n++){var i=o[n].split(","),r={max:i[2],min:i[1]};e.starConfig.push(r)}}for(n=0;n<e.starConfig.length;n++)if(t>=e.starConfig[n].min&&t<=e.starConfig[n].max)return n+1;return 1},e.CustomerServiceSwitchOn=function(){return!M.instance.disableCallCustomerService&&(i.DATA.UserData.UID<=0||i.DATA.UserData.FunctionOn(n.FunctionKey.CustomerService))},e.canShowTWFlag=function(){return!("TW"!=i.DATA.UserData.RegCountry||"TW"!=M.instance.getCurrentCountry()||!i.DATA.UserData.FunctionOn(n.FunctionKey.special_flag_display)||!M.instance.isForeign())},e.getNationalFlag=function(e){if(!e)return 0;var t=l.TABLE.getTableDataByKeyValue(c.TableName.NATIONAL_FLAG,"abbreviation",e);return t&&t.length>0?t[0].id:0},e.getNationalShort=function(e){if(null===e||e<0)return"UN";if(228===e)return this.canShowTWFlag()?"TW1":"UN";if(("CN"==M.instance.getCurrentCountry()||48==i.DATA.UserData.NationalFlag)&&95===e){var t=l.TABLE.getTableDataById(c.TableName.NATIONAL_FLAG,"48");if(t)return t.abbreviation;K.log("\u4e0d\u8be5\u8d70\u5230\u8fd9\uff0c\u8868\u91cc\u6ca1\u6709\u4e2d\u56fd\uff1f\uff1f\uff1f")}var a=l.TABLE.getTableDataById(c.TableName.NATIONAL_FLAG,String(e));return a?a.abbreviation:"UN"},e.FBShare20Available=function(){return!!M.instance.enableShare20&&!!i.DATA.UserData.FunctionOn(n.FunctionKey.facebookShare20)},e.FBShare21Available=function(){return!!M.instance.enableFBAppRequest&&!!i.DATA.UserData.FunctionOn(n.FunctionKey.new_share_treasure)},e.showFBFriendsView=function(t){var a=t.PlayerList[t.PlayerList.length-1];a&&e.FBShare21Available()&&_.default.Instance().OpenUI(R.UIDataInfo.FBFriendHelpTips,a)},e.checkRateMePopup=function(e){if(M.instance.enableRateMe&&(i.DATA.UserData.FunctionOn(n.FunctionKey.Googleplay_rateme)&&"1"!==L.get("WB_RATEME_FLAG"))){var t=L.get("WB_RATEME_POP_TIME");t||(t=0);var a=L.get("WB_RATEME_POP_COUNT");a||(a=0);var o=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"33035"),r=1;if(o&&(r=parseInt(o.value)),t&&this.isSameDayStampS(t)){if(a>=r)return}else a=0;var s=i.DATA.ServerTime-i.DATA.UserData.RegTime,d=Math.ceil(s/3600/24);K.log("reg day===",d);var p=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"33034");if(!(p&&d<parseInt(p.value))){var u=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"33038");if(u){for(var h=u.value.split(","),m=!1,f=0;f<h.length;f++){var y=h[f],g=y.split("-");if(g.length>=2){if(e>=parseInt(g[0])&&e<=parseInt(g[1])){m=!0;break}}else if(e===parseInt(y)){m=!0;break}}if(m)return _.default.Instance().OpenUI(R.UIDataInfo.RateMePanel),L.set("WB_RATEME_POP_TIME",i.DATA.ServerTime),void L.set("WB_RATEME_POP_COUNT",a+1)}}}},e.getSNSTypeByBindPF=function(e){var t="";return"googleplay"===e?t="googleplay":"appfb"===e&&(t="facebook"),t},e.getSNSNameByBindPF=function(e){var t="";return"googleplay"===e?t="Google Play":"facebook"===e&&(t="Facebook"),t},e.getBindPFBySNSType=function(e){var t="";return"googleplay"===e?t="appgp":"facebook"===e&&(t="appfb"),t},e.canUseSNSBind=function(){return!!i.DATA.UserData.FunctionOn(n.FunctionKey.Foreign_Binding_SNS)&&M.instance.canUseSNSBind()},e.canUseMultiSNSBind=function(){return!!i.DATA.UserData.FunctionOn(n.FunctionKey.Multi_Binding_SNS)&&M.instance.canUseMultiSNSBind()},e.canFixGPAccount=function(){return void 0!==i.DATA.UserData.GPNeedFix&&M.instance.canFixGPAccount()},e.judgeIfShowFirstCharge=function(){return!!(!L.get("IS_FIRST_LESS_COIN")&&G.ExchangeController.Instance.canPay()&&i.DATA.UserData.Level>=5&&i.DATA.UserData.Level<=15&&(G.ExchangeController.Instance.getCanPayExchangeConfigById(13003)||G.ExchangeController.Instance.getCanPayExchangeConfigById(13005)))&&(L.set("IS_FIRST_LESS_COIN",1),G.ExchangeController.openFirstChargeBenefitPanel(!0),!0)},e.checkProbabilityShow=function(e,t){var a=l.TABLE.getTableGroup(c.TableName.PROBABILITY),o=null;for(var n in a)if((o=a[n]).type===e&&o.para===t)return!0;return!1},e.showProbability=function(t,a){e.checkProbabilityShow(t,a)&&_.default.Instance().OpenUI(R.UIDataInfo.ProbabilityPanel,{type:t,params:a})},e.getSNSInfoCMD=function(){i.DATA.UserData.ClearSNSList(),m.NET.send(f.RequestId.BindSNSInfo,{},this,function(e){e.d&&3!==e.s&&i.DATA.UserData.UpdateSNSList(e)})},e.getPveTowerData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.Pve_Tower)&&m.NET.send(f.RequestId.GET_PVE_TOWER_DATA,{},this,function(t){if(0==t.s&&null!=t.d){var a=e.JSON_PARSE(t.d);i.DATA.UserData.PveTowerData.UpdateData(a)}})},e.EnterIslandMainView=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.island)?e.showIsLandBattle():_.default.Instance().ShowTips(o.LOCAL.getText("100599"))},e.isInAttackOnTitanTime=function(){return!1},e.isAttackOnTitanFirstStep=function(){return!1},e.isAttackOnTitanSecondStep=function(){return!1},e.isAttackOnTitanEnd=function(){return!1},e.isInSinsTime=function(){var e=i.DATA.getLocalTime();return e>=1583942400&&e<=1585152e3},e.isInSinsFirstStep=function(){return!1},e.isInSinsSecondStep=function(){return!1},e.isSinsEnd=function(){return!1},e.useGuide200605=function(){return i.DATA.UserData.FunctionOn(n.FunctionKey.g123_newguild_200616)},e.isInGodzillaTime=function(){return!1},e.isGodzillaFirstStep=function(){return!1},e.isGodzillaSecondStep=function(){return!1},e.isGodzillaEnd=function(){return!1},e.playGuideSound=function(e){return cc.audioEngine.stopAllEffects(),z.SOUND.playClip(e),!0},e.enableWorldMusic=function(){return i.DATA.UserData.FunctionOn(n.FunctionKey.WorldMap_Music)},e.playWorldBGM=function(){var t=i.DATA.UserData.ThroneData;if(!t||1!=t.IsFight||e.isKVK()){var a=i.DATA.UserData.getCommonLocalData(V.UserSettingKey.WorldMapBGMusic,1);if(i.DATA.UserData.SystemBGMPacks||(a=1),parseInt(a)>1&&i.DATA.UserData.SystemBGMPacks&&i.DATA.UserData.SystemBGMPacks[a]){var o=i.DATA.UserData.SystemBGMPacks[a],n=i.DATA.ServerTime;-1!==o&&o<=n&&(i.DATA.UserData.setCommonLocalData(V.UserSettingKey.WorldMapBGMusic,1),a=1)}var r=l.TABLE.getTableDataById(c.TableName.WORLD_BG_MUSIC,a+"");if((!r||1===a)&&e.enableWorldMusic()&&(e.isKVK()||i.DATA.UserData.ServerState==V.ServerState.Ready||i.DATA.UserData.ServerState==V.ServerState.Fight))return z.SOUND.playClip(Q.SoundPath.CrossServer_Intro),void setTimeout(function(){z.SOUND.playBg(Q.SoundPath.CrossServer_Loop)},4500);z.SOUND.playBg(r.sound_file_name)}else z.SOUND.playBg(Q.SoundPath.kingwar_loop)},e.isInRailgunTime=function(){return!1},e.isInRailgunFirstStep=function(){return!1},e.isInRailgunSecondStep=function(){return!1},e.isRailgunTimeEnd=function(){return!1},e.isRailgunTimePreview=function(){return!1},e.isInUltraManTime=function(){return!1},e.isInUltraManFirstStep=function(){return!1},e.isInUltraManSecondStep=function(){return!1},e.isUltraManTimeEnd=function(){return!1},e.isUltraManTimePreview=function(){return!1},e.isInMarsTime=function(){return!1},e.isInMarsFirstStep=function(){return!1},e.isInMarsSecondStep=function(){return!1},e.isMarsTimeEnd=function(){return!0},e.isMarsTimePreview=function(){return!1},e.canUseEmotionPack=function(){return i.DATA.UserData.FunctionOn(n.FunctionKey.emotion_new)},e.playG123SoundPathByName=function(e){if(!i.DATA.UserData.FunctionOn(n.FunctionKey.system_voice_pack)){var t="sound/g123_normal/"+e;return cc.audioEngine.stopAllEffects(),void z.SOUND.playClip(t)}var a=i.DATA.UserData.getCommonLocalData(V.UserSettingKey.DubbingPack,"1");if(parseInt(a)>1&&i.DATA.UserData.DubbingPacks&&i.DATA.UserData.DubbingPacks[a]){var o=i.DATA.UserData.DubbingPacks[a],r=i.DATA.ServerTime;-1!==o&&o<=r&&(i.DATA.UserData.setCommonLocalData(V.UserSettingKey.DubblingPack,1),a=1)}var s=l.TABLE.getTableDataById(c.TableName.SYSTEM_VOICE_PACK,a+"");if(s){var d="sound/"+s.sound_file_name+"/"+e;cc.audioEngine.stopAllEffects(),z.SOUND.playClip(d)}},e.shouldShowSpecialSkin=function(e){var t=l.TABLE.getTableDataById(c.TableName.SKIN,e.toString()),a=!1;if(t&&1===t.only_limited){var o=t.only_time,n=t.only_endtime,r=h.Str.ConvertBeiJingTimeToStamp(o),s=h.Str.ConvertBeiJingTimeToStamp(n),d=i.DATA.ServerTime;d>r&&d<s&&(a=!0)}return a},e.StartTowerBattle=function(e){var t=l.TABLE.getTableDataById(c.TableName.CONTINUOUS_CHALLENGE,e.toString());if(null!=t){var a={to:e},n=t.arm_limit,r=new Array;if(i.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&(null==e.Data||0!=n&&n!=e.Data.type||r.push(new U.BattleArmyData(e.ArmyId,e.Id)))}),0!=r.length){for(var s=t.enemy_config.toString().split(","),d=new Array,p=0;p<s.length;p++)d.push(new U.BattleArmyData(parseInt(s[p])));var u=new U.BattleItemData(i.DATA.UserData.UID,i.DATA.UserData.Name,0,null,i.DATA.UserData.ICONURL,r),h=new U.BattleItemData(0,"????????",1,"",null,d);i.DATA.CurBattleData=new U.BattleData(U.BattleType.PVE_Tower,u,h,a),_.default.Instance().OpenUI(R.UIDataInfo.BattleMainPanel)}else _.default.Instance().ShowTips(o.LOCAL.getText("100272"))}},e.jumpTo=function(t,a){if(void 0===a&&(a=null),null!=t)switch(t){case 1:if(y.default.Instance().curSceneName==g.SceneName.WORLD)return;_.default.Instance().MainUI.OnWorldClick();break;case 2:_.default.Instance().OpenUI(R.UIDataInfo.HeroRecruitPopup);break;case 3:var o=null;a>0&&(o={activityId:a}),_.default.Instance().OpenUI(R.UIDataInfo.ActivityPanelNew,o);break;case 4:var r={tabType:V.GiftShopTabType.ITEM_SHOP};_.default.Instance().OpenUI(R.UIDataInfo.GiftShopPanel,r);break;case 5:q.AllianceController.getInstance().onAllianceBtnClick();break;case 6:void 0!=a&&G.ExchangeController.tryShowByGiftId(a);break;case 7:if(3001==a){var s=i.DATA.UserData.getBuildingByBuildingId(3001);h.Obj.isEmpty(s)?Z.default.Instance.StartSpecialGuide(V.TaskGuideId.BuildBuilding,3e3):i.DATA.UserData.FunctionOn(n.FunctionKey.ProductFactory)?_.default.Instance().OpenUI(R.UIDataInfo.ProductionFactoryPanel):_.default.Instance().OpenUI(R.UIDataInfo.strengthenPanel)}else if(3101==a){s=i.DATA.UserData.getBuildingByBuildingId(3101);h.Obj.isEmpty(s)?Z.default.Instance.StartSpecialGuide(V.TaskGuideId.BuildBuilding,3100):e.showIsLandBattle()}else if(2201==a)i.DATA.UserData.FunctionOn(n.FunctionKey.lucky_tree)&&(z.SOUND.playClip(Q.SoundPath.Button_CommonYes),i.DATA.UserData.sharkMoneyTreeData&&_.default.Instance().OpenUI(R.UIDataInfo.CoinTreePanel));else if(3801==a&&i.DATA.UserData.FunctionOn(n.FunctionKey.Adventure)){s=i.DATA.UserData.getBuildingByBuildingId(3801);h.Obj.isEmpty(s)?Z.default.Instance.StartSpecialGuide(V.TaskGuideId.BuildBuilding,3800):_.default.Instance().OpenUI(R.UIDataInfo.AdventureMainPanel)}break;case 8:var l=1;i.DATA.UserData.FunctionOn(n.FunctionKey.RewardTaskOn)&&i.DATA.UserData.Level>=te.QuestController.Instance.getBountyQuestLimitLevel()&&(l=2),_.default.Instance().OpenUI(R.UIDataInfo.QuestComponent,{showTab:l});break;case 99:var c=null;a>0&&(c={activityId:a}),_.default.Instance().OpenUI(R.UIDataInfo.ActivityPanelNew,c,1);break;case 9:_.default.Instance().OpenUI(R.UIDataInfo.FinancialCenterPanel,"treasureNode");break;case 10:G.ExchangeController.tryShowByGiftShopTabType(a);break;case 11:_.default.Instance().OpenUI(R.UIDataInfo.FinancialCenterPanel,"treasure2Node");break;case 12:e.goToPveActivity();break;case 13:e.gotoPvpActivity()}},e.goToPveActivity=function(){var t=Number(e.getDataConfigData(930010));t?t>i.DATA.UserData.Level?_.default.Instance().ShowTips(o.LOCAL.getText("100090",String(t))):m.NET.send(f.RequestId.ARENA_PVE_MAIN_REQUEST,{},this,function(t){var a=e.JSON_PARSE(t.d);h.Obj.isEmpty(a)||_.default.Instance().OpenUI(R.UIDataInfo.ArenaPvePanel,a)}):_.default.Instance().ShowTips(o.LOCAL.getText("skill_lable_021"))},e.gotoPvpActivity=function(){var t=Number(e.getDataConfigData(930011));t?t>i.DATA.UserData.Level?_.default.Instance().ShowTips(o.LOCAL.getText("100090",String(t))):le.send(le.Names.ARENA_PVP_MAIN_PANEL_OEPN,null):_.default.Instance().ShowTips(o.LOCAL.getText("skill_lable_021"))},e.canBuildTower=function(e){if(!e)return!1;var t=l.TABLE.getTableDataById(c.TableName.MAP_BUILDING,String(e));if(!t)return!1;var a,o=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"61005");a=h.Obj.getPropertyNumberByNames(o,0,"value");var n=0,r=i.DATA.UserData.MyProfessionalTowers;if(r.length>=a)return!1;if(0==r.length)return!0;for(var s=0;s<r.length;s++){var d=r[s].bid,p=l.TABLE.getTableDataById(c.TableName.MAP_BUILDING,d);p&&p.group==t.group&&n++}return!!(t.build_count&&t.build_count>n)},e.showIsLandBattle=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.island_newserver_display)?_.default.Instance().OpenUI(R.UIDataInfo.IsleMainPanel):i.DATA.UserData.FunctionOn(n.FunctionKey.island)?(z.SOUND.playClip(Q.SoundPath.Button_CommonYes),i.DATA.UserData.getIslandBattleData(function(){i.DATA.UserData.FunctionOn(n.FunctionKey.IsleBattle)||0==i.DATA.UserData.IslandBattleData.floor?_.default.Instance().OpenUI(R.UIDataInfo.IslandBattleLevelNode):_.default.Instance().OpenUI(R.UIDataInfo.IslandBattleMainView)})):_.default.Instance().ShowTips(o.LOCAL.getText("100599"))},e.playHeroSoundTouch=function(t){var a=ce.HeroController.getInstance().getHeroDataById(t),o=0;if(a&&(o=a.Star),0!==o&&1!==o){var n="1",i=["1","2","3"];switch(o){case 2:n=i[0];break;case 3:this._randomIdx=pe.GetUniqueRandomNum(0,1,this._randomIdx),n=i[this._randomIdx];break;case 4:case 5:this._randomIdx=pe.GetUniqueRandomNum(0,2,this._randomIdx),n=i[this._randomIdx]}e.playHeroSoundById(t+"",n)}},e.playHeroSoundById=function(e,t){if(ce.HeroController.getInstance().hasDubbling(parseInt(e))){if("hero_welcome1"===t||"hero_welcome2"===t||"hero_welcome3"===t){var a=l.TABLE.getTableGroup(c.TableName.HERO_VOICE_PACK);for(var n in a){var i=a[n];if(i.hero_id+""===e&&"hero_welcome"===i.line_file_name){t="hero_welcome";break}}}if(0!==ce.HeroController.getInstance().getHeroDataById(parseInt(e)).Star){var r="sound/hero/"+e+"/"+t;cc.audioEngine.stopAllEffects(),z.SOUND.playClip(r)}else _.default.Instance().ShowTips(o.LOCAL.getText("hero_voice_pack_008"))}},e.playHeroSkinSoundTouch=function(t){if(ce.HeroController.getInstance().hasHeroSkinById(t)){var a;this._randomIdx=pe.GetUniqueRandomNum(0,2,this._randomIdx),a=["1","2","3"][this._randomIdx],e.playHeroSkinSoundById(t+"",a)}else _.default.Instance().ShowTips(o.LOCAL.getText("hero_voice_pack_008"))},e.playHeroSkinSoundById=function(e,t){if(!ce.HeroController.getInstance().hasSkinDubbling(parseInt(e)))return!1;if("hero_welcome1"===t||"hero_welcome2"===t||"hero_welcome3"===t){var a=l.TABLE.getTableGroup(c.TableName.HERO_VOICE_PACK);for(var o in a){var n=a[o];if(n.skin_id+""===e&&"hero_welcome"===n.line_file_name){t="hero_welcome";break}}}var i="sound/hero_skin/"+e+"/"+t;return cc.audioEngine.stopAllEffects(),z.SOUND.playClip(i),!0},e.checkCanInput=function(){return!0},e.getCountryBossData=function(){i.DATA.UserData.FunctionOn(n.FunctionKey.CountryBoss)&&m.NET.send(f.RequestId.GET_COUNTRY_BOSS_TASK_DATA,{type:1},this,function(t){if(0==t.s){var a=e.JSON_PARSE(t.d);a&&(i.DATA.UserData.CountryBossData.UpdateData(a),p.EVENT.emit(u.EventId.CountryBossDataUpdate))}})},e.AtiIndulgedGateShow=function(){if(!i.DATA.UserData.FunctionOn(n.FunctionKey.AtiIndulged))return!1;var e=i.DATA.UserData.AtiIndulgedData;return-1!=e.Status&&(0==e.Status||e.HaveReward)},e.AtiIndulgedPayEnable=function(e){if("appios"===M.instance.platformSID&&!F.GLOBAL.IsReviewVersion)return!0;if(!i.DATA.UserData.FunctionOn(n.FunctionKey.AtiIndulged))return!0;var t=i.DATA.UserData.AtiIndulgedData;return-1==t.Status||4==t.Status||(!i.DATA.UserData.FunctionOn(n.FunctionKey.AtiIndulged2)||(0==t.Status?(_.default.Instance().OpenUI(R.UIDataInfo.RealNameVerifyPanel),!1):-1==t.IndulgedPayNum||(!i.DATA.UserData.FunctionOn(n.FunctionKey.AtiIndulged3)||(!(e.product_id>t.IndulgedPayNum)||(_.default.Instance().OpenUI(R.UIDataInfo.RealNameVerifyResultPanel),!1)))))},e.CheckAtiIndulgedGameEnable=function(){if("appios"===M.instance.platformSID&&!F.GLOBAL.IsReviewVersion)return!0;if(!i.DATA.UserData.FunctionOn(n.FunctionKey.AtiIndulged)||!i.DATA.UserData.FunctionOn(n.FunctionKey.AtiIndulged3))return!0;if(e._CheckAtiIndulgedTime>0&&i.DATA.ServerTime-e._CheckAtiIndulgedTime<50)return!0;e._CheckAtiIndulgedTime=i.DATA.ServerTime;var t=i.DATA.UserData.AtiIndulgedData;if(0==t.Status)return _.default.Instance().OpenUI(R.UIDataInfo.RealNameVerifyPanel),!1;if(t.Status<0||t.Status>3)return!0;var a=new Date(1e3*i.DATA.ServerTime).getHours();if(a>=22||a<8)return de.trace({resp:"\u5f3a\u5236\u9000\u51fa"},"\u9632\u6c89\u8ff7-\u6df1\u591c\u65f6\u95f4"),ee.alert("\u6839\u636e\u5e94\u7ba1\u5c40\u7684\u9632\u6c89\u8ff7\u89c4\u5b9a\uff0c\u60a8\u5728\u6bcf\u65e522:00-8:00\u65e0\u6cd5\u7ee7\u7eed\u6e38\u620f\uff0c\u8fd8\u8bf7\u6ce8\u610f\u4f11\u606f","\u9632\u6c89\u8ff7",this,function(){e.ForceExitGame()}),!1;var o=60*t.OnLineTimeMax;return o<=0||(!(t.GameTime>o)||(de.trace({resp:"\u5f3a\u5236\u9000\u51fa"},"\u9632\u6c89\u8ff7-\u6e38\u620f\u8d85\u65f6"),ee.alert("\u6839\u636e\u5e94\u7ba1\u5c40\u7684\u9632\u6c89\u8ff7\u89c4\u5b9a\uff0c\u60a8\u5df2\u8d85\u8fc7\u672c\u65e5\u7684\u6e38\u73a9\u9650\u5236\u65f6\u95f4\uff0c\u8fd8\u8bf7\u6ce8\u610f\u4f11\u606f\u3002","\u9632\u6c89\u8ff7",this,function(){e.ForceExitGame()}),!1))},e.ForceExitGame=function(){M.instance.exitMiniProgram(null)},e.CheckArrearGold=function(e){if(!i.DATA.UserData.FunctionOn(n.FunctionKey.Minus_Diamond))return!1;var t=i.DATA.UserData.Resource.Gold;if(t>=0)return!1;var a=l.TABLE.getTableGroup(c.TableName.MINUS_DIAMOND);if(!a)return!1;var r=null;for(var s in a){var d=a[s];t<=d.upper_limit&&(null==r||r.upper_limit>d.upper_limit)&&(r=d)}if(!r)return!1;for(var p=r.banned_function.split("|"),u=!1,h=0;h<p.length;h++)if(parseInt(p[h])==e){u=!0;break}return!!u&&(O.default.ShowView(o.LOCAL.getText("minus_diamond_001"),o.LOCAL.getText("100127"),this,function(){G.ExchangeController.Instance.openBasePayView()},function(){var e=i.DATA.UserData.getSessionFromData();M.instance.openCustomerServiceConversation({sessionFrom:e})},o.LOCAL.getText("qqmini_payment_ranking_002"),o.LOCAL.getText("102085"),!1,!1,0,!1),!0)},e.translate=function(t,a,n,i){var r={appId:102,message:t,tf:o.LOCAL.getTranslateLanguage(o.LOCAL.CurrLang)},s=(new Date).getTime().toString();r.sign=e.doMd5(s);se.default.sendProxy("https://chatapi.rivergame.net/translate/tran",function(t){K.log("translate:success"),n&&e.verifyComponent(a)&&n(t)},r,"",function(t){i&&e.verifyComponent(a)&&i(t)})},e.getPresetMarchOpenLevel=function(t){var a=e.getDataConfigData(130023);""==a&&(a="10|20|40|60");var o=a.split("|"),n=0;return t>=0&&t<o.length&&(n=parseInt(o[t])),n},e.SET_TEST_ARMY=function(e){e<=0?this.TEST_ARMY_ID=0:(this.TEST_ARMY_ID=e,this.TEST_AMRY=l.TABLE.getTableDataById(c.TableName.ARMY,String(e)),this.TEST_MODEL_A=l.TABLE.getTableDataById(c.TableName.MODEL,String(this.TEST_AMRY.orign_model)),this.TEST_MODEL_B=l.TABLE.getTableDataById(c.TableName.MODEL,String(this.TEST_AMRY.pro_model)),K.log("\u5175, TEST_ARMY",this.TEST_AMRY),K.log("\u8f6c\u804c\u524d, TEST_MODEL_A",this.TEST_MODEL_A),K.log("\u8f6c\u804c\u540e, TEST_MODEL_B",this.TEST_MODEL_B))},e.getOriginalWsGameIp=function(t){if(t&&M.instance.needGameServerRacing()&&1===e.GlobalSwitchIntVal(V.SwitchType.gameServerAcc)){var a=t.split("@@");if(a.length<1||!a[0])return t;t=a[0]}return t},e.processWsGameIp=function(t){if(!t)return t;var a=t,o="";if(M.instance.needGameServerRacing()&&1===e.GlobalSwitchIntVal(V.SwitchType.gameServerAcc)){var n=a.split("@@");if(n.length<1||!n[0])return t;a=n[0],n.length>1&&(o=n[1])}return 0!=a.indexOf("ws")&&(a="wss://"+a+"/websocket"),e.doGameIpCombineAccLines(a,o)},e.gameIpCombineAccLines=function(t,a){var o=null;return M.instance.needGameServerRacing()&&1===e.GlobalSwitchIntVal(V.SwitchType.gameServerAcc)&&void 0===(o=M.instance.getWssAccLines(a))&&(o=a.wssLinesCN),e.doGameIpCombineAccLines(t,o)},e.doGameIpCombineAccLines=function(e,t){return e+(t?"@@"+t:"")},e.WarFeverFunctionOn=function(){var e=!1;return i.DATA.UserData.ServerState==V.ServerState.Fight?e=i.DATA.UserData.FunctionOn(n.FunctionKey.WarFever_CrossServer):i.DATA.UserData.ServerState==V.ServerState.Ready?e=!1:i.DATA.UserData.ThroneData.IsFight&&(e=i.DATA.UserData.FunctionOn(n.FunctionKey.WarFever_Throne)),e},e.getWarFeverState=function(){var t=parseInt(e.getDataConfigData(130048)),a=parseInt(e.getDataConfigData(130049)),o=i.DATA.UserData.Buff.getStateDataById(t),n=i.DATA.UserData.Buff.getStateDataById(a);return null==o?o=n:null!=n&&o.EndTime<n.EndTime&&(o=n),o},e.checkShieldEnable=function(t){void 0===t&&(t=!0);var a=e.getWarFeverState();if(a&&a.EndTime>i.DATA.ServerTime){if(t){var n=e.getTimeShowWord(a.EndTime-i.DATA.ServerTime);O.default.ShowView(o.LOCAL.getText("war_fever_002",n),"")}return!1}return!0},e.checkWarFever=function(t,a){var n=a,r=t;if(!e._WarFeverCheckSkip&&e.WarFeverFunctionOn()){var s=0;s=i.DATA.UserData.ServerState==V.ServerState.Fight?parseInt(e.getDataConfigData(130047)):parseInt(e.getDataConfigData(130046));var l=o.LOCAL.getText("war_fever_001",Math.floor(s/60).toString());O.default.ShowView(l,"",this,function(t){t&&(e._WarFeverCheckSkip=!0),n.call(r)},null,"","",!0)}else n.call(r)},e.UpdateMailPlayerAvatarAndName=function(t,a,n,i,r,s,d){if(a)n.string=e.getPlayerDisplayName(r.playerInfo),I.UpdateSpriteFrameByWXUrl(j.getAvatarUrlFromTPlayerInfo(r.playerInfo),i);else if(s&&s.playerInfo)n.string=e.getPlayerDisplayName(s.playerInfo),I.UpdateSpriteFrameByWXUrl(j.getAvatarUrlFromTPlayerInfo(s.playerInfo),i);else if(t.reportStr.pveId>0){var p=l.TABLE.getTableDataById(c.TableName.MONSTER,t.reportStr.pveId+"");if(p){var u=l.TABLE.getTableDataById(c.TableName.MONSTER_GROUP,p.group_id+"");u&&(n.string=o.LOCAL.getText(u.name),I.UpdateSpriteFrame(u.icon,i))}}else if(t.reportStr.pvpNpcId>0){var h=l.TABLE.getTableDataById(c.TableName.ARENA_NPC,String(t.reportStr.pvpNpcId));h&&(I.UpdateSpriteFrameByWXUrl(h.head_image,i),n.string=o.LOCAL.getText(h.name))}else if([re.NBattleReportType.AL_Defender_Monster,re.NBattleReportType.Defender_Monster].indexOf(t.reportStr.battle.fightType)>=0){if(t.reportStr.monsterGroupId){var m=l.TABLE.getTableDataById(c.TableName.MONSTER_GROUP,String(t.reportStr.monsterGroupId));m&&(n.string=o.LOCAL.getText(m.name),I.UpdateSpriteFrame(m.icon,i))}}else if(s&&s.playerInfo)n.string=e.getPlayerDisplayName(s.playerInfo),I.UpdateSpriteFrameByWXUrl(j.getAvatarUrlFromTPlayerInfo(s.playerInfo),i);else if(t.reportStr.battle.fightType===re.NBattleReportType.Throne){var f=t.reportStr.battle.throneId;d||(f=t.reportStr.battle.throneGunId);var _=l.TABLE.getTableDataById(c.TableName.THRONE,f+"");_&&(I.UpdateSpriteFrame("image/throne/"+_.icon,i),n.string=o.LOCAL.getText(_.name))}},e.getGameWsConnectOption=function(t,a){var o=t,n=null;if(M.instance.needGameServerRacing()&&1===e.GlobalSwitchIntVal(V.SwitchType.gameServerAcc)){var i=t.split("@@");if(i.length>1&&(o=i[0],i[1])){var r=i[1].split(","),s=r.length;if(s>0){n={};for(var l=0;l<s;++l){var c=r[l].split("|");2==c.length&&(n[c[0]]=c[1])}}}}var d={};if(d.host=o,n&&(d.accLineMap=n),a){var p="wss://",u=o.indexOf(p);if(u<0&&(p="ws://",u=o.indexOf(p)),u>=0){u+=p.length;var h=o.indexOf("/",u);if(h>u){var m=o.substring(u,h);m!=a&&(d.fallbackHost=o.replace(m,a))}}}return d},e.isWorldBossChange=function(e){return!1},e.getNomalBgStrByQuality=function(e){var t="";switch(e){case 1:t="bg_icon_white";break;case 2:t="bg_icon_green";break;case 3:t="bg_icon";break;case 4:t="bg_icon_purple";break;case 5:t="bg_icon_yellow";break;default:t="bg_icon"}return"image/mainui_old/"+t},e.isKVK=function(){return le.send(le.Names.SUBPACK_EIGHT_COUNTRY_SERVER_TYPE,null).data},e.getKVKOpenStatus=function(){return le.send(le.Names.SUBPACK_EIGHT_COUNTRY_OPEN_STATUS,null).data},e.isKVKRewardOpenStatus=function(){return e.getKVKOpenStatus()>=6},e.judgeKvkIfConnect=function(e,t,a){m.NET.send(f.RequestId.KVK_JUDGE_IS_CONNECT,{id:e},this,function(e){0==e.s&&t.call(a)})},e.judgeKvkCityIfConnect=function(e,t,a,o){m.NET.send(f.RequestId.KVK_JUDGE_CITY_IS_CONNECT,{x:e,y:t},this,function(e){0==e.s&&a.call(o)})},e.judgeKvkFixedBuildingIfContainPoint=function(e,t){var a=!0,o=le.send(le.Names.SUBPACK_EIGHT_COUNTRY_KVK_BUILDING,[]).data;if(o&&o.length)for(var n=0;n<o.length;n++){var i=o[n].coordinate.split(";");if(!(Math.abs(Number(i[0])-e)>20||Math.abs(Number(i[1])-t)>20)){var r=o[n].ligeance_width,s=o[n].width,l=Number(i[1])+s-1,c=Number(i[0])-s+1;c=c-o[n].ligeance_width+s;for(var d=0;d<r;d++){for(var p=c+d,u=l+d,h=0;h<r;h++)if(p+h==e&&u-h==t){a=!1;break}if(!a)break}}}return a},e.getKVKBuildTypeByPointType=function(t){return e.config[t]},e.getDefaultCitySprite=function(e){var t="castle_face_1";return e===V.TPlayerGender.Female&&(t="castle_face_2"),t=he.DIFF_BIZ_TOOL.getDefaultCity(e)||t},e.getDefaultCityBigSprite=function(e){var t="castle_face_1_big";return e===V.TPlayerGender.Female&&(t="castle_face_2_big"),t=he.DIFF_BIZ_TOOL.getDefaultCity_Big(e)||t},e.getDefaultMarchSkinPrefab=function(){return he.DIFF_BIZ_TOOL.getMarchPrefabPath("ea_prefab/__subpack/armyLineSkin/skinNomal")},e.isRTLLanguage=function(){return"ar"==o.LOCAL.CurrLang},e.getAllianceHelpMyNum=function(e){if(!e)return 0;var t=0;if(1==e.Type){var a=l.TABLE.getTableDataById(c.TableName.ALLI_ITEM_HELP,e.ItemId.toString());a&&(t=i.DATA.UserData.getItemAmount(a.itemid))}else t=0==e.Type?i.DATA.UserData.Resource.Coin:i.DATA.UserData.Resource.getResource(e.ItemId);return t},e.getBigNum=function(e){for(var t=[];e>0;){var a=e%10;t.push(a),e=Math.floor(e/10)}for(var o="",n=t.length-1;n>=0;n--)2==t.length&&1==t[t.length-1]&&n==t.length-1?o+=V.units[n]:o+=V.smallNum[t[n]]+V.units[n];return o},e.resetNode=function(e){return e&&(e.x=e.y=0,e.scale=1,e.angle=0,e.zIndex=0,e.opacity=255),e},e.getTrapListArray=function(){var e=l.TABLE.getTableDataById(c.TableName.DATACONFIG,"130115");return h.Obj.getProperty(e,"value","").split(",")},e.getSeaMinLevel=function(e){var t=0==e?i.DATA.UserData.FunctionOn(n.FunctionKey.pve_marine_patrol)?"2015":"2007":"132104",a=l.TABLE.getTableDataById(c.TableName.DATACONFIG,t);return a=a?Number(a.value||9999):9999},e.checkTouchInNode=function(e,t){var a=e.getParent().convertToWorldSpaceAR(e.position),o=e.width,n=e.height;return!!new cc.Rect(a.x-o/2,a.y-n/2,o,n).contains(t)},e.checkTreasureThemeHaveNewPieceItem=function(e){var t=l.TABLE.getTableDataById(c.TableName.TreasureContents,e.toString());if(!t||!t.content)return!1;for(var a=t.content.split("|"),o=i.DATA.UserData.TreasureThemeData,n=!1,r=0;r<a.length;r++){var s=l.TABLE.getTableDataById(c.TableName.BUILDING,a[r]);if(!n&&s&&0!=s.is_open&&!i.DATA.UserData.checkTreasureGeted(s.id)&&s.treasure_debris)for(var d=s.treasure_debris.split("|"),p=0;p<d.length;p++){var u=parseInt(d[p]);if(i.DATA.UserData.getItemAmount(u)>0&&!o.CheckItemInThemeCache(u)){n=!0;break}}}return n},e.convertToNodePosByTargetNode=function(e,t){var a=t.parent.convertToWorldSpaceAR(t.position);return e.parent.convertToNodeSpaceAR(a)},e.checkAddWorldMarchQueue=function(t){var a=parseInt(e.getDataConfigData(950018));if(i.DATA.UserData.getItemAmount(a)>0){var r=i.DATA.UserData.Buff.getStateDataById(parseInt(e.getDataConfigData(950019)));if(!r||r.EndTime<=i.DATA.ServerTime){if(t){var s=o.LOCAL.getText("queue_prompt001"),l=o.LOCAL.getText("112347"),c=o.LOCAL.getText("102428");O.default.ShowView(s,l,this,function(){e.useMarchQueueItem()},null,c,"",!1,!1,0,!0,!1,a)}return!0}}if(G.ExchangeController.Instance.isMonthlyCardCanBuy()){if(t){s=o.LOCAL.getText("100271"),l=o.LOCAL.getText("112347"),c=o.LOCAL.getText("101032");O.default.ShowView(s,l,this,function(){G.ExchangeController.Instance.buyMonthlyCard()},null,c)}return!0}if(i.DATA.UserData.FunctionOn(n.FunctionKey.key_novice_adjustments)){var d=ye.default.GetCurScienceDataByGroupId(33e4);if(!d||d.level<25){if(t){s=o.LOCAL.getText("newarea_unlock045"),l=o.LOCAL.getText("112347"),c=o.LOCAL.getText("101032");O.default.ShowView(s,l,this,function(){_.default.Instance().OpenUI(R.UIDataInfo.HeadquartersPanel)},null,c)}return!0}}else if(!i.DATA.UserData.haveScienceByGroupId(324e3)){if(t){s=o.LOCAL.getText("112348"),l=o.LOCAL.getText("112347"),c=o.LOCAL.getText("101032");O.default.ShowView(s,l,this,function(){ye.default.openMainSciencePanel(!0)},null,c)}return!0}return t&&_.default.Instance().ShowTips(o.LOCAL.getText("101145")),!1},e.useMarchQueueItem=function(){var t=parseInt(e.getDataConfigData(950018)),a={itemid:t,amount:1};m.NET.send(f.RequestId.ITEM_USE,a,this,function(a){var n=e.JSON_PARSE(a.d);if(null!==n){n.tips&&_.default.Instance().ShowTips(o.LOCAL.getText(n.tips));var i=2,r=l.TABLE.getTableDataById(c.TableName.ITEM,t.toString());if(r){var s=r.para1.split("|");s.length>=4&&(i=parseInt(s[2])/3600)}var d={useTool:{itemId:t,detail:o.LOCAL.getText("public877",i+"")}};_.default.Instance().OpenUI(R.UIDataInfo.CommonRewardPanel,d),C.send(C.Names.WorldMapUIMyMarchUpdate,null)}})},e.saveServerRegionInfo=function(e){"string"==typeof e.region&&L.set("lastServerRegion",e.region)},e.clientActivityOrder=function(t){if(!e.orderArray.length){for(var a=e.getDataConfigData(930014).split(","),o=0;o<a.length;o++){var n=a[o].split("|"),i={id:n[0],order:Number(n[1])};this.orderArray.push(i)}this.orderArray.sort(function(e,t){return e.order-t.order})}for(o=0;o<e.orderArray.length;o++)for(var r=0;r<t.length;r++)if(t[r].id==e.orderArray[o].id){var s=t.splice(r,1);s.length&&(e.orderArray[o].order>=t.length?t.push(s[0]):t.splice(e.orderArray[o].order,0,s[0]));break}},e.ShowItemDetailView=function(e,t,a,o,i,r){void 0===a&&(a=n.ResourceType.Item),void 0===o&&(o=0),void 0===i&&(i=null),void 0===r&&(r=-1);var s=l.TABLE.getTableDataById(c.TableName.ITEM,String(t));if(s)switch(s.type){case V.ItemType.ItemChooseArmyLineSkin:case V.ItemType.ItemChooseCastleSkin:case V.ItemType.ItemChooseCityEffect:_.default.Instance().OpenUI(R.UIDataInfo.SkinSelectPanel,t,!1);break;default:fe.default.ShowView(e,t,a,o,i,r)}else fe.default.ShowView(e,t,a,o,i,r)},e.getKingMarkData=function(){m.NET.send(f.RequestId.King_Mark_Get,null,this,function(t){if(t.s)t.d;else{var a=e.JSON_PARSE(t.d);i.DATA.UserData.initKingMarkMsg(a.tips)}})},e.setKingMarkData=function(e,t,a,o){m.NET.send(f.RequestId.King_Mark_CHANGE,{x:e,y:t,tips:a,type:o},this,function(e){e.s&&e.d})},e.doMd5=function(e){return""},e._PlayformPayEnable=null,e.VisitLock=!1,e.WelcomeUIShowed=!1,e._A=0,e._A_Hospital=0,e._B_Hospital=0,e._C_Hospital=0,e.GotOtherData=!1,e._ThroneCenterAreas=null,e._BlastedAreas=null,e._buildingLevelSpConfig=[],e.TEST_BUILDING_LEVEL=0,e.CrossTargetId=-1,e.starConfig=null,e._randomIdx=0,e._CheckAtiIndulgedTime=0,e._WarFeverCheckSkip=!1,e.config={41:2,42:1,43:4,44:3,45:5,46:6,47:7,48:9,49:8},e.orderArray=[],e}();a.default=Ce,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/SoundManager":"SoundManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetChatClient":"NetChatClient","../../Core/Net/NetMgr":"NetMgr","../../Core/Utils/GetCompentToAdd":"GetCompentToAdd","../../Core/Utils/Random":"Random","../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../System/CocosWrap":"CocosWrap","../../fws/FWSEnv":"FWSEnv","../../fws/display/MsgBox":"MsgBox","../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/ConfirmPanel":"ConfirmPanel","../Common/ListView/FrameTaskManager":"FrameTaskManager","../Common/LoadManager":"LoadManager","../Common/TaskGuide":"TaskGuide","../Common/UIManager":"UIManager","../Common/biz/DiffBizTool":"DiffBizTool","../Common/icon/IconSystemCommon":"IconSystemCommon","../Common/icon/IconTool":"IconTool","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/HomeMapCommon":"HomeMapCommon","../Const/RequestId":"RequestId","../Const/SceneName":"SceneName","../Const/SoundPath":"SoundPath","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/BattleData":"BattleData","../Data/DataCenter":"DataCenter","../Data/GameConst":"GameConst","../Data/GlobalData":"GlobalData","../Data/GuideData":"GuideData","../Data/PlayerInfo":"PlayerInfo","../Data/UserStaticData":"UserStaticData","../Module/Home/ResFly":"ResFly","../Module/Item/PropItem":"PropItem","../Module/UI/PropDetailPanel":"PropDetailPanel","../Procedure/ProcedureManager":"ProcedureManager","../Profession/ProfessionController":"ProfessionController","../Scene/SceneManager":"SceneManager","../Start/ResetGame":"ResetGame","../alliance/AllianceCommon":"AllianceCommon","../alliance/AllianceController":"AllianceController","../alliance/AllianceScienceNet":"AllianceScienceNet","../alliance/AllianceShopNet":"AllianceShopNet","../alliance/AllianceWelfarePanel":"AllianceWelfarePanel","../battleReport/NBattleReportCommon":"NBattleReportCommon","../components/cointree/CoinTreeComponent":"CoinTreeComponent","../components/worldmap/WorldMapCommon":"WorldMapCommon","../components/worldmap/WorldMapModel":"WorldMapModel","../components/worldmap/WorldMapMsgs":"WorldMapMsgs","../components/worldmap/controllers/WorldMapController":"WorldMapController","../controllers/ActivityController":"ActivityController","../controllers/ArmyEquipController":"ArmyEquipController","../controllers/BuildingController":"BuildingController","../controllers/ExchangeController":"ExchangeController","../controllers/QuestController":"QuestController","../controllers/ScienceController":"ScienceController","../controllers/ThroneController":"ThroneController","../hero/HeroController":"HeroController","./PlayerInfoTool":"PlayerInfoTool","./SubPackMsgs":"SubPackMsgs"}],PlayerInfoTool:[function(e,t,a){"use strict";cc._RF.push(t,"1902du3qnhJdbAjSc4awsqP","PlayerInfoTool");var o,n=e("../Const/GameDefine"),i=e("../Data/DataCenter"),r=e("../../fws/utils/FWSTool"),s=e("./GameTools"),l=e("../../fws/platforms/PlatformCore");(function(e){function t(e,t,a){void 0===a&&(a="");var o=e||t||a;return o=r.Str.replaceSpecChars(o)}function a(e){var t=s.default.getDefaultAvatarByGender(o(e));if(i.DATA.UserData.FunctionOn(n.FunctionKey.AvatarBlock))return t;var a=e.avatarurl||e.headimgurl_custom||e.headimgurl,r=i.DATA.UserData.FunctionOn(n.FunctionKey.UploadHeadImage)&&l.instance.canUploadHeaderPicture;if(""==e.headimgurl_custom||a!=e.headimgurl_custom||r||(a=t),a&&a.indexOf("aprialsfool20")>=0){i.DATA.getLocalTime()>1585756800&&(a="headIcon_1_1")}return a||"headIcon_1_1"}function o(e){return e&&(e.usergender||e.gender)||n.TPlayerGender.Unknow}e.getPlayerDisplayName=t,e.getNameFromTPlayerInfo=function(e,a){return void 0===a&&(a=""),e?t(e.username,e.nickname,a):a},e.getPlayerFromPlayerInfo=function(e,t){return void 0===t&&(t=""),e?e.getDisplayName(t):t},e.getAvatarUrlByInfo=a,e.getAvatarUrlFromTPlayerInfo=function(e){return e?a(e):""},e.getGenderFromTPlayerInfo=o})(o||(o={})),window.PlayerInfoTool=o,t.exports=o,cc._RF.pop()},{"../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../Const/GameDefine":"GameDefine","../Data/DataCenter":"DataCenter","./GameTools":"GameTools"}],SubPackMsgs:[function(e,t,a){"use strict";cc._RF.push(t,"9b163TKallLPYRMqzlZ+hLn","SubPackMsgs");var o,n=e("../../fws/mvc/FWSMvc");(function(e){e.send=function(e,t,a){void 0===a&&(a="");var o=new n.FMessage(e,t,a);return o.send(),o},e.Names={SUBPACK_SAMPLE:"SUBPACK_SAMPLE",SUBPACK_ACTIVITY_EVERYDAY_REWARD:"SUBPACK_ACTIVITY_EVERYDAY_REWARD",SUBPACK_ACTIVITY_EVERYDAY_UPDATE:"SUBPACK_ACTIVITY_EVERYDAY_UPDATE",SUBPACK_ACTIVITY_VALENTINE_ALLSEVER_RANK:"SUBPACK_ACTIVITY_VALENTINE_ALLSEVER_RANK",SUBPACK_BIND_ACCOUNT_AFTER_PUSH:"SUBPACK_BIND_ACCOUNT_AFTER_PUSH",SUBPACK_CHAT_GET_WORLD_CHAT_LIST:"SUBPACK_CHAT_GET_WORLD_CHAT_LIST",SUBPACK_CHAT_GET_ALLIANCE_CHAT_LIST:"SUBPACK_CHAT_GET_ALLIANCE_CHAT_LIST",SUBPACK_CHAT_GET_CROSSSEVER_CHAT_LIST:"SUBPACK_CHAT_GET_CROSSSEVER_CHAT_LIST",SUBPACK_CHAT_GET_KVK_CHAT_LIST:"SUBPACK_CHAT_GET_KVK_CHAT_LIST",SUBPACK_CHAT_CHECK_UNREADUSERINFO:"SUBPACK_CHAT_CHECK_UNREADUSERINFO",SUBPACK_CHAT_CONTROLLER_CALL:"SUBPACK_CHAT_CONTROLLER_CALL",SUBPACK_CHAT_CONTROLLER_SET:"SUBPACK_CHAT_CONTROLLER_SET",SUBPACK_CHAT_GROUP_CHOOSEFRIEND:"SUBPACK_CHAT_GROUP_CHOOSEFRIEND",SUBPACK_ARMY_CHECK_OUT_WAREHOUSE_BATCH_MERGE:"SUBPACK_ARMY_CHECK_OUT_WAREHOUSE_BATCH_MERGE",SUBPACK_CALL_ACTIVITY_CONTROLL_getActivityByActivityId:"SUBPACK_CALL_ACTIVITY_CONTROLL_getActivityByActivityId",SUBPACK_EIGHT_COUNTRY_SET_SERVER_TYPE:"SUBPACK_EIGHT_COUNTRY_SET_SERVER_TYPE",SUBPACK_EIGHT_COUNTRY_SET_KVK_DATA:"SUBPACK_EIGHT_COUNTRY_SET_KVK_DATA",SUBPACK_EIGHT_COUNTRY_SERVER_TYPE:"SUBPACK_EIGHT_COUNTRY_SERVER_TYPE",SUBPACK_EIGHT_COUNTRY_OPEN_STATUS:"SUBPACK_EIGHT_COUNTRY_OPEN_STATUS",EIGHT_COUNTRY_TERRITORY_GET_ONE_ENTITY:"EIGHT_COUNTRY_TERRITORY_GET_ONE_ENTITY",SUBPACK_EIGHT_COUNTRY_MY_COLOR:"SUBPACK_EIGHT_COUNTRY_MY_COLOR",SUBPACK_EIGHT_COUNTRY_FINISH_NUMS:"SUBPACK_EIGHT_COUNTRY_FINISH_NUMS",SUBPACK_EIGHT_COUNTRY_REGISTER:"SUBPACK_EIGHT_COUNTRY_REGISTER",SUBPACK_EC_PREPARE_getTaskInfo:"SUBPACK_EC_PREPARE_getTaskInfo",SUBPACK_EIGHT_COUNTRY_MY_COLOR_INDEX:"SUBPACK_EIGHT_COUNTRY_MY_COLOR_INDEX",SUBPACK_EIGHT_COUNTRY_KVK_BUILDING:"SUBPACK_EIGHT_COUNTRY_KVK_BUILDING",ARENA_PVP_MAIN_PANEL_OEPN:"ARENA_PVP_MAIN_PANEL_OEPN",SUBPACK_ARENA_PVE_TIME:"SUBPACK_ARENA_PVE_TIME",SUBPACK_askPveConfig:"SUBPACK_askPveConfig",SUBPACK_ARENA_PVP_CONFIG_ARMY_NUM:"SUBPACK_ARENA_PVP_CONFIG_ARMY_NUM",SUBPACK_ARENA_PVP_HERO_CONFIG:"SUBPACK_ARENA_PVP_HERO_CONFIG",SUBPACK_ARENA_PVP_THEME_CONFIG:"SUBPACK_ARENA_PVP_THEME_CONFIG",Push_AREAN_CONFIG_PUSH:"Push_AREAN_CONFIG_PUSH",SUBPACK_ARENA_CONFIG:"SUBPACK_ARENA_CONFIG",ARENA_THEME:"ARENA_THEME",SUBPACK_ARENA_PVE_CONFIG_ARMY_NUM:"SUBPACK_ARENA_PVE_CONFIG_ARMY_NUM",SUBPACK_PURGE:"SUBPACK_PURGE",SUBPACK_EIGHT_COUNTRY_GET_STAGES:"SUBPACK_EIGHT_COUNTRY_GET_STAGES",SUBPACK_EIGHT_COUNTRY_STRONGEST_LEADER:"SUBPACK_EIGHT_COUNTRY_STRONGEST_LEADER",SUBPACK_EIGHT_COUNTRY_CHANGE_TASK:"SUBPACK_EIGHT_COUNTRY_CHANGE_TASK"}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc"}],TimeZoneTool:[function(e,t,a){"use strict";cc._RF.push(t,"ae5c6lVsI9Jloqqoa4nzJCY","TimeZoneTool");var o,n=e("../../fws/utils/FWSTool");(function(e){var t=/\{([a-zA-Z0-9]+):([^\}]+)\}/gm,a=null;function o(e,t,o){if(!e||e.length<3)return t;var n=e.index,c=e[0].length,d=e[1];d=d.toLowerCase();var p=e[2];a||(a={hour:i,datetime:r,week:s,weekhour:l});var u="";if(a[d])try{u=a[d](p,o)}catch(e){}return t.substr(0,n)+u+t.substr(n+c)}function i(e,t){var a=parseInt(e)||0;return n.DateTime.convertTimeZoneHours(a)+""}function r(e,t){if(e){var a=n.Str.matchs(/\d+/gm,e),o=parseInt(a[0])||0,i=parseInt(a[1])-1||0,r=parseInt(a[2])||0,s=parseInt(a[3])||0,l=parseInt(a[4])||0,c=parseInt(a[5])||0,d=new Date(o,i,r,s,l,c);return d=n.DateTime.convertTimeZone(d),n.Str.dateTimeFormat(d)}return""}function s(e,t){return e?c(parseInt(e)||0,null,t):""}function l(e,t){if(e){var a=e.split(",");return c(parseInt(a[0])||0,parseInt(a[1])||0,t)}return""}function c(e,t,a){if(void 0===t&&(t=null),e>=1&&e<=7){var o="";if(null!=t)o=h(n=new Date(2019,6,e,t,0,0,0),a);else if(-480!=(new Date).getTimezoneOffset()){var n=new Date(2019,6,e,0,0,0,0),i=new Date(2019,6,e+1,0,0,0,0);o=a.getText("tz_range",h(n,a),h(i,a))}else o=u(e,a);return o}}function d(e){var t=e;return t<1&&(t=7),t}function p(e,t){var a=e+"";return t.getText("tz_hours",a)}function u(e,t){return t.getText("tz_week"+e)}function h(e,t,a){void 0===a&&(a=!0);var o=n.DateTime.convertTimeZone(e),i=u(d(o.getDay()),t);return a&&(i+=p(o.getHours(),t)),i}e.replaceTSParams=function(e,a){try{for(var i=e,r=n.Str.matchs(t,e),s=r.length-1;s>=0;s--)i=o(r[s],i,a);return i}catch(t){return e}},e.fixTextWithZoneTime=function(e){var t=new RegExp(/\d{4}\D+\d{1,2}\D+\d{1,2}\D+\d+\D+\d+(\D\d+)?/gm),a=n.Str.matchs(t,e),o=e;if(0==a.length)return o;for(var i=0;i<a.length;i++){var s=a[i],l=r(s[0],null);o=o.replace(s[0],l)}return o}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../fws/utils/FWSTool":"FWSTool"}],AllianceAssemlbyController:[function(e,t,a){"use strict";cc._RF.push(t,"fd6b0UWMI9OerPnUU1lVMLc","AllianceAssemlbyController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/mvc/FWSMvc"),n=e("../../Core/Net/NetMgr"),i=e("../Const/RequestId"),r=e("../Tools/GameTools"),s=e("../Data/DataCenter"),l=e("../../fws/utils/X"),c=e("../Const/GameDefine"),d=e("../../Core/Event/EventCenter"),p=e("../Const/EventId"),u=function(e){function t(){var t=e.call(this)||this;return t.m_blockStr="",t.m_blockData=[],t}return __extends(t,e),t.getInstance=function(){return this._instance||(this._instance=new t),window.AllianceAssemlbyController=this._instance,this._instance},t.prototype.GetAssemlbyDatas=function(){var e=this;n.NET.send(i.RequestId.ALLIANCE_Assemblys,{},this,function(t){var a=r.default.JSON_PARSE(t.d);r.default.ObjIsEmpty(a)||(s.DATA.UserData.UpdateAlliacneAssemlyDatas(a),e.checkBlockList())}),this.initBlockList(),this.GetAssemblyBattleRecordDatas(),this.GetAssistanceDatas(),this.GetAssistanceRecordDatas()},t.prototype.GetAssistanceDatas=function(){n.NET.send(i.RequestId.ALLIANCE_Assistances,{},this,function(e){var t=r.default.JSON_PARSE(e.d);l.table(t),r.default.ObjIsEmpty(t)||s.DATA.UserData.UpdateAlliacneAssistanceDatas(t.member)})},t.prototype.GetAssistanceRecordDatas=function(){n.NET.send(i.RequestId.ALLIANCE_AssistanceRecored,{},this,function(e){var t=r.default.JSON_PARSE(e.d);l.table(t),r.default.ObjIsEmpty(t)||s.DATA.UserData.UpdateAlliacneAssistanceRecordDatas(t.reinforceList)})},t.prototype.GetAssemblyBattleRecordDatas=function(){n.NET.send(i.RequestId.ALLIANCE_AssemblyBattleRecored,{},this,function(e){var t=r.default.JSON_PARSE(e.d);l.table(t),r.default.ObjIsEmpty(t)||s.DATA.UserData.UpdateAssemblyBattleRecordDatas(t.recordList)})},t.prototype.initBlockList=function(){this.m_blockData=[];var e=s.DATA.UserData.getLocalData(c.LocalDataKey.AllianceBlock,""),t=e?e.split(","):[];this.m_blockStr=e;for(var a=0;a<t.length;a++)this.m_blockData.push(t[a])},t.prototype.checkBlockList=function(){for(var e=!1,t=this.m_blockData.length-1;t>=0;t--)if(""!=this.m_blockData[t]){for(var a=!1,o=0;o<s.DATA.UserData.AllianceAssemlbyDatas.length;o++){var n=s.DATA.UserData.AllianceAssemlbyDatas[o];if(this.m_blockData[t]==n.teamId){a=!0;break}}a||(this.m_blockData.splice(t,1),e=!0)}e&&this.saveBlock()},t.prototype.setBlockAssemlItem=function(e){if(!(this.m_blockData.indexOf(e)>-1))return""!=this.m_blockStr?this.m_blockStr+=","+e:this.m_blockStr=e,this.m_blockData.push(e),s.DATA.UserData.setLocalData(c.LocalDataKey.AllianceBlock,this.m_blockStr),d.EVENT.emit(p.EventId.AssemblysUpdate),!0},Object.defineProperty(t.prototype,"AllianceAssemlData",{get:function(){for(var e=s.DATA.UserData.AllianceAssemlbyDatas.concat(),t=e.length-1;t>=0;t--)this.m_blockData.indexOf(e[t].teamId)>-1&&e.splice(t,1);return e},enumerable:!0,configurable:!0}),t.prototype.saveBlock=function(){this.m_blockStr="";for(var e=0;e<this.m_blockData.length;e++)""!=this.m_blockStr?this.m_blockStr+=","+this.m_blockData[e]:this.m_blockStr=this.m_blockData[e];s.DATA.UserData.setLocalData(c.LocalDataKey.AllianceBlock,this.m_blockStr)},t}(o.FMessageConnectionAbstract);a.default=u,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/utils/X":"X","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],AllianceCommon:[function(e,t,a){"use strict";var o;cc._RF.push(t,"97eb7/yR+NNJ5smK/r96ZZU","AllianceCommon"),function(e){e.ICON_NUM=2,function(e){e[e.peace=0]="peace",e[e.fight=1]="fight"}(e.AllianceCityState||(e.AllianceCityState={})),function(e){e[e.coin=0]="coin",e[e.gold=1]="gold",e[e.leader=2]="leader"}(e.AllianceRoleBufType||(e.AllianceRoleBufType={})),function(e){e[e.Help=0]="Help",e[e.FakeGift=1]="FakeGift"}(e.AllianceWelfareType||(e.AllianceWelfareType={})),function(e){e[e.ReceiveGift=0]="ReceiveGift",e[e.UpMember=1]="UpMember",e[e.DownMember=2]="DownMember",e[e.ExpelMember=3]="ExpelMember",e[e.Invite=4]="Invite",e[e.ManageApply=5]="ManageApply",e[e.EditNotice=6]="EditNotice",e[e.EditDeclare=7]="EditDeclare",e[e.EditSlogan=8]="EditSlogan",e[e.ChangeBadge=9]="ChangeBadge",e[e.ChangeName=10]="ChangeName",e[e.SelectLanguage=11]="SelectLanguage",e[e.OpenRecruit=12]="OpenRecruit",e[e.GiveUpPosition=13]="GiveUpPosition",e[e.Dismiss=14]="Dismiss",e[e.ChangeCountry=15]="ChangeCountry",e[e.UpScience=16]="UpScience",e[e.RecommendScience=17]="RecommendScience",e[e.SendToAllMail=18]="SendToAllMail"}(e.AllianceAuthorityType||(e.AllianceAuthorityType={})),function(e){e[e.Fortress=1]="Fortress",e[e.SuperMine=2]="SuperMine",e[e.Defense=3]="Defense"}(e.AllianceTerritoryBuildType||(e.AllianceTerritoryBuildType={})),function(e){e[e.Locked=0]="Locked",e[e.CanBuild=1]="CanBuild",e[e.Building=2]="Building",e[e.CanGarrison=3]="CanGarrison"}(e.AllianceTerritoryBuildStatus||(e.AllianceTerritoryBuildStatus={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.FIREING=1]="FIREING",e[e.FIXING=2]="FIXING",e[e.NO_ACTIVE=3]="NO_ACTIVE"}(e.KVKAllianceTerritoryBuildStatus||(e.KVKAllianceTerritoryBuildStatus={})),function(e){e[e.Donate=1]="Donate",e[e.Shop=2]="Shop",e[e.Member=3]="Member",e[e.Rank=4]="Rank",e[e.Function=5]="Function",e[e.Apply=6]="Apply",e[e.Territory=7]="Territory",e[e.Gift=8]="Gift"}(e.AllianceDevelopType||(e.AllianceDevelopType={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],AllianceController:[function(e,t,a){"use strict";cc._RF.push(t,"054d2rCSQ1BJYjqnKi0QYmJ","AllianceController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../fws/utils/FWSTool"),i=e("../../Core/Common/TableManager"),r=e("../Data/DataCenter"),s=e("../Tools/GameTools"),l=e("../../fws/mvc/FWSMvc"),c=e("../../Core/Net/NetMgr"),d=e("../Const/RequestId"),p=e("../Common/UIManager"),u=e("../Const/UIDataInfo"),h=e("../Data/AllianceData"),m=e("../Const/GameDefine"),f=e("../../Core/Event/EventCenter"),_=e("../Const/EventId"),y=e("../Data/PlayerInfo"),g=e("./AllianceCommon"),C=e("../../fws/utils/X"),v=e("../../fws/platforms/PlatformCore"),I=e("./AllianceAssemlbyController"),T=e("../Const/TableName"),S=e("../Tools/SubPackMsgs"),A=function(e){function t(){var t=e.call(this)||this;return t.applyCount=0,t.isPopRecommand=!1,t}return __extends(t,e),t.prototype.isShowAllianceBtn=function(){if(!r.DATA.UserData.FunctionOn(m.FunctionKey.Alliance))return!1;var e=i.TABLE.getTableDataById(T.TableName.DATACONFIG,"9903");if(n.Obj.isEmpty(e))return!1;var t=n.Obj.getPropertyByNames(e,null,"value");return null!==t&&r.DATA.UserData.Level>=parseInt(t)},t.prototype.onAllianceBtnClick=function(){this.tryOpenMyAllianceMainView()},t.prototype.tryOpenMyAllianceMainView=function(){s.default.CheckArrearGold(m.GameOperation.Alliance)||c.NET.send(d.RequestId.ALLIANCE_GET_INFO,{},this,function(e){C.log(e);var t=s.default.JSON_PARSE(e.d);null!=t&&(void 0!==t.allianceInfo?(r.DATA.UserData.UpdateAllianceInfo(t.allianceInfo),(new h.default).UpdateData(t.allianceInfo),p.default.Instance().OpenUI(u.UIDataInfo.AllianceMainPanel)):p.default.Instance().OpenUI(u.UIDataInfo.AllianceJoinPopup))})},t.prototype.tryOpenOtherAllianceInfoView=function(e){c.NET.send(d.RequestId.ALLIANCE_GET_INFO,{allianceId:e},this,function(e){var t=s.default.JSON_PARSE(e.d);if(null!=t&&void 0!==t.allianceInfo){var a=new h.default;a.UpdateData(t.allianceInfo),a.Aid===r.DATA.UserData.Alliance.Aid?p.default.Instance().OpenUI(u.UIDataInfo.AllianceMainPanel):p.default.Instance().OpenUI(u.UIDataInfo.AllianceMainOtherPopup,a)}})},t.prototype.getAutoAssemlbyData=function(){r.DATA.UserData.FunctionOn(m.FunctionKey.AutoAssemlby)&&c.NET.send(d.RequestId.ALLIANCE_AUTO_ASSEMLBY_GET,{},this,function(e){if(0==e.s){var t=s.default.JSON_PARSE(e.d);r.DATA.UserData.Alliance.AutoAssemlbyData.UpdateData(t)}})},t.prototype.SetAutoAssemlbyData=function(e,t,a,n){var i={joinArmyType:e,joinTargetTypes:t,open:a};c.NET.send(d.RequestId.ALLIANCE_AUTO_ASSEMLBY_SET,i,this,function(e){if(0==e.s){var t=s.default.JSON_PARSE(e.d);r.DATA.UserData.Alliance.AutoAssemlbyData.UpdateData(t),n?p.default.Instance().ShowTips(o.LOCAL.getText("auto_join013")):p.default.Instance().ShowTips(o.LOCAL.getText("auto_zhanchui04"))}})},t.prototype.getIconPathByIdx=function(e){return"image/alliance/icon_alliance_"+e},t.prototype.haveAllianceHelp=function(){if(r.DATA.UserData.ServerState==m.ServerState.Ready||r.DATA.UserData.ServerState==m.ServerState.Fight)return!1;if(!r.DATA.UserData.Alliance)return!1;var e=i.TABLE.getTableDataById(T.TableName.ALLIANCE_FUNCTION_UNLOCK,"1");if(e&&r.DATA.UserData.Alliance.Achevementlevel<e.need_level)return!1;var t=r.DATA.UserData.Alliance.getSelfHelpData();return null!==t&&1===t.State},t.prototype.haveAllianceShopRefresh=function(){var e=i.TABLE.getTableDataById(T.TableName.ALLIANCE_FUNCTION_UNLOCK,"3");return!(e&&r.DATA.UserData.Alliance.Achevementlevel<e.need_level)&&(!!r.DATA.UserData.FunctionOn(m.FunctionKey.AllianceShop)&&(null!==r.DATA.UserData.Alliance.shopData&&r.DATA.UserData.Alliance.shopData.isShowRedPoint()))},t.prototype.getAllianceTotalRedPoint=function(){if(!r.DATA.UserData.Alliance.isInAlliance())return 0;var e=0;return this.applyCount>0&&this.isHasPermission(g.AllianceAuthorityType.ManageApply)&&(e+=this.applyCount),e+=r.DATA.UserData.Alliance.AllianceHelpList.length,this.haveAllianceHelp()&&++e,this.haveAllianceShopRefresh()&&++e,e+=this.getAllianceGiftNum(),e+=I.default.getInstance().AllianceAssemlData.length,this.isClickAllianceScienceToday()||++e,this.canDonateAllianceBoss()&&++e,e+=r.DATA.UserData.AllianceRedDot.badge.length+r.DATA.UserData.AllianceRedDot.levelTask,e+=this.getAllianceTerritoryRedDot()},t.prototype.getAllianceGiftNum=function(){return 0==r.DATA.UserData.FunctionOn(m.FunctionKey.AllianceGift)||0==r.DATA.UserData.Alliance.isInAlliance()?0:r.DATA.UserData.Alliance.AllianceGiftData.getTotalRewardNum()},t.prototype.getAllianceTerritoryRedDot=function(){var e=0;if(e+=this.isClickAllianceMonsterDefender(),r.DATA.UserData.AllianceDefenderData.redDot)for(var t in r.DATA.UserData.AllianceDefenderData.redDot)e+=r.DATA.UserData.AllianceDefenderData.redDot[t];return e},t.prototype.isClickAllianceMonsterDefender=function(){return 0},t.prototype.isClickAllianceScienceToday=function(){var e=i.TABLE.getTableDataById(T.TableName.ALLIANCE_FUNCTION_UNLOCK,"2");if(e&&r.DATA.UserData.Alliance.Achevementlevel<e.need_level)return!0;if(!r.DATA.UserData.FunctionOn(m.FunctionKey.AllianceScience))return!0;var t=r.DATA.UserData.getLocalData(m.LocalDataKey.ClickAllianceScienceDay,0),a=s.default.GetTimeOfDay();return t>0&&t==a},t.prototype.canDonateAllianceBoss=function(){var e=i.TABLE.getTableDataById(T.TableName.ALLIANCE_FUNCTION_UNLOCK,"6");return!(e&&r.DATA.UserData.Alliance.Achevementlevel<e.need_level)&&!(!r.DATA.UserData.Alliance.territoryData.judgeIfHaveTerritoryCanGarrison()||!r.DATA.UserData.Alliance.AllianceBossDonateFree)},t.prototype.getTerritoryInfo=function(){r.DATA.UserData.Alliance.isInAlliance()&&(S.send(S.Names.SUBPACK_EIGHT_COUNTRY_SERVER_TYPE,null).data?r.DATA.UserData.Alliance.kvkTerritoryData.sendCmdGetTerritoryInfo():r.DATA.UserData.Alliance.territoryData.sendCmdGetTerritoryInfo())},t.prototype.getAllianceGiftData=function(){0!=r.DATA.UserData.FunctionOn(m.FunctionKey.AllianceGift)&&r.DATA.UserData.Alliance.isInAlliance()&&c.NET.send(d.RequestId.GET_ALLIANCE_GIFTS,{},this,function(e){if(0==e.s){var t=s.default.JSON_PARSE(e.d);r.DATA.UserData.Alliance.UpdateAllianceGiftData(t),f.EVENT.emit(_.EventId.AllianceGiftUpdate)}})},t.prototype.getAllianceBossDonateData=function(){c.NET.send(d.RequestId.ALLIANCE_BOSS_GET_INFO,{},this,function(e){var t=s.default.JSON_PARSE(e.d);null!=t&&r.DATA.UserData.Alliance.UpdateAllianceBossDonateFree(t)})},t.prototype.getAllianceFakeMemberIconPath=function(){return"image/mainui_old/alliance_fake_member.png"},t.prototype.getAllianceFakeGiftRewardId=function(){return i.TABLE.getTableDataById(T.TableName.DATACONFIG,"16009").value},t.prototype.checkPushAllianceFakeGift=function(){!this.haveReceiveAllianceFakeGift()&&this.isReachAllianceFakeGiftPlayerLvLimit()&&f.EVENT.emit(_.EventId.AllianceFakeGiftUpdate)},t.prototype.getAllianceFakeGiftPlayerLvLimit=function(){return i.TABLE.getTableDataById(T.TableName.DATACONFIG,"16008").value},t.prototype.isReachAllianceFakeGiftPlayerLvLimit=function(){var e=this.getAllianceFakeGiftPlayerLvLimit();return!(r.DATA.UserData.Level<e)},t.prototype.haveReceiveAllianceFakeGift=function(){return 1===r.DATA.UserData.HaveReceiveAllianceFakeGift},t.prototype.haveAllianceFakeGift=function(){return!!r.DATA.UserData.FunctionOn(m.FunctionKey.AllianceFakeGift)&&(r.DATA.UserData.ServerState!=m.ServerState.Ready&&r.DATA.UserData.ServerState!=m.ServerState.Fight&&(!!this.isReachAllianceFakeGiftPlayerLvLimit()&&!this.haveReceiveAllianceFakeGift()))},t.prototype.getRankCellData=function(e,t){var a=n.Obj.getProperty(t,"uid",""),o=n.Obj.getProperty(t,"playerInfo",""),i=new y.default;return i.update(o),{rank:e+1,uid:a,power:n.Obj.getProperty(t,"power",0),worldId:n.Obj.getProperty(t,"worldId",-1),playerInfo:i,rLevel:n.Obj.getProperty(t,"r_level",0)}},t.prototype.getMyRankCellData=function(e,t){return{rank:e+1,uid:r.DATA.UserData.UID.toString(),power:t,worldId:r.DATA.UserData.WorldId,playerInfo:r.DATA.UserData.PlayerInfoData.playerInfo}},t.prototype.JoinAlliance=function(e){v.instance.postStatsEvent("join_alliance"),c.NET.send(d.RequestId.ALLIANCE_APPLY,{allianceId:e},this,function(e){var t=s.default.JSON_PARSE(e.d);null!=t&&(void 0!==t.allianceInfo&&((new h.default).UpdateData(t.allianceInfo),r.DATA.UserData.UpdateAllianceInfo(t.allianceInfo),p.default.Instance().OpenUI(u.UIDataInfo.AllianceMainPanel),p.default.Instance().ShowTips(o.LOCAL.getText("100370",r.DATA.UserData.Alliance.Name)),r.DATA.UserData.UpdateAlliacneAssemly()))})},t.prototype.isHasPermission=function(e){var t=i.TABLE.getTableDataById(T.TableName.LEAGUE_RANK,e.toString());if(n.Obj.isEmpty(t))return!1;if(1!==n.Obj.getPropertyByNames(t,null,"is_show"))return!1;var a=n.Obj.getPropertyByNames(t,null,"rank"+r.DATA.UserData.Alliance.Rank);return 1===Number(a)},t.prototype.checkPopFirstJoinReward=function(){r.DATA.UserData.IsJoinedAllianceBefore||(r.DATA.UserData.IsJoinedAllianceBefore=!0,p.default.Instance().OpenUI(u.UIDataInfo.AllianceFirstJoinRewardPopup),f.EVENT.emit(_.EventId.MainUI_Update))},t.prototype.showErrorMsgById=function(e){if(isNaN(e)||null==e)return!1;var t="";switch(e){case 2201:t=o.LOCAL.getText("100401");break;case 2202:t=o.LOCAL.getText("100402");break;case 2203:t=o.LOCAL.getText("100403");break;case 2204:t=o.LOCAL.getText("100404");break;case 2205:t=o.LOCAL.getText("100405");break;case 2206:t=o.LOCAL.getText("100406");break;case 2207:t=o.LOCAL.getText("100398");break;case 2209:t=o.LOCAL.getText("100407");break;case 2210:t=o.LOCAL.getText("100408");break;case 2211:t=o.LOCAL.getText("100409");break;case 2215:t=o.LOCAL.getText("100410");break;case 2250:t=o.LOCAL.getText("100411");break;case 2251:t=o.LOCAL.getText("100412")}return""!==t&&(p.default.Instance().ShowTips(t),!0)},t.prototype.getRobotNotic=function(){var e=i.TABLE.getTableDataById(T.TableName.DATACONFIG,"130004"),t=n.Obj.getPropertyStringByNames(e,"95","value"),a=i.TABLE.getTableDataById(T.TableName.DATACONFIG,"130003"),r=n.Obj.getPropertyStringByNames(a,"0","value");r=s.default.getShortTimeShowSingleNew(Number(r));var l=i.TABLE.getTableDataById(T.TableName.DATACONFIG,"130005"),c=n.Obj.getPropertyStringByNames(l,"50","value"),d=i.TABLE.getTableDataById(T.TableName.DATACONFIG,"130007"),p=n.Obj.getPropertyStringByNames(d,"95","value"),u=i.TABLE.getTableDataById(T.TableName.DATACONFIG,"130006"),h=n.Obj.getPropertyStringByNames(u,"0","value");return h=s.default.getShortTimeShowSingleNew(Number(h)),o.LOCAL.getText("VirtualAlliance_Rules",t,r,c,p,h,p)},t.getInstance=function(){return t._instance||(t._instance=new t),window.AllianceController=t._instance,t._instance},t.prototype.purge=function(){t._instance=null},t}(l.FMessageConnectionAbstract);a.AllianceController=A,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/AllianceData":"AllianceData","../Data/DataCenter":"DataCenter","../Data/PlayerInfo":"PlayerInfo","../Tools/GameTools":"GameTools","../Tools/SubPackMsgs":"SubPackMsgs","./AllianceAssemlbyController":"AllianceAssemlbyController","./AllianceCommon":"AllianceCommon"}],AllianceHelpItem:[function(e,t,a){"use strict";cc._RF.push(t,"03633lVrtZDQ520sn5YUW7A","AllianceHelpItem"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../System/ComponentBase"),i=e("../Data/DataCenter"),r=e("../Tools/GameTools"),s=e("../Common/UIManager"),l=e("../../Core/Utils/UpdateSpriteFrame"),c=e("../Const/UIDataInfo"),d=e("../../fws/utils/FWSTool"),p=e("../Common/ConfirmPanel"),u=e("../../Core/Common/TableManager"),h=e("../Const/TableName"),m=cc._decorator,f=m.ccclass,_=m.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabName=null,t.LabLevel=null,t.LabCity=null,t.LabCoin=null,t.LabProvideHelp=null,t.LabReward=null,t.PlayerIcon=null,t.NodeMan=null,t.NodeWomen=null,t.BtnHelp=null,t.NodeHonor=null,t.LabHelpType=null,t.HelpItemIcon=null,t._NickName=o.LOCAL.getText("110085"),t._IsMySelf=!1,t.itemLevel=1,t}var a;return __extends(t,e),a=t,Object.defineProperty(t.prototype,"Data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NickName",{get:function(){return this._NickName},enumerable:!0,configurable:!0}),t.prototype.UpdateItem=function(e,t){this._Delegate=t,this._data=e;var a=e.IsMySelf;this._IsMySelf=a;var n=o.LOCAL.getText("name_001","");if(this.LabHelpType.string=o.LOCAL.getText("alli_request011"),1==e.Type){var s=u.TABLE.getTableDataById(h.TableName.ALLI_ITEM_HELP,e.ItemId.toString());s&&r.default.UpdateItemIcon(s.itemid,this.HelpItemIcon)}else l.UpdateSpriteFrame(r.default.getResourceIcon(e.ItemId),this.HelpItemIcon);if(a){var c="";c=i.DATA.UserData.PlayerInfoData.playerInfo.getDisplayName(),d.Str.isEmpty(c)&&(c=o.LOCAL.getText("110086")),this.LabName.string=c,this._NickName=c,this.LabLevel.string=n+i.DATA.UserData.Level.toString(),l.UpdateSpriteFrameByWXUrl(i.DATA.UserData.PlayerInfoData.playerInfo.getDisplayAvatarUrl(),this.PlayerIcon);var p=i.DATA.UserData.PlayerInfoData.playerInfo.gender||0;this.setGenderShow(p)}else if(e.PlayerInfo.isEmpty){c=r.default.getPlayerDisplayName(e.PlayerInfo);this.LabName.string=c,this.LabLevel.string=n+e.PlayerInfo.level.toString(),this.setGenderShow(e.PlayerInfo.gender),l.UpdateSpriteFrameByWXUrl(e.PlayerInfo.getDisplayAvatarUrl(),this.PlayerIcon),this._NickName=c,this.itemLevel=e.PlayerInfo.level}else{c=o.LOCAL.getText("110087");this.LabName.string=c,this._NickName=c,this.LabLevel.string=n+"1"}this.LabCoin.string=r.default.GetLargeNumberShow(e.Num),this.BtnHelp.getComponent(cc.Sprite).enabled=!a,this.NodeHonor.active=!a,this.BtnHelp.getComponent(cc.Button).interactable=!a,this.LabProvideHelp.node.active=!a,a?(this.LabReward.string="",this.setLabCoinColor(cc.Color.WHITE)):(this.LabReward.string=r.default.GetLargeNumberShow(e.Honor),e.Num>r.default.getAllianceHelpMyNum(this._data)?this.setLabCoinColor(cc.Color.RED):this.setLabCoinColor(cc.Color.WHITE))},t.prototype.setGenderShow=function(e){this.NodeMan.active=e<=1,this.NodeWomen.active=2==e},t.prototype.setLabCoinColor=function(e){this.LabCoin.node.color=e},t.prototype.onHelpClick=function(){if(!this._IsMySelf)if(r.default.getAllianceHelpMyNum(this._data)<this._data.Num)s.default.Instance().ShowTips(o.LOCAL.getText("Manufacture018"));else if(1!=this._data.Type){if(this.itemLevel-i.DATA.UserData.Level>=5)return void s.default.Instance().ShowTips(o.LOCAL.getText("league_ui_006"));a.ShowOverLevelTips&&i.DATA.UserData.Level<this.itemLevel?p.default.ShowView(o.LOCAL.getText("league_help_001"),o.LOCAL.getText("100127"),this,this.SureHelpMember,null,"","",!0):this.SureHelpMember(!1)}else this.SureHelpMember(!1)},t.prototype.SureHelpMember=function(e){1==e&&(a.ShowOverLevelTips=!1),this._Delegate.onItemClick(this,this._data.Type)},t.prototype.onPlayerInfoShow=function(){s.default.Instance().OpenUI(c.UIDataInfo.PlayerInfoPanel,this.Data.Uid.toString())},t.ShowOverLevelTips=!0,__decorate([_(cc.Label)],t.prototype,"LabName",void 0),__decorate([_(cc.Label)],t.prototype,"LabLevel",void 0),__decorate([_(cc.Label)],t.prototype,"LabCity",void 0),__decorate([_(cc.Label)],t.prototype,"LabCoin",void 0),__decorate([_(cc.Label)],t.prototype,"LabProvideHelp",void 0),__decorate([_(cc.Label)],t.prototype,"LabReward",void 0),__decorate([_(cc.Sprite)],t.prototype,"PlayerIcon",void 0),__decorate([_(cc.Node)],t.prototype,"NodeMan",void 0),__decorate([_(cc.Node)],t.prototype,"NodeWomen",void 0),__decorate([_(cc.Node)],t.prototype,"BtnHelp",void 0),__decorate([_(cc.Node)],t.prototype,"NodeHonor",void 0),__decorate([_(cc.Label)],t.prototype,"LabHelpType",void 0),__decorate([_(cc.Sprite)],t.prototype,"HelpItemIcon",void 0),t=a=__decorate([f],t)}(n.default);a.default=y,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../System/ComponentBase":"ComponentBase","../../fws/utils/FWSTool":"FWSTool","../Common/ConfirmPanel":"ConfirmPanel","../Common/UIManager":"UIManager","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],AllianceHelpPanel:[function(e,t,a){"use strict";cc._RF.push(t,"0e1af2H3vdDVZAht3rATS+D","AllianceHelpPanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../Common/UIManager"),i=e("../Const/UIDataInfo"),r=e("../Common/BaseUI"),s=e("../../fws/display/FWSTableView"),l=e("./AllianceHelpItem"),c=e("../Data/DataCenter"),d=e("../Tools/GameTools"),p=e("../../Core/Net/NetMgr"),u=e("../Const/RequestId"),h=e("../../Core/Event/EventCenter"),m=e("../Const/EventId"),f=e("../Module/Home/ResFly"),_=e("../Const/GameDefine"),y=e("../components/SimpleDescTips"),g=e("../Common/ConfirmPanel"),C=e("../Common/MessageInfoPanel"),v=e("../../fws/utils/FWSTool"),I=e("../../Core/Utils/UpdateSpriteFrame"),T=e("../../Core/Common/TableManager"),S=e("../Const/TableName"),A=cc._decorator,D=A.ccclass,N=A.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollview=null,t.content=null,t.itemPrefabNode=null,t.BtnHelp=null,t.BtnReceive=null,t.BtnHonorTips=null,t.LabHelpCount=null,t.SelfHelpNum=null,t.SelfHelpIcon=null,t.BtnCancleHelp=null,t.HelpEmptyNode=null,t.LabBtnHelp=null,t.LabHonor=null,t.HonorProgressBar=null,t.LabHonorProgress=null,t.HelpingNode=null,t.HelpInstructionNode=null,t.helpNameLabel=null,t.countNode=null,t.RewardCoin=0,t._tableView=null,t.helpList=new Array,t}return __extends(t,e),t.ShowView=function(){0!=c.DATA.UserData.FunctionOn(_.FunctionKey.AllianceHelp)?n.default.Instance().OpenUI(i.UIDataInfo.AllianceHelpPanel):n.default.Instance().ShowTips(o.LOCAL.getText("110090"))},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),this._tableView||(this._tableView=s.FWSTableView.createTableView(this._tableView,this)),this.UpdateView()},t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),h.EVENT.on(m.EventId.AllianceHelpUpdate,this.UpdateView,this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),h.EVENT.off(m.EventId.AllianceHelpUpdate,this.UpdateView,this),this._tableView&&this._tableView.onDisableTableView()},t.prototype.cpnDestroy=function(){this._tableView&&this._tableView.onDestroyTableView(),e.prototype.cpnDestroy.call(this)},t.prototype.UpdateView=function(){var e=c.DATA.UserData.Alliance;this.LabHelpCount.string=o.LOCAL.getText("100350")+"("+e.AllianceHelpCount.toString()+"/"+e.AllianceHelpMax.toString()+")",this.LabHonor.string=c.DATA.UserData.Resource.Honor.toString();var t=e.getSelfHelpData();if(this.HelpingNode.active=null!=t,this.HelpInstructionNode.active=null==t,t)if(this.SelfHelpNum.string=d.default.GetLargeNumberShow(t.Num),1==t.Type){var a=T.TABLE.getTableDataById(S.TableName.ALLI_ITEM_HELP,t.ItemId.toString());a&&d.default.UpdateItemIcon(a.itemid,this.SelfHelpIcon)}else I.UpdateSpriteFrame(d.default.getResourceIcon(t.ItemId),this.SelfHelpIcon);var n=c.DATA.UserData.Alliance.AllianceHelpList.slice(0);if(this.BtnHelp.node.active=null==t,this.BtnReceive.node.active=t&&1==t.State,this.BtnCancleHelp.active=t&&0==t.State,this.countNode.active=!0,this.helpNameLabel.node.active=!1,t&&1==t.State){this.countNode.active=!1,this.helpNameLabel.node.active=!0;var i=d.default.getPlayerDisplayName(t.HelpInfo,o.LOCAL.getText("110003"));this.helpNameLabel.string=o.LOCAL.getText("league_help_003",i)}null==t&&(e.AllianceHelpCount>=e.AllianceHelpMax?this.LabBtnHelp.string=o.LOCAL.getText("110092"):this.LabBtnHelp.string=o.LOCAL.getText("110093")),this.BtnCancleHelp.active&&(t.setIsMySelf(!0),n.unshift(t)),this.helpList=n,this.HelpEmptyNode.active=0===this.helpList.length,this.LabHonorProgress.string=e.AllianceHelpHonorCount.toString()+"/"+e.AllianceHelpHonorMax.toString();var r=0;e.AllianceHelpHonorMax>0&&(r=e.AllianceHelpHonorCount/e.AllianceHelpHonorMax),r>1&&(r=1),this.HonorProgressBar.progress=r,this._tableView&&this._tableView.reloadData()},t.prototype.onCloseClick=function(){n.default.Instance().CloseUI(i.UIDataInfo.AllianceHelpPanel)},t.prototype.tableCellSizeForIndex=function(e){return new cc.Size(540,130)},t.prototype.numberOfCellsInTableView=function(){return this.helpList.length},t.prototype.tableCellAtIndex=function(e,t){if(e){var a=e.getComponent(l.default);if(a){var o=null;t<this.helpList.length&&(o=this.helpList[t]),v.Obj.isEmpty(o)||a.UpdateItem(o,this)}}},t.prototype.preCreateCellNums=function(){return 4},t.prototype.onItemClick=function(e){var t=this;c.DATA.UserData.Alliance.AllianceHelpHonorCount>=c.DATA.UserData.Alliance.AllianceHelpHonorMax?g.default.ShowView(o.LOCAL.getText("100355"),o.LOCAL.getText("110111"),this,function(){t.SendHelpToServer(e)}):this.SendHelpToServer(e)},t.prototype.SendHelpToServer=function(e){var t={helpedUid:e.Data.Uid.toString(),type:e.Data.Type,qid:e.Data.Qid.toString()},a=c.DATA.UserData.Alliance.AllianceHelpHonorCount>=c.DATA.UserData.Alliance.AllianceHelpHonorMax;p.NET.send(u.RequestId.ALLIANCE_HELP_MEMBER,t,this,function(t){if(0==t.s){var i=o.LOCAL.getText("100356",e.NickName);if(n.default.Instance().ShowTips(i),0==a){var r={honor:e.Data.Honor};f.default.Fly(e.BtnHelp,r,1,0,null,null,n.default.Instance().flyLayer)}if(null!=t.d){var s=d.default.JSON_PARSE(t.d);c.DATA.UserData.Alliance.UpdateAllianceHelpHonorCount(s.alhdhonor)}}else{i=o.LOCAL.getText("110098");null!=t.d?(i=t.d.toString(),n.default.Instance().ShowTips(o.LOCAL.getNetMsgText(i))):n.default.Instance().ShowTips(i)}var l=e.Data.Id;c.DATA.UserData.Alliance.DeleteAllianceHelpData(l)})},t.prototype.onWaitTipsClick=function(){n.default.Instance().ShowTips(o.LOCAL.getText("110099"))},t.prototype.onHelpClick=function(){if(c.DATA.UserData.Alliance.AllianceHelpCount>=c.DATA.UserData.Alliance.AllianceHelpMax)n.default.Instance().ShowTips(o.LOCAL.getText("110100"));else if(c.DATA.UserData.FunctionOn(_.FunctionKey.AllianceHelpNew))n.default.Instance().OpenUI(i.UIDataInfo.AllianceHelpSelectPanel);else{var e={type:2,itemId:_.ResourceType.Coin};p.NET.send(u.RequestId.ALLIANCE_HELP_APPLY,e,this,function(e){if(0==e.s){n.default.Instance().ShowTips(o.LOCAL.getText("110101"));var t=d.default.JSON_PARSE(e.d);c.DATA.UserData.Alliance.UpdateAllianceHelpCountAndHonor(t),c.DATA.UserData.Alliance.UpdateSelfHelpList(t.selfHelps,!1),h.EVENT.emit(m.EventId.AllianceHelpUpdate)}})}},t.prototype.onHonorTips=function(){y.default.ShowView(this.BtnHonorTips,o.LOCAL.getText("110102"))},t.prototype.onShowMoreMessage=function(){var e=o.LOCAL.getText("101034");C.default.ShowView(e,o.LOCAL.getText("100362"))},t.prototype.onReceiveClick=function(){var e=c.DATA.UserData.Alliance.getSelfHelpData();if(e&&1==e.State){var t={type:e.Type,qid:"0"};p.NET.send(u.RequestId.ALLIANCE_HELP_RECEIVE,t,this,function(t){if(0==t.s){c.DATA.UserData.Alliance.DeleteSelfHelpList(e.Type);var a=d.default.JSON_PARSE(t.d);if(a.reward){var o={serverReward:a.reward};n.default.Instance().OpenUI(i.UIDataInfo.CommonRewardPanel,o)}}})}},t.prototype.onCancleHelpClick=function(){var e=this,t=c.DATA.UserData.Alliance.getSelfHelpData();null!=t&&g.default.ShowView(o.LOCAL.getText("alli_request010"),"",this,function(){var a={type:t.Type,qid:"0"};p.NET.send(u.RequestId.ALLIANCE_HELP_CANCLE,a,e,function(e){if(0==e.s){var a=d.default.JSON_PARSE(e.d);c.DATA.UserData.Alliance.UpdateAllianceHelpCountAndHonor(a),c.DATA.UserData.Alliance.DeleteSelfHelpList(t.Type)}})})},__decorate([N(cc.ScrollView)],t.prototype,"scrollview",void 0),__decorate([N(cc.Node)],t.prototype,"content",void 0),__decorate([N(cc.Node)],t.prototype,"itemPrefabNode",void 0),__decorate([N(cc.Button)],t.prototype,"BtnHelp",void 0),__decorate([N(cc.Button)],t.prototype,"BtnReceive",void 0),__decorate([N(cc.Node)],t.prototype,"BtnHonorTips",void 0),__decorate([N(cc.Label)],t.prototype,"LabHelpCount",void 0),__decorate([N(cc.Label)],t.prototype,"SelfHelpNum",void 0),__decorate([N(cc.Sprite)],t.prototype,"SelfHelpIcon",void 0),__decorate([N(cc.Node)],t.prototype,"BtnCancleHelp",void 0),__decorate([N(cc.Node)],t.prototype,"HelpEmptyNode",void 0),__decorate([N(cc.Label)],t.prototype,"LabBtnHelp",void 0),__decorate([N(cc.Label)],t.prototype,"LabHonor",void 0),__decorate([N(cc.ProgressBar)],t.prototype,"HonorProgressBar",void 0),__decorate([N(cc.Label)],t.prototype,"LabHonorProgress",void 0),__decorate([N(cc.Node)],t.prototype,"HelpingNode",void 0),__decorate([N(cc.Node)],t.prototype,"HelpInstructionNode",void 0),__decorate([N(cc.Label)],t.prototype,"helpNameLabel",void 0),__decorate([N(cc.Node)],t.prototype,"countNode",void 0),t=__decorate([D],t)}(r.default);a.default=b,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../fws/display/FWSTableView":"FWSTableView","../../fws/utils/FWSTool":"FWSTool","../Common/BaseUI":"BaseUI","../Common/ConfirmPanel":"ConfirmPanel","../Common/MessageInfoPanel":"MessageInfoPanel","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Module/Home/ResFly":"ResFly","../Tools/GameTools":"GameTools","../components/SimpleDescTips":"SimpleDescTips","./AllianceHelpItem":"AllianceHelpItem"}],AllianceMsgs:[function(e,t,a){"use strict";cc._RF.push(t,"d5a3eB039lN1K1fH5jWjQ7s","AllianceMsgs");var o,n=e("../../fws/mvc/FWSMvc");(function(e){(function(e){e[e.AllianceMsgSelectIcon=0]="AllianceMsgSelectIcon",e[e.AllianceMsgRefreshApplyView=1]="AllianceMsgRefreshApplyView",e[e.AllianceMsgRefreshMainView=2]="AllianceMsgRefreshMainView",e[e.AllianceMsgRefreshFuncView=3]="AllianceMsgRefreshFuncView",e[e.AllianceMsgRefreshMemberView=4]="AllianceMsgRefreshMemberView",e[e.AllianceMsgRefreshMemberManageView=5]="AllianceMsgRefreshMemberManageView",e[e.AllianceMsgCloseMainView=6]="AllianceMsgCloseMainView",e[e.AllianceMsgCloseJoinView=7]="AllianceMsgCloseJoinView",e[e.AllianceMsgCloseMemberView=8]="AllianceMsgCloseMemberView",e[e.AllianceMsgJoinViewApply=9]="AllianceMsgJoinViewApply",e[e.AllianceMsgCloseScienceView=10]="AllianceMsgCloseScienceView",e[e.AllianceMsgBossInfoChange=11]="AllianceMsgBossInfoChange"})(e.Names||(e.Names={})),e.send=function(t,a,o){void 0===o&&(o="");var i=e.Names[t],r=new n.FMessage(i,a,o);return r.send(),r}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc"}],AllianceScienceNet:[function(e,t,a){"use strict";cc._RF.push(t,"13952ekdZNErJwzh9ofx3YI","AllianceScienceNet"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../Core/Net/NetMgr"),i=e("../Const/RequestId"),r=e("../Tools/GameTools"),s=e("../Data/DataCenter"),l=e("../../Core/Event/EventCenter"),c=e("../Const/EventId"),d=e("../Common/UIManager"),p=e("../Const/GameDefine"),u=e("../../fws/utils/X"),h=function(){function e(){}return e.getScienceData=function(){0!=s.DATA.UserData.FunctionOn(p.FunctionKey.AllianceScience)&&s.DATA.UserData.Alliance.isInAlliance()&&n.NET.send(i.RequestId.ALLIANCE_GET_SCIENCE,{},this,function(e){u.log(e);var t=r.default.JSON_PARSE(e.d);null!=t&&(s.DATA.UserData.Alliance.scienceData.initAllianceInitData(t),l.EVENT.emit(c.EventId.AllianceScienceInitData))})},e.uplevelScience=function(e){n.NET.send(i.RequestId.ALLIANCE_UPLEVEL_SCIENCE,{scienceId:e},this,function(e){u.log(e);var t=r.default.JSON_PARSE(e.d);null!=t&&(s.DATA.UserData.Alliance.scienceData.updateScienceItemData(t),d.default.Instance().ShowTips(o.LOCAL.getText("100307")),l.EVENT.emit(c.EventId.AllianceUpLevelScience))})},e.donateScience=function(e,t){n.NET.send(i.RequestId.ALLIANCE_DOANTE_SCIENCE,{scienceId:e,type:t},this,function(e){u.log(e);var a=r.default.JSON_PARSE(e.d);if(null!=a){var n=Number(a.addPoint),i=Number(a.addExp);s.DATA.UserData.Alliance.scienceData.updateScienceItemData(a)&&(n>0?d.default.Instance().ShowTips(o.LOCAL.getText("100308",i.toString(),n.toString())):d.default.Instance().ShowTips(o.LOCAL.getText("100309",i.toString()))),1==t&&(s.DATA.UserData.Alliance.scienceData.donateDailyHonor+=n),l.EVENT.emit(c.EventId.AllianceScienceDonate)}})},e.uplevelScienceDone=function(e){n.NET.send(i.RequestId.ALLIANCE_UPLEVEL_DONE,{scienceId:e},this,function(e){u.log(e);var t=r.default.JSON_PARSE(e.d);null!=t&&(s.DATA.UserData.Alliance.scienceData.updateScienceItemList(t.scs),d.default.Instance().ShowTips(o.LOCAL.getText("100310")),l.EVENT.emit(c.EventId.AllianceScienceDone))})},e.AllianceRecommend=function(e){n.NET.send(i.RequestId.ALLIANCE_RECOMMEND,{scienceId:e},this,function(e){u.log(e);var t=r.default.JSON_PARSE(e.d);null!=t&&(d.default.Instance().ShowTips(o.LOCAL.getText("100311")),s.DATA.UserData.Alliance.scienceData.updateScienceItemList(t.scs),l.EVENT.emit(c.EventId.AllianceScienceRecommend))})},e.pushScienceData=function(e){s.DATA.UserData.Alliance.scienceData.updateScienceItemList(e.scs),l.EVENT.emit(c.EventId.AllianceUpLevelScience)},e.pushDiamondDonateNum=function(e){void 0!=e.alDiamondDonateNum&&(s.DATA.UserData.Alliance.scienceData.DiamondDonateNum=e.alDiamondDonateNum),void 0!=e.alDonateDailyHonor&&(s.DATA.UserData.Alliance.scienceData.donateDailyHonor=e.alDonateDailyHonor),l.EVENT.emit(c.EventId.AllianceScienceDonate)},e.getDiamondDonateNum=function(){0!=s.DATA.UserData.FunctionOn(p.FunctionKey.AllianceScience)&&s.DATA.UserData.Alliance.isInAlliance()&&n.NET.send(i.RequestId.ALLIANCE_SCIENCE_INFO,{},this,function(e){u.log(e);var t=r.default.JSON_PARSE(e.d);null!=t&&(void 0!=t.alDiamondDonateNum&&(s.DATA.UserData.Alliance.scienceData.DiamondDonateNum=t.alDiamondDonateNum),void 0!=t.alDonateDailyHonor&&(s.DATA.UserData.Alliance.scienceData.donateDailyHonor=t.alDonateDailyHonor))})},e}();a.default=h,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/utils/X":"X","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],AllianceShopNet:[function(e,t,a){"use strict";cc._RF.push(t,"8df2fMVAfNNIqX2mlwx2ViJ","AllianceShopNet"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Const/GameDefine"),n=e("../Data/DataCenter"),i=e("../../Core/Net/NetMgr"),r=e("../Const/RequestId"),s=e("../Tools/GameTools"),l=e("../../Core/Event/EventCenter"),c=e("../Const/EventId"),d=e("../../fws/utils/FWSTool"),p=e("../Const/UIDataInfo"),u=e("../Common/UIManager"),h=e("../../fws/utils/X"),m=function(){function e(){}return e.getShopData=function(){0!=n.DATA.UserData.FunctionOn(o.FunctionKey.AllianceShop)&&n.DATA.UserData.Alliance.isInAlliance()&&i.NET.send(r.RequestId.ALLIANCE_SHOP,{},this,function(e){h.log(e);var t=s.default.JSON_PARSE(e.d);null!=t&&(n.DATA.UserData.Alliance.shopData.initByData(t),l.EVENT.emit(c.EventId.AllianceShopData))})},e.buyShopItem=function(e,t){i.NET.send(r.RequestId.ALLIANCE_BUYSHOP,{shopId:e,amount:t},this,function(e){var t=s.default.JSON_PARSE(e.d);if(null!=t){var a=d.Obj.getPropertyByNames(t,null,"reward");if(null!==a){var o={serverReward:a,isPay:!1};u.default.Instance().OpenUI(p.UIDataInfo.CommonRewardPanel,o)}var i={shopId:t.shopId,buyTimes:t.buyTimes};n.DATA.UserData.Alliance.shopData.updateItemData(i),l.EVENT.emit(c.EventId.AllianceBuyShopItem)}})},e.readShopStatus=function(){i.NET.send(r.RequestId.ALLIANCE_SHOP_STATUE,{},this,function(e){n.DATA.UserData.Alliance.shopData.updateShopStatus()})},e.pushShopData=function(e){n.DATA.UserData.Alliance.shopData.initByData(e),l.EVENT.emit(c.EventId.AllianceShopDataUpdate)},e}();a.default=m,cc._RF.pop()},{"../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],AllianceWelfarePanel:[function(e,t,a){"use strict";cc._RF.push(t,"6b8e2d+A3lGpKFxB09rt+RN","AllianceWelfarePanel"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../Common/BaseUI"),i=e("./AllianceCommon"),r=e("../Common/UIManager"),s=e("../Const/UIDataInfo"),l=e("./AllianceController"),c=e("../Tools/GameTools"),d=e("../Data/DataCenter"),p=e("../../Core/Utils/UpdateSpriteFrame"),u=e("../controllers/RewardController"),h=e("../../Core/Net/NetMgr"),m=e("../Const/RequestId"),f=e("../../Core/Event/EventCenter"),_=e("../Const/EventId"),y=e("../../fws/utils/FWSTool"),g=e("./AllianceHelpPanel"),C=e("../ShareSDK/RGShareInterface"),v=e("../../fws/platforms/PlatformCore"),I=e("../../fws/utils/ErrorReport"),T=cc._decorator,S=T.ccclass,A=T.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleLabel=null,t.headSpr=null,t.nameLabel=null,t.descLabel=null,t.itemSpr=null,t.itemNumLabel=null,t.videoBtnNode=null,t.showType=i.AllianceWelfareType.Help,t}return __extends(t,e),t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this)},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this)},t.AutoPupupView=function(){return l.AllianceController.getInstance().haveAllianceFakeGift()?(r.default.Instance().OpenUI(s.UIDataInfo.AllianceWelfarePanel,i.AllianceWelfareType.FakeGift),!0):!!l.AllianceController.getInstance().haveAllianceHelp()&&(r.default.Instance().OpenUI(s.UIDataInfo.AllianceWelfarePanel,i.AllianceWelfareType.Help),!0)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),t&&t[0]&&(this.showType=t[0]),this.initView()},t.prototype.initView=function(){if(this.videoBtnNode.active=!1,this.showType===i.AllianceWelfareType.Help){this.titleLabel.string=o.LOCAL.getText("110111"),this.descLabel.string=o.LOCAL.getText("102645"),d.DATA.UserData.Alliance&&d.DATA.UserData.Alliance.SelfHelpData?this.itemNumLabel.string=c.default.GetLargeNumberShow(d.DATA.UserData.Alliance.SelfHelpData.Num):this.itemNumLabel.string="0";var e=d.DATA.UserData.Alliance.getSelfHelpData().HelpInfo;if(!y.Obj.isEmpty(e)){var t=c.default.getPlayerDisplayName(e,o.LOCAL.getText("110003"));this.nameLabel.string=t,y.Str.isEmpty(e.getDisplayAvatarUrl())||p.UpdateSpriteFrameByWXUrl(e.getDisplayAvatarUrl(),this.headSpr)}}else if(this.showType===i.AllianceWelfareType.FakeGift){this.titleLabel.string=o.LOCAL.getText("110113"),this.nameLabel.string=o.LOCAL.getText("110003");var a=l.AllianceController.getInstance().getAllianceFakeMemberIconPath();p.UpdateSpriteFrame(a,this.headSpr);var n=o.LOCAL.getText("110083");this.descLabel.string=n;var r=l.AllianceController.getInstance().getAllianceFakeGiftRewardId(),s=u.RewardController.Instance.getRewardsArrById(r);if(s.length>0){var h=s[0],m={itemId:h.id,itemCount:h.count,type:h.type};u.RewardController.Instance.setSingleReward(m,this.itemSpr,this.itemNumLabel,.4),this.descLabel.string=n+o.LOCAL.getText(h.name)}}},t.prototype.onClickRewardBtn=function(){this.showType===i.AllianceWelfareType.Help?(d.DATA.UserData.Alliance.isInAlliance()&&g.default.ShowView(),this.onClickCloseBtn()):this.showType===i.AllianceWelfareType.FakeGift&&this.sendCmdAllianceReceiveFakeGift()},t.prototype.onclickVideoFakeGift=function(){var e=this,t=v.instance.adVideoLoadFrom();C.default.RGShareSDKDoAction(C.RGSharePoint.SP_AllianceFakeGiftVideo,C.IRGShareType.shartype_watchAd,{adtype:t},{success:function(){c.default.verifyComponent(e)&&e.sendCmdAllianceReceiveFakeGift(!0)},fail:function(e){e==C.IShareErrorCode.Share_Fail_CancalSeeVideo?r.default.Instance().ShowTips(o.LOCAL.getText("100012")):r.default.Instance().ShowTips(o.LOCAL.getText("100498"))}})},t.prototype.sendCmdAllianceReceiveFakeGift=function(e){var t=this;void 0===e&&(e=!1);var a={multiple:0};e&&(a.multiple=1,I.trace({resp:"requestServer",data:JSON.stringify({para:a,c:m.RequestId.ALLIANCE_RECEIVE_FAKE_GIFT})},"video")),h.NET.send(m.RequestId.ALLIANCE_RECEIVE_FAKE_GIFT,a,this,function(e){var a=c.default.JSON_PARSE(e.d);if(null!==a&&void 0!==a){var o=y.Obj.getPropertyByNames(a,null,"reward");if(null!==o){var n={serverReward:o,isPay:!1,needOpenAllianceUI:!0};r.default.Instance().OpenUI(s.UIDataInfo.CommonRewardPanel,n),I.trace({resp:"serverResponse",data:JSON.stringify({c:m.RequestId.ALLIANCE_RECEIVE_FAKE_GIFT})},"video")}d.DATA.UserData.updateHaveReceiveAllianceFakeGift(a.fakeAlReward),f.EVENT.emit(_.EventId.AllianceFakeGiftUpdate),t.endAllianceReceiveFakeGift()}},!0)},t.prototype.endAllianceReceiveFakeGift=function(){this.onClickCloseBtn()},t.prototype.onClickCloseBtn=function(){r.default.Instance().CloseUI(s.UIDataInfo.AllianceWelfarePanel)},__decorate([A(cc.Label)],t.prototype,"titleLabel",void 0),__decorate([A(cc.Sprite)],t.prototype,"headSpr",void 0),__decorate([A(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([A(cc.Label)],t.prototype,"descLabel",void 0),__decorate([A(cc.Sprite)],t.prototype,"itemSpr",void 0),__decorate([A(cc.Label)],t.prototype,"itemNumLabel",void 0),__decorate([A(cc.Node)],t.prototype,"videoBtnNode",void 0),t=__decorate([S],t)}(n.default);a.default=D,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/FWSTool":"FWSTool","../Common/BaseUI":"BaseUI","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/RequestId":"RequestId","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../ShareSDK/RGShareInterface":"RGShareInterface","../Tools/GameTools":"GameTools","../controllers/RewardController":"RewardController","./AllianceCommon":"AllianceCommon","./AllianceController":"AllianceController","./AllianceHelpPanel":"AllianceHelpPanel"}],CountryNotifyResponse:[function(e,t,a){"use strict";cc._RF.push(t,"e6b1dc7QSBBd5cWQPOdf5Q+","CountryNotifyResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../msgs/MvcMsgs"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){n.send(n.Names.ALLIANCE_NOTICE_CHANGED,null)},t}(o.default);a.default=i,cc._RF.pop()},{"../../Core/Net/ResponseBase":"ResponseBase","../msgs/MvcMsgs":"MvcMsgs"}],PayToServerResponse:[function(e,t,a){"use strict";cc._RF.push(t,"17dd1tcDahGY62jNi8SRE81","PayToServerResponse"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Net/ResponseBase"),n=e("../msgs/PayMsgs"),i=e("../Tools/GameTools"),r=e("../../Core/Common/SoundManager"),s=e("../Const/SoundPath"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Handler=function(e){var t=i.default.JSON_PARSE(e.data);null!==t&&(n.send(n.Names.PayToServerPush,t),r.SOUND.playClip(s.SoundPath.PayFinish))},t}(o.default);a.default=l,cc._RF.pop()},{"../../Core/Common/SoundManager":"SoundManager","../../Core/Net/ResponseBase":"ResponseBase","../Const/SoundPath":"SoundPath","../Tools/GameTools":"GameTools","../msgs/PayMsgs":"PayMsgs"}],NBattleCommon:[function(e,t,a){"use strict";var o;cc._RF.push(t,"eab7fv24bpM7Kwm+viX/JBN","NBattleCommon"),function(e){(function(e){e[e.Unknow=0]="Unknow",e[e.Ground=1]="Ground",e[e.Water=2]="Water",e[e.Air=3]="Air"})(e.NBattleTerrainType||(e.NBattleTerrainType={})),function(e){e[e.Attacker=0]="Attacker",e[e.Defender=1]="Defender"}(e.NBattleForces||(e.NBattleForces={})),function(e){e[e.Fire=0]="Fire",e[e.BulletToTarget=1]="BulletToTarget",e[e.Hit=2]="Hit",e[e.SpecFire=3]="SpecFire",e[e.Dead=4]="Dead"}(e.NBattleUnitAction||(e.NBattleUnitAction={})),function(e){e[e.Hit=1]="Hit",e[e.Miss=2]="Miss",e[e.Crit=4]="Crit"}(e.NBattleDamageFlags||(e.NBattleDamageFlags={})),function(e){e[e.SELECT=0]="SELECT",e[e.READY=1]="READY",e[e.START=2]="START",e[e.OVER=3]="OVER"}(e.NBattleStates||(e.NBattleStates={})),function(e){e[e.Enter=1]="Enter",e[e.Attack=2]="Attack",e[e.Skill=3]="Skill",e[e.Round=4]="Round",e[e.RemoveSkillBuff=5]="RemoveSkillBuff",e[e.EnterHero=6]="EnterHero",e[e.AddSkillBuff=7]="AddSkillBuff",e[e.MissAttack=8]="MissAttack",e[e.LIFEBAR_RESET=9]="LIFEBAR_RESET",e[e.HeroAttack=10]="HeroAttack",e[e.HeroAddBuff=11]="HeroAddBuff",e[e.HeroItemBuff=12]="HeroItemBuff"}(e.NBattlePvPDataProcessType||(e.NBattlePvPDataProcessType={})),function(e){e[e.Unknow=0]="Unknow",e[e.PvE=1]="PvE",e[e.PvR=2]="PvR",e[e.PvE_island=3]="PvE_island",e[e.Pve_Tower=4]="Pve_Tower",e[e.Pve_Adventure=5]="Pve_Adventure",e[e.Pve_ARENA=6]="Pve_ARENA",e[e.PVP_ARENA=7]="PVP_ARENA",e[e.PvR_DIM=8]="PvR_DIM"}(e.NBattleReportDataType||(e.NBattleReportDataType={})),function(e){e[e.None=0]="None",e[e.InBattle=1]="InBattle",e[e.StartBattle=2]="StartBattle"}(e.NBattleSkillPlayType||(e.NBattleSkillPlayType={})),function(e){e[e.single=1]="single",e[e.all=2]="all",e[e.attack=3]="attack"}(e.NBattleSkillShowType||(e.NBattleSkillShowType={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],NBattleDisplayObjectFacade:[function(e,t,a){"use strict";cc._RF.push(t,"c38b5IBHoNLk7LoJNnzxp/z","NBattleDisplayObjectFacade");var o,n=e("./NBattleCommon"),i=e("./components/PrefabPlaceHolder"),r=e("../Tools/GameTools"),s=e("../../fws/utils/FWSTool"),l=e("../../Core/Common/TableManager"),c=e("../../System/CocosWrap"),d=e("../../fws/utils/X"),p=e("./NBattleMsgs"),u=e("../Const/TableName");(function(e){function t(t,a){return t===n.NBattleForces.Defender?e.DefenderPosNodes[a]:e.AttackPosNodes[a]}function a(t){return t===n.NBattleForces.Defender?e.defenderNode:e.attackerNode}function o(e,t){if(r.default.verifyNode(e)){var a=e.getChildByName("__army__");if(a){var o=a.getChildByName(t);if(o)return o}}return e}e.active=!1,e.AttackPosNodes={},e.DefenderPosNodes={},e.attackUnits={},e.defendUnits={},e.defenderTerrainType=n.NBattleTerrainType.Ground,e.attackerTerrainType=n.NBattleTerrainType.Ground,e.upBackgroundNodes=[],e.downBackgroundNodes=[],e.getPosNode=t,e.getForceNode=a,e.getForceBgNode=function(t){return t===n.NBattleForces.Defender?e.defenderBgNode:e.attackerBgNode},e.getBgPositionByForceNode=function(e,t){var a=cc.Vec2.ZERO,o=this.getForceBgNode(e);return a=t.convertToWorldSpaceAR(a),o?a=o.convertToNodeSpaceAR(a):(a.x=0,a.y=0),a},e.getPositionByForceNode=function(e,o){var n=cc.Vec2.ZERO,i=t(e,o);if(i){n=i.convertToWorldSpaceAR(n);var r=a(e);r?n=r.convertToNodeSpaceAR(n):(n.x=0,n.y=0)}return n},e.getBloodPositionByForceNode=function(a,o){var n=cc.Vec2.ZERO,i=t(a,o);return i&&(n=i.convertToWorldSpaceAR(n),e.bloodUINode?n=e.bloodUINode.convertToNodeSpaceAR(n):(n.x=0,n.y=0)),n},e.getHeroSkillNodeByForceNode=function(t){return t===n.NBattleForces.Defender?e.defendHeroSkillNodes:e.attackHeroSkillNodes},e.getHeroSkillFullEffectNodeByForceNode=function(t){return t===n.NBattleForces.Defender?e.defendHeroSkillFullEffectNodes:e.attackHeroSkillFullEffectNodes},e.clearModelNode=function(t){var a=t===n.NBattleForces.Attacker?e.attackUnits:e.defendUnits;for(var o in a){var i=a[o];i&&(i.removeFromParent(),i.destroy(),a[o]=null)}},e.getArmyPlaceHolder=function(t,a){return t===n.NBattleForces.Attacker?e.attackUnits[a]:t===n.NBattleForces.Defender?e.defendUnits[a]:null},e.getModelNode=function(t,a){var o=e.getModelPrefabPlaceHolder(t,a);return o?o.ContainerNode:null},e.getModelPrefabPlaceHolder=function(t,a){var o=null;return t===n.NBattleForces.Attacker?(o=e.attackUnits[a])&&!o.isValid&&(e.attackUnits[a]=null,o=null):(o=e.defendUnits[a])&&!o.isValid&&(e.defendUnits[a]=null,o=null),o?o.getComponent(i.default):null},e.getFireNodeByModel=function(e,t){return r.default.verifyNode(e)?"0"==t.shoot_point?o(e,"fireNode"):o(e,t.shoot_point):null},e.getFireEffectNodeByModel=function(e,t){return r.default.verifyNode(e)?"0"==t.attack_effect_point||s.Str.isEmpty(t.attack_effect_point)?o(e,"fireNode"):o(e,t.attack_effect_point):null},e.getFootNodesByModel=function(e){var t=[];if(e)for(var a=e.getComponentsInChildren("FootNode"),o=0;o<a.length;o++){var n=a[o];t.push(n.node)}return t},e.setModelBack=function(a,o,i){var r=t(a,o);if(r){if(!r.active){r.active=!0;var c=r.getChildByName("back");c&&(c.active=!1)}var d=r.getChildByName("ArmyBack");if(d){var p=r.getChildByName("sea"),h=d.getChildByName("view");if(h){var m=h.children;if(s.Obj.isEmpty(i))d.active=!1,p.active=!1;else{var f=l.TABLE.getTableDataById(u.TableName.ARMY,i.toString());if(!f)return;var _=l.TABLE.getTableDataById(u.TableName.ARMY_CLASS,f.type+"");if(a===n.NBattleForces.Defender?p.active=1===_.type&&e.defenderTerrainType===n.NBattleTerrainType.Ground:p.active=1===_.type&&e.attackerTerrainType===n.NBattleTerrainType.Ground,0==_.type)return void(d.active=!1);d.active=!0;for(var y=0;y<m.length;y++){var g=m[y];g.active=g.name==_.type+""}}}}}},e.setModelHP=function(e,t,a,o,n,i,l,c){if(void 0===o&&(o=!1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===l&&(l=null),void 0===c&&(c=null),!r.default.verifyNode(e))return!1;var u=e.getComponent("NBattleArmy");if(!r.default.verifyComponent(u)||!u._army)return!1;if(!s.Obj.isEmpty(t)&&!s.Obj.isEmpty(a)){var h=!1;if(!o)return u.life=t,u.lifeBar&&(d.log("setModelHP offsetMode=%d, life=%d, maxLife=%d, shield=%d, maxShield=%d",o?1:0,t,a,i,n),u.lifeBar.setValues(t,t,0,0,i)),!1;t<0&&(h=!0);var m=t;if(h&&(u._army.maxPower=u._army.maxPower+t,u._army.maxPower<0&&(u._army.maxPower=0)),u.lifeBar){if(h){var f=u.lifeBar.applyDamage(m,l,c);return u.life=u.lifeBar.lifeVal,u._army.bufferData&&u._army.bufferData.shieldData&&p.send(p.Names.NBattle_Shield_Change,{parent:e,shieldVal:u.lifeBar.shieldVal},""),f}return d.log("\u6682\u65f6\u4e0d\u652f\u6301\u52a0\u8840"),!1}}},e.setModelHPByServer=function(e,t){if(!r.default.verifyNode(e))return!1;var a=e.getComponent("NBattleArmy");if(!r.default.verifyComponent(a))return!1;if(!s.Obj.isEmpty(t)){var o=a._army.power;t=a.life-t,t=Math.max(0,t),t=Math.min(a._army.power,t),a.myHPLabel&&(a.myHPLabel.string=t.toString());var n=t/o;if(n=Math.max(n,0),n=Math.min(n,1),t>a._army.maxPower&&(t=Math.min(a._army.maxPower,t)),a.life=t,a.myHP){var i=n-a.myHP.progress;d.log(s.Str.format("(NBattle) set hp = {0}",n));var l=a.myHP.node;if(l&&l.isValid){var p=.36*Math.abs(i);i/=40,l.stopAllActions(),l.runAction(cc.repeat(cc.sequence(cc.delayTime(p/40),c.default.callFunc(function(){a.myHP.progress+=i},l)),40))}}return a.life<=0}}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../System/CocosWrap":"CocosWrap","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Const/TableName":"TableName","../Tools/GameTools":"GameTools","./NBattleCommon":"NBattleCommon","./NBattleMsgs":"NBattleMsgs","./components/PrefabPlaceHolder":"PrefabPlaceHolder"}],NBattleModel:[function(e,t,a){"use strict";cc._RF.push(t,"67dddqWSIhMOJc34ONEpJMk","NBattleModel");var o,n=e("../../Core/Common/LocalManager"),i=e("../../fws/mvc/FWSMvc"),r=e("../Module/Battle/BattleItem"),s=e("../Data/BattleData"),l=e("../Common/UIManager"),c=e("./NBattleMsgs"),d=e("./NBattleCommon"),p=e("../../Core/Common/TableManager"),u=e("../Data/DataCenter"),h=e("../../Core/Net/NetMgr"),m=e("../Tools/GameTools"),f=e("../Const/GameDefine"),_=e("../Const/RequestId"),y=e("../Common/BIManager"),g=e("../components/worldmap/controllers/WorldMapController"),C=e("../Const/UIDataInfo"),v=e("../components/worldmap/WorldMapCommon"),I=e("../msgs/MvcMsgs"),T=e("./NBattleDisplayObjectFacade"),S=e("../../fws/utils/FWSTool"),A=e("../Const/GameDefine"),D=e("../Common/ConfirmPanel"),N=e("../../fws/utils/X"),b=e("./NBattlePositionBiz"),L=e("../Tools/PlayerInfoTool"),E=e("../../fws/platforms/PlatformCore"),P=e("../components/worldmap/controllers/WorldMapTodoController"),w=e("../../Core/Event/EventCenter"),B=e("../Const/EventId"),M=e("../Const/TableName"),U=e("../Tools/SubPackMsgs"),R=e("../../fws/utils/LocalStorageUtils"),G=function(e){function t(){var t=e.call(this)||this;return t.attackers=[],t.defenders=[],t._myMaxArmysNum=5,t.testMyMaxArmysNum=0,t.state=d.NBattleStates.SELECT,t.attackerHeros=[],t.attackerTraps=[],t.playerProfessionIds={},t.unitMap={},t._ARENA_PVP_IS_ASKING_FIGHTING=!1,t._ARENA_IS_ASKING_FIGHTING=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"myMaxArmysNum",{get:function(){return this._myMaxArmysNum},set:function(e){this._myMaxArmysNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return o||(o=new t),o},enumerable:!0,configurable:!0}),t.prototype.purge=function(){o=null},t.prototype.onConnect=function(){e.prototype.onConnect.call(this)},t.prototype.onDisconnect=function(){e.prototype.onDisconnect.call(this),this.resetData(),c.clearBattleMsgQueue()},t.prototype.resetAttackerData=function(){this.attackers.splice(0,this.attackers.length)},t.prototype.resetData=function(){c.send(c.Names.NBattle_TimeZoom,1),this.defenders.splice(0,this.defenders.length),this.state=d.NBattleStates.SELECT},t.prototype.resetArmyLifes=function(){for(var e=0;e<this.myMaxArmysNum;e++){var t=T.getModelNode(d.NBattleForces.Attacker,e);t&&T.setModelHP(t,Number.POSITIVE_INFINITY,0,!0)}},t.prototype.clearUnitByForce=function(e){var t=e===d.NBattleForces.Attacker?this.attackers:this.defenders;t.splice(0,t.length)},t.prototype.getUnitByForceAndPos=function(e,t){return t===d.NBattleForces.Attacker?S.Ary.isEmpty(this.attackers[e])?null:this.attackers[e][0]:t===d.NBattleForces.Defender?S.Ary.isEmpty(this.defenders[e])?null:this.defenders[e][0]:null},t.prototype.getUnitsByForceAndPos=function(e,t){return t===d.NBattleForces.Attacker?S.Ary.isEmpty(this.attackers[e])?null:this.attackers[e]:t===d.NBattleForces.Defender?S.Ary.isEmpty(this.defenders[e])?null:this.defenders[e]:null},t.prototype.getUnit=function(e,t,a){if(void 0===t&&(t=!0),void 0===a&&(a=!0),a)for(var o=0;o<this.attackers.length;o++)if(!S.Ary.isEmpty(this.attackers[o]))for(var n=0;n<this.attackers[o].length;n++){if((i=this.attackers[o][n])&&i.BattleItemCoreData.id==e)return i}if(t)for(o=0;o<this.defenders.length;o++)if(!S.Ary.isEmpty(this.defenders[o]))for(n=0;n<this.defenders[o].length;n++){var i;if((i=this.defenders[o][n])&&i.BattleItemCoreData.id==e)return i}return null},t.prototype.getArmyId=function(e,t){var a=null;if(e===d.NBattleForces.Attacker){if(S.Ary.isEmpty(this.attackers[t]))return-1;a=this.attackers[t][0]}else{if(S.Ary.isEmpty(this.defenders[t]))return-1;a=this.defenders[t][0]}return a?a.BattleItemCoreData.armyid:-1},t.prototype.getArmyUuid=function(e,t){var a=null;if(e===d.NBattleForces.Attacker){if(S.Ary.isEmpty(this.attackers[t]))return null;a=this.attackers[t][0]}else{if(S.Ary.isEmpty(this.defenders[t]))return null;a=this.defenders[t][0]}return a?a.BattleItemCoreData.id:null},t.prototype.onFMessage_NBattle_ClearBattleArmys=function(e){return e.data&&e.data.a&&this.clearUnitByForce(d.NBattleForces.Attacker),e.data&&e.data.d&&this.clearUnitByForce(d.NBattleForces.Defender),!0},t.prototype.getMaxCoutByPos=function(e){return 1+Math.floor(b.NBattlePositionBiz.getArmyAddNum()/this.myMaxArmysNum)+(b.NBattlePositionBiz.getArmyAddNum()%this.myMaxArmysNum>e?1:0)},t.prototype.createAttackArmy=function(e,t,a,o){void 0===t&&(t=-1),void 0===a&&(a=-1),void 0===o&&(o=0);var i=p.TABLE.getTableDataById(M.TableName.ARMY,e.armyID.toString());i=Object.assign({},i);var s=-1;if(t>=0)s=t;else for(var u=0;u<this.myMaxArmysNum;u++)if(!this.attackers[u]){s=u;break}if(-1===s)return l.default.Instance().ShowTips(n.LOCAL.getText("reinforce_tip002")),!1;if(this.checkAllianceAssistanceMax(1)<=0)return l.default.Instance().ShowTips(n.LOCAL.getText("reinforce_tip001")),!1;a>0?(i.power=Math.floor(a/1),i.maxPower=a,i.maxNum=1):(i.maxPower=1*i.power,i.maxNum=1),i.shield=o,i.maxShield=o;var h=new r.BattleItem({armyid:e.armyID,id:e.serverID,power:i.power,load:i.load,cp:i.power,force:d.NBattleForces.Attacker,armyCfg:i,count:1},null,null,null);return h.BattleItemCoreData.pos=s,this.attackers[s]=[h],c.send(c.Names.NBattle_SetPosition,{force:d.NBattleForces.Attacker,pos:s,unit:[{id:e.serverID,armyId:e.armyID,power:i.power,cp:i.power,_uid_:e.ownerUid}],maxSize:1,datas:[h]}),!0},t.prototype.checkAllianceAssistanceMax=function(e){if(null==u.DATA.CurBattleData||u.DATA.CurBattleData.Type!=s.BattleType.PVP_Alliance_Assistance)return e;for(var t=0,a=0;a<this.attackers.length;a++)null!=this.attackers[a]&&(t+=this.attackers[a].length);var o=u.DATA.CurBattleData.otherData.nowNum,n=u.DATA.CurBattleData.otherData.maxNum-o-t;return n<e?n:e},t.prototype.createAttackArmyByCount=function(e,t,a,o,i){if(void 0===t&&(t=-1),void 0===a&&(a=-1),void 0===o&&(o=-1),void 0===i&&(i=0),S.Ary.isEmpty(e))return 0;var s=p.TABLE.getTableDataById(M.TableName.ARMY,e[0].armyID.toString());s=Object.assign({},s);var u=-1;if(t>=0)u=t;else for(var h=0;h<this.myMaxArmysNum;h++)if(!this.attackers[h]){u=h;break}if(-1===u)return l.default.Instance().ShowTips(n.LOCAL.getText("reinforce_tip002")),0;var m=0;if(0===o?(m=Math.min(this.getMaxCoutByPos(u),e.length),o=this.getMaxCoutByPos(u)):m=e.length,(m=this.checkAllianceAssistanceMax(m))<=0)return l.default.Instance().ShowTips(n.LOCAL.getText("reinforce_tip001")),0;s.maxShield=i,s.shield=Math.floor(i/m),a>0?t>=0?(s.power=Math.floor(a/m),s.maxPower=a,s.maxNum=m):(s.power=a,s.maxPower=a*m,s.maxNum=m):(s.maxPower=s.power*m,s.maxNum=m);for(var f=[],_=[],y=0;y<m;y++){var g=e[y],C=new r.BattleItem({armyid:g.armyID,id:g.serverID,power:s.power,load:s.load,cp:s.power,force:d.NBattleForces.Attacker,armyCfg:s},null,null,null);C.BattleItemCoreData.pos=u,f.push(C),_.push({id:g.serverID,armyId:g.armyID,power:s.power,cp:s.power,_uid_:g.ownerUid})}return this.attackers[u]=f,c.send(c.Names.NBattle_SetPosition,{force:d.NBattleForces.Attacker,pos:u,unit:_,maxSize:-1===o?_.length:o,datas:f}),m},t.prototype.createDefendArmy=function(e,t,a,o,n,i){void 0===o&&(o=-1),void 0===n&&(n=null),void 0===i&&(i=0);var s=p.TABLE.getTableDataById(M.TableName.ARMY,e.toString());s=Object.assign({},s),o>0?(s.power=Math.floor(o/1),s.maxPower=o,s.maxNum=1):(s.maxPower=1*s.power,s.maxNum=1),s.maxShield=i,s.shield=i;var l=new r.BattleItem({armyid:e,id:t,power:s.power,cp:s.power,force:d.NBattleForces.Defender,pos:a,armyCfg:s,count:1},null,null,null);this.defenders[a]=[l],c.send(c.Names.NBattle_SetPosition,{force:d.NBattleForces.Defender,pos:a,unit:[{id:t,armyId:e,power:s.power,cp:s.power,_uid_:n}],maxSize:1,datas:[l]})},t.prototype.createDefendArmyByCount=function(e,t,a,o,i){if(void 0===t&&(t=-1),void 0===a&&(a=-1),void 0===o&&(o=-1),void 0===i&&(i=0),S.Ary.isEmpty(e))return 0;var s=p.TABLE.getTableDataById(M.TableName.ARMY,e[0].armyID.toString());s=Object.assign({},s);var u=-1;if(t>=0)u=t;else for(var h=0;h<this.myMaxArmysNum;h++)if(!this.attackers[h]){u=h;break}if(-1===u)return l.default.Instance().ShowTips(n.LOCAL.getText("reinforce_tip002")),0;var m=e.length;if((m=this.checkAllianceAssistanceMax(m))<=0)return l.default.Instance().ShowTips(n.LOCAL.getText("reinforce_tip001")),0;s.shield=Math.floor(i/m),s.maxShield=i,a>0?(s.power=Math.floor(a/m),s.maxPower=a,s.maxNum=m):(s.maxPower=s.power*m,s.maxNum=m);for(var f=[],_=[],y=0;y<m;y++){var g=e[y],C=new r.BattleItem({armyid:g.armyID,id:g.serverID,power:s.power,load:s.load,cp:s.power,force:d.NBattleForces.Defender,armyCfg:s},null,null,null);C.BattleItemCoreData.pos=u,f.push(C),_.push({id:g.serverID,armyId:g.armyID,power:s.power,cp:s.power,_uid_:g.ownerUid})}return this.defenders[u]=f,c.send(c.Names.NBattle_SetPosition,{force:d.NBattleForces.Defender,pos:u,unit:_,maxSize:-1===o?_.length:o,datas:f}),m},t.prototype.removeAttackArmy=function(e,t){null===e||void 0===e||e<0||e>this.myMaxArmysNum-1||this.attackers[e]&&(this.attackers[e]=null,c.send(c.Names.NBattle_SetPosition,{force:d.NBattleForces.Attacker,pos:e,unit:null,maxSize:t,datas:null}))},t.prototype.removeArmy=function(e,t){N.log(S.Str.format("\u6e05\u7a7a{0} pos:{1}",e,t)),e===d.NBattleForces.Attacker?(this.attackers[t]=null,c.send(c.Names.NBattle_SetPosition,{force:d.NBattleForces.Attacker,pos:t,unit:null,maxSize:0,datas:null},"")):(this.defenders[t]=null,c.send(c.Names.NBattle_SetPosition,{force:d.NBattleForces.Defender,pos:t,unit:null,maxSize:0,datas:null},""))},t.prototype.pveBattleType=function(){if(!u.DATA.CurBattleData||!u.DATA.CurBattleData.otherData)return-1;var e=p.TABLE.getTableDataById(M.TableName.AREA,String(u.DATA.CurBattleData.otherData.areaId));return e?e.terrain_type:-1},t.prototype.startFight=function(){if(0===this.attackerArmyCount)return l.default.Instance().ShowTips(n.LOCAL.getText("100013")),!1;for(var e=[],a=0;a<this.attackers.length;a++){if(p=this.attackers[a]){var o=p[0];if(!S.Obj.isEmpty(u.DATA.CurBattleData.otherData))if(S.Obj.getProperty(u.DATA.CurBattleData.otherData.levelId,"pveId",0)===A.PVEFirstID&&"90004"===o.BattleItemCoreData.id)continue;var i=0;if(a<3)i=a+1;else if(a<6){i=10+(0===(r=(a+1)%3)?3:r)}else{var r;i=20+(0===(r=(a+1)%3)?3:r)}e.push({pos:i,armyId:o.BattleItemCoreData.armyid,armyNum:p.length})}}var c=[];for(a=0;a<this.attackers.length;a++){var p;if(p=this.attackers[a]){o=p[0];if(!S.Obj.isEmpty(u.DATA.CurBattleData.otherData))if(S.Obj.getProperty(u.DATA.CurBattleData.otherData.levelId,"pveId",0)===A.PVEFirstID&&"90004"===o.BattleItemCoreData.id)continue;c.push(o.BattleItemCoreData.id)}}if(u.DATA.CurBattleData.Type!==s.BattleType.PVE_OBSTACLE){var h=0;if(e.forEach(function(e){S.Obj.isEmpty(e)||S.Obj.isEmpty(e.armyNum)||(h+=e.armyNum)}),this.myMaxArmysNum+b.NBattlePositionBiz.getArmyAddNum()<h)return l.default.Instance().ShowTips(n.LOCAL.getText("battle_121514")),!1}var m=!1;switch(u.DATA.CurBattleData.Type){case s.BattleType.PVE_OBSTACLE:m=this.start_PVE_OBSTACLE(c);break;case s.BattleType.PVM_MILITARY:m=this.start_PVM_MILITARY(e);break;case s.BattleType.PVM:m=this.start_PVM(e);break;case s.BattleType.PVR:m=this.start_PVR(e);break;case s.BattleType.PVP:m=this.start_PVP(e);break;case s.BattleType.PVP_Alliance:m=this.start_PVP_Alliance(e);break;case s.BattleType.AllianceBuilding:m=this.start_AllianceBuilding(e);break;case s.BattleType.WorldBoss:m=this.start_WorldBoss(e);break;case s.BattleType.Country_Boss:m=this.start_CountryBoss(e);break;case s.BattleType.AllianceBoss:m=this.start_AllianceBoss(e);break;case s.BattleType.PVP_Alliance_Assembly_Create:m=this.start_PVP_AllianceAssembly(e);break;case s.BattleType.PVP_Alliance_Supper_Assembly_Create:m=this.start_PVP_SupperAllianceAssembly(e);break;case s.BattleType.PVP_Alliance_Assistance:m=this.start_PVP_AllianceAssistance(e);break;case s.BattleType.PVP_Alliance_Assembly_Join:m=this.Join_PVP_AllianceAssembly(e);break;case s.BattleType.WorldSite:m=this.start_WorldSiteMarch(e);break;case s.BattleType.Throne:m=this.start_WorldThroneMarch(e);break;case s.BattleType.CROSS_SEND_SOLDIER:m=this.start_CrossServerSendSoldier(e);break;case s.BattleType.AIR_DROP:m=this.start_AirDropMarch(e);break;case s.BattleType.AIR_DROP_Intercept:m=this.start_AirDropMarchIntercept(e);break;case s.BattleType.DarkPortal_Donate:m=this.start_DarkPortalDonate(e);break;case s.BattleType.PVE_Island:m=this.start_PVE_Island(e);break;case s.BattleType.ATTACK_DIM_MINE:m=this.start_ATTACK_DimMine(e);break;case s.BattleType.PVE_Tower:m=this.start_PVE_Tower(e);break;case s.BattleType.WorldTreasure_March:m=this.start_WorldTreasureMarch(e);break;case s.BattleType.WorldTreasure_Fight:m=this.start_WorldTreasureFightMarch(e);break;case s.BattleType.BUILD_PVR_TOWER:case s.BattleType.BUILD_BUFF_TOWER:m=this.start_PVR_Tower(e);break;case s.BattleType.ATTACK_TOWER:case s.BattleType.TOWER_COLLECT:case s.BattleType.TOWER_ASSISTANCE:m=this.start_ATTACK_TOWER(e);break;case s.BattleType.AL_DEFENDER_MONSTER:m=this.start_ATTACK_ALMonsterDefender(e);break;case s.BattleType.TO_KVK_ALLIANCE_BUILD:m=this.start_ATTACK_TO_KVK_ALLIANCE_BUILD(e);break;case s.BattleType.TO_KVK_WORLD_BUILD:m=this.start_ATTACK_TO_KVK_WORLD_BUILD(e);break;case s.BattleType.Adventure_Boss:m=this.start_adventure_boss(e);break;case s.BattleType.Isle_Embattle:m=this.start_IsleEmbattleMarch(e);break;case s.BattleType.ARENA_PVE_BATTLE:m=this.start_ARENA_PVE_BATTLE(e);break;case s.BattleType.ARENA_PVP_BATTLE:m=this.start_ARENA_PVP_BATTLE(e);break;case s.BattleType.ATTACK_TREASURE_MAP_WORLD_BOSS:m=this.start_TreasureMapBoss(e)}return m&&(t.instance.state=d.NBattleStates.READY),m},t.prototype.start_ARENA_PVP_BATTLE=function(e){if(!this._ARENA_PVP_IS_ASKING_FIGHTING&&(this._ARENA_PVP_IS_ASKING_FIGHTING=!0,N.log("start_PVE_OBSTACLE",e),E.instance.postStatsEvent("pve_fight_start"),u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData)){var a=null;a=u.DATA.CurBattleData.otherData.uid?{armyListNew:e,heroList:this.attackerHeros,uid:u.DATA.CurBattleData.otherData.uid}:{armyListNew:e,heroList:this.attackerHeros,index:u.DATA.CurBattleData.otherData.index};var o=this;return h.NET.send(_.RequestId.ARENA_PVP_START_FIGHT,a,this,function(e){if(o._ARENA_PVP_IS_ASKING_FIGHTING=!1,e.s)return t.instance.state=d.NBattleStates.SELECT,void l.default.Instance().ShowTips(n.LOCAL.getText("100567"));var i={theme:U.send(U.Names.ARENA_THEME,-1).data,armyListNew:a.armyListNew};R.set("PVP_FORMATION_ARMY"+u.DATA.UserData.UID,JSON.stringify(i)),l.default.Instance().CloseUI(C.UIDataInfo.PVPMainpanel);var r=m.default.JSON_PARSE(e.d);r&&c.send(c.Names.NBattle_ReportData,{type:d.NBattleReportDataType.PVP_ARENA,data:r})}),!0}},t.prototype.start_ARENA_PVE_BATTLE=function(e){if(!this._ARENA_IS_ASKING_FIGHTING&&(this._ARENA_IS_ASKING_FIGHTING=!0,N.log("start_PVE_OBSTACLE",e),E.instance.postStatsEvent("pve_fight_start"),u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData)){var a=this;return h.NET.send(_.RequestId.NBATTLE_ARENA_PVE,{armyListNew:e,heroList:this.attackerHeros,type:u.DATA.CurBattleData.otherData.type},this,function(o){if(a._ARENA_IS_ASKING_FIGHTING=!1,o.s)return t.instance.state=d.NBattleStates.SELECT,void l.default.Instance().ShowTips(n.LOCAL.getText("100567"));var i={armyListNew:e};R.set("PVE_FORMATION_ARMY"+u.DATA.UserData.UID,JSON.stringify(i)),l.default.Instance().CloseUI(C.UIDataInfo.ArenaPvePanel);var r=m.default.JSON_PARSE(o.d);r&&c.send(c.Names.NBattle_ReportData,{type:d.NBattleReportDataType.Pve_ARENA,data:r})}),!0}},t.prototype.start_adventure_boss=function(e){var t=this.getPresetArmyAndHeroParams(0);return t.missionId=u.DATA.UserData.AdventureData.StageId,h.NET.send(_.RequestId.Adventure_Boss_Attack,t,this,function(e){if(e){if(0!=e.s)return!1;var t=m.default.JSON_PARSE(e.d);t&&(c.send(c.Names.NBattle_ReportData,{type:d.NBattleReportDataType.Pve_Adventure,data:t}),t.userIdle&&u.DATA.UserData.UpdateAdventureData(t))}else l.default.Instance().ShowTips(n.LOCAL.getText("100567"))}),!0},t.prototype.start_PVP_AllianceAssembly=function(e){return!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(h.NET.send(_.RequestId.ALLIANCE_Assembly_Create,{marchType:v.MarchType.ALLIANCE_RALLY_BATTLE,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,time:u.DATA.CurBattleData.otherData.assemblytime||60,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_PVP_SupperAllianceAssembly=function(e){return!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(h.NET.send(_.RequestId.ALLIANCE_Assembly_Create,{marchType:v.MarchType.ALLIANCE_SUPER_RALLY_BATTLE,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,time:u.DATA.CurBattleData.otherData.assemblytime||60,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.Join_PVP_AllianceAssembly=function(e){var t=this;if(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos){var a=u.DATA.CurBattleData.otherData.enemyInfo;if(!S.Obj.isEmpty(a)){var o=0;if(e.forEach(function(e){S.Obj.isEmpty(e)||S.Obj.isEmpty(e.armyNum)||(o+=e.armyNum)}),a.rallyCapacity-a.rallySize<o)return l.default.Instance().ShowTips(n.LOCAL.getText("assembly_armymaxinfo")),!1;if(!S.Obj.isEmpty(u.DATA.CurBattleData.otherData.marchTime)&&a.startTime-u.DATA.ServerTime<u.DATA.CurBattleData.otherData.marchTime)return D.default.ShowView(n.LOCAL.getText("public107"),n.LOCAL.getText("100114"),this,function(){h.NET.send(_.RequestId.ALLIANCE_Assembly_Join,{marchType:v.MarchType.ALLIANCE_RALLY_ASSEMBLY,teamId:u.DATA.CurBattleData.otherData.teamId,armyList:e,armyListNew:e,heroList:t.attackerHeros,trapList:t.attackerTraps},t,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel)}),!1}return h.NET.send(_.RequestId.ALLIANCE_Assembly_Join,{marchType:v.MarchType.ALLIANCE_RALLY_ASSEMBLY,teamId:u.DATA.CurBattleData.otherData.teamId,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0}return!1},t.prototype.start_WorldSiteMarch=function(e){if(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos){var t=u.DATA.UserData.getWorldSitgeById(u.DATA.CurBattleData.otherData.siteId,g.model.CurrentWorldId);if(null==t)return!0;var a=this;return 0==u.DATA.CurBattleData.otherData.breakAttack&&t.State==A.WorldSiteState.FIGHT&&u.DATA.UserData.ShieldTime>u.DATA.ServerTime?D.default.ShowView(n.LOCAL.getText("101143"),n.LOCAL.getText("101073"),this,function(){a.SureAttackWorldSite(t,e)}):a.SureAttackWorldSite(t,e),!0}return!1},t.prototype.start_IsleEmbattleMarch=function(e){return h.NET.send(_.RequestId.ISLE_EMBATTLE,{armyListNew:e,heroList:this.attackerHeros},this,function(e){if(e&&0==e.s){var t=m.default.JSON_PARSE(e.d);u.DATA.UserData.UpdateIsleData(t),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),w.EVENT.emit(B.EventId.IsleEmbattleCall)}else l.default.Instance().ShowTips(n.LOCAL.getText("100567"))}),!0},t.prototype.start_WorldTreasureMarch=function(e){if(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.itemId){var t=u.DATA.CurBattleData.otherData.itemId;return h.NET.send(_.RequestId.MARCH_WORLD_POINT,{marchType:v.MarchType.WORLD_TREASURE_SEARCH,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps,itemId:t},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),P.getInstance().gotoWorldAndDo(v.WorldMapToDoType.MOVE_TO),!0}return!1},t.prototype.start_WorldTreasureFightMarch=function(e){return!(!u.DATA.CurBattleData||!u.DATA.CurBattleData.otherData)&&(u.DATA.CurBattleData.otherData.enemyInfo&&void 0!=u.DATA.CurBattleData.otherData.enemyInfo.costEnegy&&u.DATA.CurBattleData.otherData.enemyInfo.costEnegy>u.DATA.UserData.Resource.Gold?void l.default.Instance().ShowTips(n.LOCAL.getText("100130")):(h.NET.send(_.RequestId.MARCH_WORLD_POINT,{marchType:v.MarchType.WORLD_TREASURE_FIGHT,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),P.getInstance().gotoWorldAndDo(v.WorldMapToDoType.MOVE_TO),!0))},t.prototype.SureAttackWorldSite=function(e,t){h.NET.send(_.RequestId.MARCH_WORLD_POINT,{marchType:v.MarchType.WORLD_SITE,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:t,armyListNew:t,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),null!=e&&e.State==A.WorldSiteState.FIGHT&&(e.Owner.Aid==u.DATA.UserData.Alliance.Aid?l.default.Instance().ShowTips(n.LOCAL.getText("alliance_reinforce_008")):l.default.Instance().ShowTips(n.LOCAL.getText("wonder_049")))},t.prototype.start_AirDropMarchIntercept=function(e){return!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.marchId)&&(h.NET.send(_.RequestId.INTERCEPT_AIRDROP_MARCH,{marchId:u.DATA.CurBattleData.otherData.marchId,marchType:v.MarchType.AIR_DROP_INTERCEPT,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),!0)},t.prototype.start_DarkPortalDonate=function(e){return!(!u.DATA.CurBattleData||!u.DATA.CurBattleData.otherData)&&(h.NET.send(_.RequestId.MARCH_WORLD_POINT,{marchId:u.DATA.CurBattleData.otherData.marchId,marchType:v.MarchType.DarkPortal_Donate,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps,items:u.DATA.CurBattleData.otherData.itemData},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),!0)},t.prototype.start_AirDropMarch=function(e){return!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(h.NET.send(_.RequestId.MARCH_WORLD_POINT,{marchType:v.MarchType.AIR_DROP,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),!0)},t.prototype.start_CrossServerSendSoldier=function(e){if(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos){h.NET.send(_.RequestId.MARCH_WORLD_POINT,{marchType:v.MarchType.CROSS_SEND_SOLDIER,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel);var t=g.model.getTileInfoByCoord(u.DATA.CurBattleData.otherData.targetPos.x,u.DATA.CurBattleData.otherData.targetPos.y),a=-1;return null!=t&&null!=t.extData&&null!=t.extData.aid&&(a=t.extData.aid),1==u.DATA.UserData.ThroneData.IsFight&&a==u.DATA.UserData.Alliance.Aid&&l.default.Instance().ShowTips(n.LOCAL.getText("alliance_reinforce_008")),!0}return!1},t.prototype.start_WorldThroneMarch=function(e){if(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos){var t=v.MarchType.THRONE;u.DATA.UserData.ifLaunchTowerStatus()&&u.DATA.UserData.ifOpenLaunchTower()&&(t=v.MarchType.GUN_FIGHT),h.NET.send(_.RequestId.MARCH_WORLD_POINT,{marchType:t,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel);var a=g.model.getTileInfoByCoord(u.DATA.CurBattleData.otherData.targetPos.x,u.DATA.CurBattleData.otherData.targetPos.y),o=-1;return null!=a&&null!=a.extData&&null!=a.extData.aid&&(o=a.extData.aid),1==u.DATA.UserData.ThroneData.IsFight&&o==u.DATA.UserData.Alliance.Aid&&l.default.Instance().ShowTips(n.LOCAL.getText("alliance_reinforce_008")),!0}return!1},t.prototype.start_PVP_AllianceAssistance=function(e){return!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(h.NET.send(_.RequestId.ALLIANCE_Defend,{marchType:v.MarchType.ALLIANCE_REINFORCE,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){N.log(e)}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_PVE_OBSTACLE=function(e){if(N.log("start_PVE_OBSTACLE",e),E.instance.postStatsEvent("pve_fight_start"),u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.levelId){var t=u.DATA.CurBattleData.otherData.levelId;if(t){var a=t.pve_level.cost_energy;if(u.DATA.UserData.getEnergy(f.EnergyType.Action).Point<a)return l.default.Instance().ShowTips(n.LOCAL.getText("100182")),!1}var o=String(u.DATA.CurBattleData.otherData.levelId);if(u.DATA.UserData.FunctionOn(f.FunctionKey.chapter_battle_replace)){c.send(c.Names.NBattle_DataBiz,{otherData:{levelId:u.DATA.CurBattleData.otherData.levelId,areaId:u.DATA.CurBattleData.otherData.areaId}});var i=0==this.pveBattleType()?_.RequestId.AREA_SEA_FIGHT:_.RequestId.NBATTLE_START_PVE_OBSTACLE;h.NET.send(i,{pveId:u.DATA.CurBattleData.otherData.levelId.pveId,armyList:e,areaId:u.DATA.CurBattleData.otherData.areaId,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){if(e){var t=m.default.JSON_PARSE(e.d);t&&(c.send(c.Names.NBattle_ReportData,{type:d.NBattleReportDataType.PvE,data:t}),y.default.Instance.PostExtraAction("BattleEnd",{battleId:o,result:String(t.battle.result)}))}else l.default.Instance().ShowTips(n.LOCAL.getText("100567"))})}else h.NET.send(_.RequestId.STARTA_PVE_OBSTACLE,{pveId:u.DATA.CurBattleData.otherData.levelId.pveId,armyList:e,areaId:u.DATA.CurBattleData.otherData.areaId});return y.default.Instance.PostExtraAction("BattleStart",{battleId:o}),!0}},t.prototype.start_PVE_Island=function(e){if(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.islandId){c.send(c.Names.NBattle_DataBiz,{otherData:{islandId:u.DATA.CurBattleData.otherData.islandId}});var t=u.DATA.CurBattleData.otherData.islandId;return h.NET.send(_.RequestId.GET_ISLAND_BLOCK_FIGHT,{to:u.DATA.CurBattleData.otherData.islandId,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){if(e){var a=m.default.JSON_PARSE(e.d);a&&(a.reward||(a.reward={}),a.reward.islandPoint=a.addPoint,c.send(c.Names.NBattle_ReportData,{type:d.NBattleReportDataType.PvE_island,data:a}),u.DATA.UserData.IslandBattleData.updateData(a),y.default.Instance.PostExtraAction("IslandBattleEnd",{battleId:t,result:String(a.battle.result)}))}else l.default.Instance().ShowTips(n.LOCAL.getText("100567"))}),y.default.Instance.PostExtraAction("IslandBattleStart",{battleId:t}),!0}return!0},t.prototype.start_ATTACK_DimMine=function(e){if(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData){c.send(c.Names.NBattle_DataBiz,{otherData:{dimId:u.DATA.CurBattleData.otherData.dimId}});var t={index:u.DATA.CurBattleData.otherData.dimIndex,armyList:e,heroList:this.attackerHeros};return u.DATA.CurBattleData.otherData.dimUid&&(t.fightUid=u.DATA.CurBattleData.otherData.dimUid.toString()),h.NET.send(_.RequestId.DEGENERATOR_FIGHT,t,this,function(e){if(e){var t=m.default.JSON_PARSE(e.d);if(t){if(1==t.failReason)return l.default.Instance().ShowTips(n.LOCAL.getText("DimMine019")),void l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel);void 0!=t.fightCount&&I.send(I.Names.MVC_DIM_UPDATE_ATTACK_COUNT,t.fightCount),c.send(c.Names.NBattle_ReportData,{type:d.NBattleReportDataType.PvR_DIM,data:t})}}else l.default.Instance().ShowTips(n.LOCAL.getText("100567"))}),!0}return!0},t.prototype.start_PVE_Tower=function(e){return N.log("start_PVE_Towerstart_PVE_Towerstart_PVE_Tower",e),u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.UserData.FunctionOn(f.FunctionKey.chapter_battle_replace)&&(c.send(c.Names.NBattle_DataBiz,{otherData:{levelId:u.DATA.CurBattleData.otherData.levelId,areaId:u.DATA.CurBattleData.otherData.areaId}}),h.NET.send(_.RequestId.STARTA_PVE_TOWER,{to:u.DATA.CurBattleData.otherData.to,armyListNew:e,heroList:this.attackerHeros,trapList:this.attackerTraps},this,function(e){if(e){var t=m.default.JSON_PARSE(e.d);t&&(t.reward||(t.reward={}),t.reward.islandPoint=t.addPoint,c.send(c.Names.NBattle_ReportData,{type:d.NBattleReportDataType.Pve_Tower,data:t}),u.DATA.UserData.IslandBattleData.updateData(t))}else l.default.Instance().ShowTips(n.LOCAL.getText("100567"))})),!0},t.prototype.start_ATTACK_TOWER=function(e){return N.log("start_ATTACK_TOWER",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.ATTACK_TOWER,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_ATTACK_ALMonsterDefender=function(e){return N.log("start_ATTACK_TOWER",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.AL_MONSTER_DEFENSE,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_ATTACK_TO_KVK_ALLIANCE_BUILD=function(e){return N.log("start_ATTACK_TOWER",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.TO_KVK_ALLIANCE_BUILD,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_ATTACK_TO_KVK_WORLD_BUILD=function(e){return N.log("start_ATTACK_TOWER",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.TO_KVK_WORLD_BUILD,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_PVM=function(e){return N.log("start_PVM",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.ATTACK_MONSTER,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_PVM_MILITARY=function(e){return N.log("start_PVM_MILITARY",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.PVM_MILITARY,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_AllianceBoss=function(e){return!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.ALLIANCE_BOSS,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_WorldBoss=function(e){return N.log("starstart_WorldBosst_PVM",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.ATTACK_WORLDBOSS,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),y.default.Instance.PostAction("MarchWorldBoss"+u.DATA.CurBattleData.otherData.bossUid,{level:u.DATA.UserData.Level,type:v.MarchType.ATTACK_WORLDBOSS,targetType:v.WorldMapEntityType.Boss,targetLevel:u.DATA.CurBattleData.otherData.itemId}),!0)},t.prototype.start_CountryBoss=function(e){return!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.COUNTRY_BOSS,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_PVR=function(e){return N.log("start_PVR",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.GATHER_RESOURCE,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps,u.DATA.CurBattleData.otherData.breakAttack?1:0),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),m.default.playG123SoundPathByName("res_collection"),y.default.Instance.PostAction("MarchGatherResouce"+u.DATA.CurBattleData.otherData.itemId,{level:u.DATA.UserData.Level,type:v.MarchType.GATHER_RESOURCE,targetType:v.WorldMapEntityType.Resource,targetLevel:u.DATA.CurBattleData.otherData.itemId}),!0)},t.prototype.start_PVR_Tower=function(e){var t=this;if(N.log("start_PVR_Tower",e),u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos){var a=0;u.DATA.CurBattleData.otherData.buildId&&(a=u.DATA.CurBattleData.otherData.buildId);var o=0,i=0,r=p.TABLE.getTableDataById(M.TableName.MAP_BUILDING,a.toString()),s="";if(r&&(r.build_coin?(o=r.build_coin,s=m.default.getResourceName(A.ResourceType.Coin),i=u.DATA.UserData.Resource.Coin):r.build_oil?(o=r.build_oil,s=m.default.getResourceName(A.ResourceType.Oil),i=u.DATA.UserData.Resource.Oila):r.build_food&&(o=r.build_food,s=m.default.getResourceName(A.ResourceType.Soil),i=u.DATA.UserData.Resource.Soil)),i<o)return void l.default.Instance().ShowTips(n.LOCAL.getText("100439"));var c=n.LOCAL.getText("map_building_tips01",m.default.GetLargeNumberShow(o),s);D.default.ShowView(c,n.LOCAL.getText("101073"),this,function(){return h.NET.send(_.RequestId.MARCH_WORLD_Build,{marchType:v.MarchType.BUILD_TOWER,x:u.DATA.CurBattleData.otherData.targetPos.x,y:u.DATA.CurBattleData.otherData.targetPos.y,armyList:e,armyListNew:e,heroList:t.attackerHeros,trapList:t.attackerTraps,buildId:a},t,function(e){if(N.log(e),e.d){var t=m.default.JSON_PARSE(e.d);if(!t)return;t.marchInfo||l.default.Instance().ShowTips(n.LOCAL.getText("100439"))}}),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0})}return!1},t.prototype.start_PVP=function(e){return N.log("start_PVP",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.ATTACK_PLAYER,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_AllianceBuilding=function(e){return N.log("start_AllianceBuilding",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.ALLIANCE_BUILDING,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},t.prototype.start_PVP_Alliance=function(e){return N.log("start_PVP_Alliance",e),h.NET.send(_.RequestId.ALLIANCE_PVP,{rank:u.DATA.CurBattleData.otherData.rank,armyList:e},this,function(e){var t=m.default.JSON_PARSE(e.d);if(!m.default.ObjIsEmpty(t))if(I.send(I.Names.ALLIANCE_ROLE_CHALLENGE_RESULT,e),m.default.ObjIsEmpty(t.fightProcessJson)||m.default.ObjIsEmpty(t.fightProcessJson.battle))l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel);else{for(var a=new Array,o=0;o<t.fightProcessJson.battle.attacker.unitArray.length;o++){var n=t.fightProcessJson.battle.attacker.unitArray[o];a.push(new s.BattleArmyData(n.armyId,n.id))}var i=m.default.ObjIsEmpty(t.fightProcessJson.battle.attacker.playerInfo)?"":m.default.getPlayerDisplayName(t.fightProcessJson.battle.attacker.playerInfo),r=m.default.ObjIsEmpty(t.fightProcessJson.battle.attacker.playerInfo)?null:L.getAvatarUrlFromTPlayerInfo(t.fightProcessJson.battle.attacker.playerInfo),c=new s.BattleItemData(t.fightProcessJson.battle.attacker.playerUid,i,0,null,r,a),d=new Array;for(o=0;o<t.fightProcessJson.battle.defender.unitArray.length;o++){n=t.fightProcessJson.battle.defender.unitArray[o];d.push(new s.BattleArmyData(n.armyId,n.id))}var p=m.default.ObjIsEmpty(t.fightProcessJson.battle.defender.playerInfo)?"":m.default.getPlayerDisplayName(t.fightProcessJson.battle.defender.playerInfo),h=m.default.ObjIsEmpty(t.fightProcessJson.battle.defender.playerInfo)?null:L.getAvatarUrlFromTPlayerInfo(t.fightProcessJson.battle.defender.playerInfo),f=new s.BattleItemData(t.fightProcessJson.battle.defender.playerUid,p,0,null,h,d),_={step:t.fightProcessJson.battleStep,result:t.fightProcessJson.vicUid==u.DATA.UserData.UID?1:0};u.DATA.CurBattleData=new s.BattleData(s.BattleType.REPLAY,c,f,_)}}),!0},t.prototype.start_TreasureMapBoss=function(e){return N.log("starstart_TreasureMapBoss_PVM",e),!!(u.DATA.CurBattleData&&u.DATA.CurBattleData.otherData&&u.DATA.CurBattleData.otherData.targetPos)&&(g.getInstance().worldMapMarch(v.MarchType.ATTACK_TREASURE_MAP_WORLD_BOSS,u.DATA.CurBattleData.otherData.targetPos,e,e,this.attackerHeros,this.attackerTraps),l.default.Instance().CloseUI(C.UIDataInfo.BattleMainPanel),l.default.Instance().CloseUI(C.UIDataInfo.ConfirmPanel),!0)},Object.defineProperty(t.prototype,"attackerArmyCount",{get:function(){for(var e=0,t=0;t<this.attackers.length;t++)this.attackers[t]&&(e+=this.attackers[t].length);return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attackerIsFull",{get:function(){return this.attackerArmyCount>=this.myMaxArmysNum+b.NBattlePositionBiz.getArmyAddNum()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attackerPosIsFull",{get:function(){for(var e=0;e<this.myMaxArmysNum;e++)if(!this.attackers[e])return!1;return!0},enumerable:!0,configurable:!0}),t.prototype.getPresetArmyAndHeroParams=function(e){var t={armyInfo:[],heroIds:[],index:e},a=this.attackerHeros,o=this.attackers;if(a&&a.length)for(var n=0;n<a.length;n++)t.heroIds.push(a[n]);if(o&&o.length)for(n=0;n<this.myMaxArmysNum;n++){for(var i=0;i<o.length;i++)if(o[i]&&o[i][0].BattleItemCoreData.pos==n){var r={pos:Number(o[i][0].BattleItemCoreData.pos),armyId:o[i][0].BattleItemCoreData.armyid,num:o[i].length};t.armyInfo.push(r);break}t.armyInfo.length<n+1&&t.armyInfo.push({pos:n,armyId:0,num:0})}else for(n=0;n<this.myMaxArmysNum;n++)t.armyInfo.push({pos:n,armyId:0,num:0});return t},t}(i.FMessageConnectionAbstract);t.exports=G,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/ConfirmPanel":"ConfirmPanel","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/BattleData":"BattleData","../Data/DataCenter":"DataCenter","../Module/Battle/BattleItem":"BattleItem","../Tools/GameTools":"GameTools","../Tools/PlayerInfoTool":"PlayerInfoTool","../Tools/SubPackMsgs":"SubPackMsgs","../components/worldmap/WorldMapCommon":"WorldMapCommon","../components/worldmap/controllers/WorldMapController":"WorldMapController","../components/worldmap/controllers/WorldMapTodoController":"WorldMapTodoController","../msgs/MvcMsgs":"MvcMsgs","./NBattleCommon":"NBattleCommon","./NBattleDisplayObjectFacade":"NBattleDisplayObjectFacade","./NBattleMsgs":"NBattleMsgs","./NBattlePositionBiz":"NBattlePositionBiz"}],NBattleMsgs:[function(e,t,a){"use strict";cc._RF.push(t,"5ad69swzg5InqTw1uU0qVJs","NBattleMsgs");var o,n=e("../../fws/mvc/FWSMvc");(function(e){var t;e.NBattleMsgQueueName="NBattleMsgQueueName",e.getBattleMsgQueue=function(){return n.Router().getQueue(e.NBattleMsgQueueName)},e.clearBattleMsgQueue=function(){n.Router().clearQueueMessages(e.NBattleMsgQueueName)},e.send=function(a,o,i){void 0===o&&(o=null),void 0===i&&(i=e.NBattleMsgQueueName);var r=t[a],s=new n.FMessage(r,o,i);return s.send(),s},function(e){e[e.NBattle_Enter=0]="NBattle_Enter",e[e.NBattle_Leave=1]="NBattle_Leave",e[e.NBattle_Init=2]="NBattle_Init",e[e.NBattle_Update_Panels=3]="NBattle_Update_Panels",e[e.NBattle_SetPosition=4]="NBattle_SetPosition",e[e.NBattle_PosDieArmy=5]="NBattle_PosDieArmy",e[e.NBattle_Start=6]="NBattle_Start",e[e.NBattle_StartReplay=7]="NBattle_StartReplay",e[e.NBattle_StartAdventure=8]="NBattle_StartAdventure",e[e.NBattle_ClickAdventure=9]="NBattle_ClickAdventure",e[e.NBattle_UnitAction=10]="NBattle_UnitAction",e[e.NBattle_UnitSkill=11]="NBattle_UnitSkill",e[e.NBattle_UnitHeroSkill=12]="NBattle_UnitHeroSkill",e[e.NBattle_Round=13]="NBattle_Round",e[e.NBattle_Result=14]="NBattle_Result",e[e.NBattle_Shock=15]="NBattle_Shock",e[e.NBattle_Update_Army_Units=16]="NBattle_Update_Army_Units",e[e.NBattle_Crit_Anim=17]="NBattle_Crit_Anim",e[e.NBattle_Delay=18]="NBattle_Delay",e[e.NBattle_ReportData=19]="NBattle_ReportData",e[e.NBattle_SetCellPosList=20]="NBattle_SetCellPosList",e[e.NBattle_SetCellPosIslandList=21]="NBattle_SetCellPosIslandList",e[e.NBattle_ClearBattleArmys=22]="NBattle_ClearBattleArmys",e[e.NBattle_DataBiz=23]="NBattle_DataBiz",e[e.NBattle_TimeZoom=24]="NBattle_TimeZoom",e[e.NBattle_ActionGroup=25]="NBattle_ActionGroup",e[e.NBattle_SetMarchTime=26]="NBattle_SetMarchTime",e[e.NBattle_SetRoundNum=27]="NBattle_SetRoundNum",e[e.NBattle_HeroSkill=28]="NBattle_HeroSkill",e[e.NBATTLE_ADD_HERO=29]="NBATTLE_ADD_HERO",e[e.NBattle_AddBuff=30]="NBattle_AddBuff",e[e.NBattle_RemoveBuff=31]="NBattle_RemoveBuff",e[e.NBattle_Shield_Change=32]="NBattle_Shield_Change",e[e.NBATTLE_HERO_BUFF_ADD=33]="NBATTLE_HERO_BUFF_ADD",e[e.NBattle_Keng=34]="NBattle_Keng",e[e.NBattle_MissAttack=35]="NBattle_MissAttack",e[e.NBattle_LifeBar_Reset=36]="NBattle_LifeBar_Reset",e[e.NBattle_UnitTrap=37]="NBattle_UnitTrap"}(t=e.Names||(e.Names={})),function(e){e[e.PVE_OBSTACLE=0]="PVE_OBSTACLE",e[e.REPLAY=1]="REPLAY"}(e.NBattleMsgsReplayDataType||(e.NBattleMsgsReplayDataType={}))})(o||(o={})),window.NBattleMsgs=o,t.exports=o,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc"}],NBattlePositionBiz:[function(e,t,a){"use strict";cc._RF.push(t,"7f5e6DMBiRJZbE3+2PJomJe","NBattlePositionBiz"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./NBattleCommon"),n=e("../../fws/utils/FWS2DUtils"),i=e("../../fws/FWSEnv"),r=e("../Data/DataCenter"),s=e("../Const/GameDefine"),l=e("../Data/BattleData"),c=e("../../fws/utils/FWSTool"),d=e("../hero/HeroController");(function(e){function t(e){for(var t=3,a=4;a>=1;a--)if(e>a*a){t=a+1;break}return t<3&&(t=3),t}e.DIST_START=0,e.DIST_SPACING=200,e.ANGLE_START=0,e.ANGLE_V=-110,e.ANGLE_H=-20,e.RATE_X=1,e.RATE_Y=.5,e.OFFSET_X_UP=260,e.OFFSET_Y_UP=70,e.OFFSET_X_DOWN=-290,e.OFFSET_Y_DOWN=-120,e.getPositionCols=t,e.getPositionRows=function(e){var a=t(e);return Math.ceil(e/a)},e.getCells=function(e){var a=t(e);return Math.ceil(e/a)*a},e.getPosition=function(a,i,r){var s=cc.Vec2.ZERO,l=a===o.NBattleForces.Defender,c=t(r),d=Math.floor(i/c),p=i%c,u=r%c;0===u&&(u=c);var h=Math.ceil(r/c),m=e.ANGLE_V,f=e.ANGLE_H;l&&(m+=180,f+=180);var _=p,y=d;if(s=n.position(s,m,e.DIST_SPACING*y,e.RATE_X,e.RATE_Y),s=n.position(s,f,e.DIST_SPACING*_,e.RATE_X,e.RATE_Y),h<3){var g=.5*(3-h);s=n.position(s,m,e.DIST_SPACING*g,e.RATE_X,e.RATE_Y)}return l?(s.x+=e.OFFSET_X_UP,s.y+=e.OFFSET_Y_UP):(s.x+=e.OFFSET_X_DOWN,s.y+=e.OFFSET_Y_DOWN),s},e.getPositionCount=function(e){var t=5;return i.USE_NEW_PVP_BATTLE?(e>=50?t=9:e>=45?t=8:e>=40?t=7:e>=35&&(t=6),t):5},e.getArmyAddNum=function(){if(!c.Obj.isEmpty(r.DATA.CurBattleData)&&r.DATA.CurBattleData.Type===l.BattleType.PVE_OBSTACLE)return 0;var e=r.DATA.UserData.Buff.getBuffAddValue(s.BuffType.BattleArmyAddNum);return c.Obj.isEmpty(r.DATA.CurBattleData)||r.DATA.CurBattleData.Type!==l.BattleType.Adventure_Boss||(e=0),e+d.HeroController.getInstance().getMarchHeroArmyAdd()},e.initAllPosition=function(){}})(a.NBattlePositionBiz||(a.NBattlePositionBiz={})),cc._RF.pop()},{"../../fws/FWSEnv":"FWSEnv","../../fws/utils/FWS2DUtils":"FWS2DUtils","../../fws/utils/FWSTool":"FWSTool","../Const/GameDefine":"GameDefine","../Data/BattleData":"BattleData","../Data/DataCenter":"DataCenter","../hero/HeroController":"HeroController","./NBattleCommon":"NBattleCommon"}],PrefabPlaceHolder:[function(e,t,a){"use strict";cc._RF.push(t,"2a20fAOeT9EKJ7bfn2WRJSu","PrefabPlaceHolder"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=cc._decorator,i=n.ccclass,r=n.property,s=e("../../../fws/display/factory/LocalAssertLoader"),l=e("../../../fws/display/factory/FWSAssertCaches"),c=e("../../../fws/utils/FWSTool"),d=e("../../../fws/utils/X"),p=e("../../Module/Item/EffectPlay"),u=e("../../Tools/GameTools"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefabPath="",t.needCalcBound=!1,t.inScene=!1,t._containerNode=null,t._preNode=null,t._loader=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"entityNode",{get:function(){return this._entityNode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preNode",{get:function(){return this._preNode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ContainerNode",{get:function(){return this._containerNode},enumerable:!0,configurable:!0}),t.prototype.cpnLoad=function(){this.node.name="PrefabPlaceHolder",this.init()},t.prototype.init=function(){this._preNode||(this._preNode=new cc.Node,this.node.addChild(this._preNode)),this._containerNode||(this._containerNode=new cc.Node,this.node.addChild(this._containerNode))},t.prototype.cpnEnable=function(){this.inScene=!0,this.clearSelf(),this.loadPrefab()},t.prototype.cpnDisable=function(){this.inScene=!1},t.prototype.cpnDestroy=function(){this.clearSelf()},t.prototype.reuse=function(){},t.prototype.unuse=function(){this.clearSelf()},t.prototype.loadPrefab=function(){if(c.Str.isEmpty(this.prefabPath))d.warn(c.Str.format("PrefabPlaceHolder::loadPrefab() \u6837\u672c\u8def\u5f84\u4e3a\u7a7a",this.prefabPath));else if(this._containerNode.destroyAllChildren(),!this.instantiatePrefab()){var e=this._loader=new s.LocalAssertLoader(this.prefabPath,cc.Prefab,!0);e.onError={target:this,handler:this.onTaskError},e.onCompleted={target:this,handler:this.onTaskCompleted},e.begin()}},t.prototype.clearSelf=function(){this._entityNode&&(u.default.verifyNode(this._entityNode)&&this._entityNode.destroy(),this._entityNode=null),this._loader&&(this._loader.cancel(),this._loader=null)},t.prototype.instantiatePrefab=function(){var e=l.getPrefab(this.prefabPath);if(!e)return!1;this._preNode.safetyDestroyAllChildren();var t=cc.instantiate(e);if(this._containerNode.addChild(t),this._entityNode=t,this.needCalcBound){var a=t.getBoundingBoxToWorld();this._containerNode.setContentSize(a.size),this.node.setContentSize(a.size)}return this.afterInstantiate(t),!0},t.prototype.afterInstantiate=function(e){e.setPosition(0,0),this.instantiateCallback&&this.instantiateCallback();var t=e.getComponent(p.default);t&&(t.callbackTarget=this,t.callbackHandler=this.onEffectPayEnd)},t.prototype.verifySelf=function(e){return void 0===e&&(e=!0),!!this.isValid&&(!!this.node&&(!!this.node.isValid&&!(e&&!this.inScene)))},t.prototype.onTaskError=function(e){this.verifySelf()},t.prototype.onTaskCompleted=function(e){this.verifySelf()&&this.instantiatePrefab()},t.prototype.onEffectPayEnd=function(){this.effectPlayEndCallbackHandler&&this.effectPlayEndCallbackHandler.call(this.effectPlayEndCallbackTarget),this.effectPlayEndAutoDestory&&this.destroy()},__decorate([r(cc.String)],t.prototype,"prefabPath",void 0),__decorate([r(cc.Boolean)],t.prototype,"needCalcBound",void 0),t=__decorate([i],t)}(o.default);a.default=h,cc._RF.pop()},{"../../../System/ComponentBase":"ComponentBase","../../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../../fws/display/factory/LocalAssertLoader":"LocalAssertLoader","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/X":"X","../../Module/Item/EffectPlay":"EffectPlay","../../Tools/GameTools":"GameTools"}],NBattleReportCommon:[function(e,t,a){"use strict";var o;cc._RF.push(t,"2dbe3soqVhCk4rzGHEin3HD","NBattleReportCommon"),function(e){e.PREFAB_BASE_PATH="ea_prefab/battle_v3/",e.PREFAB_SUMMARY_PVE=e.PREFAB_BASE_PATH+"PrefabNBattleMailSummaryPvE",e.PREFAB_SUMMARY_PVM=e.PREFAB_BASE_PATH+"PrefabNBattleMailSummaryPvM",e.PREFAB_SUMMARY_PVP=e.PREFAB_BASE_PATH+"PrefabNBattleMailSummaryPvP",e.PREFAB_PROP_CELL="ea_prefab/item/PropItem",e.PREFAB_PROP_LIST=e.PREFAB_BASE_PATH+"PrefabNBattleMailPropList",e.PREFAB_NVN_CELL=e.PREFAB_BASE_PATH+"PrefabNBattleMailNvNCell",e.PREFAB_NVN_LIST=e.PREFAB_BASE_PATH+"PrefabNBattleMailNvNList",e.PREFAB_PROPERTY_CELL=e.PREFAB_BASE_PATH+"PrefabNBattleMailPropertyCell",e.PREFAB_PROPERTY_LIST=e.PREFAB_BASE_PATH+"PrefabNBattleMailPropertyList",e.PREFAB_ARMY_CELL=e.PREFAB_BASE_PATH+"PrefabNBattleMailArmyCell",e.PREFAB_HERO_CELL=e.PREFAB_BASE_PATH+"PrefabNBattleMailHeroCell",e.PREFAB_ARMY_LIST=e.PREFAB_BASE_PATH+"PrefabNBattleMailArmyList",e.PREFAB_BOSS_DAMAGE=e.PREFAB_BASE_PATH+"PrefabNBattleMailBossDamage",e.PREFAB_SCOUT=e.PREFAB_BASE_PATH+"PrefabNBattleMailScout",e.PREFAB_CTREAD=e.PREFAB_BASE_PATH+"PrefabNBattleMailCtRead",e.PREFAB_SUPER_SCOUT_ITEM=e.PREFAB_BASE_PATH+"PrefabSuperScoutItem",e.PREFAB_BECOME_STRONGER=e.PREFAB_BASE_PATH+"PrefabNBattleMailPromotion",function(e){e[e.Live=0]="Live",e[e.Wounded=1]="Wounded",e[e.Dead=2]="Dead"}(e.NBattleReportUnitRuntimeState||(e.NBattleReportUnitRuntimeState={})),function(e){e[e.PvP=2]="PvP",e[e.PvR=3]="PvR",e[e.PvM=4]="PvM",e[e.PvB=5]="PvB",e[e.PvP_Team=7]="PvP_Team",e[e.PvB_Team=9]="PvB_Team",e[e.PvP_WONDER=10]="PvP_WONDER",e[e.PvB_Alliance=11]="PvB_Alliance",e[e.Throne=12]="Throne",e[e.Defender_Monster=14]="Defender_Monster",e[e.AL_Defender_Monster=15]="AL_Defender_Monster",e[e.Country_BOSS=16]="Country_BOSS",e[e.KVK_SCOUT=18]="KVK_SCOUT",e[e.TREASUREMAP_BOSS=23]="TREASUREMAP_BOSS",e[e.DIM_MINE=24]="DIM_MINE"}(e.NBattleReportType||(e.NBattleReportType={})),e.enabled=function(){return!1}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],ImageLoader:[function(e,t,a){"use strict";cc._RF.push(t,"f091e6eB/VHXZdSayEEADgR","ImageLoader"),Object.defineProperty(a,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,i=o.property,r=e("../../System/ComponentBase"),s=e("../../fws/utils/HttpUtils"),l=e("../../fws/display/factory/RemoteAssertLoader"),c=e("../../fws/display/factory/LocalAssertLoader"),d=e("../Tools/GameTools"),p=e("../../fws/display/factory/FWSAssertCaches"),u=e("../../fws/utils/IntervalReleaseManager"),h=e("../../fws/utils/ErrorReport"),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._url="",t.loadedUrl="",t._loading=!1,t._loadedSpf=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},set:function(e){this._url!=e&&this.doLoad(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aliveTime",{get:function(){return 12e4},enumerable:!0,configurable:!0}),t.prototype.release=function(){this._url&&this._loadedSpf&&this.sprite&&this.sprite.spriteFrame===this._loadedSpf&&this.clearImage()},t.prototype.loadWithCallback=function(e,t){this._url!=e&&this.doLoad(e,t)},t.prototype.doLoad=function(e,t){this.clearLoader(),this._url=e,this.createLoader(t)},t.prototype.cpnLoad=function(){e.prototype.cpnLoad.call(this),this.sprite=this.getComponent(cc.Sprite),window.ImageLoaderTest=this},t.prototype.cpnEnable=function(){if(e.prototype.cpnEnable.call(this),this._loadedSpf&&u.remove(this),this.loadedUrl!=this._url){if(this._loading)return;this.loader&&(this._loading=!0,this.loader.begin()),this.clearLoader(),this.createLoader()}},t.prototype.cpnDisable=function(){this._loadedSpf&&u.add(this)},t.prototype.cpnDestroy=function(){this.clearImage()},t.prototype.clearImage=function(){this._loadedSpf&&(this._loadedSpf=null,u.remove(this)),this.sprite&&(this.sprite.spriteFrame=null),this.clearLoader()},t.prototype.clearLoader=function(){this.loadedUrl="",this._loading=!1,this._loadedSpf=null,this.loader&&(this.loader.cancel(),this.loader=null)},t.prototype.createLoader=function(e){if(this.sprite){var t=this._url;t&&(this._loading=!0,this.loadedUrl="",this._loadedSpf=null,s.isUrl(t)?this.loader=new l.RemoteSpriteFrameLoader(t):this.loader=new c.LocalAssertLoader(t,cc.SpriteFrame),this.loader.onCompleted={target:this,handler:function(a,o){if(this.onSpriteFrameLoaded(p.getSpriteFrame(t),o),this.loader.cancel(),this.loader=null,this.loadedUrl=this._url,this._loading=!1,this.enabledInHierarchy||u.add(this),e)try{e(this._loadedSpf)}catch(e){h.error(e,"ImageLoaderCallback",t)}}},this.loader.onError={target:this,handler:function(){this._loading=!1,this.loader.reset(),this.enabledInHierarchy&&this.cpnScheduleOnce(this,function(){this.loader&&this.loader.begin()},1e3)}},this.loader.begin())}},t.prototype.onSpriteFrameLoaded=function(e,t){t||(e.enableAutoRelease=u.enabled),d.default.verifyComponent(this)&&this.sprite&&(this.sprite.spriteFrame=e,this._loadedSpf=e)},__decorate([i()],t.prototype,"_url",void 0),__decorate([i()],t.prototype,"url",null),t=__decorate([n],t)}(r.default);a.default=m,cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase","../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../fws/display/factory/LocalAssertLoader":"LocalAssertLoader","../../fws/display/factory/RemoteAssertLoader":"RemoteAssertLoader","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/HttpUtils":"HttpUtils","../../fws/utils/IntervalReleaseManager":"IntervalReleaseManager","../Tools/GameTools":"GameTools"}],RadialBlurTransition:[function(e,t,a){"use strict";cc._RF.push(t,"28bb0pFN+5M9oyK8xw4pkhJ","RadialBlurTransition"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=cc._decorator,i=n.ccclass,r=n.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=null,t.maskLayer=null,t._transitionTex=null,t._transitionSession=-1,t._spMaterial=null,t._animationStartTime=0,t}var a;return __extends(t,e),a=t,t.prototype.cpnLoad=function(){this.sprite&&(this._spMaterial=this.sprite.getMaterial(0))},t.prototype.showEffect=function(e){this.hideEffect(),++a._increaseSession;var t=this,o=t._transitionSession=a._increaseSession;t.node.opacity=255,cc.director.once(cc.Director.EVENT_BEFORE_DRAW,function(){if(cc.isValid(t.node,!0)&&o===t._transitionSession){var a=!1,n=cc.director.getScene().getChildByName("Canvas");n&&0===n.opacity&&(a=!0,n.opacity=255);var i=cc.game._renderContext.canvas;t._transitionTex=new cc.RenderTexture,t._transitionTex.initWithSize(i.width/cc.view.getScaleX(),i.height/cc.view.getScaleY()),cc.Camera.main.targetTexture=t._transitionTex,cc.Camera.main.render(null),cc.Camera.main.targetTexture=null;var r=new cc.SpriteFrame(t._transitionTex),s=r.uv[1],l=r.uv[5];r.uv[1]=r.uv[3]=l,r.uv[5]=r.uv[7]=s,t._spMaterial&&t._spMaterial.setProperty("sampleMaxDist",0,!0),t.node.scale=1,t.sprite.spriteFrame=r,t.node.width=i.width/cc.view.getScaleX(),t.node.height=i.height/cc.view.getScaleY(),t.node.setSiblingIndex(0),t.maskLayer&&(t.maskLayer.active=!0),t.enabled=!0,a&&(n.opacity=0),e&&e(),t._animationStartTime=performance.now()}})},t.prototype.cpnUpdate=function(){if(!(this._transitionSession<0)){var e=performance.now()-this._animationStartTime;if(this._spMaterial){var t=.3+.002*e*.5;t>1&&(t=1),this._spMaterial.setProperty("sampleMaxDist",t,!0)}var a=1+.002*e*.15;a>1.3&&(a=1.3),this.node.scale=a}},t.prototype.hideEffect=function(){this.node.opacity=0,this.enabled=!1,this._transitionSession=-1;var e=this.sprite.spriteFrame;e&&e.destroy(),this.sprite.spriteFrame=null,this._transitionTex&&(this._transitionTex.destroy(),this._transitionTex=null),this.maskLayer&&(this.maskLayer.active=!1)},t.prototype.cpnDestroy=function(){this.hideEffect()},t._increaseSession=0,__decorate([r(cc.Sprite)],t.prototype,"sprite",void 0),__decorate([r(cc.Node)],t.prototype,"maskLayer",void 0),t=a=__decorate([i],t)}(o.default);a.default=s,cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase"}],SimpleDescTips:[function(e,t,a){"use strict";cc._RF.push(t,"beab1E/u9tBDpZqtM3YzdQj","SimpleDescTips"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Common/BaseUI"),n=e("../Common/UIManager"),i=e("../Const/UIDataInfo"),r=e("../../fws/platforms/PlatformCore"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LabContent=null,t.TextContent=null,t}return __extends(t,e),t.ShowView=function(e,t){if(null!=e){var a=e.convertToWorldSpaceAR(new cc.Vec2(0,-e.height/2));n.default.Instance().OpenUI(i.UIDataInfo.SimpleDescTips,a,t)}},t.ShowViewWithWorldPos=function(e,t){n.default.Instance().OpenUI(i.UIDataInfo.SimpleDescTips,e,t)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t);var a=t[0],o=this.node.parent.convertToNodeSpaceAR(a),n=this.node.width,i=n/2+10-320,s=310;if(r.instance.canUseLandscapeUI()){var l=cc.view.getDesignResolutionSize(),c=window.innerHeight/l.height,d=window.innerWidth/c;i=n/2+10-d/2,s=d/2-10}o.x<i?o.x=i:o.x>s&&(o.x=s),this.node.position=o;var p=t[1].toString();this.TextContent.string=p},t.prototype.onCloseClick=function(){n.default.Instance().CloseUI(i.UIDataInfo.SimpleDescTips)},__decorate([c(cc.Label)],t.prototype,"LabContent",void 0),__decorate([c(cc.RichText)],t.prototype,"TextContent",void 0),t=__decorate([l],t)}(o.default);a.default=d,cc._RF.pop()},{"../../fws/platforms/PlatformCore":"PlatformCore","../Common/BaseUI":"BaseUI","../Common/UIManager":"UIManager","../Const/UIDataInfo":"UIDataInfo"}],ActivityValentineAnimComponent:[function(e,t,a){"use strict";cc._RF.push(t,"6d75a0JYpxHTLlFYxEsKwYx","ActivityValentineAnimComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Utils/UpdateSpriteFrame"),n=e("../../../System/ComponentBase"),i=e("../../Data/PlayerInfo"),r=e("../../Tools/GameTools"),s=e("../../Data/DataCenter"),l=e("../../Const/GameDefine"),c=cc._decorator,d=c.ccclass,p=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.leftIconSprite=null,t.rightIconSprite=null,t.leftNameLabel=null,t.rightNameLabel=null,t.MarkToggle=null,t}var a;return __extends(t,e),a=t,t.CheckShowAnime=function(){if(a._ShowAnimeState>=0)return 0==a._ShowAnimeState;var e=0;return r.default.GetTimeOfDay()==s.DATA.UserData.getLocalData(l.LocalDataKey.ValentineAnimeShowDay,0)&&(e=s.DATA.UserData.getLocalData(l.LocalDataKey.ValentineAnimeShowState,0)),a.SaveValentineAnimeState(e),0==e},t.SaveValentineAnimeState=function(e){a._ShowAnimeState=e;var t=r.default.GetTimeOfDay();s.DATA.UserData.setLocalData(l.LocalDataKey.ValentineAnimeShowDay,t),s.DATA.UserData.setLocalData(l.LocalDataKey.ValentineAnimeShowState,e)},t.prototype.setPlayer=function(e,t){var a;(this.leftNameLabel.string="",e.length>0)&&((a=new i.default).update(e),a.isEmpty&&(this.leftNameLabel.string=r.default.getPlayerDisplayName(a),o.UpdateSpriteFrameByWXUrl(a.getDisplayAvatarUrl(),this.leftIconSprite)));(this.rightNameLabel.string="",t.length>0)&&((a=new i.default).update(t),a.isEmpty&&(this.rightNameLabel.string=r.default.getPlayerDisplayName(a),o.UpdateSpriteFrameByWXUrl(a.getDisplayAvatarUrl(),this.rightIconSprite)))},t.prototype.onBtnCloseClick=function(){this.MarkToggle.isChecked&&a.SaveValentineAnimeState(1),this.node.active=!1,this.node.parent.removeChild(this.node,!0),this.node.destroy()},t._ShowAnimeState=-1,__decorate([p(cc.Sprite)],t.prototype,"leftIconSprite",void 0),__decorate([p(cc.Sprite)],t.prototype,"rightIconSprite",void 0),__decorate([p(cc.Label)],t.prototype,"leftNameLabel",void 0),__decorate([p(cc.Label)],t.prototype,"rightNameLabel",void 0),__decorate([p(cc.Toggle)],t.prototype,"MarkToggle",void 0),t=a=__decorate([d],t)}(n.default);a.default=u,cc._RF.pop()},{"../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../System/ComponentBase":"ComponentBase","../../Const/GameDefine":"GameDefine","../../Data/DataCenter":"DataCenter","../../Data/PlayerInfo":"PlayerInfo","../../Tools/GameTools":"GameTools"}],CoinTreeComponent:[function(e,t,a){"use strict";cc._RF.push(t,"f490axXszZIF4+JzhKaxdl7","CoinTreeComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../../Core/Common/TableManager"),i=e("../../../Core/Event/EventCenter"),r=e("../../../Core/Net/NetMgr"),s=e("../../Common/BaseUI"),l=e("../../Common/BIManager"),c=e("../../Common/ConfirmPanel"),d=e("../../Common/UIManager"),p=e("../../Const/EventId"),u=e("../../Const/GameDefine"),h=e("../../Const/RequestId"),m=e("../../Data/DataCenter"),f=e("../../Module/Home/ResFlyCompent"),_=e("../../Module/UI/FreeGoldPanel"),y=e("../../Tools/GameTools"),g=e("../../../fws/utils/FWSTool"),C=e("../../Common/LoadManager"),v=e("../../Module/Battle/AddRes"),I=e("../../../fws/utils/X"),T=e("../../Common/TaskGuide"),S=e("../../../fws/platforms/PlatformCore"),A=e("../../Const/UIDataInfo"),D=e("../../Const/TableName"),N=cc._decorator,b=N.ccclass,L=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.treeParticle=null,t.coinBaseValue=null,t.coinBaseValue2=null,t.coinMaxValue=null,t.progressSpriteNode=null,t.progressLabel=null,t.freeBtn=null,t.costGoldBtn=null,t.goldValueLabel=null,t.freeLabel=null,t.mutipleLeftLabel=null,t.mutipleRightLabel=null,t.mutipleEffectNode=null,t.timesLabels=null,t.buildCountNode=null,t.buildCountLabel=null,t.noBuildNode=null,t.buildMaxNode=null,t.content=null,t.itemNode=null,t.flyNode=null,t.valueLabel=null,t.maxNode=null,t.addCoinEffectNode=null,t._prevValue=0,t._pause=!1,t.needGoldNum=0,t.maxFreeNum=0,t.maxGoldNum=0,t._critPointMax=0,t._unlockSubLevel=0,t._unlockLevel=0,t._unlockScienceGroup=31e4,t._unlockCount=0,t.goldNums=[],t.levelPercent=0,t.levelTipLimit=100,t.buildingLimit=20,t.buildingList=[],t.buildingCount=0,t.buildingMinLevel=0,t}var a;return __extends(t,e),a=t,t.prototype.cpnLoad=function(){var e=n.TABLE.getTableDataById(D.TableName.DATACONFIG,"5072");if(!g.Obj.isEmpty(e)){var t=g.Obj.getProperty(e,"value","0"),a=m.DATA.UserData.Buff.getBuffAddValue(u.BuffType.CoinTreeAddFreeTimes);this.maxFreeNum=parseInt(t)+a}var o=n.TABLE.getTableDataById(D.TableName.DATACONFIG,"5073");if(!g.Obj.isEmpty(o)){t=g.Obj.getProperty(o,"value","0");var i=(a=m.DATA.UserData.Buff.getBuffDataById(970004))?a.Value:0;this.maxGoldNum=parseInt(t)+i}var r=n.TABLE.getTableDataById(D.TableName.DATACONFIG,"5079");g.Obj.isEmpty(r)||null!=(t=g.Obj.getPropertyByNames(r,null,"value"))&&(this.goldNums=t.split("|"));var s=n.TABLE.getTableDataById(D.TableName.DATACONFIG,"50001");g.Obj.isEmpty(s)||null!=(t=g.Obj.getPropertyByNames(s,null,"value"))&&(this._unlockSubLevel=parseInt(t));var l=n.TABLE.getTableDataById(D.TableName.DATACONFIG,"50002");g.Obj.isEmpty(l)||null!=(t=g.Obj.getPropertyByNames(l,null,"value"))&&(this._unlockCount=parseInt(t));var c=n.TABLE.getTableDataById(D.TableName.DATACONFIG,"17006");if(!g.Obj.isEmpty(c)&&null!=(t=g.Obj.getPropertyStringByNames(c,null,"value"))){var d=t.split("|");d.length>0&&(this._critPointMax=parseInt(d[0]))}},t.prototype.onShow=function(e){this.cpnUnschedule(this.setMultiple),this.cpnSchedule(this,this.setMultiple,.1),a.GetSharkMoneyTreeData(),this._unlockLevel=m.DATA.UserData.Level-this._unlockSubLevel,this.setMultiple(0);for(var t=0,i=0,r={},s=0;s<m.DATA.UserData.Buildings.length;s++){var l=m.DATA.UserData.Buildings[s];6===l.Data.type&&(t+=l.Data.para,i++,r[l.Data.level]?r[l.Data.level].count++:r[l.Data.level]={count:1,para:l.Data.para,level:l.Data.level})}this.buildCountNode.active=i<this.buildingLimit,this.buildMaxNode.active=i>=this.buildingLimit,i<this.buildingLimit&&(this.buildCountLabel.string=i.toString()),this.maxNode.active=!1;var c=n.TABLE.getTableDataById(D.TableName.BUILDING,String(1700+m.DATA.UserData.Level));if(c){var d=m.DATA.UserData.Buff.getBuffPercentValue(u.BuffType.CoinTreeAdd),p=Math.ceil(5*t/c.para)+100*d;this.levelPercent=Math.min(p,100),p>=100&&(this.valueLabel.node.color=new cc.Color(255,172,65),this.maxNode.active=!0),this.valueLabel.string=Math.min(p,100)+"%"}var h=[];for(var f in r)h.push(r[f]);h.sort(function(e,t){return t.level-e.level}),this.buildingList=h;if(this.content.safetyDestroyAllChildren(),this.noBuildNode.active=0==i,this.buildingCount=i,h.length>0&&(this.buildingMinLevel=h[0].level),i>0)for(var _=0;_<h.length&&!(0>=this.buildingLimit);_++){this.buildingMinLevel>h[_].level&&(this.buildingMinLevel=h[_].level);var g=h[_].count;g+0>this.buildingLimit&&(g=this.buildingLimit-0);var C=cc.instantiate(this.itemNode);if(C){var v=C.getChildByName("bg"),I=C.getChildByName("level"),T=C.getChildByName("num"),S=C.getChildByName("coin"),A=C.getChildByName("sign1"),N=C.getChildByName("sign2");v&&(v.active=_%2==0),I&&I.getComponent(cc.Label)&&(I.getComponent(cc.Label).string="Lv."+h[_].level+" "+o.LOCAL.getText("106935")),T&&T.getComponent(cc.Label)&&(T.getComponent(cc.Label).string="x"+h[_].count),S&&S.getComponent(cc.Label)&&(S.getComponent(cc.Label).string="+"+y.default.GetLargeNumberShow(h[_].para*h[_].count/20)),A&&N&&(this.levelPercent>=100?(A.active=!1,N.active=!1):m.DATA.UserData.Level<=h[_].level?(A.active=!0,N.active=!1):(A.active=!1,N.active=!0)),C.parent=this.content}}this.RefreshData()},t.prototype.cpnEnable=function(){i.EVENT.on(p.EventId.UpdateSharkMoneyTreeData,this.RefreshData,this)},t.prototype.cpnDisable=function(){i.EVENT.off(p.EventId.UpdateSharkMoneyTreeData,this.RefreshData,this)},t.prototype.RefreshData=function(){this.setBtnState(),this.setProgress(),this.setBaseValue(),this.setTimes()},t.prototype.setBtnState=function(){var e=m.DATA.UserData.sharkMoneyTreeData.moneyTreeUseFreeTime<this.maxFreeNum;this.freeBtn.node.active=e,this.costGoldBtn.node.active=!e,this.freeBtn.interactable=!0,this.costGoldBtn.interactable=!0,this.needGoldNum=0,e?this.freeLabel.string=g.Str.format("{0}/{1}",m.DATA.UserData.sharkMoneyTreeData.moneyTreeUseFreeTime,this.maxFreeNum):(this.goldNums.length>0?this.goldNums.length>m.DATA.UserData.sharkMoneyTreeData.moneyTreeUseBuyTime?this.needGoldNum=parseInt(this.goldNums[m.DATA.UserData.sharkMoneyTreeData.moneyTreeUseBuyTime]):this.needGoldNum=parseInt(this.goldNums[this.goldNums.length-1]):this.needGoldNum=0,this.goldValueLabel.string=this.needGoldNum.toString())},t.prototype.setProgress=function(){var e=m.DATA.UserData.sharkMoneyTreeData.moneyTreeCritPoint,t=this._critPointMax;t<=0?(this.progressLabel.string="0/0",this.progressSpriteNode.scaleX=0):(e=Math.min(t,e),this.progressLabel.string=g.Str.format("{0}/{1}",e,t),this.progressSpriteNode.scaleX=e/t)},t.prototype.setBaseValue=function(){this.coinBaseValue.string=y.default.GetLargeNumberShow(m.DATA.UserData.sharkMoneyTreeData.mutipleBaseValue),this.coinBaseValue2.string=y.default.GetLargeNumberShow(m.DATA.UserData.sharkMoneyTreeData.mutipleBaseValue),this.coinMaxValue.string=y.default.GetLargeNumberShow(m.DATA.UserData.sharkMoneyTreeData.mutipleBaseValue/(this.levelPercent/100))},t.prototype.setTimes=function(){var e=m.DATA.UserData.sharkMoneyTreeData.moneyTreeUseFreeTime+m.DATA.UserData.sharkMoneyTreeData.moneyTreeUseBuyTime,t=this.maxFreeNum+this.maxGoldNum;this.timesLabels.string=o.LOCAL.getText("public115",e.toString(),t.toString())},t.prototype.setMultiple=function(e){if(!this._pause){var t=[1,2,5,10],a=t.indexOf(this._prevValue);a>=0&&t.splice(a,1);var o=t[g.Random.getInt(0,t.length-1)];this._prevValue=o,this.setMutipleByValue(o,!1)}},t.prototype.setMutipleByValue=function(e,t){if(t){var a={1:cc.color(137,235,106),2:cc.color(52,195,255),5:cc.color(208,117,255),10:cc.color(255,180,0)};a[e]&&(this.mutipleLeftLabel.node.color=a[e],this.mutipleRightLabel.node.color=a[e])}else this.mutipleLeftLabel.node.color=cc.Color.WHITE,this.mutipleRightLabel.node.color=cc.Color.WHITE;var o=Math.floor(e/10),n=e%10;this.mutipleLeftLabel.string=o.toString(),this.mutipleRightLabel.string=n.toString()},t.prototype.getCoinClick=function(){if(S.instance.postStatsEvent("click_coin_tree"),this.levelPercent<this.levelTipLimit&&m.DATA.UserData.SharkMoneyTreeLevelTip){var e=this;d.default.Instance().OpenUI(A.UIDataInfo.cointreeTipPanel,this.buildingCount,this.buildingMinLevel,function(t){if(t&&(m.DATA.UserData.SharkMoneyTreeLevelTip=!1),y.default.verifyComponent(e))if(e.needGoldNum>m.DATA.UserData.Resource.Gold)_.default.ShowView();else if(e.needGoldNum>0&&m.DATA.UserData.ConfirmCostGold){var a=o.LOCAL.getText("100126",e.needGoldNum.toString());c.default.ShowView(a,o.LOCAL.getText("100114"),e,e.SureShark,null,"","",!0)}else e.SureShark(!1)},this)}else if(m.DATA.UserData.sharkMoneyTreeData.moneyTreeUseBuyTime>=this.maxGoldNum)d.default.Instance().ShowTips(o.LOCAL.getText("100125"));else if(this.needGoldNum>0&&this.needGoldNum>m.DATA.UserData.Resource.Gold)_.default.ShowView();else if(this.needGoldNum>0&&m.DATA.UserData.ConfirmCostGold){var t=o.LOCAL.getText("100126",this.needGoldNum.toString());c.default.ShowView(t,o.LOCAL.getText("100114"),this,this.SureShark,null,"","",!0)}else this.SureShark(!1)},t.prototype.SureShark=function(e){1==e&&(m.DATA.UserData.ConfirmCostGold=!1),l.default.Instance.PostAction("SharkMoneyTreeClick"),this.freeBtn.interactable=!1,this.costGoldBtn.interactable=!1;var t=this;r.NET.send(h.RequestId.ShakeMoneyTreeData,{},this,function(e){var a=y.default.JSON_PARSE(e.d);null!==a&&t.GetCoinData(a)})},t.prototype.GetCoinData=function(e){I.log(e),m.DATA.UserData.UpdateSharkMoneyTreeData(e);var t=g.Obj.getProperty(e,"nowGold",0),a=g.Obj.getProperty(e,"nowMultiple",0);this._pause=!0,this.setMutipleByValue(a,!0);var o=this.addCoinEffectNode.parent.convertToWorldSpaceAR(this.addCoinEffectNode.position);v.default.AddResByWorldPos(u.ResourceType.Coin,"+"+y.default.GetLargeNumberShow(t),o,1),this.setMutipleEffect(a),this.freeBtn.interactable=!0,this.costGoldBtn.interactable=!0,this._pause=!1,this.cpnUnschedule(this.endAni),this.cpnScheduleOnce(this,this.endAni,1.5),this.coinsFly()},t.prototype.coinsFly=function(){for(var e=this.content.children,t=function(t){var o=cc.scaleTo(.1,0),n=cc.scaleTo(.1,1),i=a;e[t].runAction(cc.sequence(cc.spawn(o,cc.callFunc(function(){if(y.default.verifyComponent(i)){var a=i.buildingList[t].para,o=i.content.convertToWorldSpaceAR(e[t].position);f.default.ResFly(o,u.ResourceType.Coin,a,0,i.flyNode,null,d.default.Instance().flyLayer,1,!1)}})),cc.delayTime(.8),n)),a.cpnScheduleOnce(a,function(){y.default.verifyComponent(i)&&i.treeParticle.resetSystem()},1),a.unschedule(a.coinDownEndAni),a.cpnScheduleOnce(a,a.coinDownEndAni,2.5)},a=this,o=0;o<e.length;o++)t(o)},t.prototype.endAni=function(){this.mutipleEffectNode.destroyAllChildren()},t.prototype.coinDownEndAni=function(){y.default.verifyComponent(this)&&this.treeParticle&&this.treeParticle.stopSystem()},t.prototype.setMutipleEffect=function(e){this.mutipleEffectNode.destroyAllChildren();var t=this,a={1:cc.color(137,235,106),2:cc.color(52,195,255),5:cc.color(208,117,255),10:cc.color(255,180,0)};C.LoadManager.loadPrefabSync("effect/prefab/Effect_yaoqianshu_baoji",function(o,n){if(n){var i=cc.instantiate(n);if(i){t.mutipleEffectNode.addChild(i);var r=i.getChildByName("nummain");if(r){a[e]&&(r.color=a[e]);var s=r.getComponent(cc.Label);s&&(s.string="X"+e.toString())}var l=i.getChildByName("titleMain");l&&a[e]&&(l.color=a[e])}}},this)},t.GetSharkMoneyTreeData=function(){r.NET.send(h.RequestId.GET_ShakeMoneyTreeData,{},this,function(e){var t=y.default.JSON_PARSE(e.d);null!==t&&m.DATA.UserData.UpdateSharkMoneyTreeData(t)})},t.prototype.onClickBuild=function(){T.default.Instance.StartSpecialGuide(u.TaskGuideId.BuildBuildingNew,1700),this.close()},t.prototype.tipsBtnClick=function(){d.default.Instance().OpenUI(A.UIDataInfo.DetailPanel,o.LOCAL.getText("100127"),o.LOCAL.getText("Taxcenter002"),500)},__decorate([L(cc.ParticleSystem)],t.prototype,"treeParticle",void 0),__decorate([L(cc.Label)],t.prototype,"coinBaseValue",void 0),__decorate([L(cc.Label)],t.prototype,"coinBaseValue2",void 0),__decorate([L(cc.Label)],t.prototype,"coinMaxValue",void 0),__decorate([L(cc.Node)],t.prototype,"progressSpriteNode",void 0),__decorate([L(cc.Label)],t.prototype,"progressLabel",void 0),__decorate([L(cc.Button)],t.prototype,"freeBtn",void 0),__decorate([L(cc.Button)],t.prototype,"costGoldBtn",void 0),__decorate([L(cc.Label)],t.prototype,"goldValueLabel",void 0),__decorate([L(cc.Label)],t.prototype,"freeLabel",void 0),__decorate([L(cc.Label)],t.prototype,"mutipleLeftLabel",void 0),__decorate([L(cc.Label)],t.prototype,"mutipleRightLabel",void 0),__decorate([L(cc.Node)],t.prototype,"mutipleEffectNode",void 0),__decorate([L(cc.Label)],t.prototype,"timesLabels",void 0),__decorate([L(cc.Node)],t.prototype,"buildCountNode",void 0),__decorate([L(cc.Label)],t.prototype,"buildCountLabel",void 0),__decorate([L(cc.Node)],t.prototype,"noBuildNode",void 0),__decorate([L(cc.Node)],t.prototype,"buildMaxNode",void 0),__decorate([L(cc.Node)],t.prototype,"content",void 0),__decorate([L(cc.Node)],t.prototype,"itemNode",void 0),__decorate([L(cc.Node)],t.prototype,"flyNode",void 0),__decorate([L(cc.Label)],t.prototype,"valueLabel",void 0),__decorate([L(cc.Node)],t.prototype,"maxNode",void 0),__decorate([L(cc.Node)],t.prototype,"addCoinEffectNode",void 0),t=a=__decorate([b],t)}(s.default);a.default=E,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Event/EventCenter":"EventCenter","../../../Core/Net/NetMgr":"NetMgr","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/X":"X","../../Common/BIManager":"BIManager","../../Common/BaseUI":"BaseUI","../../Common/ConfirmPanel":"ConfirmPanel","../../Common/LoadManager":"LoadManager","../../Common/TaskGuide":"TaskGuide","../../Common/UIManager":"UIManager","../../Const/EventId":"EventId","../../Const/GameDefine":"GameDefine","../../Const/RequestId":"RequestId","../../Const/TableName":"TableName","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Module/Battle/AddRes":"AddRes","../../Module/Home/ResFlyCompent":"ResFlyCompent","../../Module/UI/FreeGoldPanel":"FreeGoldPanel","../../Tools/GameTools":"GameTools"}],UnLockBuildingUpComponent:[function(e,t,a){"use strict";cc._RF.push(t,"e01e9W5Sv5H7oBo5XDIYiSl","UnLockBuildingUpComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../../Core/Common/TableManager"),i=e("../../../System/ComponentBase"),r=e("../../../fws/utils/FWSTool"),s=e("../../Tools/GameTools"),l=e("../../Const/TableName"),c=cc._decorator,d=c.ccclass,p=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconCoinNode=null,t.iconSoliderNode=null,t.buildingDescLabel=null,t.valueLabel=null,t.upLabel=null,t._configId=0,t}return __extends(t,e),t.prototype.init=function(e){this._configId=e;do{var t=n.TABLE.getTableDataById(l.TableName.BUILDING,this._configId.toString());if(r.Obj.isEmpty(t))break;var a=r.Obj.getPropertyNumberByNames(t,null,"level"),i=r.Obj.getPropertyNumberByNames(t,null,"group"),c=r.Obj.getPropertyNumberByNames(t,null,"type");if(null===a||null===i||null==c)break;var d=null;if(6===c){var p=a-1,u=n.TABLE.getTableGroup(l.TableName.BUILDING);for(var h in u){var m=u[h];if(m.group===i&&m.level===p){d=m;break}}if(r.Obj.isEmpty(d))break}this.iconCoinNode.active=6===c,this.iconSoliderNode.active=2===c;var f="",_="",y="";if(6===c){f=o.LOCAL.getText("118753");var g=r.Obj.getPropertyNumberByNames(t,0,"para"),C=r.Obj.getPropertyNumberByNames(t,0,"produce_time"),v=0;C>0&&(v=Math.ceil(g/C),_=s.default.GetLargeNumberShow(v));var I=r.Obj.getPropertyNumberByNames(d,0,"para"),T=r.Obj.getPropertyNumberByNames(d,0,"produce_time"),S=0;T>0&&(S=Math.ceil(I/T));var A=Math.max(0,v-S);y="+"+s.default.GetLargeNumberShow(A)}else if(2===c){g=r.Obj.getPropertyNumberByNames(t,0,"para");var D=n.TABLE.getTableDataById(l.TableName.ARMY,g.toString()),N=s.default.getArmyName(D.id);f=o.LOCAL.getText("118754",N)}else{var b=r.Obj.getPropertyStringByNames(t,"","desc");f=o.LOCAL.getText(b)}this.buildingDescLabel.string=f,this.buildingDescLabel.node.active=f.length>0,this.valueLabel.string=_,this.valueLabel.node.active=_.length>0,this.upLabel.string=y,this.upLabel.node.active=y.length>0}while(0)},__decorate([p(cc.Node)],t.prototype,"iconCoinNode",void 0),__decorate([p(cc.Node)],t.prototype,"iconSoliderNode",void 0),__decorate([p(cc.Label)],t.prototype,"buildingDescLabel",void 0),__decorate([p(cc.Label)],t.prototype,"valueLabel",void 0),__decorate([p(cc.Label)],t.prototype,"upLabel",void 0),t=__decorate([d],t)}(i.default);a.default=u,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../System/ComponentBase":"ComponentBase","../../../fws/utils/FWSTool":"FWSTool","../../Const/TableName":"TableName","../../Tools/GameTools":"GameTools"}],UnLockPanelComponent:[function(e,t,a){"use strict";cc._RF.push(t,"d6e2cHZDI1NyKLOFHnPd2/O","UnLockPanelComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Core/Common/LocalManager"),n=e("../../../Core/Common/TableManager"),i=e("../../../Core/Net/NetMgr"),r=e("../../Common/BaseUI"),s=e("../../Common/UIManager"),l=e("../../Const/GameDefine"),c=e("../../Const/RequestId"),d=e("../../Const/UIDataInfo"),p=e("../../Data/DataCenter"),u=e("../../Tools/GameTools"),h=e("../../../fws/utils/FWSTool"),m=e("../../Common/LoadManager"),f=e("../../Module/Item/EffectTitlePrefab"),_=e("./UnLockBuildingUpComponent"),y=e("../../Common/ListView/FrameTaskManager"),g=e("../../../fws/display/factory/FWSAssertCaches"),C=e("../../ShareSDK/RGShareInterface"),v=e("../../../fws/utils/X"),I=e("../../../fws/platforms/PlatformCore"),T=e("../../Const/TableName"),S=cc._decorator,A=S.ccclass,D=S.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.effectNode=null,t.nameLabel=null,t.levelLabel=null,t.unlockBuildingSprite=null,t.unlockMergeSprite=null,t.topLbNode=null,t.titleNode=null,t.buildingUpNode=null,t.buildingShareBtnNode=null,t.buildingShareBtnLabel=null,t.bottomDescLabel=null,t.closeNode=null,t._callBack=null,t._delegate=null,t._configId=0,t._Type=0,t._titleString="",t}var a;return __extends(t,e),a=t,t.unlockArmy=function(e,t){void 0===t&&(t=!1);var o=n.TABLE.getTableDataById(T.TableName.ARMY,e.toString()),i=o.level||0,r=n.TABLE.getTableDataById(T.TableName.DATACONFIG,"100002"),c=h.Obj.getPropertyNumberByNames(r,0,"value"),p=I.instance.adVideoLoadFrom();C.default.RGShareSDKGetShareType(C.RGSharePoint.SP_UnLockItemPanelArmy,C.IRGCanUseShareType.canUse_ShareOrWatchAd,{adtype:p},function(n){a._unlockArmyActionType=n,i==c&&o.type==l.ArmyType.Land&&a._unlockArmyActionType==C.IRGShareType.shartype_watchAd?a._unlockArmySpecial=!0:a._unlockArmySpecial=!1,s.default.Instance().OpenUI(d.UIDataInfo.UnLockArmyPanelComponent,{type:1,id:e,openAgain:t})})},t.unlockBuilding=function(e,t){void 0===t&&(t=!1),s.default.Instance().OpenUI(d.UIDataInfo.UnLockPanelComponent,{type:2,id:e,openAgain:t})},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t);var a=t[0];t.length>=3&&(this._callBack=t[1],this._delegate=t[2]),v.log(a),this._Type=h.Obj.getPropertyNumberByNames(a,0,"type"),this._configId=h.Obj.getPropertyNumberByNames(a,0,"id");var o=h.Obj.getProperty(a,"desc","");""!==o&&(this.nameLabel.string=o),this.onShowSetPanel()},t.prototype.onShowSetPanel=function(){this.buildingShareBtnNode.active=!1,this.bottomDescLabel.string="",this.nameLabel.node.active=!1,this.levelLabel.node.active=!1,this.unlockMergeSprite.active=!1,this.closeNode.active=!1},t.prototype.onScaleShowFinished=function(t){e.prototype.onScaleShowFinished.call(this,t),this.scaleFinishedSetPanel()},t.prototype.scaleFinishedSetPanel=function(){var e="UnLockPanelComponent",t=function(){u.default.verifyComponent(this)&&this.setBgEffect()}.bind(this),a=function(){u.default.verifyComponent(this)&&this.setBaseInfo()}.bind(this),o=function(){u.default.verifyComponent(this)&&this.setTitleEffect()}.bind(this),n=function(){u.default.verifyComponent(this)&&this.setUp()}.bind(this);y.FrameTaskManager.getInstance().addTask(new y.FrameTask(a,e)),y.FrameTaskManager.getInstance().addTask(new y.FrameTask(o,e)),y.FrameTaskManager.getInstance().addTask(new y.FrameTask(n,e)),y.FrameTaskManager.getInstance().addTask(new y.FrameTask(t,e))},t.prototype.setBaseInfo=function(){this.closeNode.active=!0;var e=2===this._Type;switch(this.unlockBuildingSprite.node.active=e,this.unlockMergeSprite.active=3===this._Type,this.buildingUpNode.active=e,this.buildingShareBtnNode.active=e,this.nameLabel.node.active=!0,this.levelLabel.node.active=e,this._Type){case 2:this.setUnlockBuilding();break;case 3:this.setUnlockBatchMerge()}2===this._Type&&this.SendOpenMarkToServer()},t.prototype.setTitleEffect=function(){var e=this.titleNode.getChildByName("title");if(e){var t=e.getComponent(f.default);t&&(t.Init(this._titleString,2),t.playAnim())}else{var a="ea_prefab/item/EffectTitlePrefab_Long";4===this._Type&&(a="ea_prefab/item/EffectTitlePrefab_Short");var o=this;m.LoadManager.loadPrefabSync(a,function(e,t){if(t){var a=cc.instantiate(t);if(a){o.titleNode.addChild(a),a.name="title";var n=a.getComponent(f.default);n&&n.Init(o._titleString,2),4===o._Type&&(o.titleNode.y+=50)}}},this)}},t.prototype.setBgEffect=function(){var e=this.effectNode.getChildByName("E");if(h.Obj.isEmpty(e)){var t=g.getPrefab("effect/prefab/Effect_jiesuo_jianzhu_xunhuan");if(t){var a=cc.instantiate(t);a&&(a.x=0,a.y=0,this.effectNode.addChild(a),a.name="E")}}},t.prototype.setUnlockBuilding=function(){this._titleString=o.LOCAL.getText("112238");var e=n.TABLE.getTableDataById(T.TableName.BUILDING,this._configId.toString()),t=h.Obj.getPropertyStringByNames(e,"","name"),a=h.Obj.getPropertyNumberByNames(e,0,"level"),i=o.LOCAL.getText(t);this.nameLabel.string=i,this.levelLabel.string="(Lv."+a.toString()+")",u.default.UpdateBuildingIcon(e,this.unlockBuildingSprite),this.shareID=C.RGSharePoint.SP_UnLockItemPanelBuilding,this.buildingShareBtnLabel.string=o.LOCAL.getText("100098"),this.bottomDescLabel.string=o.LOCAL.getText("118755"),this.buildingShareBtnNode.active=!0;var r=this,s=I.instance.adVideoLoadFrom();C.default.RGShareSDKGetShareType(C.RGSharePoint.SP_UnLockItemPanelBuilding,C.IRGCanUseShareType.canUse_ShareOrWatchAd,{adtype:s},function(e){e!=C.IRGShareType.sharetype_Share&&(r.buildingShareBtnNode.active=!1)})},t.prototype.setUnlockBatchMerge=function(){this._titleString=o.LOCAL.getText("112243"),this.nameLabel.string=o.LOCAL.getText("100123"),this.bottomDescLabel.string=o.LOCAL.getText("100124")},t.prototype.setUp=function(){switch(this._Type){case 2:this.setBuildingUp()}},t.prototype.setBuildingUp=function(){var e=this.buildingUpNode.getChildByName("B");if(h.Obj.isEmpty(e)){var t=this;m.LoadManager.loadPrefabSync("ea_prefab/ui/unlock/prefabUnLockBuildingUp",function(e,a){if(a){var o=cc.instantiate(a);if(o){t.buildingUpNode.addChild(o),o.name="B";var n=o.getComponent(_.default);n&&n.init(t._configId)}}},this)}else{var a=e.getComponent(_.default);a&&a.init(this._configId)}},t.prototype.ForceClose=function(){this.checkRateMePop(),this.close()},t.prototype.checkRateMePop=function(){var e=!1;switch(this._Type){case 2:e=p.DATA.UserData.FunctionOn(l.FunctionKey.GP_rateme_building)}e&&u.default.checkRateMePopup(p.DATA.UserData.Level)},t.prototype.unlockBuildingBtnClick=function(){var e=I.instance.adVideoLoadFrom();C.default.RGShareSDKDoAction(this.shareID,C.IRGShareType.sharetype_Share,{adtype:e},{success:function(){},fail:function(e){v.log("UnLockItemPanel_UseSDK   ShareErrorCode:"+e)}})},t.prototype.CloseUI=function(){v.log("onCloseCLIKKKKKKKKK"),4===this._Type&&this._callBack&&this._delegate?this._callBack.call(this._delegate):(this.close(),this.checkRateMePop())},t.prototype.SendOpenMarkToServer=function(){var e={type:this._Type,itemid:this._configId.toString()};i.NET.send(c.RequestId.SetMaxItem,e)},t._unlockArmyActionType=null,t._unlockArmySpecial=!1,__decorate([D(cc.Node)],t.prototype,"effectNode",void 0),__decorate([D(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([D(cc.Label)],t.prototype,"levelLabel",void 0),__decorate([D(cc.Sprite)],t.prototype,"unlockBuildingSprite",void 0),__decorate([D(cc.Node)],t.prototype,"unlockMergeSprite",void 0),__decorate([D(cc.Node)],t.prototype,"topLbNode",void 0),__decorate([D(cc.Node)],t.prototype,"titleNode",void 0),__decorate([D(cc.Node)],t.prototype,"buildingUpNode",void 0),__decorate([D(cc.Node)],t.prototype,"buildingShareBtnNode",void 0),__decorate([D(cc.Label)],t.prototype,"buildingShareBtnLabel",void 0),__decorate([D(cc.Label)],t.prototype,"bottomDescLabel",void 0),__decorate([D(cc.Node)],t.prototype,"closeNode",void 0),t=a=__decorate([A],t)}(r.default);a.default=N,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Net/NetMgr":"NetMgr","../../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/X":"X","../../Common/BaseUI":"BaseUI","../../Common/ListView/FrameTaskManager":"FrameTaskManager","../../Common/LoadManager":"LoadManager","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Const/RequestId":"RequestId","../../Const/TableName":"TableName","../../Const/UIDataInfo":"UIDataInfo","../../Data/DataCenter":"DataCenter","../../Module/Item/EffectTitlePrefab":"EffectTitlePrefab","../../ShareSDK/RGShareInterface":"RGShareInterface","../../Tools/GameTools":"GameTools","./UnLockBuildingUpComponent":"UnLockBuildingUpComponent"}],CrossServerMapData:[function(e,t,a){"use strict";cc._RF.push(t,"519f6TgLONBX5cVCo7O530V","CrossServerMapData"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../fws/task/FWSTask"),n=e("../../Data/GlobalData"),i=e("../../Common/LoadManager"),r=e("../../../fws/utils/X"),s=e("../../../fws/utils/FWSTool"),l=e("./WorldMapCommon"),c=e("./WorldMapCommon"),d=e("../../../Core/Common/LocalManager"),p=e("../../../fws/platforms/PlatformCore"),u=e("../../../fws/utils/ErrorReport");a.CS_WorldMapTileSetMap={1:{name:"wm_tile_desert_01"},2:{name:"wm_tile_desert_02"},3:{name:"wm_tile_desert_03"},4:{name:"wm_tile_desert_04"},5:{name:"wm_tile_desert_05"},6:{name:"wm_tile_desert_06"},7:{name:"wm_tile_desert_07"},8:{name:"wm_tile_desert_08"},9:{name:"wm_tile_desert_09"},10:{name:"wm_tile_desert_10"},11:{name:"wm_tile_desert_11"},12:{name:"wm_tile_desert_12"},13:{name:"wm_tile_desert_13"},14:{name:"wm_tile_desert_14"},15:{name:"wm_tile_desert_15"},16:{name:"wm_tile_snow_01"},17:{name:"wm_tile_snow_02"},18:{name:"wm_tile_snow_03"},19:{name:"wm_tile_snow_04"},20:{name:"wm_tile_snow_05"},21:{name:"wm_tile_snow_06"},22:{name:"wm_tile_snow_07"},23:{name:"wm_tile_snow_08"},24:{name:"wm_tile_snow_09"},25:{name:"wm_tile_snow_10"},26:{name:"wm_tile_snow_11"},27:{name:"wm_tile_snow_12"},28:{name:"wm_tile_snow_13"},29:{name:"wm_tile_snow_14"},30:{name:"wm_tile_snow_15"},31:{name:"wm_spec_01",pos:new cc.Vec2(1,1),scale:1},32:{name:"wm_spec_02",pos:new cc.Vec2(1,1),scale:1},33:{name:"wm_spec_03",pos:new cc.Vec2(1,1),scale:1},34:{name:"wm_spec_04",pos:new cc.Vec2(1,1),scale:1},35:{name:"wm_spec_05",pos:new cc.Vec2(1,1),scale:1},36:{name:"wm_spec_06",pos:new cc.Vec2(1,1),scale:1},37:{name:"wm_spec_07",pos:new cc.Vec2(1,1),scale:1},38:{name:"wm_spec_08",pos:new cc.Vec2(1,1),scale:1},39:{name:"wm_spec_09",pos:new cc.Vec2(1,1),scale:1},40:{name:"wm_spec_10",pos:new cc.Vec2(1,1),scale:1.4},41:{name:"wm_spec_11",pos:new cc.Vec2(1,1),scale:1.4},42:{name:"wm_spec_12",pos:new cc.Vec2(1,1),scale:1.4},43:{name:"wm_spec_13",pos:new cc.Vec2(1,1),scale:1.4},44:{name:"wm_spec_14",pos:new cc.Vec2(1,1),scale:1.4},45:{name:"wm_spec_15",pos:new cc.Vec2(1,1),scale:1.4},46:{name:"wm_spec_16",pos:new cc.Vec2(1,1),scale:1.4},47:{name:"wm_spec_17",pos:new cc.Vec2(1,1),scale:1.4},48:{name:"wm_units_1",pos:new cc.Vec2(1,1),scale:1},49:{name:"wm_units_10",pos:new cc.Vec2(1,1),scale:1},50:{name:"wm_units_11",pos:new cc.Vec2(1,1),scale:1},51:{name:"wm_units_21",pos:new cc.Vec2(1,1),scale:1},52:{name:"wm_units_23",pos:new cc.Vec2(1,1),scale:1},53:{name:"wm_units_32",pos:new cc.Vec2(1,1),scale:1},54:{name:"wm_units_35",pos:new cc.Vec2(1,1),scale:1},55:{name:"wm_units_4",pos:new cc.Vec2(1,1),scale:1},56:{name:"wm_units_46",pos:new cc.Vec2(1,1),scale:1},57:{name:"wm_units_47",pos:new cc.Vec2(1,1),scale:1},58:{name:"wm_units_7",pos:new cc.Vec2(1,1),scale:1},59:{name:"wm_units_8",pos:new cc.Vec2(1,1),scale:1},60:{name:"wm_units_9",pos:new cc.Vec2(1,1),scale:1},61:{name:"wm_units_wc1",pos:new cc.Vec2(1,1),scale:1},62:{name:"wm_units_wc10",pos:new cc.Vec2(1,1),scale:1},63:{name:"wm_units_wc11",pos:new cc.Vec2(1,1),scale:1},64:{name:"wm_units_wc12",pos:new cc.Vec2(1,1),scale:1},65:{name:"wm_units_wc13",pos:new cc.Vec2(1,1),scale:1},66:{name:"wm_units_wc14",pos:new cc.Vec2(1,1),scale:1},67:{name:"wm_units_wc15",pos:new cc.Vec2(1,1),scale:1},68:{name:"wm_units_wc16",pos:new cc.Vec2(1,1),scale:1},69:{name:"wm_units_wc17",pos:new cc.Vec2(1,1),scale:1},70:{name:"wm_units_wc18",pos:new cc.Vec2(1,1),scale:1},71:{name:"wm_units_wc19",pos:new cc.Vec2(1,1),scale:1},72:{name:"wm_units_wc2",pos:new cc.Vec2(1,1),scale:1},73:{name:"wm_units_wc20",pos:new cc.Vec2(1,1),scale:1},74:{name:"wm_units_wc21",pos:new cc.Vec2(1,1),scale:1},75:{name:"wm_units_wc22",pos:new cc.Vec2(1,1),scale:1},76:{name:"wm_units_wc23",pos:new cc.Vec2(1,1),scale:1},77:{name:"wm_units_wc24",pos:new cc.Vec2(1,1),scale:1},78:{name:"wm_units_wc25",pos:new cc.Vec2(1,1),scale:1},79:{name:"wm_units_wc26",pos:new cc.Vec2(1,1),scale:1},80:{name:"wm_units_wc27",pos:new cc.Vec2(1,1),scale:1},81:{name:"wm_units_wc28",pos:new cc.Vec2(1,1),scale:1},82:{name:"wm_units_wc29",pos:new cc.Vec2(1,1),scale:1},83:{name:"wm_units_wc3",pos:new cc.Vec2(1,1),scale:1},84:{name:"wm_units_wc30",pos:new cc.Vec2(1,1),scale:1},85:{name:"wm_units_wc31",pos:new cc.Vec2(1,1),scale:1},86:{name:"wm_units_wc32",pos:new cc.Vec2(1,1),scale:1},87:{name:"wm_units_wc4",pos:new cc.Vec2(1,1),scale:1},88:{name:"wm_units_wc5",pos:new cc.Vec2(1,1),scale:1},89:{name:"wm_units_wc6",pos:new cc.Vec2(1,1),scale:1},90:{name:"wm_units_wc7",pos:new cc.Vec2(1,1),scale:1},91:{name:"wm_units_wc8",pos:new cc.Vec2(1,1),scale:1},92:{name:"wm_units_wc9",pos:new cc.Vec2(1,1),scale:1},95:{name:"wm_footer_1",pos:new cc.Vec2(1,1),scale:1},96:{name:"wm_footer_11",pos:new cc.Vec2(1,1),scale:1},97:{name:"wm_footer_13",pos:new cc.Vec2(1,1),scale:1},98:{name:"wm_footer_14",pos:new cc.Vec2(1,1),scale:1},99:{name:"wm_footer_2",pos:new cc.Vec2(1,1),scale:1},100:{name:"wm_footer_20",pos:new cc.Vec2(1,1),scale:1},101:{name:"wm_footer_24",pos:new cc.Vec2(1,1),scale:1},102:{name:"wm_footer_25",pos:new cc.Vec2(1,1),scale:1},103:{name:"wm_footer_26",pos:new cc.Vec2(1,1),scale:1},104:{name:"wm_footer_27",pos:new cc.Vec2(1,1),scale:1},105:{name:"wm_footer_28",pos:new cc.Vec2(1,1),scale:1},106:{name:"wm_footer_29",pos:new cc.Vec2(1,1),scale:1},107:{name:"wm_footer_3",pos:new cc.Vec2(1,1),scale:1},108:{name:"wm_footer_31",pos:new cc.Vec2(1,1),scale:1},109:{name:"wm_footer_36",pos:new cc.Vec2(1,1),scale:1},110:{name:"wm_footer_37",pos:new cc.Vec2(1,1),scale:1},111:{name:"wm_footer_38",pos:new cc.Vec2(1,1),scale:1},112:{name:"wm_footer_48",pos:new cc.Vec2(1,1),scale:1},113:{name:"wm_footer_5",pos:new cc.Vec2(1,1),scale:1},114:{name:"wm_footer_6",pos:new cc.Vec2(1,1),scale:1},115:{name:"wm_footer_7",pos:new cc.Vec2(1,1),scale:1},116:{name:"wm_footer_wc1",pos:new cc.Vec2(1,1),scale:1},117:{name:"wm_footer_wc2",pos:new cc.Vec2(1,1),scale:1},118:{name:"wm_footer_wc3",pos:new cc.Vec2(1,1),scale:1},119:{name:"wm_footer_wc4",pos:new cc.Vec2(1,1),scale:1},120:{name:"wm_footer_wc5",pos:new cc.Vec2(1,1),scale:1},121:{name:"wm_footer_wc6",pos:new cc.Vec2(1,1),scale:1},122:{name:"wm_footer_wc7",pos:new cc.Vec2(1,1),scale:1},123:{name:"wm_footer_wc8",pos:new cc.Vec2(1,1),scale:1},124:{name:"wm_footer_wc9",pos:new cc.Vec2(1,1),scale:1},125:{name:"wm_tile_th1_01"},126:{name:"wm_tile_th1_02"},127:{name:"wm_tile_th1_03"},128:{name:"wm_tile_th1_04"},129:{name:"wm_tile_th1_05"},130:{name:"wm_tile_th1_06"},131:{name:"wm_tile_th1_07"},132:{name:"wm_tile_th1_08"},133:{name:"wm_tile_th1_09"},134:{name:"wm_tile_th1_10"},135:{name:"wm_tile_th1_11"},136:{name:"wm_tile_th1_12"},137:{name:"wm_tile_th1_13"},138:{name:"wm_tile_th1_14"},139:{name:"wm_tile_th1_15"},140:{name:"wm_tile_th1_16"},141:{name:"wm_tile_th1_17"},142:{name:"wm_tile_th1_18"},143:{name:"wm_tile_th1_19"},144:{name:"wm_tile_th1_20"},145:{name:"wm_tile_th1_21"},146:{name:"wm_tile_th1_22"},147:{name:"wm_tile_th1_23"},148:{name:"wm_tile_th1_24"},149:{name:"wm_tile_th1_25"},150:{name:"wm_tile_th1_26"},151:{name:"wm_tile_th1_27"},152:{name:"wm_tile_th1_28"},153:{name:"wm_tile_th1_29"},155:{name:"wm_tile_th2_01"},156:{name:"wm_tile_th2_02"},157:{name:"wm_tile_th2_03"},158:{name:"wm_tile_th2_04"},159:{name:"wm_tile_th2_05"},160:{name:"wm_tile_th2_06"},161:{name:"wm_tile_th2_07"},162:{name:"wm_tile_th2_08"},163:{name:"wm_tile_th2_09"},164:{name:"wm_tile_th2_10"},165:{name:"wm_tile_th2_11"},166:{name:"wm_tile_th2_12"},167:{name:"wm_tile_th2_13"},168:{name:"wm_tile_th2_14"},169:{name:"wm_tile_th2_15"},174:{name:"wm_tile_water_01"},175:{name:"wm_tile_water_02"},176:{name:"wm_tile_water_03"},177:{name:"wm_tile_water_04"},178:{name:"wm_tile_water_05"},179:{name:"wm_tile_water_06"},180:{name:"wm_tile_water_07"},181:{name:"wm_tile_water_08"},182:{name:"wm_tile_water_09"},183:{name:"wm_tile_water_10"},184:{name:"wm_tile_water_11"},185:{name:"wm_tile_water_12"},186:{name:"wm_tile_water_13"},187:{name:"wm_tile_water_14"},188:{name:"wm_tile_water_15"},189:{name:"z_wm_dx_01_01"},190:{name:"z_wm_dx_01_02"},191:{name:"z_wm_dx_01_03"},192:{name:"z_wm_dx_01_04"},193:{name:"z_wm_dx_01_05"},194:{name:"z_wm_dx_01_06"},195:{name:"z_wm_dx_01_07"},196:{name:"z_wm_dx_01_08"},197:{name:"z_wm_dx_01_09"},198:{name:"z_wm_dx_01_10"},199:{name:"z_wm_dx_01_11"},200:{name:"z_wm_dx_01_12"},201:{name:"z_wm_dx_01_13"},202:{name:"z_wm_dx_01_14"},203:{name:"z_wm_dx_01_15"},204:{name:"z_wm_dx_02_01"},205:{name:"z_wm_dx_02_02"},206:{name:"z_wm_dx_02_03"},207:{name:"z_wm_dx_02_04"},208:{name:"z_wm_dx_02_05"},209:{name:"z_wm_dx_02_06"},210:{name:"z_wm_dx_02_07"},211:{name:"z_wm_dx_02_08"},212:{name:"z_wm_dx_02_09"},213:{name:"z_wm_dx_02_10"},214:{name:"z_wm_dx_02_11"},215:{name:"z_wm_dx_02_12"},216:{name:"z_wm_dx_02_13"},217:{name:"z_wm_dx_02_14"},218:{name:"z_wm_dx_02_15"},219:{name:"z_wm_dx_03_01"},220:{name:"z_wm_dx_03_02"},221:{name:"z_wm_dx_03_03"},222:{name:"z_wm_dx_03_04"},223:{name:"z_wm_dx_03_05"},224:{name:"z_wm_dx_03_06"},225:{name:"z_wm_dx_03_07"},226:{name:"z_wm_dx_03_08"},227:{name:"z_wm_dx_03_09"},228:{name:"z_wm_dx_03_10"},229:{name:"z_wm_dx_03_11"},230:{name:"z_wm_dx_03_12"},231:{name:"z_wm_dx_03_13"},232:{name:"z_wm_dx_03_14"},233:{name:"z_wm_dx_03_15"},234:{name:"z_wm_dx_04_01"},235:{name:"z_wm_dx_04_02"},236:{name:"z_wm_dx_04_03"},237:{name:"z_wm_dx_04_04"},238:{name:"z_wm_dx_04_05"},239:{name:"z_wm_dx_04_06"},240:{name:"z_wm_dx_04_07"},241:{name:"z_wm_dx_04_08"},242:{name:"z_wm_dx_04_09"},243:{name:"z_wm_dx_04_10"},244:{name:"z_wm_dx_04_11"},245:{name:"z_wm_dx_04_12"},246:{name:"z_wm_dx_04_13"},247:{name:"z_wm_dx_04_14"},248:{name:"z_wm_dx_04_15"},249:{name:"z_wm_dx_05_01"},250:{name:"z_wm_dx_05_02"},251:{name:"z_wm_dx_05_03"}};var h=function(){function e(){this._loaded=!1,this._mapData={links:[],files:[],terrainMap:{},areaMap:{}}}return Object.defineProperty(e,"instance",{get:function(){return e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapData",{get:function(){return this._mapData},enumerable:!0,configurable:!0}),e.prototype.loadFileData=function(e){var t=0;this._mapData.version=s.Binary.readByte(e,t++)+s.Binary.readByte(e,t++)/100,this._mapData.links.length=s.Binary.readByte(e,t++);for(var a=0;a<this._mapData.links.length;a++){var o={terrain:0,specData:[]};o.terrain=s.Binary.readByte(e,t++);for(var n=s.Binary.readByte(e,t++),i=0;i<n;i++)o.specData.push({index:s.Binary.readByte(e,t++),type:s.Binary.readByte(e,t++),fillArea:s.Binary.readByte(e,t++),nullArea:s.Binary.readByte(e,t++)});this._mapData.links[a]=o}this._mapData.files.length=s.Binary.readByte(e,t++);for(a=0;a<this._mapData.files.length;a++){var r={type:s.Binary.readByte(e,t++),index:s.Binary.readByte(e,t++),cols:s.Binary.readInt16(e,t),rows:s.Binary.readInt16(e,t+2),layers:[],layerMap:{}};t+=4,r.layers.length=s.Binary.readByte(e,t++);var c=r.cols*r.rows;for(i=0;i<r.layers.length;i++){var d={type:s.Binary.readByte(e,t++),tiles:[]};d.tiles.length=c;for(var p=0;p<d.tiles.length;p++)d.tiles[p]=s.Binary.readByte(e,t++);r.layers[i]=d,r.layerMap[d.type]=d}this._mapData.files[a]=r,r.type==l.CrossServerMapFileTypes.Area?this._mapData.areaMap[r.index]=r:this._mapData.terrainMap[r.index]=r}this._loaded=!0},e._instance=new e,e}();a.CrossServerMapData=h;var m=function(){function e(){this.TMX_ROWS=256,this.TMX_COLS=64,this.SPEC_ROWS=128,this.SPEC_COLS=32,this.WORLD_ROWS=1536,this.WORLD_COLS=384,this.LINK_TMX_ROWS=6,this.LINK_TMX_COLS=6,this.LINK_SPEC_ROWS=2,this.LINK_SPEC_COLS=2}return Object.defineProperty(e.prototype,"settings",{get:function(){return c.WorldMapSettings.AutoDynamicAddonElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cols",{get:function(){return this.WORLD_COLS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this.WORLD_ROWS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"crood_max_x",{get:function(){return 2*this.cols},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"crood_max_y",{get:function(){return this.rows},enumerable:!0,configurable:!0}),e.prototype.getAssetName=function(e){return a.CS_WorldMapTileSetMap[e]},e.prototype.getTile=function(e,t,a,o){if(e<0||t<0)return 0;if(e>=this.crood_max_x||t>=this.crood_max_y)return 0;var n=cc.v2(e,t);n=l.game2tmx(n);var i=Math.floor(n.x/this.TMX_COLS),r=Math.floor(n.y/this.TMX_ROWS),s=Math.floor((n.x-i*this.TMX_COLS)/this.SPEC_COLS),c=Math.floor((n.y-r*this.TMX_ROWS)/this.SPEC_ROWS),d=n.x%this.TMX_COLS,p=n.y%this.TMX_ROWS,m=n.x%this.SPEC_COLS,f=n.y%this.SPEC_ROWS,_=r*this.LINK_TMX_COLS+i,y=c*this.LINK_SPEC_COLS+s,g=h.instance.mapData.links[_];if(g||u.error(new Error("areaLink\u4e3a\u7a7a: area_index:"+_+", x:"+e+", y:"+t),"getTile","",!1,"CrossServerMapData"),a==l.CrossServerMapLayerTypes.Terrain)return(S=(T=h.instance.mapData.terrainMap[g.terrain]).layerMap[l.CrossServerMapLayerTypes.Terrain]).tiles[p*this.TMX_COLS+d];for(var C=0,v=g.specData.length-1;v>=0;v--){var I=g.specData[v];if(I.index===y)if(a==l.CrossServerMapLayerTypes.Area){var T,S;if(!(T=h.instance.mapData.areaMap[I.type]))return I.nullArea;if(!(S=T.layerMap[l.CrossServerMapLayerTypes.Area]))return I.nullArea;C=S.tiles[f*this.SPEC_COLS+m]?I.fillArea:I.nullArea}else{var A=h.instance.mapData.areaMap[I.type];if(!A)continue;var D=A.layerMap[l.CrossServerMapLayerTypes.Addon];if(!D)continue;var N=D.tiles[f*this.SPEC_COLS+m];if(N>0)return N}}return a==l.CrossServerMapLayerTypes.Addon?(S=(T=h.instance.mapData.terrainMap[g.terrain]).layerMap[l.CrossServerMapLayerTypes.Addon]).tiles[p*this.TMX_COLS+d]:C},e.prototype.isBlock=function(e,t,a){if(e<0||t<0)return!0;if(e>c.currentWorldMapTmxData.crood_max_x-1)return!0;if(t>c.currentWorldMapTmxData.crood_max_y-1)return!0;var o=this.getTile(e,t,c.CrossServerMapLayerTypes.Block);return o<=0?(o=this.getTile(e,t,c.CrossServerMapLayerTypes.Terrain))>=174&&o<=188:o>0},e.prototype.getArea=function(e,t,a){return this.getTile(e,t,l.CrossServerMapLayerTypes.Area)},e.prototype.canMoveTo=function(e,t){return this.isBlock(e,t)?d.LOCAL.getText("100206"):""},e.prototype.isBlockId=function(e){return e>=31&&e<=47},e.prototype.getReplaceBlockAssetName=function(e){return this.isBlockId(e)?"z_wm_unit_001":null},e}();a.CrossServerMapTmxData=m;var f=function(e){function t(t){var a=e.call(this,"fileUrl")||this;return a._fileUrl=t,a}return __extends(t,e),t.prototype.begin=function(){if(e.prototype.begin.call(this),!this._alreadyBegin&&!this._alreadyCompoleted){var t=n.GLOBAL.ResourceUrl+"/DynRes/genfiles/"+this._fileUrl;"g123"===p.instance.platformSID&&(this._fileUrl=this._fileUrl.replace(".bin",".map"),t=cc.url.raw("resources/map/"+this._fileUrl));var a=this;i.LoadManager.load(t,function(e,t){if(e)a.callListener(a.onError);else try{r.time("\u89e3\u6790\u8de8\u670d\u5730\u56fe\u6587\u4ef6"),h.instance.loadFileData(t),r.timeEnd("\u89e3\u6790\u8de8\u670d\u5730\u56fe\u6587\u4ef6"),a.callListener(a.onCompleted)}catch(e){a.callListener(a.onError),r.log(e)}})}},t}(o.Task);a.CrossServerMapDataLoader=f,c.crossServerMapTmxData=new m,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/task/FWSTask":"FWSTask","../../../fws/utils/ErrorReport":"ErrorReport","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/X":"X","../../Common/LoadManager":"LoadManager","../../Data/GlobalData":"GlobalData","./WorldMapCommon":"WorldMapCommon"}],WorldMapCommon:[function(e,t,a){"use strict";var o;cc._RF.push(t,"63958i7ny5DbaXeWPE/cAMX","WorldMapCommon"),function(e){e.MIN_ZOOM_LEVEL=.8,e.MAX_ZOOM_LEVEL=2,e.REBOUND_ZOOM_LEVEL=.9,e.DEFAULT_ZOOM_LEVEL=1.3,e.Tile_W=160,e.Tile_H=116,e.Tile_L=Math.pow(9764,.5),e.Global_Tile_W=800,e.Global_Tile_H=800,e.Server_Offset=0,e.MARCH_ENDTIME_DELAY=1,e.MARCH_SHOW_BATTLE_EFFECT_INTERVAL=2,e.MARCH_TIMEOUT_DELETE_DELAY=2,e.tmx2game=function(e){var t=e.clone(),a=t.y%2?1:0;return t.x=2*t.x+a,t},e.game2tmx=function(e){var t=e.clone();return t.y%2&&t.x--,t.x=Math.floor(t.x/2),t},e.ProvinceMatrix=[[1,2,3,4,5,6,7,8],[28,29,30,31,32,33,34,9],[27,48,49,50,51,52,35,10],[26,47,60,61,62,53,36,11],[25,46,59,64,63,54,37,12],[24,45,58,57,56,55,38,13],[23,44,43,42,41,40,39,14],[22,21,20,19,18,17,16,15]],function(e){e[e.WorldMap=0]="WorldMap",e[e.GlobalMap=1]="GlobalMap"}(e.WorldMapViewState||(e.WorldMapViewState={})),function(e){e[e.Blank=0]="Blank",e[e.City=1]="City",e[e.Monster=2]="Monster",e[e.Occupy=3]="Occupy",e[e.Resource=4]="Resource",e[e.Throne=10]="Throne",e[e.Boss=11]="Boss",e[e.RALLY_BOSS=12]="RALLY_BOSS",e[e.Territory=13]="Territory",e[e.ACTIVITY_BOSS=14]="ACTIVITY_BOSS",e[e.WorldSite=15]="WorldSite",e[e.ALLIANCE_BOSS=17]="ALLIANCE_BOSS",e[e.RefugeeCamp=18]="RefugeeCamp",e[e.AirDrop=19]="AirDrop",e[e.ItemGetMonster=20]="ItemGetMonster",e[e.DarkPortal=21]="DarkPortal",e[e.DefenderMonster=23]="DefenderMonster",e[e.ResourceTower=24]="ResourceTower",e[e.BuffTower=25]="BuffTower",e[e.WorldTreasure=26]="WorldTreasure",e[e.ALDefenderMonster=27]="ALDefenderMonster",e[e.CountryBoss=31]="CountryBoss",e[e.SELF_MONSTER=28]="SELF_MONSTER",e[e.MILITARY_RESOURCE=29]="MILITARY_RESOURCE",e[e.MILITARY_SELF_RALLY_MONSTER=30]="MILITARY_SELF_RALLY_MONSTER",e[e.TREASURE_MAP_WORLD_BOSS=32]="TREASURE_MAP_WORLD_BOSS",e[e.KVK_ALLIANCE_FORTRESS=41]="KVK_ALLIANCE_FORTRESS",e[e.KVK_ALLIANCE_FLAG=42]="KVK_ALLIANCE_FLAG",e[e.KVK_EXPEDITION_FORTRESS=43]="KVK_EXPEDITION_FORTRESS",e[e.KVK_EXPEDITION_OUTPOST=44]="KVK_EXPEDITION_OUTPOST",e[e.KVK_MILITARY_BASE=45]="KVK_MILITARY_BASE",e[e.KVK_MILITARY_FORTRESS=46]="KVK_MILITARY_FORTRESS",e[e.KVK_RESEARCH_INSTITUTE=47]="KVK_RESEARCH_INSTITUTE",e[e.KVK_DOOR=48]="KVK_DOOR",e[e.KVK_ETERNAL_CITY=49]="KVK_ETERNAL_CITY",e[e.occupied_tiled=100]="occupied_tiled"}(e.WorldMapEntityType||(e.WorldMapEntityType={})),function(e){e[e.Throne=1]="Throne",e[e.SmallThrone=2]="SmallThrone",e[e.Turret=3]="Turret",e[e.Tower=4]="Tower"}(e.ThroneType||(e.ThroneType={})),function(e){e[e.LOCK=0]="LOCK",e[e.OPEN=1]="OPEN",e[e.NORMAL=2]="NORMAL",e[e.FIGHTING=3]="FIGHTING"}(e.KVKWorldBuildingSTATUS||(e.KVKWorldBuildingSTATUS={})),function(e){e[e.GREEN=0]="GREEN",e[e.RED=1]="RED",e[e.BLUE=2]="BLUE"}(e.MarchLineColor||(e.MarchLineColor={})),e.MarchLineColor_MY=cc.Color.GREEN,e.MarchLineColor_OTHER_PLAYER=(new cc.Color).fromHEX("#ffb72c"),e.MarchLineColor_Alliance=(new cc.Color).fromHEX("#67e8ff"),e.MarchLineColor_BE_ATTACKED=(new cc.Color).fromHEX("#d41022"),function(e){e[e.NONE=-1]="NONE",e[e.POP_PIN=0]="POP_PIN",e[e.POP_BUTTON=1]="POP_BUTTON"}(e.WorldMapTilePopupType||(e.WorldMapTilePopupType={})),function(e){e[e.NONE=0]="NONE",e[e.POWER_RANK=1]="POWER_RANK",e[e.MONSTER_SEARCH=2]="MONSTER_SEARCH",e[e.WORLD_BUILD_BUILDING=3]="WORLD_BUILD_BUILDING",e[e.MOVE_TO=4]="MOVE_TO",e[e.WORLD_MAP_UI_HIDE=5]="WORLD_MAP_UI_HIDE",e[e.LOCKPLANE=6]="LOCKPLANE"}(e.WorldMapToDoType||(e.WorldMapToDoType={})),function(e){e[e.NONE=0]="NONE",e[e.COUT=1]="COUT",e[e.BATTLE=2]="BATTLE",e[e.GATHER_RESOURCE=3]="GATHER_RESOURCE",e[e.ENCAMPMENT=4]="ENCAMPMENT",e[e.ATTACK_MONSTER=5]="ATTACK_MONSTER",e[e.ALLIANCE_REINFORCE=6]="ALLIANCE_REINFORCE",e[e.ALLIANCE_TRADE=7]="ALLIANCE_TRADE",e[e.ALLIANCE_RALLY_BATTLE=8]="ALLIANCE_RALLY_BATTLE",e[e.ALLIANCE_RALLY_ASSEMBLY=9]="ALLIANCE_RALLY_ASSEMBLY",e[e.ALLIANCE_SUPER_RALLY_BATTLE=10]="ALLIANCE_SUPER_RALLY_BATTLE",e[e.ALLIANCE_GARRISON=11]="ALLIANCE_GARRISON",e[e.WONDER_BATTLE=12]="WONDER_BATTLE",e[e.ATTACK_PLAYER=13]="ATTACK_PLAYER",e[e.ATTACK_WORLDBOSS=14]="ATTACK_WORLDBOSS",e[e.RALLY_BOSS=15]="RALLY_BOSS",e[e.ALLIANCE_BUILDING=16]="ALLIANCE_BUILDING",e[e.WORLD_SITE=17]="WORLD_SITE",e[e.ALLIANCE_BOSS=18]="ALLIANCE_BOSS",e[e.THRONE=19]="THRONE",e[e.AIR_DROP=20]="AIR_DROP",e[e.AIR_DROP_TRANSPORT=21]="AIR_DROP_TRANSPORT",e[e.AIR_DROP_INTERCEPT=22]="AIR_DROP_INTERCEPT",e[e.DarkPortal_Donate=23]="DarkPortal_Donate",e[e.CROSS_SEND_SOLDIER=24]="CROSS_SEND_SOLDIER",e[e.BUILD_TOWER=25]="BUILD_TOWER",e[e.ATTACK_TOWER=26]="ATTACK_TOWER",e[e.WORLD_TREASURE_SEARCH=27]="WORLD_TREASURE_SEARCH",e[e.WORLD_TREASURE_FIGHT=28]="WORLD_TREASURE_FIGHT",e[e.MONSTER_ATTACK_CITY=29]="MONSTER_ATTACK_CITY",e[e.AL_MONSTER_DEFENSE=30]="AL_MONSTER_DEFENSE",e[e.MONSTER_ATTACK_TOWER=31]="MONSTER_ATTACK_TOWER",e[e.COUNTRY_BOSS=33]="COUNTRY_BOSS",e[e.PVM_MILITARY=32]="PVM_MILITARY",e[e.GUN_FIGHT=35]="GUN_FIGHT",e[e.ATTACK_TREASURE_MAP_WORLD_BOSS=36]="ATTACK_TREASURE_MAP_WORLD_BOSS",e[e.TO_KVK_ALLIANCE_BUILD=40]="TO_KVK_ALLIANCE_BUILD",e[e.TO_KVK_WORLD_BUILD=41]="TO_KVK_WORLD_BUILD"}(e.MarchType||(e.MarchType={})),function(e){e[e.INIT=0]="INIT",e[e.MARCHING=1]="MARCHING",e[e.ARRIVED=2]="ARRIVED",e[e.RETURNING=3]="RETURNING",e[e.ARRIVED_HOME=4]="ARRIVED_HOME",e[e.GATHERING=5]="GATHERING",e[e.ENCAMPING=6]="ENCAMPING",e[e.RALLY_ASSEMBLING=7]="RALLY_ASSEMBLING",e[e.RALLY_ASSEMBLED=8]="RALLY_ASSEMBLED",e[e.REINFORCING=9]="REINFORCING",e[e.GARRISON=10]="GARRISON",e[e.OCCUPY=11]="OCCUPY"}(e.MarchState||(e.MarchState={}));var t=function(){function e(e){this.UpdateData(e)}return e.prototype.UpdateData=function(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h,this.a=t.a||0,this.owner=t.owner,this.time=t.time,this.buildId=t.buildId,this.s=t.s,this.key=e.getInfoKey(this.x,this.y),this.bh=t.bh,this.bw=t.bw},e.getInfoKey=function(e,t){return 1e4*t+e},e}();e.AllianceTerritoryInfo=t,function(e){e[e.RIGHT=0]="RIGHT",e[e.UP_RIGHT=1]="UP_RIGHT",e[e.UP=2]="UP",e[e.UP_LEFT=3]="UP_LEFT",e[e.LEFT=4]="LEFT",e[e.BOTTOM_LEFT=5]="BOTTOM_LEFT",e[e.BOTTOM=6]="BOTTOM",e[e.BOTTOM_RIGHT=7]="BOTTOM_RIGHT"}(e.WorldMapDirection||(e.WorldMapDirection={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.REMOVED=999]="REMOVED"}(e.WorldMapTileEntityStatus||(e.WorldMapTileEntityStatus={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.DIRTY=1]="DIRTY",e[e.NEED_CLEAN=2]="NEED_CLEAN"}(e.WorldMapTileViewStatus||(e.WorldMapTileViewStatus={}));var a=function(){function e(e,t){this.mainNode=this.createNode(e,t),this.terrainNode=this.createNode("terrain",t,this.mainNode),this.terrainEffectNode=this.createNode("terrainEffec",t,this.mainNode),this.floorNode=this.createNode("floor",t,this.mainNode),this.areaNode=this.createNode("area",t,this.mainNode),this.buffEffectNode=this.createNode("buffEffect",t,this.mainNode),this.unitsNode=this.createNode("unit",t,this.mainNode),this.kingsMarkNode=this.createNode("kingsMark",t,this.mainNode),this.pathNode=this.createNode("path",t,this.mainNode),this.armyNode=this.createNode("army",t,this.mainNode),this.armyHeaderBorderNode=this.createNode("armyHeaderBorder",t,this.mainNode),this.armyHeaderNode=this.createNode("armyHeader",t,this.mainNode),this.labelNode=this.createNode("label",t,this.mainNode),this.bmLabelNode=this.createNode("bmLabel",t,this.mainNode),this.effectsNode=this.createNode("effect",t,this.mainNode),this.uiNode=this.createNode("ui",t,this.mainNode)}return e.prototype.createNode=function(e,t,a){void 0===a&&(a=null);var o=new cc.Node;return o.name=e,o.setContentSize(t),a&&(o.parent=a),o},e}();e.WorldMapLayer=a,function(e){e[e.Spec=0]="Spec",e[e.Grassland=1]="Grassland",e[e.Desert=2]="Desert",e[e.Snowfield=3]="Snowfield"}(e.CrossServerMapTerrains||(e.CrossServerMapTerrains={})),function(e){e[e.Terrain=0]="Terrain",e[e.Area=1]="Area"}(e.CrossServerMapFileTypes||(e.CrossServerMapFileTypes={})),function(e){e[e.Terrain=0]="Terrain",e[e.Addon=1]="Addon",e[e.Area=2]="Area",e[e.Block=3]="Block"}(e.CrossServerMapLayerTypes||(e.CrossServerMapLayerTypes={})),function(e){e[e.None=0]="None",e[e.DrawWaterOutline=1]="DrawWaterOutline",e[e.DrawAreaLine=2]="DrawAreaLine",e[e.DrawThroneTerrain=4]="DrawThroneTerrain",e[e.AutoDynamicAddonElements=8]="AutoDynamicAddonElements"}(e.WorldMapSettings||(e.WorldMapSettings={})),e.checkMapSetting=function(t,a){return void 0===a&&(a=!0),e.currentWorldMapTmxData?!!(e.currentWorldMapTmxData.settings&t):a},e.USE_NEW_WORLDMAP_TMX_DATA=!0,function(e){e[e.TO_NEXT=0]="TO_NEXT",e[e.KEEP_IN_QUEUE=1]="KEEP_IN_QUEUE"}(e.FrameOperationExecuteResult||(e.FrameOperationExecuteResult={})),function(e){e[e.SELF=0]="SELF",e[e.NORMAL=1]="NORMAL",e[e.LOW_PRIORITY=2]="LOW_PRIORITY"}(e.WorldMapFrameOperationQueue||(e.WorldMapFrameOperationQueue={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],WorldMapDisplayPools:[function(e,t,a){"use strict";cc._RF.push(t,"ea965uf+LJPD6vdgb/z9MPP","WorldMapDisplayPools");var o,n=e("../../../fws/utils/X"),i=e("../../../fws/display/FWSNodePool"),r=e("../../../fws/display/factory/FWSAssertCaches"),s=e("../../../fws/mvc/FWSMvc"),l=e("../../../fws/task/FWSTask"),c=e("../../../fws/display/factory/LocalAssertLoader"),d=e("./WorldMapMsgs"),p=e("./WorldMapTerrain"),u=e("../../Module/WorldItem/WIResource"),h=e("../../Module/WorldItem/WICity"),m=e("../../../System/JSWrap"),f=e("../../Tools/GameTools"),_=e("../../../fws/utils/ErrorReport"),y=e("./CrossServerMapData"),g=e("../../battle/components/PrefabPlaceHolder"),C=e("../../Module/WorldItem/WIAsyncPrefab");(function(e){var t;e.displayObjects={prefabWorldCity:"ea_prefab/world/prefabWorldCity",PrefabWmEnemy1:"ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_A1",PrefabWmEnemy2:"ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_S2",PrefabWmEnemy3:"ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_B1",PrefabWmBoss3:"ea_prefab/world/enemy/PrefabWmBoss3",prefabWorldLabel:"ea_prefab/world/prefabWorldLabel",prefabWorldBMLabel:"ea_prefab/world/prefabWorldBMLabel",prefabWorldResource:"ea_prefab/world/prefabWorldResource",PrefabRefugeeCamp:"ea_prefab/world/enemy/PrefabRefugeeCamp",AllianceLine:"ea_prefab/world/allianceLine",WorldAddingItem:"ea_prefab/world/prefabAddingItem",Territory:"ea_prefab/world/Territory",Effect_boss_kongjun_idle:"ea_prefab/world/enemy/PrefabCountryBoss",Effect_hagendasi_boss:"ea_prefab/world/enemy/Effect_hagendasi_boss",Tower:"ea_prefab/world/Tower",towerCover:"ea_prefab/world/towerCover",WorldWaterEffect:"effect/prefab/WorldWaterEffect"};var a=!1,o=!1;e.getInstance=function(){return t||(t=new v),t},e.isLoaded=function(){return a};var v=function(t){function s(){var e=t.call(this)||this;return e.config=[],e.pools={},e.init(),p.worldMapDisplayPools=e,e}return __extends(s,t),s.prototype.init=function(){if(f.default.isInRailgunTime()){for(var t=1;t<=3;t++)this.config.push({key:"ea_prefab/world/enemy/PrefabWmEnemy"+t.toString()+"_RailGun",type:cc.Prefab,count:1});e.displayObjects.PrefabWmEnemy1="ea_prefab/world/enemy/PrefabWmEnemy1_RailGun",e.displayObjects.PrefabWmEnemy2="ea_prefab/world/enemy/PrefabWmEnemy2_RailGun",e.displayObjects.PrefabWmEnemy3="ea_prefab/world/enemy/PrefabWmEnemy3_RailGun"}for(t=1;t<=4;t++)e.displayObjects["PrefabEnemyD_A"+t]="ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_A"+t,e.displayObjects["PrefabEnemyD_B"+t]="ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_B"+t,e.displayObjects["PrefabEnemyD_S"+t]="ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_S"+t,e.displayObjects["PrefabEnemyD_T"+t]="ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_T"+t,this.config.push({key:"ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_A"+t,type:cc.Prefab,count:1,placeHolder:!0,poolHandlerComp:g.default}),this.config.push({key:"ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_B"+t,type:cc.Prefab,count:1,placeHolder:!0,poolHandlerComp:g.default}),this.config.push({key:"ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_S"+t,type:cc.Prefab,count:1,placeHolder:!0,poolHandlerComp:g.default}),this.config.push({key:"ea_prefab/world/enemy/dynamicLoad/PrefabEnemyD_T"+t,type:cc.Prefab,count:1,placeHolder:!0,poolHandlerComp:g.default});this.config.push({key:"ea_prefab/world/enemy/PrefabCountryBoss",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/enemy/PrefabWmBoss3",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/allianceLine",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/Territory",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/prefabAddingItem",type:cc.Prefab,count:1}),this.config.push({key:"effect/prefab/WorldWaterEffect",type:cc.Prefab,count:1}),this.config.push({key:"WORLDMAP_FLOOR",type:cc.Sprite,count:1}),this.config.push({key:"WORLDMAP_UNIT",type:cc.Sprite,count:1}),this.config.push({key:"WORLDMAP_AREA_BORDER",type:cc.Sprite,count:1}),this.config.push({key:"ea_prefab/world/prefabWorldCity",type:cc.Prefab,count:1,poolHandlerComp:h.default}),this.config.push({key:"ea_prefab/world/prefabWorldLabel",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/prefabWorldBMLabel",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/march/prefabWorldMarchLabel",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/march/prefabWorldMarchBattleEffect",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/prefabWorldResource",type:cc.Prefab,count:1,poolHandlerComp:u.default}),this.config.push({key:"ea_prefab/world/enemy/PrefabRefugeeCamp",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/prefabWorldTilePopup",type:cc.Prefab,count:-1}),this.config.push({key:"texture/world_1",type:cc.SpriteAtlas,count:-1}),this.config.push({key:"texture/world_2",type:cc.SpriteAtlas,count:-1}),this.config.push({key:"texture/marchLine",type:cc.SpriteAtlas,count:-1}),this.config.push({key:"font/resFont",type:cc.BitmapFont,count:-1}),this.config.push({key:"WORLDMAP_TILE",type:cc.Sprite,count:1}),this.config.push({key:"ea_prefab/world/enemy/Effect_hagendasi_boss",type:cc.Prefab,count:1}),this.config.push({key:"ea_prefab/world/Tower",type:cc.Prefab,count:1,poolHandlerComp:"WITower"}),this.config.push({key:"ea_prefab/world/towerCover",type:cc.Prefab,count:1}),this.config.push({key:"WORLDMAP_ASYNC_PREFAB_CONTAINER",type:cc.Node,count:1,poolHandlerComp:C.default})},s.prototype.createNode=function(e){if(!e)return null;if(!e.tag)return null;var t=e.tag;switch(t.type){case cc.Prefab:if(t.placeHolder){var a=new cc.Node;return a.addComponent(g.default).prefabPath=t.key,a}var o=r.getPrefab(t.key);if(o)return cc.instantiate(o);break;case cc.Sprite:var i=new cc.Node,s=i.addComponent(cc.Sprite);return s.trim=!1,s.sizeMode=cc.Sprite.SizeMode.RAW,i;case cc.Node:return new cc.Node;default:n.error("\u672a\u652f\u6301\u7684\u5bf9\u8c61\u6c60\u914d\u7f6e",t)}return null},s.prototype.createPools=function(){this.removePools();for(var e=0;e<this.config.length;e++){var t=this.config[e];if(!(t.count<0)){var a=new i.NodePool(this.createNode,t.count,0,null,null,t.poolHandlerComp);a.tag=t,this.pools[t.key]=a}}},s.prototype.removePools=function(){for(var e in this.pools){this.pools[e].putAllNodes()}},s.prototype.getNode=function(e){var t=this.pools[e];return t?t.getNode():null},s.prototype.putNode=function(t,a){var o=a;null!==o&&void 0!==o&&""!==o||(o=t.name),t&&"notusepool"==o&&(t.removeFromParent(),t.destroy(),t=null),t&&0===t.opacity&&(t.opacity=255);var n=e.displayObjects[o],i=this.pools[n];i&&i.putNode(t)},s.prototype.putNodeByKey=function(e,t){e&&0===e.opacity&&(e.opacity=255);var a=this.pools[t];a&&a.putNode(e)},s.prototype.putNodes=function(e){var t=this.pools[e];t&&t.putAllNodes()},s.prototype.onTaskProgress=function(e,t){},s.prototype.onTaskError=function(e,t){_.res(t.toString(),0,t.getDebugInfo()),t.reset(),m.default.setTimeout(function(){t.begin()},1e3)},s.prototype.onTaskComplete=function(e,t){a=!0,o=!1,this.createPools(),n.timeEnd("\u5730\u56fe\u52a0\u8f7d"),d.send(d.Names.WorldMapResourcesOnLoad,null)},s.prototype.preloadWorldMapResources=function(){return!a&&this.doLoadWorldMapResources()},s.prototype.onFMessage_WorldMapResourcesLoad=function(e){if(!a)return this.doLoadWorldMapResources();d.send(d.Names.WorldMapResourcesOnLoad,null)},s.prototype.doLoadWorldMapResources=function(){if(o)return!1;o=!0;var e=new l.TaskList;e.asyncMode=!0,e.onProgress={target:this,handler:this.onTaskProgress},e.onError={target:this,handler:this.onTaskError},e.onCompleted={target:this,handler:this.onTaskComplete};for(var t=0;t<this.config.length;t++){var a=this.config[t];if(a.type!==cc.Sprite&&a.type!==cc.Node&&!a.placeHolder){var i=new c.LocalAssertLoader(a.key,a.type);e.add(i)}}return e.add(new p.WorldMapBinLoader(p.BinDataFlags.Area,"MapArea")),e.add(new p.WorldMapBinLoader(p.BinDataFlags.Throne,"MapThrone")),e.add(new y.CrossServerMapDataLoader("crossserver_cd_20_0722_01.bin")),n.time("\u5730\u56fe\u52a0\u8f7d"),e.begin(),!0},s}(s.FMessageConnectionAbstract);e.WorldMapDisplayPoolsClass=v})(o||(o={})),window.WorldMapDisplayPools=o,t.exports=o,cc._RF.pop()},{"../../../System/JSWrap":"JSWrap","../../../fws/display/FWSNodePool":"FWSNodePool","../../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../../fws/display/factory/LocalAssertLoader":"LocalAssertLoader","../../../fws/mvc/FWSMvc":"FWSMvc","../../../fws/task/FWSTask":"FWSTask","../../../fws/utils/ErrorReport":"ErrorReport","../../../fws/utils/X":"X","../../Module/WorldItem/WIAsyncPrefab":"WIAsyncPrefab","../../Module/WorldItem/WICity":"WICity","../../Module/WorldItem/WIResource":"WIResource","../../Tools/GameTools":"GameTools","../../battle/components/PrefabPlaceHolder":"PrefabPlaceHolder","./CrossServerMapData":"CrossServerMapData","./WorldMapMsgs":"WorldMapMsgs","./WorldMapTerrain":"WorldMapTerrain"}],WorldMapDynamicTerrainModel:[function(e,t,a){"use strict";cc._RF.push(t,"abe65wJp7dM9KVYFhlg+219","WorldMapDynamicTerrainModel");var o,n=e("./WorldMapCommon"),i=e("../../../fws/mvc/FWSMvc"),r=e("./utils/TerrainUtils"),s=!1;(function(e){var t;e.getInstance=function(){return t||(t=new a,window.WMDT=t),t},e.dynamicTerrainEnabled=function(){return s};var a=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){s&&(this.ground=new r.TerrainLayer(n.currentWorldMapTmxData.crood_max_y,n.currentWorldMapTmxData.crood_max_x),this.clear())},t.prototype.clear=function(){s&&this.ground.clear()},t.prototype.setTile=function(e,t,a){void 0===a&&(a=!1),s&&this.ground.setCell(e,t,!a)},t.prototype.getTileName=function(e,t,a){void 0===a&&(a="wm_tile_desert_");var o=null,n=this.ground.getResult(e,t,0,0),i=r.convertoDirectFlags(n);return null!==i&&void 0!==i&&i!==r.TerrainDirectFlags.None&&(o=a+r.TileImageNames[i]),o},t}(i.FMessageConnectionAbstract)})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../../fws/mvc/FWSMvc":"FWSMvc","./WorldMapCommon":"WorldMapCommon","./utils/TerrainUtils":"TerrainUtils"}],WorldMapEvents:[function(e,t,a){"use strict";var o;cc._RF.push(t,"7ac02MA+JNPUpkq1hs9tGkq","WorldMapEvents"),function(e){(function(e){e[e.WorldMapRemoveTileNode=0]="WorldMapRemoveTileNode",e[e.WorldMapUpdateTile=1]="WorldMapUpdateTile",e[e.WorldMapMarchViewUpdate=2]="WorldMapMarchViewUpdate",e[e.WorldMapEffectUpdate=3]="WorldMapEffectUpdate"})(e.Names||(e.Names={}));var t=function(e){function t(t,a){var o=e.call(this,t,!1)||this;return o.data=a,o}return __extends(t,e),t}(cc.Event);e.WorldMapEvent=t;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(cc.EventTarget);function o(){return a._instance||(a._instance=new a),a._instance}e.send=function(a,n){var i=new t(e.Names[a],n);o().dispatchEvent(i)},e.on=function(t,a,n){o().on(e.Names[t],a,n)},e.targetOff=function(e){o().targetOff(e)},e.off=function(t,a,n){o().off(e.Names[t],a,n)}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],WorldMapModel:[function(e,t,a){"use strict";cc._RF.push(t,"be98cOcanlHGIXXECywJKN1","WorldMapModel");var o,n=e("../../../Core/Common/LocalManager"),i=e("./WorldMapCommon"),r=e("../../../fws/utils/FWSTool"),s=e("./WorldMapTerrain"),l=e("../../../Core/Net/NetMgr"),c=e("../../Const/RequestId"),d=e("../../Data/DataCenter"),p=e("./WorldMapMsgs"),u=e("../../Tools/GameTools"),h=e("./controllers/WorldMarchController"),m=e("../../../Core/Common/TableManager"),f=e("../../Data/PlayerInfo"),_=e("../../Const/GameDefine"),y=e("../../Common/UIManager"),g=e("../../../fws/utils/FWS2DUtils"),C=e("../../Tools/PlayerInfoTool"),v=e("../../../fws/utils/X"),I=e("../../Const/GameDefine"),T=e("../../Tools/SubPackMsgs"),S=e("./WorldMapEvents"),A=e("../../Const/TableName"),D=function(){function e(){this.entities={},this.placeFlags=new Map,this.terrains=[],this.terrainFloors=[],this.march={},this.AllianceTerritory={},this.AlliancePointPool={},this.miniMapShow=!0,this.SelfServerId=1,this.Server_Count=4090,this.WorldMapLeftTop=cc.v2(0,0),this.worldMapRightBottom=cc.v2(0,0),this.initMapState=-1,this.dataLoaded=!1,this.ServerMatrix={},this.ServerMatrixArr=[],this._monsterDataCache=null,this.lastUpdateInfo={centerCoord:cc.v2(0,0),serverId:0,width:10,height:20,timestamp:0},this.CurrentWorldId=-1,this._myMarch={},this._myMarchNum=0,this._myMarchNumMAX=1,this.initServerMatrix()}return e.getInstance=function(){return o||(o=new e),window.WMM=o,o},e.prototype.purge=function(){o=null},e.prototype.getWorldPosByCoord=function(e,t,a){t||(t=this.SelfServerId);var o=i.Tile_W/2,n=-i.Tile_H/2,r=o+e.x*i.Tile_W/2+this.ServerMatrix[t.toString()].x*(i.Tile_W*i.currentWorldMapTmxData.crood_max_x/2+i.Server_Offset),s=n-e.y*i.Tile_H/2+this.ServerMatrix[t.toString()].y*(i.Tile_H*i.currentWorldMapTmxData.crood_max_y/2+i.Server_Offset);if(1===a){var l=this.getTileInfoByCoord(e.x,e.y,t);void 0!=l&&4===l.tileArea&&(s+=i.Tile_H/2),void 0!=l&&9===l.tileArea&&(s+=i.Tile_H),void 0!=l&&16===l.tileArea&&(s+=1.5*i.Tile_H),d.DATA.UserData.UsingCastleFace>0&&(void 0===l||null===l)&&(s+=i.Tile_H/2)}return new cc.Vec2(r,s)},e.prototype.getWorldPosByCoord2=function(e,t,a){return this.getWorldPosByCoord2WithNumber(e.x,e.y,t,a)},e.prototype.getWorldPosByCoord2WithNumber=function(e,t,a,o){if(a||(a=this.SelfServerId),-1===a)return null;var n=i.Tile_W/2,r=-i.Tile_H/2,s=n+e*i.Tile_W/2+this.ServerMatrix[a.toString()].x*(i.Tile_W*i.currentWorldMapTmxData.crood_max_x/2+i.Server_Offset),l=r-t*i.Tile_H/2+this.ServerMatrix[a.toString()].y*(i.Tile_H*i.currentWorldMapTmxData.crood_max_y/2+i.Server_Offset);return o?(o.x=s,o.y=l,o):new cc.Vec2(s,l)},e.prototype.getCoordServerId=function(e){for(var t=-1,a=this.ServerMatrixArr,o=this.ServerMatrixArr.length,n=i.currentWorldMapTmxData,r=i.Tile_W,s=i.Tile_H,l=i.Server_Offset,c=i.Server_Offset/2,d=r*n.crood_max_x/2+l,p=s*n.crood_max_y/2+l,u=0;u<o;++u){var h=a[u];if(e.x>=h.x*d-c&&e.x<(h.x+1)*d+c&&e.y<=h.y*p+c&&e.y>(h.y-1)*p-c){t=h.k;break}}if(-1===t)for(u=0;u<o;++u){h=a[u];if(e.x>=h.x*d-c-2*r&&e.x<(h.x+1)*d+c+2*r&&e.y<=h.y*p+c+2*s&&e.y>(h.y-1)*p-c-2*s){t=h.k;break}}return t},e.prototype.getCoordByWorldPos=function(e,t){var a=this.ServerMatrix,o=i.currentWorldMapTmxData,n=i.Tile_W,r=i.Tile_H,s=o.crood_max_x/2,l=o.crood_max_y/2,c=i.Server_Offset,d=this.getCoordServerId(e),p=0,u=e.x,h=e.y;-1!==d&&(u-=a[d].x*(n*s+c),h-=a[d].y*(r*l+c));var m,f=2*Math.floor(u/n),_=2*Math.floor(-h/r),y=u-f*n/2,g=-h-_*r/2;y<n/2?g<(m=r/n*(n/2-y))?(f-=1,_-=1):g>r-m&&(f-=1,_+=1):g<(m=r/n*(y-n/2))?(f+=1,_-=1):g>r-m&&(f+=1,_+=1);return(f<0||f>o.crood_max_x-1||_<0||_>o.crood_max_y-1)&&(p=1),-1==d&&(p=-1),t?(t.serverId=d,t.x=f,t.y=_,t.flag=p,t):{serverId:d,x:f,y:_,flag:p}},e.prototype.initServerMatrix=function(){this.SelfServerId=d.DATA.UserData.ServerId,this.ServerMatrix={},this.ServerMatrixArr=[];var e=cc.v2(0,0),t=cc.v2(0,0);if(this.ServerMatrix[this.SelfServerId.toString()]={x:0,y:0,k:this.SelfServerId},I.currentWorldMapCrossServerModel&&I.currentWorldMapCrossServerModel.serverMartixs)for(var a=0;a<I.currentWorldMapCrossServerModel.serverMartixs.length;a++){var o=I.currentWorldMapCrossServerModel.serverMartixs[a];this.ServerMatrix[o.k+""]=o}for(var n in this.ServerMatrix)this.ServerMatrix[n].x<=e.x&&this.ServerMatrix[n].y>=e.y&&(e=cc.v2(this.ServerMatrix[n].x,this.ServerMatrix[n].y)),this.ServerMatrix[n].x>=t.x&&this.ServerMatrix[n].y<=t.y&&(t=cc.v2(this.ServerMatrix[n].x,this.ServerMatrix[n].y)),this.ServerMatrixArr.push(this.ServerMatrix[n]);this.WorldMapLeftTop.x=e.x*(i.Tile_W*i.currentWorldMapTmxData.crood_max_x/2+i.Server_Offset),this.WorldMapLeftTop.y=e.y*(i.Tile_H*i.currentWorldMapTmxData.crood_max_y/2+i.Server_Offset),this.worldMapRightBottom.x=(t.x+1)*(i.Tile_W*i.currentWorldMapTmxData.crood_max_x/2+i.Server_Offset)-i.Server_Offset,this.worldMapRightBottom.y=(t.y-1)*(i.Tile_H*i.currentWorldMapTmxData.crood_max_y/2+i.Server_Offset)+i.Server_Offset},e.prototype.getHostTileAll=function(e,t,a){if(a||(a=this.SelfServerId),null!=this.entities[this.getTileIdByCoord(e,t,a).toString()])return{x:e,y:t,serverId:a};for(var o=2;o<5;o++){for(var n=[],i=0;i<o;i++)for(var r=e+i,s=t+i,l=0;l<o;l++){var c={x:r-l,y:s+l};n.push(c)}for(var d=0;d<n.length;d++){var p=this.entities[this.getTileIdByCoord(n[d].x,n[d].y,a).toString()];if(void 0!=p&&p.tileArea==o*o)return{x:n[d].x,y:n[d].y,serverId:a}}}return null},e.prototype.getHostTile=function(e,t,a){a||(a=this.SelfServerId);for(var o=[{x:e-1,y:t+1},{x:e+1,y:t+1},{x:e,y:t},{x:e,y:t+2}],n=0;n<o.length;n++){var i=this.entities[this.getTileIdByCoord(o[n].x,o[n].y,a).toString()];if(void 0!=i&&4==i.tileArea)return{x:o[n].x,y:o[n].y,serverId:a}}return null},e.prototype.get9AreaTile=function(e,t,a){a||(a=this.SelfServerId);for(var o=[{x:e,y:t},{x:e-1,y:t+1},{x:e+1,y:t+1},{x:e-2,y:t+2},{x:e,y:t+2},{x:e+2,y:t+2},{x:e-1,y:t+3},{x:e+1,y:t+3},{x:e,y:t+4}],n=0;n<o.length;n++){var i=this.entities[this.getTileIdByCoord(o[n].x,o[n].y,a).toString()];if(void 0!=i&&9==i.tileArea)return{x:o[n].x,y:o[n].y,serverId:a}}return null},e.prototype.getTileIdByCoord=function(e,t,a){return a||(a=this.SelfServerId),(a-1)*i.currentWorldMapTmxData.crood_max_x*i.currentWorldMapTmxData.crood_max_y+e*i.currentWorldMapTmxData.crood_max_y+t},e.prototype.getTileInfoByCoord=function(e,t,a){return a||(a=this.SelfServerId),this.entities[this.getTileIdByCoord(e,t,a)]},e.prototype.getTileInfoById=function(e){return this.entities[e]},e.prototype.getAreaIdByCoord=function(e,t){return i.currentWorldMapTmxData.getArea(e,t)},e.prototype.getCityInfoByTileId=function(e){var t=this.entities[e];if(void 0==t||1!==t.type)return null;var a=u.default.JSON_PARSE(t.extData.playerInfo),o="";this.SelfServerId==t.serverId&&d.DATA.UserData.WorldCoord.x==t.tileX&&d.DATA.UserData.WorldCoord.y==t.tileY?o=n.LOCAL.getText("100475"):(o=u.default.getPlayerDisplayName(a,n.LOCAL.getText("100476")),void 0!==t.extData.a_tag&&(r.Str.isEmpty(this.entities[e].extData.a_tag)||(o="["+this.entities[e].extData.a_tag+"]"+o)));var i=0,s=-1;return null!==t.extData.fireTime&&void 0!==t.extData.fireTime&&(s=t.extData.fireTime),null!==t.extData.fireState&&void 0!==t.extData.fireState&&(i=t.extData.fireState),{entityid:t.id,pid:t.extData.pid,x:t.tileX,y:t.tileY,serverId:t.serverId,name:o,Avatarurl:C.getAvatarUrlFromTPlayerInfo(a),nationalflag:a&&a.nationalflag?a.nationalflag:0,gender:C.getGenderFromTPlayerInfo(a),level:t.extData.level,power:t.extData.power,proviceId:t.extData.province,aid:t.extData.aid||0,a_tag:t.extData.a_tag||"",a_name:t.extData.a_name||"",countryRank:r.Obj.getPropertyNumberByNames(t,null,"extData","countryRank"),shieldTime:t.extData.shieldTime,fireState:i,fireTime:s,skinId:t.extData.skinId,sskin:t.extData.sskin,sBId:t.extData.sBId,sBNum:t.extData.sBNum,castleEffectId:t.extData.castleEffectId,tCastleEffectId:t.extData.tCastleEffectId,nameplateId:t.extData.plateId||0,resource:null,energy:null,title:t.extData.title||0,language:t.extData.language||""}},e.prototype.getAllianceBuildInfoByTileId=function(e){var t=this.entities[e];if(null!=t.extData.bid){var a=m.TABLE.getTableDataById(A.TableName.KVK_BUILDING,t.extData.bid.toString());if(a)return{entityid:t.id,x:t.tileX,y:t.tileY,serverId:t.serverId,name:n.LOCAL.getText(a.name),Avatarurl:"image/EightCountry/"+a.building_image}}return null},e.prototype.getMonsterDataByGroupAndLevel=function(e,t){if(!this._monsterDataCache){var a=m.TABLE.getTableGroup(A.TableName.MONSTER);for(var o in this._monsterDataCache={},a){var n=a[o];0;var i=1e3*n.group_id+n.level;this._monsterDataCache[i]=n}}var r=1e3*e+t;return this._monsterDataCache[r]},e.prototype.getEnemyInfoByTileId=function(e){var t,a,o=this.entities[e];if(void 0===o||null===o||o.type!==i.WorldMapEntityType.Monster&&o.type!==i.WorldMapEntityType.SELF_MONSTER&&o.type!==i.WorldMapEntityType.MILITARY_SELF_RALLY_MONSTER&&o.type!==i.WorldMapEntityType.RALLY_BOSS&&o.type!==i.WorldMapEntityType.ACTIVITY_BOSS&&o.type!==i.WorldMapEntityType.ALLIANCE_BOSS&&o.type!==i.WorldMapEntityType.RefugeeCamp&&o.type!==i.WorldMapEntityType.ItemGetMonster&&o.type!==i.WorldMapEntityType.WorldTreasure&&o.type!==i.WorldMapEntityType.CountryBoss)return null;if(null!=o.extData.itemId){var n=0;if((n=2!==o.type||u.default.isKVK()?o.extData.level:o.extData.level+d.DATA.UserData.Level)<1&&(n=1),a=m.TABLE.getTableDataById(A.TableName.MONSTER_GROUP,o.extData.itemId.toString()),null!=(t=this.getMonsterDataByGroupAndLevel(o.extData.itemId,n))&&null!=a){var r=m.TABLE.getTableDataById(A.TableName.PVE_MONSTER,t.monster_level.toString()),s=0;if(r&&r.enemy_config)for(var l=r.enemy_config.split(","),c=0;c<l.length;c++){var p=m.TABLE.getTableDataById(A.TableName.ARMY,l[c]);p&&p.power?s+=p.power:s+=20*t.level}return{entityid:o.id,mid:o.extData.mid,x:o.tileX,y:o.tileY,groupId:o.extData.itemId,serverId:o.serverId,name:a.name,desc:a.desc,model:a.model,icon:a.icon,power:s,monsterLevel:t.monster_level,costEnegy:a.cost_energy,supperAssemblyCostEnegy:a.super_assembly_cost?a.super_assembly_cost:0,level:t.level,expireTime:o.extData.expireTime,rewards:a.drop_client}}}return null},e.prototype.getEnemyExpireTimeByTileId=function(e){var t=this.entities[e];return void 0===t||null===t||t.type!==i.WorldMapEntityType.Monster&&t.type!==i.WorldMapEntityType.SELF_MONSTER&&t.type!==i.WorldMapEntityType.MILITARY_SELF_RALLY_MONSTER&&t.type!==i.WorldMapEntityType.RALLY_BOSS&&t.type!==i.WorldMapEntityType.ACTIVITY_BOSS&&t.type!==i.WorldMapEntityType.ALLIANCE_BOSS&&t.type!==i.WorldMapEntityType.RefugeeCamp&&t.type!==i.WorldMapEntityType.ItemGetMonster&&t.type!==i.WorldMapEntityType.WorldTreasure&&t.type!==i.WorldMapEntityType.CountryBoss?null:null!=t.extData.itemId?t.extData.expireTime:-1},e.prototype.getThroneInfoByTileId=function(e){var t=this.entities[e];if(null!=t.extData.itemId){var a=m.TABLE.getTableDataById(A.TableName.THRONE,t.extData.itemId.toString());if(a)return{entityid:t.id,pid:t.extData.pid,x:t.tileX,y:t.tileY,serverId:t.serverId,name:n.LOCAL.getText(a.name),Avatarurl:"",gender:1,level:t.extData.level,power:t.extData.power,proviceId:t.extData.province,aid:t.extData.aid||0,a_tag:t.extData.a_tag||"",a_name:t.extData.a_name||"",countryRank:r.Obj.getPropertyNumberByNames(t,null,"extData","countryRank"),shieldTime:t.extData.shieldTime,fireState:0,fireTime:-1,skinId:0,sskin:0,nameplateId:0,resource:null,energy:null}}return null},e.prototype.getMapEntityTypeByRileId=function(e){var t=this.entities[e];return r.Obj.isEmpty(t)?i.WorldMapEntityType.Blank:t.type},e.prototype.getResourceInfoByTileId=function(e){var t=this.entities[e];if(void 0==t||t.type!==i.WorldMapEntityType.Resource&&t.type!==i.WorldMapEntityType.MILITARY_RESOURCE)return null;if(null!=t.extData.itemId){var a=m.TABLE.getTableDataById(A.TableName.RESOURCE,t.extData.itemId.toString()),o=!1;if(a){var n=a.gather_speed;if(1===a.resource_type){var r=m.TABLE.getTableDataById(A.TableName.PLAYER_LEVEL,d.DATA.UserData.Level.toString());for(var s in r&&(n=r.gather_coin_speed),this.march){var l=this.march[s];if(l&&(l.target_tx===t.tileX&&l.target_ty===t.tileY&&l.marchType===i.MarchType.GATHER_RESOURCE&&l.marchState===i.MarchState.GATHERING)){n=Math.floor(l.gatherSpeed),o=!0;break}}}return[1,5,7].indexOf(a.resource_type)>=0&&0==o&&(n=Math.floor(d.DATA.UserData.Buff.getValueWithBuff(n,_.BuffType.WorldGatherSpeed,!0,"Resource",a.resource_type))),{rid:t.extData.itemId,x:t.tileX,y:t.tileY,serverId:t.serverId,ownerId:t.extData.ownerId,name:a.name,desc:a.desc,model:a.model,offSet:new cc.Vec2(Number(a.x_para),Number(a.y_para)),type:a.resource_type,gatherSpeed:n,level:a.level,rewards:String(a.reward),marchId:t.extData.marchId,build_prefab:a.build_prefab,iconSrc:a.iconSrc,iconType:Number(a.iconType),scale_para:a.scale_para,x_para:a.x_para,y_para:a.y_para,storage:a.storage,load_factor:a.load_factor,gather_time:a.gather_time,amount:t.extData.amount}}}return null},e.prototype.getPointInfoTileId=function(e){var t=e.k,a=e.x,o=e.y;return this.getTileIdByCoord(a,o,t).toString()},e.prototype.deleteTileInfo=function(e){var t=this.entities[e];t&&(t.status=i.WorldMapTileEntityStatus.REMOVED,delete this.entities[e],S.send(S.Names.WorldMapRemoveTileNode,t))},e.prototype.updateTileInfo=function(e,t){void 0===t&&(t=!1);var a=e.k,o=e.x,n=e.y,r=e.pointType,s={},l=this.getTileIdByCoord(o,n,a),c=l.toString(),p=this.entities[c],h=1;if(p&&p.type===r&&(new Date).getTime()-p.refreshCDTime<1e4&&!t)p.refreshCDTime=(new Date).getTime();else{switch(r){case i.WorldMapEntityType.Blank:return void this.deleteTileInfo(c);case i.WorldMapEntityType.City:(s=e.p).skinId>0&&(h=4);break;case i.WorldMapEntityType.Monster:s=e.m;break;case i.WorldMapEntityType.CountryBoss:s=e.m,h=4;break;case i.WorldMapEntityType.Resource:s=e.r;break;case i.WorldMapEntityType.Throne:if(s=e.t,!d.DATA.UserData.FunctionOn(_.FunctionKey.world_throne))return;var f=s.itemId,y=m.TABLE.getTableDataById(A.TableName.THRONE,f.toString());y&&(h=Number(y.width)*Number(y.width));break;case i.WorldMapEntityType.Territory:if(s=e.b,h=4,void 0==e.b)return;break;case i.WorldMapEntityType.KVK_ALLIANCE_FLAG:if(s=e.b,h=1,void 0==e.b)return;break;case i.WorldMapEntityType.KVK_ALLIANCE_FORTRESS:case i.WorldMapEntityType.KVK_EXPEDITION_FORTRESS:case i.WorldMapEntityType.KVK_EXPEDITION_OUTPOST:case i.WorldMapEntityType.KVK_MILITARY_BASE:case i.WorldMapEntityType.KVK_MILITARY_FORTRESS:case i.WorldMapEntityType.KVK_RESEARCH_INSTITUTE:case i.WorldMapEntityType.KVK_DOOR:case i.WorldMapEntityType.KVK_ETERNAL_CITY:if(s=e.b,h=4,void 0==e.b)return;break;case i.WorldMapEntityType.Boss:if(s=e.wb,!d.DATA.UserData.FunctionOn(_.FunctionKey.world_boss))return;if(h=4,void 0==e.wb||void 0==e.wb.bossId)return;break;case i.WorldMapEntityType.RALLY_BOSS:case i.WorldMapEntityType.ACTIVITY_BOSS:case i.WorldMapEntityType.ALLIANCE_BOSS:s=e.m;break;case i.WorldMapEntityType.TREASURE_MAP_WORLD_BOSS:if(e.tmwb){(s=e.tmwb).bossId=-1;var g=u.default.getDataConfigData(48301).split("|"),C=g[s.quality];if(void 0!=s.quality&&g.length>0&&C){var v=m.TABLE.getTableDataById(A.TableName.MONSTER,C);v&&(s.bossId=v.group_id,s.monsterId=C)}}h=4;break;case i.WorldMapEntityType.WorldSite:s=e.id,h=4;break;case i.WorldMapEntityType.WorldTreasure:if((s=e.m)&&s.itemId){var I=m.TABLE.getTableDataById(A.TableName.MONSTER_GROUP,s.itemId);I&&2==I.model_size&&(h=4)}break;case i.WorldMapEntityType.DarkPortal:s=e.ctp_status,h=16;break;case i.WorldMapEntityType.AirDrop:s=e.ad,h=4;break;case i.WorldMapEntityType.RefugeeCamp:(s=e.m).itemId=s.bossId;break;case i.WorldMapEntityType.MILITARY_SELF_RALLY_MONSTER:case i.WorldMapEntityType.SELF_MONSTER:(s=e.m).itemId=s.bossId;break;case i.WorldMapEntityType.MILITARY_RESOURCE:s=e.r;break;case i.WorldMapEntityType.ItemGetMonster:(s=e.m).itemId=s.bossId;break;case i.WorldMapEntityType.ResourceTower:case i.WorldMapEntityType.BuffTower:s=e.b;break;case i.WorldMapEntityType.DefenderMonster:case i.WorldMapEntityType.ALDefenderMonster:s=e.m}var T,S=this.getWorldPosByCoord(cc.v2(o,n),a);4===h&&(S.y+=i.Tile_H/2),9===h&&(S.y+=i.Tile_H),16===h&&(S.y+=1.5*i.Tile_H);var D=Date.now();p?(T=p,p.type=r,p.tileX=o,p.tileY=n,p.tileArea=h,p.serverId=a,p.extData=s,p.screenX=S.x,p.screenY=S.y,p.stampTime=p.refreshCDTime=D,p.pointId=e.id,p.status=i.WorldMapTileEntityStatus.NORMAL):T=this.entities[c]={id:l,idString:c,type:r,tileX:o,tileY:n,tileArea:h,serverId:a,extData:s,screenX:S.x,screenY:S.y,stampTime:D,refreshCDTime:D,pointId:e.id,status:i.WorldMapTileEntityStatus.NORMAL},this.setPlaceFlag(T.tileX,T.tileY,a,T.type,h)}},e.prototype.setPlaceFlag=function(e,t,a,o,n,r){void 0===r&&(r=!0);var s=this.getTileIdByCoord(e,t,a);if(o==i.WorldMapEntityType.KVK_DOOR){var l=this.placeFlags.get(s);if(l&&l==o)return}if(this.placeFlags.set(s,o),o==i.WorldMapEntityType.KVK_DOOR)for(var c=-6;c<6;c++)for(var d=-5;d<4;d++){var p=this.getTileIdByCoord(e+c,t+d,a);this.placeFlags.set(p,o)}else if(r)switch(n){case 4:this.setPlaceFlag(e-1,t-1,a,o,n,!1),this.setPlaceFlag(e+1,t-1,a,o,n,!1),this.setPlaceFlag(e,t-2,a,o,n,!1)}},e.prototype.clearExpiredTileInfo=function(e){var t=this.entities[e];if(t)if(t.refreshCDTime+6e3<(new Date).getTime())this.deleteTileInfo(e);else if(2===t.type){var a=this.getEnemyExpireTimeByTileId(t.id);a>=0&&a<d.DATA.ServerTime&&this.deleteTileInfo(e)}},e.prototype.checkTileAvailable=function(e,t,a,o){a||(a=this.SelfServerId),void 0!==o&&null!==o||(o=1);var n=[{x:e,y:t}];4==o?n=[{x:e-1,y:t-1},{x:e+1,y:t-1},{x:e,y:t},{x:e,y:t-2}]:9==o&&(n=[{x:e,y:t},{x:e-1,y:t+1},{x:e+1,y:t+1},{x:e-2,y:t+2},{x:e,y:t+2},{x:e+2,y:t+2},{x:e-1,y:t+3},{x:e+1,y:t+3},{x:e,y:t+4}]);for(var i=0;i<n.length;i++){if(void 0!=this.getHostTile(n[i].x,n[i].y,a))return!1}return!!this.checkTileArea(e,t,a)},e.prototype.checkTileArea=function(e,t,a){if(i.currentWorldMapTmxData!=i.worldMapTmxData)return!0;var o=this.getAreaIdByCoord(e,t);return!(o>0&&I.currentWorldMapCrossServerModel&&I.currentWorldMapCrossServerModel.gatewayAreas.indexOf(o)>=0)},e.prototype.checkTileUsed=function(e,t){var a=this.getTileIdByCoord(e,t,this.SelfServerId);return!!this.placeFlags.get(a)},e.prototype.checkTileBlockUsed=function(e,t){return!!this.checkTileUsed(e-1,t-1)||(!!this.checkTileUsed(e+1,t-1)||!!this.checkTileUsed(e,t-2))},e.prototype.checkIsPlainTile=function(e,t,a){if(void 0===a&&(a=!1),i.currentWorldMapTmxData.isBlock(e,t,0))return!1;var o=this.getTileInfoByCoord(e,t);if(o&&(!a||o.tileX!==d.DATA.UserData.WorldCoord.x||o.tileY!==d.DATA.UserData.WorldCoord.y))return!1;for(var n=[{x:e-1,y:t+1},{x:e+1,y:t+1},{x:e,y:t+2}],r=0;r<n.length;r++){var l=this.getTileInfoByCoord(n[r].x,n[r].y);if(l&&4===l.tileArea&&(l.type===i.WorldMapEntityType.City||l.type==i.WorldMapEntityType.Throne||l.type==i.WorldMapEntityType.WorldSite||l.type==i.WorldMapEntityType.Boss)){if(a&&l.tileX===d.DATA.UserData.WorldCoord.x&&l.tileY===d.DATA.UserData.WorldCoord.y)continue;return!1}}var c=this.getCoordByWorldPos(new cc.Vec2(e,t));if(s.verifyThroneDataPos(c)){var p=s.getThroneDataIndex(e,t);if(s.ThroneTerrain1[p])return!1}return!0},e.prototype.checkIsPlainTile4=function(e,t,a){return this.checkIsPlainTile(e,t,a)&&this.checkIsPlainTile(e,t-2,a)&&this.checkIsPlainTile(e-1,t-1,a)&&this.checkIsPlainTile(e+1,t-1,a)},e.prototype.CheckIsAreaBorder=function(e){return this.CheckIsAreaBorderWithXY(e.x,e.y)},e.prototype.CheckIsAreaBorderWithXY=function(e,t){return!(e<1||t<1||e>i.currentWorldMapTmxData.crood_max_x-3||t>i.currentWorldMapTmxData.crood_max_y-3)&&(e%(i.currentWorldMapTmxData.crood_max_x/8)==0||t%(i.currentWorldMapTmxData.crood_max_y/8)==0)},e.prototype.updateWorldMapData=function(e,t,a,o,n){var i=this;this.CurrentWorldId!=t&&(this.CurrentWorldId=t,u.default.getWorldSitesData(this.CurrentWorldId)),Math.abs(e.x-this.lastUpdateInfo.centerCoord.x)<5&&Math.abs(e.y-this.lastUpdateInfo.centerCoord.y)<9&&a<=1.5*this.lastUpdateInfo.width&&o<=1.5*this.lastUpdateInfo.height&&(new Date).getTime()<this.lastUpdateInfo.timestamp+1500||!n&&(new Date).getTime()<this.lastUpdateInfo.timestamp+800||(this.lastUpdateInfo.serverId!=t&&u.default.getWorldSitesData(t),this.lastUpdateInfo={centerCoord:cc.v2(e.x,e.y),serverId:t,width:a,height:o,timestamp:(new Date).getTime()},l.NET.send(c.RequestId.GET_WORLD_INFO,{x:e.x,y:e.y,k:t,width:Math.floor(1.5*a),height:Math.floor(1.5*o),marchInfo:!0},this,function(n){if(null!=n.d&&""!=n.d&&3!=n.s){var r=u.default.JSON_PARSE(n.d);if(null!=r){if(void 0!=r.pointList)for(var s=0;s<r.pointList.length;s++){var d=r.pointList[s];i.updateTileInfo(d)}if(void 0!=r.marchList)v.log("\u6d4b\u8bd5\u4ee3\u7801\uff0c \u603b\u5171\u6574\u4e86%d\u6761\u884c\u519b\u6570\u636e",r.marchList.length),i.addMonsterDefenderMarchData(),r.marchList.forEach(function(e){var t={marchInfo:e};i.worldMarchDataHandler(t)});for(var h in i.entities){void 0!=i.entities[h]&&i.clearExpiredTileInfo(h)}1===i.initMapState&&(i.initMapState=2),i.dataLoaded=!0,p.send(p.Names.WorldMapDataOnLoad,null),p.send(p.Names.WorldMapUpdateViewPort,null),v.log("(DynamicElement) updateWorldMapData"),l.NET.send(c.RequestId.GET_TERRITORY_INFO,{x:e.x,y:e.y,k:t,width:Math.floor(1.5*a),height:Math.floor(1.5*o)},i,function(e){if(null!=e.d&&""!=e.d&&3!=e.s){var t=u.default.JSON_PARSE(e.d);null!=t&&i.UpdateAllianceTerritory(t.infos,!1)}})}}}))},e.prototype.addMonsterDefenderMarchData=function(){var e=this,t=[],a=T.send(T.Names.SUBPACK_CALL_ACTIVITY_CONTROLL_getActivityByActivityId,153).data,o=T.send(T.Names.SUBPACK_CALL_ACTIVITY_CONTROLL_getActivityByActivityId,130).data;if(o&&o.userMonsterSiege&&!o.userMonsterSiege.isEnd){var n=u.default.getWorldPosByServerPointId(o.userMonsterSiege.pointId);this.march.hasOwnProperty("0")?2147483647==o.userMonsterSiege.nextTime&&t.push({aid:0,begin:{bx:n.x,by:n.y,bk:d.DATA.UserData.ServerId},marchArrive:Number(d.DATA.ServerTime),marchIcon:0,marchId:"0",marchStartTime:d.DATA.ServerTime,marchType:i.MarchType.MONSTER_ATTACK_CITY,name:"",returnArriveTime:d.DATA.ServerTime,returnStartTime:d.DATA.ServerTime,state:i.MarchState.ARRIVED_HOME,target:{itemId:0,targetType:1,tk:d.DATA.UserData.ServerId,tx:d.DATA.UserData.WorldCoord.x,ty:d.DATA.UserData.WorldCoord.y},uid:0}):t.push({aid:0,armyLoad:0,armySkin:"",begin:{bx:n.x,by:n.y,bk:d.DATA.UserData.ServerId},gatherStartTime:0,gatherspeed:"0.0",marchArrive:Number(d.DATA.ServerTime)+674767459,marchIcon:0,marchId:"0",marchSkin:0,marchStartTime:d.DATA.ServerTime,marchType:i.MarchType.MONSTER_ATTACK_CITY,name:"",returnArriveTime:0,returnStartTime:0,state:i.MarchState.MARCHING,target:{itemId:0,targetType:1,tk:d.DATA.UserData.ServerId,tx:d.DATA.UserData.WorldCoord.x,ty:d.DATA.UserData.WorldCoord.y},uid:0})}else if(this.march.hasOwnProperty("0")&&o&&o.userMonsterSiege&&o.userMonsterSiege.pointId){n=u.default.getWorldPosByServerPointId(o.userMonsterSiege.pointId);t.push({aid:0,begin:{bx:n.x,by:n.y,bk:d.DATA.UserData.ServerId},marchArrive:Number(d.DATA.ServerTime),marchIcon:0,marchId:"0",marchStartTime:d.DATA.ServerTime,marchType:i.MarchType.MONSTER_ATTACK_CITY,name:"",returnArriveTime:d.DATA.ServerTime,returnStartTime:d.DATA.ServerTime,state:i.MarchState.ARRIVED_HOME,target:{itemId:0,targetType:1,tk:d.DATA.UserData.ServerId,tx:d.DATA.UserData.WorldCoord.x,ty:d.DATA.UserData.WorldCoord.y},uid:0})}if(a&&a.alMonsterSiege&&!a.alMonsterSiege.isEnd){if(!a.alMonsterSiege.pointId||!a.alMonsterSiege.targetId)return;n=u.default.getWorldPosByServerPointId(a.alMonsterSiege.pointId);var r=u.default.getWorldPosByServerPointId(a.alMonsterSiege.targetId);this.march.hasOwnProperty("1")?2147483647==a.alMonsterSiege.nextTime&&t.push({aid:0,begin:{bx:n.x,by:n.y,bk:d.DATA.UserData.ServerId},marchArrive:Number(d.DATA.ServerTime),marchIcon:0,marchId:"1",marchStartTime:d.DATA.ServerTime,marchType:i.MarchType.MONSTER_ATTACK_TOWER,name:"",returnArriveTime:d.DATA.ServerTime,returnStartTime:d.DATA.ServerTime,state:i.MarchState.ARRIVED_HOME,target:{itemId:0,targetType:13,tk:d.DATA.UserData.ServerId,tx:r.x,ty:r.y},uid:0}):t.push({aid:0,armyLoad:0,armySkin:"",begin:{bx:n.x,by:n.y,bk:d.DATA.UserData.ServerId},gatherStartTime:0,gatherspeed:"0.0",marchArrive:Number(d.DATA.ServerTime)+674767459,marchIcon:0,marchId:"1",marchSkin:0,marchStartTime:d.DATA.ServerTime,marchType:i.MarchType.MONSTER_ATTACK_TOWER,name:"",returnArriveTime:0,returnStartTime:0,state:i.MarchState.MARCHING,target:{itemId:0,targetType:1,tk:d.DATA.UserData.ServerId,tx:r.x,ty:r.y},uid:0})}else if(this.march.hasOwnProperty("1")&&a&&a.alMonsterSiege){n=u.default.getWorldPosByServerPointId(a.alMonsterSiege.pointId),r=u.default.getWorldPosByServerPointId(a.alMonsterSiege.targetId);t.push({aid:0,begin:{bx:n.x,by:n.y,bk:d.DATA.UserData.ServerId},marchArrive:Number(d.DATA.ServerTime),marchIcon:0,marchId:"1",marchStartTime:d.DATA.ServerTime,marchType:i.MarchType.MONSTER_ATTACK_TOWER,name:"",returnArriveTime:d.DATA.ServerTime,returnStartTime:d.DATA.ServerTime,state:i.MarchState.ARRIVED_HOME,target:{itemId:0,targetType:13,tk:d.DATA.UserData.ServerId,tx:r.x,ty:r.y},uid:0})}t.forEach(function(t){var a={marchInfo:t};e.worldMarchDataHandler(a)})},e.prototype.UpdateTerritoryPointPool=function(){var e=this.AllianceTerritory,t=new Array;for(var a in e){null!=e[a]&&t.push(e[a])}t.sort(this.compareByCreateTime),this.AlliancePointPool={};for(var o=0;o<t.length;o++)this.UpdateAlliancePoint(t[o])},e.prototype.compareByCreateTime=function(e,t){return e.time>t.time?-1:e.time<t.time?1:0},e.prototype.UpdateAlliancePoint=function(e){var t=e.w,a=e.bw,o=e.y+a-a/2,n=e.x-a+a/2;n=n-e.w+a,a%2==1&&(n=e.x-e.w+1,o=e.y);for(var r=0;r<t;r++)for(var s=n+r,l=o+r,c=0;c<t;c++)this.AlliancePointPool[i.AllianceTerritoryInfo.getInfoKey(s+c,l-c)]=e},e.prototype.getAllianceDataByPoint=function(e,t){var a=null,o=i.AllianceTerritoryInfo.getInfoKey(e,t),n=this.AlliancePointPool[o];return void 0!=n&&(a=n),a},e.prototype.checkMarchIsInView=function(e){var t=new cc.Vec2(e.screenStartX,e.screenStartY),a=new cc.Vec2(e.screenEndX,e.screenEndY),o=this.getWorldPosByCoord(this.lastUpdateInfo.centerCoord),n=new cc.Rect(o.x-this.lastUpdateInfo.width*i.Tile_W/2,o.y-this.lastUpdateInfo.height*i.Tile_H/2,this.lastUpdateInfo.width*i.Tile_W,this.lastUpdateInfo.height*i.Tile_H);return n.width<100||n.height<100||n.x<100||n.y<-i.Tile_H*i.currentWorldMapTmxData.crood_max_y/2-100||g.checkLineAndRectIntersect(t,a,n)},e.prototype.checkCoordIsInView=function(e,t,a){void 0===t&&(t=300),void 0===a&&(a=!0);var o=this.getWorldPosByCoord(e),n=this.getWorldPosByCoord(this.lastUpdateInfo.centerCoord),r=new cc.Rect(n.x-this.lastUpdateInfo.width*i.Tile_W/2,n.y-this.lastUpdateInfo.height*i.Tile_H/2,this.lastUpdateInfo.width*i.Tile_W,this.lastUpdateInfo.height*i.Tile_H);return!(!a||!(r.width<100||r.height<100||r.x<100||r.y<-i.Tile_H*i.currentWorldMapTmxData.crood_max_y/2-100))||!(o.x<r.x-t||o.x>r.x+r.width+t||o.y<r.y-t||o.y>r.y+r.height+t)},e.prototype.worldMarchDataHandler=function(e){if(null!=e){var t=e.marchInfo;if(!r.Obj.isEmpty(t)&&!(r.Obj.isEmpty(t.begin)||r.Obj.isEmpty(t.target)||r.Obj.isEmpty(t.begin.bk)||r.Obj.isEmpty(t.target.tk))){var a=t.begin.bk,o=t.target.tk,s=this.getWorldPosByCoord(cc.v2(t.begin.bx,t.begin.by),a,1),l=this.getWorldPosByCoord(cc.v2(t.target.tx,t.target.ty),o,1),c=s.x,p=s.y,m=l.x,_=l.y,g=t.marchStartTime,C=t.marchArrive+i.MARCH_ENDTIME_DELAY,v=new f.default,I=r.Obj.getProperty(t,"playerInfo","");I.length>0&&v.update(I),t.state===i.MarchState.RETURNING&&(c=l.x,p=l.y,m=s.x,_=s.y,g=t.returnStartTime<t.marchArrive?t.returnStartTime-(t.marchArrive-t.returnStartTime):t.returnStartTime,C=t.returnArriveTime+i.MARCH_ENDTIME_DELAY);var T=t.marchId.toString(),A={marchId:T,marchType:t.marchType,marchState:t.state,marchStartTime:t.marchStartTime,marchArrive:t.marchArrive,returnStartTime:t.returnStartTime,returnArriveTime:t.returnArriveTime,begin_bx:t.begin.bx,begin_by:t.begin.by,begin_bk:t.begin.bk,target_tx:t.target.tx,target_ty:t.target.ty,target_tk:t.target.tk,name:t.name,uid:t.uid,screenStartX:c,screenStartY:p,screenEndX:m,screenEndY:_,beginTime:g,endTime:C,gatherStartTime:t.gatherStartTime,armyLoad:t.armyLoad,gatherSpeed:t.gatherspeed,itemId:t.target.itemId,aid:t.aid,fire:t.fire,deploy:t.deploy,nodeWaitingState:0,labelWaittingState:0,language:t.language||""},D=!1;if("number"==typeof t.mc?(D=!0,A.members=t.mc):A.members=0,A.avatars=[],D&&(r.Str.isEmpty(t.av)||A.avatars.push(t.av),!r.Obj.isEmpty(t.mavs)))for(var N=0;N<t.mavs.length;N++){var b=t.mavs[N];if(!r.Str.isEmpty(b)&&(A.avatars.push(b),A.avatars.length>=5))break}if(A.uid===d.DATA.UserData.UID&&A.marchType===i.MarchType.GATHER_RESOURCE)if(A.marchState===i.MarchState.ARRIVED_HOME)u.default.playG123SoundPathByName("res_collection_finish"),y.default.Instance().ShowTips(n.LOCAL.getText("100477"));else if(A.marchState===i.MarchState.GATHERING&&this.march.hasOwnProperty(T)){this.march[T].marchState===i.MarchState.MARCHING&&y.default.Instance().ShowTips(n.LOCAL.getText("100478"))}if(t.armySkin&&(A.armySkin=t.armySkin),void 0!=t.marchSkin&&(A.marchSkin=t.marchSkin),void 0!=t.k&&(A.userServer=t.k),this.checkMarchDeleteCompletely(A))this.march.hasOwnProperty(T)&&(S.send(S.Names.WorldMapMarchViewUpdate,{delete:!0,marchId:T}),delete this.march[T]),A.uid===d.DATA.UserData.UID&&this.setMyMarch(T,!0);else{var L=this.logicCheckMarchShow(A),E=!0;if(r.Obj.isEmpty(this.march[T]))(this.checkMarchIsInView(A)||A.uid===d.DATA.UserData.UID)&&(this.march[T]=A);else{var P=this.march[T];this._resetMarchClientData(P),E=h.Instance.checkNeedUpdateView(P,A),this.march[T]=Object.assign(P,A)}A.uid===d.DATA.UserData.UID&&this.setMyMarch(T,!1),!E&&L||S.send(S.Names.WorldMapMarchViewUpdate,{delete:!L,marchId:T})}}}},e.prototype._resetMarchClientData=function(e){delete e.clientFix,delete e.clientDelayMark},Object.defineProperty(e.prototype,"myMarchNum",{get:function(){return this._myMarchNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"myMarch",{get:function(){return this._myMarch},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"myMarchNumMAX",{get:function(){return d.DATA.UserData.Buff.getValueWithBuff(this._myMarchNumMAX,_.BuffType.MarchSize,!0)},enumerable:!0,configurable:!0}),e.prototype.loginInitMyMarchNum=function(e,t){this._myMarchNum=e,this._myMarchNumMAX=t,p.send(p.Names.WorldMapUIMyMarchUpdate,null)},e.prototype.checkCleanWorldMarch=function(){p.send(p.Names.WorldMapLoginCleanUpView,null),this.march={},this._myMarch={}},e.prototype.setMyMarch=function(e,t){t?this._myMarch[e]&&delete this._myMarch[e]:this._myMarch[e]=1,this._myMarchNum=Object.keys(this._myMarch).length,p.send(p.Names.WorldMapUIMyMarchUpdate,null)},e.prototype.logicCheckMarchShow=function(e){var t=!0;return(e.marchState===i.MarchState.ARRIVED_HOME||e.marchState===i.MarchState.GATHERING||e.marchState===i.MarchState.INIT||e.marchState===i.MarchState.RALLY_ASSEMBLED||e.marchState===i.MarchState.GARRISON||e.marchState===i.MarchState.OCCUPY||e.marchType===i.MarchType.ALLIANCE_REINFORCE&&e.marchState===i.MarchState.ARRIVED)&&(t=!1),t},e.prototype.clientCheckMarchShow=function(e){return!(e&&!r.Obj.isEmpty(e.clientDelayMark)&&e.clientDelayMark)},e.prototype.checkMarchDeleteCompletely=function(e){return e.marchState===i.MarchState.ARRIVED_HOME},e.prototype.UpdateAllianceTerritory=function(e,t){if(null!=e){for(var a=!1,o=0;o<e.length;o++){var n=e[o],r=i.AllianceTerritoryInfo.getInfoKey(n.x,n.y),s=this.AllianceTerritory[r];null!=s?t?(this.AllianceTerritory[r]=null,a=!0):(s.UpdateData(n),a=!0):t||(s=new i.AllianceTerritoryInfo(n),this.AllianceTerritory[r]=s,a=!0)}a&&(this.UpdateTerritoryPointPool(),p.send(p.Names.AllianceTerritoryUpdate,null))}},e}();t.exports=D,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Core/Common/TableManager":"TableManager","../../../Core/Net/NetMgr":"NetMgr","../../../fws/utils/FWS2DUtils":"FWS2DUtils","../../../fws/utils/FWSTool":"FWSTool","../../../fws/utils/X":"X","../../Common/UIManager":"UIManager","../../Const/GameDefine":"GameDefine","../../Const/RequestId":"RequestId","../../Const/TableName":"TableName","../../Data/DataCenter":"DataCenter","../../Data/PlayerInfo":"PlayerInfo","../../Tools/GameTools":"GameTools","../../Tools/PlayerInfoTool":"PlayerInfoTool","../../Tools/SubPackMsgs":"SubPackMsgs","./WorldMapCommon":"WorldMapCommon","./WorldMapEvents":"WorldMapEvents","./WorldMapMsgs":"WorldMapMsgs","./WorldMapTerrain":"WorldMapTerrain","./controllers/WorldMarchController":"WorldMarchController"}],WorldMapMsgs:[function(e,t,a){"use strict";cc._RF.push(t,"19581TrXI1Ga7+mhGFjlthK","WorldMapMsgs");var o,n=e("../../../fws/mvc/FWSMvc");(function(e){(function(e){e[e.WorldMapResourcesLoad=0]="WorldMapResourcesLoad",e[e.WorldMapResourcesOnLoad=1]="WorldMapResourcesOnLoad",e[e.WorldMapDataLoad=2]="WorldMapDataLoad",e[e.WorldMapDataOnLoad=3]="WorldMapDataOnLoad",e[e.WorldMapSetTileView=4]="WorldMapSetTileView",e[e.WorldMapSetPointView=5]="WorldMapSetPointView",e[e.WorldMapRemoveTileNode=6]="WorldMapRemoveTileNode",e[e.WorldMapJumpToTile=7]="WorldMapJumpToTile",e[e.WorldMapJumpToServerTile=8]="WorldMapJumpToServerTile",e[e.WorldMapJumpToTileClick=9]="WorldMapJumpToTileClick",e[e.WorldMapEnterTodo=10]="WorldMapEnterTodo",e[e.WorldMapUpdateTile=11]="WorldMapUpdateTile",e[e.WorldMapMarchViewUpdate=12]="WorldMapMarchViewUpdate",e[e.WorldMapDelayDeleteMarchView=13]="WorldMapDelayDeleteMarchView",e[e.WorldMapLoginCleanUpView=14]="WorldMapLoginCleanUpView",e[e.WorldMapLoginCleanUpData=15]="WorldMapLoginCleanUpData",e[e.WorldMapUIMyMarchUpdate=16]="WorldMapUIMyMarchUpdate",e[e.WorldMapTileClick=17]="WorldMapTileClick",e[e.WorldMapOnExit=18]="WorldMapOnExit",e[e.WorldMapViewportChange=19]="WorldMapViewportChange",e[e.WorldMapUIHide=20]="WorldMapUIHide",e[e.WorldMapMyCityPosChange=21]="WorldMapMyCityPosChange",e[e.WorldMapViewLockCamera=22]="WorldMapViewLockCamera",e[e.WorldMapShowMarchDetail=23]="WorldMapShowMarchDetail",e[e.WorldMapSetMarchBattleEffectShow=24]="WorldMapSetMarchBattleEffectShow",e[e.AllianceTerritoryUpdate=25]="AllianceTerritoryUpdate",e[e.AddWorldItem=26]="AddWorldItem",e[e.WorldSureAddItem=27]="WorldSureAddItem",e[e.WorldCnacleAddItem=28]="WorldCnacleAddItem",e[e.GetKvkResouceDistrictState=29]="GetKvkResouceDistrictState",e[e.GetKvkColorBySid=30]="GetKvkColorBySid",e[e.WorldMapScout=31]="WorldMapScout",e[e.WorldMapSuperScout=32]="WorldMapSuperScout",e[e.WorldMapScoutResult=33]="WorldMapScoutResult",e[e.WorldMapHaveOpenTilePopup=34]="WorldMapHaveOpenTilePopup",e[e.WorldMapTowerCoverRemove=35]="WorldMapTowerCoverRemove",e[e.WorldMapUpdateViewPort=36]="WorldMapUpdateViewPort",e[e.WorldMapConvertToContainerPosition=37]="WorldMapConvertToContainerPosition"})(e.Names||(e.Names={})),e.send=function(t,a,o){void 0===o&&(o="");var i=e.Names[t],r=new n.FMessage(i,a,o);return r.send(),r}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../../fws/mvc/FWSMvc":"FWSMvc"}],WorldMapTerrain:[function(e,t,a){"use strict";cc._RF.push(t,"fa4852pIsJHjK3k+9kpNYJs","WorldMapTerrain");var o,n=e("./WorldMapCommon"),i=e("../../../fws/task/FWSTask"),r=(e("./WorldMapDynamicTerrainModel"),e("../../Data/GlobalData")),s=e("../../Common/LoadManager"),l=e("../../../fws/display/factory/FWSAssertCaches"),c=e("../../../fws/utils/X"),d=e("../../Common/biz/DiffBizTool"),p=e("../../Tools/GameTools"),u=e("../../../Core/Common/LocalManager"),h=e("../../../fws/platforms/PlatformCore");(function(e){var t;(function(e){e[e.Area=0]="Area",e[e.Throne=1]="Throne"})(t=e.BinDataFlags||(e.BinDataFlags={}));var a=function(a){function o(e,o){void 0===e&&(e=t.Area),void 0===o&&(o="MAP");var n=a.call(this,o)||this;return n.currentBinDataFlag=e,n}return __extends(o,a),o.prototype.begin=function(){if(a.prototype.begin.call(this),!this._alreadyBegin&&!this._alreadyCompoleted){this._alreadyBegin=!0,this._alreadyCompoleted=!1;var o=this,i="WorldMapArea_20_0424_01.bin";switch(this.currentBinDataFlag){case t.Area:i=d.DIFF_BIZ_TOOL.getWorldMapBinLayer(1)||"WorldMapArea_20_0810_01.bin",i=n.USE_NEW_WORLDMAP_TMX_DATA?i:"WM2x2_20190708.bin";break;case t.Throne:i=n.USE_NEW_WORLDMAP_TMX_DATA?d.DIFF_BIZ_TOOL.getWorldMapBinLayer(2)||"WorldMapCenter_20_0810_01.bin":"NewWorldMapCenter_201912301621.bin"}this.url=r.GLOBAL.ResourceUrl+"/DynRes/genfiles/"+i,"g123"===h.instance.platformSID&&(i=i.replace(".bin",".map"),this.url=cc.url.raw("resources/map/"+i)),s.LoadManager.load(this.url,function(a,n){if(a)o.callListener(o.onError);else try{o.currentBinDataFlag===t.Area?e._terrainData=n:o.currentBinDataFlag===t.Throne&&(e._centerData=n,e.parseCenterData(n,128,64)),o.callListener(o.onCompleted)}catch(e){o.callListener(o.onError)}})}},o.prototype.getDebugInfo=function(){return this._isOvertime?"\u8d85\u65f6>>"+this.url:"\u5931\u8d25>>"+this.url},o}(i.Task);e.WorldMapBinLoader=a,e.getLayerData=function(t,a,o){var n=t,i=o,r=Math.floor(a/2)%64+i%256*64;r+=16384*n;var s=e._terrainData[r];return 0===s&&1===n&&(s=e._terrainData[r+16384]),s||0};function o(e,t,a,o,n){for(var i=n*o,r=t*i,s=0;s<i;s++){var l=e[s+r];a[s]=l}}function m(t,a,o,i,r){if(null===a||void 0===a||0===a)return!1;var s;if(n.USE_NEW_WORLDMAP_TMX_DATA){var c=n.currentWorldMapTmxData.getAssetName(a);c&&(s="object"==typeof c?c.name:c)}else s=e.TerrainTileMap[a];if(!s)return!1;var d=e.worldMapDisplayPools.getNode("WORLDMAP_TILE");if(!d)return!1;var p=d.getComponent(cc.Sprite);return!!p&&(p.spriteFrame=l.getSpriteFrame(s,"texture/world_1",!0),t[t.length]={id:0,idString:"0",screenX:o,screenY:i,node:d},d.setPosition(o,i),r.addChild(d),!0)}function f(e,t){return e-=192,t-=448,e=Math.floor(e/2),64*(t%=128)+(e%=64)}function _(e){if((e.x+e.y)%2!=0)return!1;var t=e.x,a=e.y;return a>=448&&a<=576&&t>=192&&t<=320}e.TerrainFloorLayer=[],e.TerrainFloorElementLayer=[],e.ThroneTerrain1=[],e.ThroneTerrain2=[],e.ThroneFloor=[],e.ThroneUnit=[],e.parseCenterData=function(t,a,i){var r=!1;t||(r=!0),r||(n.USE_NEW_WORLDMAP_TMX_DATA?(o(t,0,e.ThroneTerrain1,a,i),o(t,1,e.ThroneTerrain2,a,i),o(t,2,e.ThroneFloor,a,i)):(o(t,0,e.ThroneTerrain1,a,i),o(t,1,e.ThroneTerrain2,a,i),o(t,2,e.ThroneFloor,a,i),o(t,3,e.ThroneUnit,a,i)))},e.dumpSimpleData=function(e,t){for(var a="DUMP SIMPLE DATA: "+t,o=0;o<e.length;o++){o%64==0&&(a+="\n");var n=e[o];a+=0===n||null===n||void 0===n?".":"X"}c.log(a)},e.parseTerrainData=function(e,t,a,o,n){},e.checkTerrainTileIsPlain=function(t){if(n.USE_NEW_WORLDMAP_TMX_DATA){var a=e.TerrainFloorLayer[t];if(a>=38&&a<=52)return!1}return!0},e.TerrainTileMap={1:"wm_tile_desert_01",2:"wm_tile_desert_02",3:"wm_tile_desert_03",4:"wm_tile_desert_04",5:"wm_tile_desert_05",6:"wm_tile_desert_06",7:"wm_tile_desert_07",8:"wm_tile_desert_08",9:"wm_tile_desert_09",10:"wm_tile_desert_10",11:"wm_tile_desert_11",12:"wm_tile_desert_12",13:"wm_tile_desert_13",14:"wm_tile_desert_14",15:"wm_tile_desert_15",25:"wm_tile_snow_01",26:"wm_tile_snow_02",27:"wm_tile_snow_03",28:"wm_tile_snow_04",29:"wm_tile_snow_05",30:"wm_tile_snow_06",31:"wm_tile_snow_07",32:"wm_tile_snow_08",33:"wm_tile_snow_09",34:"wm_tile_snow_10",35:"wm_tile_snow_11",36:"wm_tile_snow_12",37:"wm_tile_snow_13",38:"wm_tile_snow_14",39:"wm_tile_snow_15",131:"wm_tile_th1_01",132:"wm_tile_th1_02",133:"wm_tile_th1_03",134:"wm_tile_th1_04",135:"wm_tile_th1_05",136:"wm_tile_th1_06",137:"wm_tile_th1_07",138:"wm_tile_th1_08",139:"wm_tile_th1_09",140:"wm_tile_th1_10",141:"wm_tile_th1_11",142:"wm_tile_th1_12",143:"wm_tile_th1_13",144:"wm_tile_th1_14",145:"wm_tile_th1_15",146:"wm_tile_th1_16",147:"wm_tile_th1_17",148:"wm_tile_th1_18",149:"wm_tile_th1_19",150:"wm_tile_th1_20",151:"wm_tile_th1_21",152:"wm_tile_th1_22",153:"wm_tile_th1_23",154:"wm_tile_th1_24",155:"wm_tile_th1_25",156:"wm_tile_th1_26",157:"wm_tile_th1_27",158:"wm_tile_th1_28",159:"wm_tile_th1_29",179:"wm_tile_th2_01",180:"wm_tile_th2_02",181:"wm_tile_th2_03",182:"wm_tile_th2_04",183:"wm_tile_th2_05",184:"wm_tile_th2_06",185:"wm_tile_th2_07",186:"wm_tile_th2_08",187:"wm_tile_th2_09",188:"wm_tile_th2_10",189:"wm_tile_th2_11",190:"wm_tile_th2_12",191:"wm_tile_th2_13",192:"wm_tile_th2_14",193:"wm_tile_th2_15",338:"wm_tile_water_01",339:"wm_tile_water_02",340:"wm_tile_water_03",341:"wm_tile_water_04",342:"wm_tile_water_05",343:"wm_tile_water_06",344:"wm_tile_water_07",345:"wm_tile_water_08",346:"wm_tile_water_09",347:"wm_tile_water_10",348:"wm_tile_water_11",349:"wm_tile_water_12",350:"wm_tile_water_13",351:"wm_tile_water_14",352:"wm_tile_water_15"},e.FloorMap={101:{name:"wm_footer_1",pos:new cc.Vec2(1,1),scale:1},102:{name:"wm_footer_11",pos:new cc.Vec2(1,1),scale:1},103:{name:"wm_footer_13",pos:new cc.Vec2(1,1),scale:1},104:{name:"wm_footer_14",pos:new cc.Vec2(1,1),scale:1},105:{name:"wm_footer_2",pos:new cc.Vec2(1,1),scale:1},106:{name:"wm_footer_20",pos:new cc.Vec2(1,1),scale:1},107:{name:"wm_footer_24",pos:new cc.Vec2(1,1),scale:1},108:{name:"wm_footer_25",pos:new cc.Vec2(1,1),scale:1},109:{name:"wm_footer_26",pos:new cc.Vec2(1,1),scale:1},110:{name:"wm_footer_27",pos:new cc.Vec2(1,1),scale:1},111:{name:"wm_footer_28",pos:new cc.Vec2(1,1),scale:1},112:{name:"wm_footer_29",pos:new cc.Vec2(1,1),scale:1},113:{name:"wm_footer_3",pos:new cc.Vec2(1,1),scale:1},114:{name:"wm_footer_31",pos:new cc.Vec2(1,1),scale:1},115:{name:"wm_footer_36",pos:new cc.Vec2(1,1),scale:1},116:{name:"wm_footer_37",pos:new cc.Vec2(1,1),scale:1},117:{name:"wm_footer_38",pos:new cc.Vec2(1,1),scale:1},118:{name:"wm_footer_48",pos:new cc.Vec2(1,1),scale:1},119:{name:"wm_footer_5",pos:new cc.Vec2(1,1),scale:1},120:{name:"wm_footer_6",pos:new cc.Vec2(1,1),scale:1},121:{name:"wm_footer_7",pos:new cc.Vec2(1,1),scale:1},122:{name:"wm_footer_wc1",pos:new cc.Vec2(1,1),scale:1},123:{name:"wm_footer_wc2",pos:new cc.Vec2(1,1),scale:1},124:{name:"wm_footer_wc3",pos:new cc.Vec2(1,1),scale:1},125:{name:"wm_footer_wc4",pos:new cc.Vec2(1,1),scale:1},126:{name:"wm_footer_wc5",pos:new cc.Vec2(1,1),scale:1},127:{name:"wm_footer_wc6",pos:new cc.Vec2(1,1),scale:1},128:{name:"wm_footer_wc7",pos:new cc.Vec2(1,1),scale:1},129:{name:"wm_footer_wc8",pos:new cc.Vec2(1,1),scale:1},130:{name:"wm_footer_wc9",pos:new cc.Vec2(1,1),scale:1},53:{name:"wm_units_1",pos:new cc.Vec2(1,1),scale:1},54:{name:"wm_units_10",pos:new cc.Vec2(1,1),scale:1},55:{name:"wm_units_11",pos:new cc.Vec2(1,1),scale:1},56:{name:"wm_units_wc12",pos:new cc.Vec2(1,1),scale:1},57:{name:"wm_units_wc13",pos:new cc.Vec2(1,1),scale:1},58:{name:"wm_units_wc14",pos:new cc.Vec2(1,1),scale:1},59:{name:"wm_units_wc15",pos:new cc.Vec2(1,1),scale:1},60:{name:"wm_units_wc16",pos:new cc.Vec2(1,1),scale:1},61:{name:"wm_units_wc17",pos:new cc.Vec2(1,1),scale:1},62:{name:"wm_units_wc18",pos:new cc.Vec2(1,1),scale:1},63:{name:"wm_units_wc19",pos:new cc.Vec2(1,1),scale:1},64:{name:"wm_units_wc20",pos:new cc.Vec2(1,1),scale:1},65:{name:"wm_units_21",pos:new cc.Vec2(1,1),scale:1},66:{name:"wm_units_wc21",pos:new cc.Vec2(1,1),scale:1},67:{name:"wm_units_23",pos:new cc.Vec2(1,1),scale:1},68:{name:"wm_units_wc22",pos:new cc.Vec2(1,1),scale:1},69:{name:"wm_units_wc23",pos:new cc.Vec2(1,1),scale:1},70:{name:"wm_units_wc24",pos:new cc.Vec2(1,1),scale:1},71:{name:"wm_units_wc25",pos:new cc.Vec2(1,1),scale:1},72:{name:"wm_units_wc26",pos:new cc.Vec2(1,1),scale:1},73:{name:"wm_units_32",pos:new cc.Vec2(1,1),scale:1},74:{name:"wm_units_wc27",pos:new cc.Vec2(1,1),scale:1},75:{name:"wm_units_wc28",pos:new cc.Vec2(1,1),scale:1},76:{name:"wm_units_35",pos:new cc.Vec2(1,1),scale:1},77:{name:"wm_units_wc3",pos:new cc.Vec2(1,1),scale:1},78:{name:"wm_units_4",pos:new cc.Vec2(1,1),scale:1},79:{name:"wm_units_wc4",pos:new cc.Vec2(1,1),scale:1},80:{name:"wm_units_wc5",pos:new cc.Vec2(1,1),scale:1},81:{name:"wm_units_wc6",pos:new cc.Vec2(1,1),scale:1},82:{name:"wm_units_wc7",pos:new cc.Vec2(1,1),scale:1},83:{name:"wm_units_wc8",pos:new cc.Vec2(1,1),scale:1},84:{name:"wm_units_wc9",pos:new cc.Vec2(1,1),scale:1},85:{name:"wm_units_46",pos:new cc.Vec2(1,1),scale:1},86:{name:"wm_units_47",pos:new cc.Vec2(1,1),scale:1},87:{name:"wm_units_wc29",pos:new cc.Vec2(1,1),scale:1},88:{name:"wm_units_7",pos:new cc.Vec2(1,1),scale:1},89:{name:"wm_units_8",pos:new cc.Vec2(1,1),scale:1},90:{name:"wm_units_9",pos:new cc.Vec2(1,1),scale:1},91:{name:"wm_units_wc1",pos:new cc.Vec2(1,1),scale:1},92:{name:"wm_units_wc2",pos:new cc.Vec2(1,1),scale:1},93:{name:"wm_units_wc3",pos:new cc.Vec2(1,1),scale:1},94:{name:"wm_units_wc4",pos:new cc.Vec2(1,1),scale:1},95:{name:"wm_units_wc5",pos:new cc.Vec2(1,1),scale:1},96:{name:"wm_units_wc6",pos:new cc.Vec2(1,1),scale:1},97:{name:"wm_units_wc7",pos:new cc.Vec2(1,1),scale:1},98:{name:"wm_units_wc8",pos:new cc.Vec2(1,1),scale:1},99:{name:"wm_units_wc9",pos:new cc.Vec2(1,1),scale:1}},e.WaterBorderTiles=n.USE_NEW_WORLDMAP_TMX_DATA?[188,188,188,188,188,188,188,188,188,184,184,184,184,184,184,188,188,178,174,174,174,174,174,185,183,0,0,0,0,0,175,188,188,177,0,0,0,0,0,185,183,0,0,0,0,0,175,188,188,177,0,0,0,0,0,185,183,0,0,0,0,0,175,188,188,177,0,0,0,0,0,185,183,0,0,0,0,0,175,188,188,177,0,0,0,0,0,185,183,0,0,0,0,0,175,188,188,177,0,0,0,0,0,185,183,176,176,176,176,176,180,188,188,182,182,182,182,182,182,188,188,188,188,188,188,188,188,188]:[352,352,352,352,352,352,352,352,352,348,348,348,348,348,348,352,352,342,338,338,338,338,338,349,347,0,0,0,0,0,339,352,352,341,0,0,0,0,0,349,347,0,0,0,0,0,339,352,352,341,0,0,0,0,0,349,347,0,0,0,0,0,339,352,352,341,0,0,0,0,0,349,347,0,0,0,0,0,339,352,352,341,0,0,0,0,0,349,347,0,0,0,0,0,339,352,352,341,0,0,0,0,0,349,347,340,340,340,340,340,344,352,352,346,346,346,346,346,346,352,352,352,352,352,352,352,352,352],e.tryReplaceWaterBorderTile=function(t,a,o){var i=t,r=Math.floor(a/2),s=n.currentWorldMapTmxData.crood_max_x/2,l=n.currentWorldMapTmxData.crood_max_y,c=8*i+r,d=o;return i<3&&r<3?d=e.WaterBorderTiles[c]:i<3&&r>=3&&r<s-3?(c=8*i+(r=(r-3)%2+3),d=e.WaterBorderTiles[c]):i<3&&r>=s-3?(c=8*i+(r=8-(r=s-r)),d=e.WaterBorderTiles[c]):r<3&&i>=3&&i<l-3?(c=8*((i-3)%10+3)+r,d=e.WaterBorderTiles[c]):r>=s-3&&i>=3&&i<l-3?(c=8*((i-3)%10+3)+(r=8-(r=s-r)),d=e.WaterBorderTiles[c]):r<3&&i>=l-3?(c=8*(i=16-(i=l-i))+r,d=e.WaterBorderTiles[c]):r>=3&&r<s-3&&i>=l-3?(c=8*(i=16-(i=l-i))+(r=(r-3)%2+3),d=e.WaterBorderTiles[c]):r>=s-3&&i>=l-3&&(c=8*(i=16-(i=l-i))+(r=8-(r=s-r)),d=e.WaterBorderTiles[c]),0!==d&&void 0!==d&&null!==d||(d=o),d},e.drawTerrainTile=m,e.getThroneDataIndex=f,e.verifyThroneDataPos=_,e.verifyThroneDataIndex=function(e){return e>=0&&e<16384},e.drawThroneTerrain1=[],e.drawThroneTerrain2=[],e.tryDrawThroneTerrainLevel1=function(t,a,o,n,i,r){if(_(o)){var s=f(o.x,o.y),l=e.ThroneTerrain1[s];e.drawThroneTerrain1[i]&&e.drawThroneTerrain1[i][r]||m(t,l,i,r,a)&&(null==e.drawThroneTerrain1[i]&&(e.drawThroneTerrain1[i]=[]),e.drawThroneTerrain1[i][r]=1)}},e.tryDrawThroneTerrainLevel2=function(t,a,o,n,i,r){if(_(o)){var s=f(o.x,o.y),l=e.ThroneTerrain2[s];e.drawThroneTerrain2[i]&&e.drawThroneTerrain2[i][r]||m(t,l,i,r,a)&&(null==e.drawThroneTerrain2[i]&&(e.drawThroneTerrain2[i]=[]),e.drawThroneTerrain2[i][r]=1)}},e.tryDrawThroneFloor=function(e,t,a,o,n){},e.tryDrawThroneUnit=function(e,t,a,o,n){};var y=function(){function t(){this._worldMapSettings=n.WorldMapSettings.DrawAreaLine|n.WorldMapSettings.DrawWaterOutline|n.WorldMapSettings.DrawThroneTerrain,this.TMX_ROWS=256,this.TMX_COLS=64,this.WORLD_ROWS=1024,this.WORLD_COLS=256}return Object.defineProperty(t.prototype,"cols",{get:function(){return this.WORLD_COLS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.WORLD_ROWS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crood_max_x",{get:function(){return 2*this.cols},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crood_max_y",{get:function(){return this.rows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"settings",{get:function(){return n.USE_NEW_WORLDMAP_TMX_DATA?this._worldMapSettings|n.WorldMapSettings.AutoDynamicAddonElements:this._worldMapSettings},enumerable:!0,configurable:!0}),t.prototype.getTile=function(t,a,o,i){switch(o){case n.CrossServerMapLayerTypes.Addon:return e.getLayerData(1,t,a);case n.CrossServerMapLayerTypes.Terrain:return e.getLayerData(0,t,a);default:return 0}},t.prototype.isBlock=function(t,a,o){if(t<3||t>n.currentWorldMapTmxData.crood_max_x-4||a<3||a>n.currentWorldMapTmxData.crood_max_y-4)return!0;if(n.USE_NEW_WORLDMAP_TMX_DATA){var i=e.getLayerData(0,t,a);if(i>=174&&i<=188)return!0}var r=e.getLayerData(1,t,a);if(_(new cc.Vec2(t,a))){var s=e.getThroneDataIndex(t,a);if(e.ThroneTerrain2[s])return!!e.ThroneTerrain1[s]}if(n.checkMapSetting(n.WorldMapSettings.AutoDynamicAddonElements)){if(r>=31&&r<=47)return!0;if(r>=249&&r<=251)return!0}else if(0!==r&&null!==r&&void 0!==r)return!0;return!1},t.prototype.getArea=function(e,t,a){var o=0,i=Math.floor(n.currentWorldMapTmxData.crood_max_x/8),r=Math.floor(n.currentWorldMapTmxData.crood_max_y/8);return i=Math.floor(e/i),r=Math.floor(t/r),i>=0&&i<n.ProvinceMatrix.length&&r>=0&&r<n.ProvinceMatrix[i].length&&(o=n.ProvinceMatrix[i][r]),o},t.prototype.canMoveTo=function(e,t){if(this.isBlock(e,t))return u.LOCAL.getText("100206");for(var a=this.getArea(e,t),o=p.default.getDataConfigData(70002).split("|"),n=0;n<o.length;n++)if(parseInt(o[n])==a)return u.LOCAL.getText("cross_server_system_002");return""},t.prototype.getAssetName=function(t){return n.USE_NEW_WORLDMAP_TMX_DATA?n.crossServerMapTmxData.getAssetName(t):e.TerrainTileMap[t+""]||e.FloorMap[t+""]},t.prototype.isBlockId=function(e){return e>=31&&e<=47},t.prototype.getReplaceBlockAssetName=function(e){return this.isBlockId(e)?"z_wm_unit_001":null},t}();e.WorldMapTmxData=y})(o||(o={})),window.WorldMapTerrain=o,n.worldMapTmxData=new o.WorldMapTmxData,n.currentWorldMapTmxData=n.worldMapTmxData,t.exports=o,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../fws/display/factory/FWSAssertCaches":"FWSAssertCaches","../../../fws/platforms/PlatformCore":"PlatformCore","../../../fws/task/FWSTask":"FWSTask","../../../fws/utils/X":"X","../../Common/LoadManager":"LoadManager","../../Common/biz/DiffBizTool":"DiffBizTool","../../Data/GlobalData":"GlobalData","../../Tools/GameTools":"GameTools","./WorldMapCommon":"WorldMapCommon","./WorldMapDynamicTerrainModel":"WorldMapDynamicTerrainModel"}],WorldMapController:[function(e,t,a){"use strict";cc._RF.push(t,"512e8JNHeNBK42OwleljBbw","WorldMapController");var o,n=e("../../../../Core/Common/LocalManager"),i=e("../../../../fws/utils/X"),r=e("../../../../fws/mvc/FWSMvc"),s=e("../WorldMapCommon"),l=e("../../../../fws/utils/FWSTool"),c=e("../../../../Core/Net/NetMgr"),d=e("../../../Const/RequestId"),p=e("../../../Data/DataCenter"),u=e("../WorldMapMsgs"),h=e("../../../Tools/GameTools"),m=e("../../../Procedure/ProcedureManager"),f=e("../../../Common/UIManager"),_=e("./WorldMarchController"),y=e("../../../../Core/Common/TableManager"),g=e("../WorldMapDisplayPools"),C=e("../../../Scene/SceneManager"),v=e("../../../Const/SceneName"),I=e("../WorldMapModel"),T=e("../../../Const/UIDataInfo"),S=e("../../../Const/GameDefine"),A=e("../../../Common/BIManager"),D=e("../../../controllers/ExchangeController"),N=e("../../../Const/EventId"),b=e("../../../Data/BattleData"),L=e("../../../Const/GameDefine"),E=e("../../../../Core/Event/EventCenter"),P=e("../WorldMapEvents"),w=e("../../../Tools/SubPackMsgs"),B=e("../../../Const/TableName"),M=e("../../../controllers/ScienceController"),U=function(e){function t(){var t=e.call(this)||this;return t.jumpToCoord=cc.v2(-1,-1),t.jumpToClick=!1,t._clickUIMyMarchId="",t}return __extends(t,e),t.getInstance=function(){return o||(o=new t),window.WMC=o,o},t.prototype.purge=function(){o.disconnect(),o=null},Object.defineProperty(t,"model",{get:function(){return I.getInstance()},enumerable:!0,configurable:!0}),t.prototype.onConnect=function(){},t.prototype.onDisconnect=function(){P.targetOff(this)},t.prototype.onFMessage_WorldMapOnExit=function(e){return t.model.march={},t.model.entities={},t.model.lastUpdateInfo.timestamp=0,this.jumpToCoord=p.DATA.UserData.WorldCoord,this.jumpToClick=!1,c.NET.send(d.RequestId.LEAVE_WORLDMAP,{},this),!0},t.prototype.onFMessage_LOGIN_SUCCESS=function(e){if(t.model.checkCleanWorldMarch(),u.send(u.Names.WorldMapUIMyMarchUpdate,null),C.default.Instance().CurSceneName===v.SceneName.WORLD){c.NET.send(d.RequestId.GET_ALL_MY_MARCH_INFO,{},this,function(e){var a=h.default.JSON_PARSE(e.d);if(null!=a)for(var o=l.Obj.getProperty(a,"marches",[]),n=0;n<o.length;n++)t.model.worldMarchDataHandler(o[n])});var a=t.model.lastUpdateInfo;t.model.updateWorldMapData(a.centerCoord,a.serverId,a.width,a.height)}return!0},t.prototype.chooseWorldArea=function(e,t){c.NET.send(d.RequestId.CHOOSE_WORLD_AREA,{province:e},this,function(a){var o=h.default.JSON_PARSE(a.d);null!=o&&(A.default.postBI("first_to_world"),p.DATA.UserData.updateWorldCoord(cc.v2(o.x,o.y),e),m.PROCE.Run(m.PROCE.World),t&&t.success&&t.success(t.data))})},t.prototype.onFMessage_WorldMapDataLoad=function(e){var a=t.model.getCoordByWorldPos(e.data.pos);return t.model.updateWorldMapData(cc.v2(a.x,a.y),a.serverId,Math.floor(e.data.rect.width/s.Tile_W),Math.floor(e.data.rect.height/s.Tile_H),e.data.tryForceLoadData),!0},t.prototype.enterWorldMap=function(){p.DATA.UserData.WorldCoord.x<0||p.DATA.UserData.WorldCoord.y<0||p.DATA.UserData.Level<p.DATA.UserData.OpenWorldLevel?C.default.Instance().CurSceneName===v.SceneName.WORLD&&m.PROCE.Run(m.PROCE.Home):((this.jumpToCoord.x<0||this.jumpToCoord.y<0)&&(this.jumpToCoord=p.DATA.UserData.WorldCoord),t.model.initMapState=0,g.isLoaded()&&(t.model.initMapState=1,u.send(u.Names.WorldMapDataLoad,{rect:new cc.Rect(0,0,10*s.Tile_W,20*s.Tile_H),pos:t.model.getWorldPosByCoord(this.jumpToCoord,t.model.SelfServerId)}),u.send(u.Names.WorldMapSetTileView,{x:this.jumpToCoord.x,y:this.jumpToCoord.y,s:t.model.SelfServerId,mark:!0})))},t.prototype.onFMessage_WorldMapResourcesOnLoad=function(e){return 0===t.model.initMapState&&(t.model.initMapState=1,(this.jumpToCoord.x<0||this.jumpToCoord.y<0)&&(this.jumpToCoord=p.DATA.UserData.WorldCoord),u.send(u.Names.WorldMapDataLoad,{rect:new cc.Rect(0,0,10*s.Tile_W,20*s.Tile_H),pos:t.model.getWorldPosByCoord(this.jumpToCoord,t.model.SelfServerId)}),u.send(u.Names.WorldMapSetTileView,{x:this.jumpToCoord.x,y:this.jumpToCoord.y,s:t.model.SelfServerId,mark:!0})),!0},t.prototype.onFMessage_WorldMapJumpToTile=function(e){if(null===e.data||void 0===e.data)return!0;if(C.default.Instance().CurSceneName===v.SceneName.WORLD)u.send(u.Names.WorldMapSetTileView,{x:e.data.x,y:e.data.y,s:t.model.SelfServerId,mark:!0});else{if(p.DATA.UserData.WorldCoord.x<0||p.DATA.UserData.WorldCoord.y<0)return!0;c.NET.send(d.RequestId.GET_ALL_MY_MARCH_INFO,{},this,function(e){var a=h.default.JSON_PARSE(e.d);if(null!=a)for(var o=l.Obj.getProperty(a,"marches",[]),n=0;n<o.length;n++)t.model.worldMarchDataHandler(o[n])}),this.jumpToCoord=e.data,m.PROCE.Run(m.PROCE.World)}return f.default.Instance().CloseAllUI(),!0},t.prototype.onFMessage_WorldMapJumpToServerTile=function(e){if(null===e.data||void 0===e.data)return!0;if(C.default.Instance().CurSceneName===v.SceneName.WORLD)u.send(u.Names.WorldMapSetTileView,{x:e.data.x,y:e.data.y,s:e.data.z,mark:!0});else{if(p.DATA.UserData.WorldCoord.x<0||p.DATA.UserData.WorldCoord.y<0)return!0;c.NET.send(d.RequestId.GET_ALL_MY_MARCH_INFO,{},this,function(e){var a=h.default.JSON_PARSE(e.d);if(null!=a)for(var o=l.Obj.getProperty(a,"marches",[]),n=0;n<o.length;n++)t.model.worldMarchDataHandler(o[n])}),this.jumpToCoord=cc.v2(e.data.x,e.data.y),m.PROCE.Run(m.PROCE.World)}return f.default.Instance().CloseAllUI(),!0},t.prototype.onFMessage_WorldMapJumpToTileClick=function(e){return null===e.data||void 0===e.data||(this.jumpToClick=!0,u.send(u.Names.WorldMapJumpToTile,cc.v2(e.data.x,e.data.y)),!0)},t.prototype.moveCity=function(e,a){var o=this;if(p.DATA.UserData.FunctionOn(S.FunctionKey.move_city)&&t.model.checkIsPlainTile(e,a))if(this.myMarchNum>0)f.default.Instance().ShowTips(n.LOCAL.getText("101151"));else{var i=0,r=t.model.getAllianceDataByPoint(e,a);null!=r&&(i=r.owner);var s=w.send(w.Names.SUBPACK_EIGHT_COUNTRY_MY_COLOR_INDEX,{}).data;if((!h.default.isKVK()||!s)&&p.DATA.UserData.ServerState!=L.ServerState.Ready&&p.DATA.UserData.ServerState!=L.ServerState.Fight&&i>0&&p.DATA.UserData.Alliance.Aid!=i)return void f.default.Instance().ShowTips(n.LOCAL.getText("league_move_007"));f.default.Instance().OpenUI(T.UIDataInfo.UseItemCommonPanel,y.TABLE.getTableIdByKeyValue(B.TableName.ITEM,"type",10),function(t){var i={itemId:t.itemId,amount:t.amount,isPurchase:0,x:e,y:a};c.NET.send(d.RequestId.MOVE_CITY_POSITION,i,o,function(e){u.send(u.Names.WorldMapUpdateViewPort,null);var t=h.default.JSON_PARSE(e.d);h.default.ObjIsEmpty(t)||f.default.Instance().ShowTips(n.LOCAL.getText("101152"))})},this,function(t){var i={itemId:t.itemId,amount:t.amount,isPurchase:1,x:e,y:a};c.NET.send(d.RequestId.MOVE_CITY_POSITION,i,o,function(e){u.send(u.Names.WorldMapUpdateViewPort,null);var t=h.default.JSON_PARSE(e.d);h.default.ObjIsEmpty(t)||f.default.Instance().ShowTips(n.LOCAL.getText("101152"))})},this,this)}},t.prototype.worldMapMarch=function(e,t,a,o,i,r,l){void 0===l&&(l=0);var p={marchType:e,x:t.x,y:t.y,armyList:a,armyListNew:o,heroList:i,trapList:r,break:l};c.NET.send(d.RequestId.MARCH_WORLD_POINT,p,this,function(t){0===t.s?e===s.MarchType.GATHER_RESOURCE?f.default.Instance().ShowTips(n.LOCAL.getText("100487")):h.default.playG123SoundPathByName("march_start"):h.default.isKVK()||f.default.Instance().ShowTips(n.LOCAL.getText("100488"))})},t.prototype.PushMarchInfo=function(e){var a=h.default.JSON_PARSE(e);if(null!=a&&C.default.Instance().CurSceneName===v.SceneName.WORLD&&a.uid!==p.DATA.UserData.UID){var o={marchInfo:a};t.model.worldMarchDataHandler(o)}},t.prototype.PushUserMarchInfo=function(e){var a=h.default.JSON_PARSE(e);t.model.worldMarchDataHandler(a)},t.prototype.PushMarchAttackMonsterFinish=function(e){var t=h.default.JSON_PARSE(e);if(null!=t){var a=t.result;if(1===a&&t.pveId){var o=y.TABLE.getTableDataById(B.TableName.MONSTER,t.pveId+"");if(o&&o.level&&(1==o.group_id||2==o.group_id||3==o.group_id)){var n={myLevel:p.DATA.UserData.Level,monsterLevel:o.level};p.DATA.UserData.setLocalData(L.LocalDataKey.SearchMonsterLevelWin,n)}}E.EVENT.emit(N.EventId.AttackMonsterResult,a)}},t.prototype.PushMarchAttackBossFinish=function(e){h.default.JSON_PARSE(e)},t.prototype.PushWorldMapTileInfo=function(e){var a=h.default.JSON_PARSE(e);if(null!=a&&C.default.Instance().CurSceneName===v.SceneName.WORLD&&void 0!=a.pointInfos)for(var o=0;o<a.pointInfos.length;o++){var n=a.pointInfos[o];null!==n.x&&null!==n.y&&t.model.checkCoordIsInView(cc.v2(n.x,n.y))&&(t.model.updateTileInfo(n,!0),P.send(P.Names.WorldMapUpdateTile,t.model.getTileInfoByCoord(n.x,n.y,n.k)))}},t.prototype.PushWorldMapEnemyRefresh=function(e){h.default.JSON_PARSE(e)},t.prototype.PushWorldMapMyPointChange=function(e){var a=h.default.JSON_PARSE(e);null!==a&&(null===a.x||void 0===a.x||a.x<0||null===a.y||void 0===a.y||a.y<0||((p.DATA.UserData.WorldCoord.x<0||p.DATA.UserData.WorldCoord.y<0)&&t.getInstance().jumpToCoord.x>=0&&t.getInstance().jumpToCoord.y>=0?p.DATA.UserData.updateWorldCoord(cc.v2(a.x,a.y)):(p.DATA.UserData.updateWorldCoord(cc.v2(a.x,a.y)),t.getInstance().jumpToCoord=p.DATA.UserData.WorldCoord),C.default.Instance().CurSceneName===v.SceneName.WORLD&&(i.log("====>>>>>>>>>>"),u.send(u.Names.WorldMapSetTileView,{x:a.x,y:a.y,s:t.model.SelfServerId,mark:!0}),u.send(u.Names.WorldMapMyCityPosChange,null),P.send(P.Names.WorldMapUpdateTile,t.model.getTileInfoByCoord(a.x,a.y,t.model.SelfServerId)))))},t.prototype.PushWorldMapUseEffectItem=function(e){e&&P.send(P.Names.WorldMapEffectUpdate,e)},t.prototype.clickUIMyMarch=function(e){if(t.model.march.hasOwnProperty(e)){var a=t.model.march[e];if(a.uid===p.DATA.UserData.UID)if(l.Obj.isEmpty(a.armyNode)){var o=_.Instance.getCurMarchProgress(a).curPos;this._clickUIMyMarchId=e,u.send(u.Names.WorldMapSetPointView,o)}else u.send(u.Names.WorldMapShowMarchDetail,e)}},Object.defineProperty(t.prototype,"clickUIMyMarchId",{get:function(){return this._clickUIMyMarchId},set:function(e){this._clickUIMyMarchId=e},enumerable:!0,configurable:!0}),t.prototype.PushTerritoryInfo=function(e){var t=h.default.JSON_PARSE(e);null!==t&&null!=t.t&&I.getInstance().UpdateAllianceTerritory(t.infos,2==t.t)},Object.defineProperty(t.prototype,"march",{get:function(){return t.model.march},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myMarchNum",{get:function(){return t.model.myMarchNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myMarch",{get:function(){return t.model.myMarch},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myMarchNumMAX",{get:function(){return t.model.myMarchNumMAX},enumerable:!0,configurable:!0}),t.prototype.fixWorldMarchInfo=function(e){if(t.model.myMarch.hasOwnProperty(e)){var a=t.model.march[e];if(!l.Obj.isEmpty(a)){if(p.DATA.ServerTime-a.endTime>=2){var o=a.clientFix;if(l.Obj.isEmpty(o)){a.clientFix=!0;var n=this,i={marchId:a.marchId};c.NET.send(d.RequestId.GET_MARCH_INFO,i,this,function(e){var t=e.d;n.PushUserMarchInfo(t)})}}}}},t.prototype.loginInitMyMarchNum=function(e,a){t.model.loginInitMyMarchNum(e,a)},t.prototype.needShowAddAMarchQueueTip=function(){if(D.ExchangeController.Instance.isMonthlyCardCanBuy())return!0;if(p.DATA.UserData.FunctionOn(S.FunctionKey.key_novice_adjustments)){var e=parseInt(h.default.getDataConfigData(950018));if(p.DATA.UserData.getItemAmount(e)>0)return!0;var t=M.default.GetCurScienceDataByGroupId(33e4);if(!t||t.level<25)return!0}else if(!p.DATA.UserData.haveScienceByGroupId(324e3))return!0;return!1},t.prototype.marchToAllianceBuilding=function(e,a){var o=p.DATA.UserData.Alliance.territoryData.getTerritoryItemDataById(e);if(o.CurMarchNum>=o.MaxMarchNum)return f.default.Instance().ShowTips(n.LOCAL.getText("alliance_120562")),!1;for(var i in t.getInstance().myMarch){var r=t.model.march[i];if(r&&(r.target_tx===a.tileX&&r.target_ty===a.tileY))return f.default.Instance().ShowTips(n.LOCAL.getText("alliance_120556")),!1}if(t.getInstance().myMarchNum>=t.getInstance().myMarchNumMAX)return h.default.checkAddWorldMarchQueue(!0),!1;var l=new Array;if(p.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&l.push(new b.BattleArmyData(e.ArmyId,e.Id))}),0===l.length)return f.default.Instance().ShowTips(n.LOCAL.getText("100272")),!1;var c={targetPos:cc.v2(a.tileX,a.tileY),enemyInfo:"",marchType:s.MarchType.ALLIANCE_BUILDING,itemId:a.extData.itemId},d=new b.BattleItemData(p.DATA.UserData.UID,p.DATA.UserData.Name,0,null,p.DATA.UserData.ICONURL,l),u=new b.BattleItemData(0,"",0,null,a.extData.Avatarurl,[]);return p.DATA.CurBattleData=new b.BattleData(b.BattleType.AllianceBuilding,d,u,c),f.default.Instance().ShowMarchPanel(),!0},t.prototype.onFMessage_WorldMapDelayDeleteMarchView=function(e){var a=e.data;if(l.Obj.isEmpty(a))return!0;var o=a,n=t.model.march;if(!n.hasOwnProperty(o))return!0;var i=n[o];return!!l.Obj.isEmpty(i)||(i.clientDelayMark=!0,t.model.setMyMarch(i.marchId,!0),!0)},t}(r.FMessageConnectionAbstract);t.exports=U,cc._RF.pop()},{"../../../../Core/Common/LocalManager":"LocalManager","../../../../Core/Common/TableManager":"TableManager","../../../../Core/Event/EventCenter":"EventCenter","../../../../Core/Net/NetMgr":"NetMgr","../../../../fws/mvc/FWSMvc":"FWSMvc","../../../../fws/utils/FWSTool":"FWSTool","../../../../fws/utils/X":"X","../../../Common/BIManager":"BIManager","../../../Common/UIManager":"UIManager","../../../Const/EventId":"EventId","../../../Const/GameDefine":"GameDefine","../../../Const/RequestId":"RequestId","../../../Const/SceneName":"SceneName","../../../Const/TableName":"TableName","../../../Const/UIDataInfo":"UIDataInfo","../../../Data/BattleData":"BattleData","../../../Data/DataCenter":"DataCenter","../../../Procedure/ProcedureManager":"ProcedureManager","../../../Scene/SceneManager":"SceneManager","../../../Tools/GameTools":"GameTools","../../../Tools/SubPackMsgs":"SubPackMsgs","../../../controllers/ExchangeController":"ExchangeController","../../../controllers/ScienceController":"ScienceController","../WorldMapCommon":"WorldMapCommon","../WorldMapDisplayPools":"WorldMapDisplayPools","../WorldMapEvents":"WorldMapEvents","../WorldMapModel":"WorldMapModel","../WorldMapMsgs":"WorldMapMsgs","./WorldMarchController":"WorldMarchController"}],WorldMapTodoController:[function(e,t,a){"use strict";cc._RF.push(t,"54cb84MA+ZIYpKxKQV4MLss","WorldMapTodoController");var o,n=e("../../../../Core/Common/LocalManager"),i=e("../../../../fws/mvc/FWSMvc"),r=e("../WorldMapCommon"),s=e("../../../Procedure/ProcedureManager"),l=e("../../../Common/UIManager"),c=e("../../../Const/UIDataInfo"),d=e("../../../Scene/SceneManager"),p=e("../../../Const/SceneName"),u=e("../../../Data/DataCenter"),h=e("../../../Module/UI/UserAuthor"),m=e("../worldmapui/WorldMapChooseAreaComponent"),f=e("../WorldMapMsgs"),_=e("../../../Const/GameDefine"),y=e("../../../../Core/Common/TableManager"),g=e("../../../Tools/GameTools"),C=e("../../../Const/TableName"),v=function(e){function t(){var t=e.call(this)||this;return t.type=r.WorldMapToDoType.NONE,t.params={},t.doFlag=!1,t}return __extends(t,e),t.getInstance=function(){return o||(o=new t),o},t.prototype.purge=function(){o=null},Object.defineProperty(t.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),t.prototype.gotoWorldAndDo=function(e,t){if(d.default.Instance().CurSceneName===p.SceneName.WORLD)return this.type=e,this.params=t,this.doFlag=!0,void this.WorldMapEnterTodo();if(u.DATA.UserData.Level<u.DATA.UserData.OpenWorldLevel)l.default.Instance().ShowTips(n.LOCAL.getText("100167",u.DATA.UserData.OpenWorldLevel.toString()));else if(u.DATA.UserData.WorldCoord.x<0||u.DATA.UserData.WorldCoord.y<0){var a=this;h.default.CheckAuthor(function(){a.doGoWorld()},!0)}else this.type=e,this.params=t,this.doFlag=!0,s.PROCE.Run(s.PROCE.World)},t.prototype.doGoWorld=function(){u.DATA.UserData.WorldCoord.x<0||u.DATA.UserData.WorldCoord.y<0?u.DATA.UserData.FunctionOn(_.FunctionKey.AutoChooseArea)?this.AutoChooseArea():m.default.ShowView():s.PROCE.Run(s.PROCE.World)},t.prototype.AutoChooseArea=function(){var e=y.TABLE.getTableGroup(C.TableName.PROVINCE),t=-1;for(var a in e){var o=e[a];-1==t&&(t=o.id),g.default.ObjIsEmpty(o)||g.default.ObjIsEmpty(o.wx)||o.wx.toLocaleLowerCase()==u.DATA.UserData.PlayerInfoData.playerInfo.province.toLocaleLowerCase()&&(t=o.id)}-1!=t&&window&&window.WMC?window.WMC.chooseWorldArea(t):m.default.ShowView()},t.prototype.onFMessage_WorldMapEnterTodo=function(e){return this.WorldMapEnterTodo(),!1},t.prototype.WorldMapEnterTodo=function(){if(this.doFlag=!1,d.default.Instance().CurSceneName===p.SceneName.WORLD)switch(this.type){case r.WorldMapToDoType.POWER_RANK:l.default.Instance().OpenUI(c.UIDataInfo.PowerRankPanel);break;case r.WorldMapToDoType.MONSTER_SEARCH:l.default.Instance().OpenUI(c.UIDataInfo.WorldUIMonsterSearch,this.params);break;case r.WorldMapToDoType.WORLD_BUILD_BUILDING:f.send(f.Names.AddWorldItem,this.params);break;case r.WorldMapToDoType.MOVE_TO:f.send(f.Names.WorldMapSetTileView,this.params);break;case r.WorldMapToDoType.WORLD_MAP_UI_HIDE:f.send(f.Names.WorldMapUIHide,this.params)}},t}(i.FMessageConnectionAbstract);t.exports=v,cc._RF.pop()},{"../../../../Core/Common/LocalManager":"LocalManager","../../../../Core/Common/TableManager":"TableManager","../../../../fws/mvc/FWSMvc":"FWSMvc","../../../Common/UIManager":"UIManager","../../../Const/GameDefine":"GameDefine","../../../Const/SceneName":"SceneName","../../../Const/TableName":"TableName","../../../Const/UIDataInfo":"UIDataInfo","../../../Data/DataCenter":"DataCenter","../../../Module/UI/UserAuthor":"UserAuthor","../../../Procedure/ProcedureManager":"ProcedureManager","../../../Scene/SceneManager":"SceneManager","../../../Tools/GameTools":"GameTools","../WorldMapCommon":"WorldMapCommon","../WorldMapMsgs":"WorldMapMsgs","../worldmapui/WorldMapChooseAreaComponent":"WorldMapChooseAreaComponent"}],WorldMarchController:[function(e,t,a){"use strict";cc._RF.push(t,"023f3VBSKFPl5Zphqt3dMYW","WorldMarchController");var o=e("../../../../fws/mvc/FWSMvc"),n=e("../WorldMapCommon"),i=e("../../../Data/DataCenter"),r=e("../../../../fws/utils/FWSTool"),s=e("../WorldMapCommon"),l=function(e){function t(){var t=e.call(this)||this;return t.connect(),t}return __extends(t,e),t.prototype.checkDelayDelete=function(e){var t=!1;if(r.Obj.isEmpty(e))return t;var a=i.DATA.ServerFloatTime,o=e.endTime;return r.Obj.isEmpty(o)||a-o>=s.MARCH_TIMEOUT_DELETE_DELAY&&(t=!0),t},t.prototype.isShowBattleEffect=function(e){var t=!1;return r.Obj.isEmpty(t)?t:t=e.marchState===n.MarchState.MARCHING&&(n.MarchType.BATTLE===e.marchType||n.MarchType.ATTACK_MONSTER===e.marchType||n.MarchType.ATTACK_WORLDBOSS===e.marchType)},t.prototype.CanSpeedUp=function(e){return e==n.MarchState.MARCHING||e==n.MarchState.RETURNING},t.prototype.getCurMarchProgress=function(e){var t=cc.v2(e.screenStartX,e.screenStartY),a=cc.v2(e.screenStartX,e.screenStartY),o=cc.v2(e.screenEndX,e.screenEndY),r=i.DATA.ServerFloatTime,s=e.beginTime,l=e.endTime,c=l-s,d=0;return r<s||(r<l&&r>=s?(d=(r-s)/c,t=a.lerp(o,d)):r>=l&&(d=1,t=cc.v2(e.screenEndX,e.screenEndY),c)),e.marchState===n.MarchState.RALLY_ASSEMBLED&&(t=a,d=0),{curPos:t,rate:d,totalTime:c}},t.prototype.getCurMarchPos=function(e){var t=cc.v2(e.screenStartX,e.screenStartY),a=cc.v2(e.screenStartX,e.screenStartY),o=cc.v2(e.screenEndX,e.screenEndY),n=i.DATA.ServerTime,r=e.beginTime,s=e.endTime;if(n<s&&n>=r){var l=(n-r)/(s-r);t=a.lerp(o,l)}else n>=r&&(t=cc.v2(e.screenEndX,e.screenEndX));return t},t.prototype.checkNeedUpdateView=function(e,t){return!(e.marchState===t.marchState&&e.marchType===t.marchType&&e.marchStartTime===t.marchStartTime&&e.marchArrive===t.marchArrive&&e.returnStartTime===t.returnStartTime&&e.returnArriveTime===t.returnArriveTime&&e.begin_bx===t.begin_bx&&e.begin_by===t.begin_by&&e.begin_bk===t.begin_bk&&e.target_tx===t.target_tx&&e.target_ty===t.target_ty&&e.target_tk===t.target_tk)},t.prototype.checkCanReturn=function(e){return null!=e&&(e.marchState!==s.MarchState.RETURNING&&(e.marchState!=n.MarchState.MARCHING||e.marchType!==n.MarchType.ALLIANCE_RALLY_BATTLE&&e.marchType!==n.MarchType.ALLIANCE_SUPER_RALLY_BATTLE))},Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.purge=function(){t._instance=null},t}(o.FMessageConnectionAbstract);t.exports=l,cc._RF.pop()},{"../../../../fws/mvc/FWSMvc":"FWSMvc","../../../../fws/utils/FWSTool":"FWSTool","../../../Data/DataCenter":"DataCenter","../WorldMapCommon":"WorldMapCommon"}],TerrainUtils:[function(e,t,a){"use strict";cc._RF.push(t,"f26dduWIpJKK5gVd/hjr+Sy","TerrainUtils");var o,n=e("../../../../fws/utils/X"),i=e("../../../../fws/utils/FWSTool");(function(e){var t,a;function o(e,o,n){void 0===o&&(o=0),void 0===n&&(n=0);var r=a.None,s=i.Enum.contain(e,t.LeftTop),l=i.Enum.contain(e,t.LeftBottom),c=i.Enum.contain(e,t.RightTop),d=i.Enum.contain(e,t.RightBottom),p=i.Enum.contain(e,t.Left),u=i.Enum.contain(e,t.Right),h=i.Enum.contain(e,t.Top),m=i.Enum.contain(e,t.Bottom);return(p||s||h)&&(r|=a.LeftTop),(h||c||u)&&(r|=a.RightTop),(u||d||m)&&(r|=a.RightBottom),(p||l||m)&&(r|=a.LeftBottom),r}function r(e){var t=["","","",""];return t[0]=i.Enum.contain(e,a.LeftTop)?"O":".",t[1]=i.Enum.contain(e,a.RightTop)?"O":".",t[2]=i.Enum.contain(e,a.LeftBottom)?"O":".",t[3]=i.Enum.contain(e,a.RightBottom)?"O":".",{row1:t[0]+t[1],row2:t[2]+t[3]}}e.TileImageNames={2:"01",8:"02",4:"03",1:"04",3:"05",10:"06",12:"07",5:"08",13:"09",7:"10",11:"11",14:"12",6:"13",9:"14",15:"15"},function(e){e[e.None=0]="None",e[e.LeftTop=1]="LeftTop",e[e.Top=2]="Top",e[e.RightTop=4]="RightTop",e[e.Right=8]="Right",e[e.RightBottom=16]="RightBottom",e[e.Bottom=32]="Bottom",e[e.LeftBottom=64]="LeftBottom",e[e.Left=128]="Left",e[e.Center=256]="Center",e[e.Full=511]="Full"}(t=e.TerrainTileFlags||(e.TerrainTileFlags={})),function(e){e[e.None=0]="None",e[e.LeftTop=1]="LeftTop",e[e.RightTop=2]="RightTop",e[e.LeftBottom=4]="LeftBottom",e[e.RightBottom=8]="RightBottom",e[e.LeftTop_RightTop=3]="LeftTop_RightTop",e[e.RightTop_RightBottom=10]="RightTop_RightBottom",e[e.RightBottom_LeftBottom=12]="RightBottom_LeftBottom",e[e.LeftTop_LeftBottom=5]="LeftTop_LeftBottom",e[e.LeftTop_LeftBottom_RightBottom=13]="LeftTop_LeftBottom_RightBottom",e[e.LeftTop_RightTop_LeftBottom=7]="LeftTop_RightTop_LeftBottom",e[e.LeftTop_RightTop_RightBottom=11]="LeftTop_RightTop_RightBottom",e[e.RightTop_RightBottom_LeftBottom=14]="RightTop_RightBottom_LeftBottom",e[e.RightTop_LeftBottom=6]="RightTop_LeftBottom",e[e.LeftTop_RightBottom=9]="LeftTop_RightBottom",e[e.ALL=15]="ALL"}(a=e.TerrainDirectFlags||(e.TerrainDirectFlags={})),e.convertoDirectFlags=o,e.getDirectFlagsText=r;var s=function(){function e(e,t){this._rows=e,this._cols=t,this.clear()}return e.prototype.clear=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),e&&(this._cells=[]),t&&(this._addons=[])},e.prototype.getIndex=function(e,t){var a=null;if((t+e)%2==0){var o=e;t%2==1&&o--,a=o+t*this._cols}return a},e.prototype.getAddonPos=function(e,t,a,o,n){if((e+t)%2!=0)return n.call(this,e,t);var i=0,r=0;-1===a&&-1===o?(r=-2,i=0):-1===a&&1===o?(r=0,i=2):-1===a&&0===o?(r=-1,i=1):1===a&&1===o?(r=2,i=0):1===a&&-1===o?(r=0,i=-2):1===a&&0===o?(r=1,i=-1):0===a&&1===o?(r=1,i=1):0===a&&-1===o&&(r=-1,i=-1);var s=t+i,l=e+r;return n.call(this,l,s)},e.prototype.getAddonIndex=function(e,t,a,o){var n=null;if((e+t)%2!=0)return n;return n=this.getAddonPos(e,t,a,o,this.getIndex)},e.prototype.getCell=function(e,t){return this._cells[this.getIndex(e,t)]},e.prototype.setCell=function(e,a,o){void 0===o&&(o=!0);this._cells[this.getIndex(e,a)]=o?t.Left|t.Right|t.Top|t.Bottom|t.Center|t.LeftTop|t.LeftBottom|t.RightTop|t.RightBottom:t.None,this.updateAddons(e,a,o)},e.prototype.updateAddons=function(e,t,a){void 0===a&&(a=!0),a?this.addAddonsByCell(e,t):this.removeAddonsByCell3x3(e,t)},e.prototype.checkCellExist=function(e,a,o,n){void 0===o&&(o=0),void 0===n&&(n=0);var i=!1,r=this.getAddonIndex(e,a,o,n);return this._cells[r]===t.Full&&(i=!0),i},e.prototype.setAddonFlag=function(e,t,a,o,n){var i=this.getAddonIndex(e,t,a,o),r=this._addons[i];r|=n,this._addons[i]=r},e.prototype.removeAddonsByCell3x3=function(e,t){this.getAddonPos(e,t,0,0,this.removeAddonsByCell),(e+t)%2==0&&(this.getAddonPos(e,t,-1,0,this.removeAddonsByCell),this.getAddonPos(e,t,0,0,this.removeAddonsByCell),this.getAddonPos(e,t,1,0,this.removeAddonsByCell),this.getAddonPos(e,t,-1,-1,this.removeAddonsByCell),this.getAddonPos(e,t,0,-1,this.removeAddonsByCell),this.getAddonPos(e,t,1,-1,this.removeAddonsByCell),this.getAddonPos(e,t,-1,1,this.removeAddonsByCell),this.getAddonPos(e,t,0,1,this.removeAddonsByCell),this.getAddonPos(e,t,1,1,this.removeAddonsByCell))},e.prototype.removeAddonsByCell=function(e,a){var o=t.None;o|=this.checkCellExist(e,a,-1,-1)?t.LeftTop:t.None,o|=this.checkCellExist(e,a,-1,1)?t.LeftBottom:t.None,o|=this.checkCellExist(e,a,1,-1)?t.RightTop:t.None,o|=this.checkCellExist(e,a,1,1)?t.RightBottom:t.None,o|=this.checkCellExist(e,a,-1,0)?t.Left:t.None,o|=this.checkCellExist(e,a,1,0)?t.Right:t.None,o|=this.checkCellExist(e,a,0,-1)?t.Top:t.None,o|=this.checkCellExist(e,a,0,1)?t.Bottom:t.None;var n=this.getIndex(e,a);this._addons[n]=o},e.prototype.addAddonsByCell=function(e,a){this.setAddonFlag(e,a,-1,-1,t.RightBottom),this.setAddonFlag(e,a,-1,0,t.Right),this.setAddonFlag(e,a,-1,1,t.RightTop),this.setAddonFlag(e,a,1,-1,t.LeftBottom),this.setAddonFlag(e,a,1,0,t.Left),this.setAddonFlag(e,a,1,1,t.LeftTop),this.setAddonFlag(e,a,0,-1,t.Bottom),this.setAddonFlag(e,a,0,1,t.Top)},e.prototype.getResult=function(e,a,o,n){return void 0===o&&(o=0),void 0===n&&(n=0),this.checkCellExist(e,a,o,n)?t.Full:this._addons[this.getAddonIndex(e,a,o,n)]},e.prototype.trace=function(e,t,a,i){var s=r(o(this.getResult(e,t,a,i)));n.log(s.row1+"\n"+s.row2)},e}();e.TerrainLayer=s})(o||(o={})),window.TerrainUtils=o,t.exports=o,cc._RF.pop()},{"../../../../fws/utils/FWSTool":"FWSTool","../../../../fws/utils/X":"X"}],WorldMapChooseAreaCellComponent:[function(e,t,a){"use strict";cc._RF.push(t,"7a363n49c9NSIrlSScvaVdL","WorldMapChooseAreaCellComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../../System/ComponentBase"),n=e("../../../../Core/Common/LocalManager"),i=cc._decorator,r=i.ccclass,s=i.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.arenaLabel=null,t.chooseNode=null,t._index=-1,t._parentComponent=null,t}return __extends(t,e),t.prototype.cpnLoad=function(){},t.prototype.cpnEnable=function(){},t.prototype.cpnDisable=function(){},t.prototype.init=function(e,t,a){this._index=e,this.arenaLabel.string=n.LOCAL.getText(t),this._parentComponent=a,this.arenaLabel.node.color=a.SelIndex==this._index?cc.Color.BLACK:cc.Color.WHITE,this.chooseNode.active=a.SelIndex==this._index},t.prototype.onBtnClickChoose=function(){this._parentComponent.setIndex(this._index)},__decorate([s(cc.Label)],t.prototype,"arenaLabel",void 0),__decorate([s(cc.Node)],t.prototype,"chooseNode",void 0),t=__decorate([r],t)}(o.default);a.default=l,cc._RF.pop()},{"../../../../Core/Common/LocalManager":"LocalManager","../../../../System/ComponentBase":"ComponentBase"}],WorldMapChooseAreaComponent:[function(e,t,a){"use strict";cc._RF.push(t,"2c99eBYuCpGZbmu3v3MxzVC","WorldMapChooseAreaComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../../Core/Common/LocalManager"),n=e("./WorldMapChooseAreaCellComponent"),i=e("../../../../Core/Common/TableManager"),r=e("../../../Common/UIManager"),s=e("../../../Const/UIDataInfo"),l=e("../../../Common/BaseUI"),c=e("../../../Data/DataCenter"),d=e("../../../Tools/GameTools"),p=e("../../../../fws/utils/X"),u=e("../../../Const/TableName"),h=cc._decorator,m=h.ccclass,f=h.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.worldArenaScrollView=null,t.content=null,t.item=null,t.curArenaLabel=null,t.labTitle=null,t.labContent=null,t._Delegate=null,t._CallBack=null,t._type=0,t._searchMonsterParam=null,t._selIndex=-1,t._curShow="",t._config=null,t._cellData=[],t}return __extends(t,e),t.ShowView=function(){c.DATA.UserData.FunctionOn("change_flag")&&0==c.DATA.UserData.ChangeNationalFlagTimes?r.default.Instance().OpenUI(s.UIDataInfo.ChangeNationalPanel,"JumpToWorld"):r.default.Instance().OpenUI(s.UIDataInfo.WorldUIChooseArea)},t.ShowViewMonsterSearching=function(e){r.default.Instance().OpenUI(s.UIDataInfo.WorldUIChooseArea,e)},t.ShowChangeAreaView=function(e,t,a,o,n){r.default.Instance().OpenUI(s.UIDataInfo.WorldUIChooseArea,e,t,a,o,n)},t.prototype.cpnLoad=function(){e.prototype.cpnLoad.call(this)},t.prototype.onShow=function(t){if(e.prototype.onShow.call(this,t),this._searchMonsterParam=null,t.length>=2?(this._Delegate=t[0],this._CallBack=t[1],this.labContent.string=o.LOCAL.getText("100473"),t.length>=3&&void 0!==t[2]&&(this._type=t[2]),t.length>=4&&void 0!==t[3]&&(this.labTitle.string=t[3]),t.length>=5&&void 0!==t[4]&&(this.labContent.string=t[4])):1==t.length&&(this._searchMonsterParam=t[0]),1===this._type&&this._cellData.push({id:-1,name:o.LOCAL.getText("100314")}),this._config=i.TABLE.getTableGroup(u.TableName.PROVINCE),this._config)for(var a in this._config){var n=this._config[a];this._cellData.push({id:n.id,name:n.name})}if(!d.default.ObjIsEmpty(c.DATA.UserData.PlayerInfoData)&&!d.default.ObjIsEmpty(c.DATA.UserData.PlayerInfoData.playerInfo.province))for(var r=0;r<this._cellData.length;r++){var s=this._cellData[r],l=i.TABLE.getTableDataById(u.TableName.PROVINCE,s.id.toString());if(!d.default.ObjIsEmpty(l)&&!d.default.ObjIsEmpty(l.wx)&&l.wx.toLocaleLowerCase()==c.DATA.UserData.PlayerInfoData.playerInfo.province.toLocaleLowerCase())return this._curShow=this._cellData[r].name,this._selIndex=r,void(this.curArenaLabel.string=o.LOCAL.getText(this._curShow))}this._cellData.length>0&&(this._curShow=this._cellData[0].name,this._selIndex=0),this.curArenaLabel.string=o.LOCAL.getText(this._curShow)},t.prototype.onBtnClickChoose=function(){this.worldArenaScrollView.active=!0,this.content.safetyDestroyAllChildren();for(var e=0;e<this._cellData.length;e++){var t=cc.instantiate(this.item);this.content.addChild(t);var a=t.getComponent(n.default);a&&a.init(e,this._cellData[e].name||"",this)}},t.prototype.onBtnClickGo=function(e){var t=this._cellData[this._selIndex].id;null==this._Delegate||null==this._CallBack?window&&window.WMC?null!=this._searchMonsterParam?window.WMC.chooseWorldArea(t,this._searchMonsterParam):window.WMC.chooseWorldArea(t):p.log("window[WMC]\u4e0d\u5b58\u5728"):this._CallBack.call(this._Delegate,t),this.onClose(e)},t.prototype.setIndex=function(e){this._selIndex=e,this._curShow=this._cellData[this._selIndex].name,this.curArenaLabel.string=o.LOCAL.getText(this._curShow),this.worldArenaScrollView.active=!1},Object.defineProperty(t.prototype,"SelIndex",{get:function(){return this._selIndex},enumerable:!0,configurable:!0}),__decorate([f(cc.Node)],t.prototype,"worldArenaScrollView",void 0),__decorate([f(cc.Node)],t.prototype,"content",void 0),__decorate([f(cc.Node)],t.prototype,"item",void 0),__decorate([f(cc.Label)],t.prototype,"curArenaLabel",void 0),__decorate([f(cc.Label)],t.prototype,"labTitle",void 0),__decorate([f(cc.Label)],t.prototype,"labContent",void 0),t=__decorate([m],t)}(l.default);a.default=_,cc._RF.pop()},{"../../../../Core/Common/LocalManager":"LocalManager","../../../../Core/Common/TableManager":"TableManager","../../../../fws/utils/X":"X","../../../Common/BaseUI":"BaseUI","../../../Common/UIManager":"UIManager","../../../Const/TableName":"TableName","../../../Const/UIDataInfo":"UIDataInfo","../../../Data/DataCenter":"DataCenter","../../../Tools/GameTools":"GameTools","./WorldMapChooseAreaCellComponent":"WorldMapChooseAreaCellComponent"}],WorldMapMonsterSearchCellComponent:[function(e,t,a){"use strict";cc._RF.push(t,"8f7c77dFE1CNqRMARM4MWPm","WorldMapMonsterSearchCellComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../../System/ComponentBase"),n=e("../../../../Core/Common/TableManager"),i=e("../../../../Core/Utils/UpdateSpriteFrame"),r=e("./WorldMapMonsterSearchComponent"),s=e("../../../Common/UIManager"),l=e("../../../Const/UIDataInfo"),c=e("../../../Tools/GameTools"),d=e("../../../../Core/Common/LocalManager"),p=e("../../../../fws/utils/FWSTool"),u=e("../../../Const/TableName"),h=cc._decorator,m=h.ccclass,f=h.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.backGroundSprite=null,t.iconSprite=null,t.namelabel=null,t.checkmark=null,t._data=null,t}return __extends(t,e),t.prototype.cpnLoad=function(){this.cpnNodeOn(this.iconSprite.node,cc.Node.EventType.TOUCH_END,this.Click,this)},t.prototype.init=function(e){this._data=e;var t=this._data.icon;i.UpdateSpriteFrame(t,this.iconSprite);var a=p.Obj.getPropertyNumberByNames(this._data,null,"x"),o=p.Obj.getPropertyNumberByNames(this._data,null,"y");p.Obj.isEmpty(a)||(this.iconSprite.node.x=a),p.Obj.isEmpty(o)||(this.iconSprite.node.y=o),this.namelabel.string=d.LOCAL.getText(e.name)},t.prototype.getId=function(){return this._data.id},t.prototype.getType=function(){return this._data.type},t.prototype.setGary=function(e){e?(this.iconSprite.setState(cc.Sprite.State.GRAY),this.backGroundSprite.setState(cc.Sprite.State.GRAY),this.checkmark.active=!e):(this.iconSprite.setState(cc.Sprite.State.NORMAL),this.backGroundSprite.setState(cc.Sprite.State.NORMAL),this.checkmark.active=!e)},t.prototype.Click=function(e){if(!(e.getStartLocation().sub(e.getLocation()).mag()>20)){var t=0;if(1==r.default._type?t=r.default.selectMonsterId:2==r.default._type?t=r.default.selectResId:3==r.default._type&&(t=r.default.selectAssembleMonsterId),t!=this.getId()||3!=r.default._type&&1!=r.default._type){if(t==this.getId()&&2==r.default._type){var a=n.TABLE.getTableDataById(u.TableName.RESOURCE,this.getId().toString());c.default.ObjIsEmpty(a)||s.default.Instance().OpenUI(l.UIDataInfo.DetailDesPanel,this.node,a.name,a.desc)}}else{var o=n.TABLE.getTableDataById(u.TableName.MONSTER_GROUP,this.getId().toString());c.default.ObjIsEmpty(o)||s.default.Instance().OpenUI(l.UIDataInfo.DetailDesPanel,this.node,o.name,o.desc)}}},__decorate([f(cc.Sprite)],t.prototype,"backGroundSprite",void 0),__decorate([f(cc.Sprite)],t.prototype,"iconSprite",void 0),__decorate([f(cc.Label)],t.prototype,"namelabel",void 0),__decorate([f(cc.Node)],t.prototype,"checkmark",void 0),t=__decorate([m],t)}(o.default);a.default=_,cc._RF.pop()},{"../../../../Core/Common/LocalManager":"LocalManager","../../../../Core/Common/TableManager":"TableManager","../../../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../../../System/ComponentBase":"ComponentBase","../../../../fws/utils/FWSTool":"FWSTool","../../../Common/UIManager":"UIManager","../../../Const/TableName":"TableName","../../../Const/UIDataInfo":"UIDataInfo","../../../Tools/GameTools":"GameTools","./WorldMapMonsterSearchComponent":"WorldMapMonsterSearchComponent"}],WorldMapMonsterSearchComponent:[function(e,t,a){"use strict";cc._RF.push(t,"4db65OfaAVO0pFvAZERiHRm","WorldMapMonsterSearchComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../../Core/Common/LocalManager"),n=e("../../../Common/BaseUI"),i=e("../../../../fws/utils/X"),r=e("../../../../Core/Common/TableManager"),s=e("../../../Data/DataCenter"),l=e("./WorldMapMonsterSearchCellComponent"),c=e("../../../../Core/Net/NetMgr"),d=e("../../../Const/RequestId"),p=e("../../../Tools/GameTools"),u=e("../WorldMapMsgs"),h=e("../../../../fws/utils/FWSTool"),m=e("../controllers/WorldMapController"),f=e("../../../Common/UIManager"),_=e("../../../Common/TaskGuide"),y=e("../../../Const/GameDefine"),g=e("../../../../fws/platforms/PlatformCore"),C=e("../../../controllers/ActivityController"),v=e("../../../Const/TableName"),I=cc._decorator,T=I.ccclass,S=I.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.levelLabel=null,t.starNode=null,t.starNumNode=null,t.levelSlider=null,t.sliderMaskNode=null,t.typeToggleContainer=null,t.toggleItemMonster=null,t.toggleItemRes=null,t.MonsterToggle=null,t.ResToggle=null,t.AssembleMonsterToggle=null,t.timeLabel=null,t._maxStarNum=5,t._minStarNum=1,t.hammer_endTime=0,t.hammer_endCfg=[],t.pengpeng_endTime=0,t.pengpeng_endCfg=[],t.SearchType=0,t.SearchLevel=0,t.SearchId=0,t._showIndex=-1,t._maxLevel=0,t._minLevel=0,t.assembleMonsterMaxLevel2=-1,t}var a;return __extends(t,e),a=t,t.prototype.cpnLoad=function(){e.prototype.cpnLoad.call(this)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),this._maxStarNum=5,this._minStarNum=1,this.init(),p.default.isKVK&&this.levelChange();for(var o=0;o<a.assembleMonsterList.length;o++)6==a.assembleMonsterList[o].id&&a.assembleMonsterList.splice(o,1);if(!p.default.isKVK()&&C.ActivityController.Instance.getLimitHammerBossExchangeActivityId("4")>0){var n=r.TABLE.getTableDataById(v.TableName.MONSTER_GROUP,"6"),s=parseFloat(h.Obj.getPropertyStringByNames(n,"0","x_para")),l=parseFloat(h.Obj.getPropertyStringByNames(n,"0","y_para")),c={id:n.id,icon:n.icon_big,name:n.name,type:3,x:s,y:l,order:n.search_order};a.assembleMonsterList.push(c)}if(t&&t[0]){var d=h.Obj.getPropertyByNames(t[0],1,"type"),u=h.Obj.getPropertyByNames(t[0],null,"monster_group_id");null!==u&&(1==d?a.selectMonsterId=u:2==d?a.selectResId=u:a.selectAssembleMonsterId=u),i.log(u);var m=h.Obj.getPropertyByNames(t[0],null,"monster_level");null!==m&&(a.selectLevel=m);var f=h.Obj.getPropertyByNames(t[0],null,"type");null!==f&&(a._type=f)}else if(null!=_.default.Instance&&null!=_.default.Instance.GuideTaskData){var y=_.default.Instance.GuideTaskData,g=y.condition;201==g?(a._type=1,y.condition_id>0&&(a.selectMonsterId=y.condition_id)):202==g?(a._type=1,y.condition_id>0&&(a.selectMonsterId=y.condition_id),y.condition_num>0&&(a.selectLevel=y.condition_num,a.selectMonsterLevel=a.selectLevel)):203==g?(a._type=2,7==y.condition_id&&(a.selectResId=701)):204==g&&y.condition_id>0&&(a.selectLevel=y.condition_id,a.selectMonsterLevel=a.selectLevel)}var I=r.TABLE.getTableDataById(v.TableName.DATACONFIG,"36001");I&&""!=I.value&&(this.hammer_endCfg=I.value.split("|")),this.pengpeng_endCfg=p.default.isKVK()?[]:["0","180","360","540","720","900","1080","1260"],2===a._type?(this.ResToggle.isChecked=!0,this.MonsterToggle.isChecked=!1,this.AssembleMonsterToggle.isChecked=!1):3===a._type?(this.ResToggle.isChecked=!1,this.MonsterToggle.isChecked=!1,this.AssembleMonsterToggle.isChecked=!0):this.initPanel(),this.cpnScheduleOnce(this,this.updateScrollViewOffset,.1)},t.prototype.cpnStart=function(){},t.prototype.addBtnClick=function(e){p.default.isKVK()&&[1,3].indexOf(a._type)>=0?(a.nowStarNum+=1,a.nowStarNum=Math.min(a.nowStarNum,this._maxStarNum)):3===a._type?a.selectLevel+10<=this._maxLevel&&(a.selectLevel+=10):a.selectLevel+1<=this._maxLevel&&++a.selectLevel,this.levelChange()},t.prototype.subBtnClick=function(e){p.default.isKVK()&&[1,3].indexOf(a._type)>=0?(a.nowStarNum-=1,a.nowStarNum=Math.max(a.nowStarNum,this._minStarNum)):3===a._type?a.selectLevel-10>=this._minLevel&&(a.selectLevel-=10):a.selectLevel-1>=this._minLevel&&--a.selectLevel,this.levelChange()},t.prototype.sliderEvent=function(e,t,a){this.peogressChange()},t.prototype.onMonsterTabClick=function(){a._type=1,this.initPanel()},t.prototype.onResTabClick=function(){a._type=2,this.initPanel()},t.prototype.onAssembleMonsterTabClick=function(){a._type=3,1==a.assembleMonsterMaxLevel||-1==this.assembleMonsterMaxLevel2?this.getAssembleMonsterMaxLevel():this.initPanel()},t.prototype.typeToggleContainerEvent=function(e){var t=e.getComponent(l.default);t&&(a._type==t.getType()&&1==a._type?a.selectMonsterId=t.getId():a._type==t.getType()&&2==a._type?a.selectResId=t.getId():a._type==t.getType()&&3==a._type&&(a.selectAssembleMonsterId=t.getId(),6==t.getId()?this._maxLevel=this.assembleMonsterMaxLevel2:this._maxLevel=a.assembleMonsterMaxLevel,this.cpnUpdate1000MS(0)));for(var o=0;o<this.typeToggleContainer.node.childrenCount;o++){var n=this.typeToggleContainer.node.children[o],i=n!==e.node,r=n.getComponent(l.default);r&&r.setGary(i)}},t.prototype.onBtnClickMonsterSearch=function(e){g.instance.postStatsEvent("world_search_monster");var t=a.selectMonsterId,n=a._type,i=a.selectLevel;2===a._type?t=a.selectResId:3===a._type&&6==(t=a.selectAssembleMonsterId)&&(n=4);var r=null,l=null;p.default.isKVK()&&[1,3].indexOf(a._type)>=0?(p.default.starConfig||p.default.getKvkStarNum(1),1==a._type?a.nowMonsterNum=a.nowStarNum:a.nowAssemblyStarNum=a.nowStarNum,r={minLevel:Number(p.default.starConfig[a.nowStarNum-1].min),maxLevel:Number(p.default.starConfig[a.nowStarNum-1].max),groupType:t,pointType:n},l=d.RequestId.WORLD_SEARCH_MONSTER):(l=d.RequestId.WORLD_SEARCH_MONSTER,r={minLevel:i,maxLevel:i,groupType:t,pointType:n}),c.NET.send(l,r,this,function(e){f.default.Instance().CloseAllUI();var t=!1;do{var n=p.default.JSON_PARSE(e.d);if(null==n)break;var i=h.Obj.getPropertyByNames(n,null,"point");if(null===i)break;var r=h.Obj.getPropertyByNames(i,null,"x"),l=h.Obj.getPropertyByNames(i,null,"y");if(null===r||null===l)break;t=!0;var c=m.model.SelfServerId;if(s.DATA.UserData.Level<=10&&1==a._type){var d=cc.v2(r,l);u.send(u.Names.WorldMapJumpToTileClick,d)}else{var _={x:r,y:l,s:c,mark:!0};u.send(u.Names.WorldMapSetTileView,_)}}while(0);t||f.default.Instance().ShowTips(o.LOCAL.getText("100474"))})},t.prototype.getAssembleMonsterMaxLevel=function(){var e=this;c.NET.send(d.RequestId.SEARCH_HAMMER_BOSS_MAXLEVEL,{},this,function(t){if(t&&t.d){var o=p.default.JSON_PARSE(t.d);if(null!==o&&p.default.verifyComponent(e)){var n=10*Math.floor(h.Obj.getPropertyNumberByNames(o,1,"level")/10);n<10&&(n=10),a.assembleMonsterMaxLevel=n;var i=10*Math.floor(h.Obj.getPropertyNumberByNames(o,1,"aprilLevel")/10);i<10&&(i=10),e.assembleMonsterMaxLevel2=i}}e.initPanel()})},t.prototype.onBtnClose=function(t){e.prototype.onClose.call(this,t)},t.prototype.peogressChange=function(){if(p.default.isKVK()&&[1,3].indexOf(a._type)>=0){var e=this.levelSlider.progress,t=this._maxStarNum*e;a.nowStarNum=Math.round(t),a.nowStarNum=Math.min(Math.max(a.nowStarNum,this._minStarNum),this._maxStarNum),this.levelSlider.progress=a.nowStarNum/this._maxStarNum}else{e=this.levelSlider.progress;var n=(this._maxLevel-this._minLevel)*e+this._minLevel;n=3===a._type?10*Math.round(n/10):Math.round(n),a.selectLevel=n,1===a._type?a.selectMonsterLevel=a.selectLevel:3===a._type&&(a.selectAssembleMonsterLevel=a.selectLevel),this.levelLabel.string=o.LOCAL.getText("102214")+a.selectLevel.toString()}this.updateStartNode();var i=this.levelSlider.node.getContentSize();i.width*=this.levelSlider.progress,this.sliderMaskNode.setContentSize(i)},t.prototype.levelChange=function(){if(p.default.isKVK()&&[1,3].indexOf(a._type)>=0)this.levelSlider.progress=a.nowStarNum/this._maxStarNum;else{if(this._maxLevel===this._minLevel)this.levelSlider.progress=1;else{var e=(a.selectLevel-this._minLevel)/(this._maxLevel-this._minLevel);this.levelSlider.progress=e}1===a._type?a.selectMonsterLevel=a.selectLevel:3===a._type&&(a.selectAssembleMonsterLevel=a.selectLevel),this.levelLabel.string=o.LOCAL.getText("102214")+a.selectLevel.toString()}this.updateStartNode();var t=this.levelSlider.node.getContentSize();t.width*=this.levelSlider.progress,this.sliderMaskNode.setContentSize(t)},t.prototype.updateStartNode=function(){if(p.default.isKVK()&&[1,3].indexOf(a._type)>=0){this.starNode.active=!0,this.levelLabel.node.active=!1;for(var e=0;e<this.starNumNode.childrenCount;e++)this.starNumNode.children[e].active=e<a.nowStarNum}else this.starNode.active=!1,this.levelLabel.node.active=!0},t.prototype.init=function(){if(!a.isInitConfig){a.nowStarNum=1,a.isInitConfig=!0;var e=r.TABLE.getTableGroup(v.TableName.MONSTER_REFRESH),t=0,o=0;if(e)for(var n in e){(_=e[n]).level_relative>o&&(o=_.level_relative),_.level_relative<t&&(t=_.level_relative)}a.monsterMaxLevelOffset=o,a.monsterMinLevelOffset=t;var i=r.TABLE.getTableGroup(v.TableName.MONSTER_GROUP);if(i){var l=null;for(var n in i){if(void 0==(_=i[n]).search_show||0!=Number(_.search_show)){var c=_.icon_big,d=parseFloat(h.Obj.getPropertyStringByNames(_,"0","x_para")),u=parseFloat(h.Obj.getPropertyStringByNames(_,"0","y_para")),m={id:_.id,icon:c,name:_.name,type:1,x:d,y:u,order:_.search_order};p.default.isKVK()?11==_.search_show?a.monsterList.push(m):12==_.search_show&&(m.type=3,a.assembleMonsterList.push(m)):s.DATA.UserData.FunctionOn(y.FunctionKey.key_novice_adjustments)?21==_.search_show?a.monsterList.push(m):22==_.search_show&&(m.type=3,a.assembleMonsterList.push(m)):1==_.search_show?a.monsterList.push(m):2==_.search_show&&(m.type=3,a.assembleMonsterList.push(m))}}a.monsterList.sort(function(e,t){return t.order-e.order}),a.monsterList[0]&&(l=a.monsterList[0].id),null!==l&&(a.selectMonsterId=l)}var f=r.TABLE.getTableGroup(v.TableName.RESOURCE);if(f)for(var n in f){var _=f[n];if(p.default.isKVK()){if(2!=_.is_visible)continue}else if(1!=_.is_visible)continue;c="image/world_unit/"+_.model,d=parseFloat(h.Obj.getPropertyStringByNames(_,"0","x_para")),u=parseFloat(h.Obj.getPropertyStringByNames(_,"0","y_para")),m={id:_.id,icon:c,name:_.name,type:2,x:d,y:u};a.resList.push(m)}var g=s.DATA.UserData.getLocalData(y.LocalDataKey.SearchMonsterLevelWin,null);g&&g.myLevel&&g.myLevel==s.DATA.UserData.Level&&g.monsterLevel?a.selectLevel=Number(g.monsterLevel):a.selectLevel=Math.min(s.DATA.UserData.Level,s.DATA.UserData.getMergeArmyScieneMaxLevel())-2,a.selectMonsterLevel=a.selectLevel,a.selectAssembleMonsterLevel=10*Math.floor(a.selectLevel/10),a.selectAssembleMonsterLevel=Math.min(a.selectAssembleMonsterLevel,10)}},t.prototype.initPanel=function(){if(this.timeLabel.node.active=!1,s.DATA.UserData.FunctionOn(y.FunctionKey.search_hammer)?this.AssembleMonsterToggle.node.active=!0:this.AssembleMonsterToggle.node.active=!1,1===a._type){var e=s.DATA.UserData.Level;this._maxLevel=e+a.monsterMaxLevelOffset,this._minLevel=e+a.monsterMinLevelOffset,a.selectLevel=a.selectMonsterLevel,a.nowStarNum=a.nowMonsterNum}else if(3===a._type)this.timeLabel.node.active=!p.default.isKVK(),this._maxLevel=a.assembleMonsterMaxLevel,this._minLevel=10,a.selectLevel=a.selectAssembleMonsterLevel,a.nowStarNum=a.nowAssemblyStarNum,this.cpnUpdate1000MS(0);else{this._maxLevel=1;var t=r.TABLE.getTableGroup(v.TableName.RESOURCE);for(var o in t)this._maxLevel=this._maxLevel<t[o].level?t[o].level:this._maxLevel;this._minLevel=1}this._minLevel<=0&&(this._minLevel=1),a.selectLevel>this._maxLevel&&(a.selectLevel=this._maxLevel),a.selectLevel<this._minLevel&&(a.selectLevel=this._minLevel),this.levelChange(),this.typeToggleContainer.node.safetyDestroyAllChildren();var n=0;1===a._type?n=a.monsterList.length:2===a._type?n=a.resList.length:3===a._type&&(n=a.assembleMonsterList.length);var i=[],c=-1;c=1==a._type?a.selectMonsterId:3==a._type?a.selectAssembleMonsterId:a.selectResId;for(var d=0;d<n;d++){var u=a.monsterList[d],h=null;if(2===a._type?(u=a.resList[d],h=cc.instantiate(this.toggleItemRes)):(3===a._type&&(u=a.assembleMonsterList[d]),h=cc.instantiate(this.toggleItemMonster)),h){this.typeToggleContainer.node.addChild(h);var m=h.getComponent(l.default);if(m&&(m.init(u),m.setGary(!0)),i.push(u.id),0===d&&c<0||c==u.id)h.getComponent(cc.Toggle).isChecked=!0,m.setGary(!1)}}if(this._showIndex=-1,i.length>0&&(this._showIndex=i.indexOf(c),this._showIndex<0)){this._showIndex=0,1==a._type?a.selectMonsterId=i[0]:2==a._type?a.selectResId=i[0]:3==a._type&&(a.selectAssembleMonsterId=i[0]),c=i[0];var f=this.typeToggleContainer.getComponentsInChildren(l.default);for(d=0;d<f.length;d++){(u=f[d]).getId()==c&&u.setGary(!1)}}},t.prototype.cpnUpdate1000MS=function(e){if(1==this.timeLabel.node.active){var t=[],n=0;if(5==a.selectAssembleMonsterId?(t=this.hammer_endCfg,n=this.hammer_endTime):(t=this.pengpeng_endCfg,n=this.pengpeng_endTime),0==t.length)return;if(n>s.DATA.ServerTime){var i=p.default.getSimpleTimeShow(n-s.DATA.ServerTime);5==a.selectAssembleMonsterId?this.timeLabel.string=o.LOCAL.getText("warhammer_guide_016")+" "+i:this.timeLabel.string=o.LOCAL.getText("activitySpin002")+" "+i}else this.updateEndTime()}},t.prototype.updateEndTime=function(){var e=[];if(0!=(e=5==a.selectAssembleMonsterId?this.hammer_endCfg:this.pengpeng_endCfg).length){var t=0,o=s.DATA.UserData.SystemZeroTime;0==o&&(o=h.DateTime.convertTimeZone(new Date((new Date).setHours(0,0,0,0))).getTime()/1e3);for(var n=(s.DATA.ServerTime-o)/60,i=0;i<e.length;i++){if(Number(e[i])>n){t=Number(e[i]);break}i==e.length-1&&(t=Number(e[0])+1440)}5==a.selectAssembleMonsterId?this.hammer_endTime=o+60*t:this.pengpeng_endTime=o+60*t,this.cpnUpdate1000MS(0)}},t.prototype.updateScrollViewOffset=function(){var e=this.scrollView.getScrollOffset(),t=this.scrollView.getMaxScrollOffset();if(this._showIndex>=0){var a=9+221*(this._showIndex-1);a>t.x&&(a=t.x),e.x=a,this.scrollView.scrollToOffset(e)}},t.purge=function(){a.selectLevel=1,a.selectMonsterLevel=-1,a.assembleMonsterMaxLevel=1,a.selectAssembleMonsterLevel=-1,a._type=1,a.selectMonsterId=1,a.selectResId=1,a.selectAssembleMonsterId=1,a.nowStarNum=1,a.nowMonsterNum=1,a.nowAssemblyStarNum=1},t.nowStarNum=1,t.nowMonsterNum=1,t.nowAssemblyStarNum=1,t.monsterList=[],t.assembleMonsterList=[],t.resList=[],t.selectLevel=1,t.selectMonsterLevel=-1,t.selectAssembleMonsterLevel=-1,t.assembleMonsterMaxLevel=1,t._type=1,t.selectMonsterId=1,t.selectResId=1,t.selectAssembleMonsterId=1,t.isInitConfig=!1,t.monsterMaxLevelOffset=1,t.monsterMinLevelOffset=1,__decorate([S(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([S(cc.Label)],t.prototype,"levelLabel",void 0),__decorate([S(cc.Node)],t.prototype,"starNode",void 0),__decorate([S(cc.Node)],t.prototype,"starNumNode",void 0),__decorate([S(cc.Slider)],t.prototype,"levelSlider",void 0),__decorate([S(cc.Node)],t.prototype,"sliderMaskNode",void 0),__decorate([S(cc.ToggleContainer)],t.prototype,"typeToggleContainer",void 0),__decorate([S(cc.Node)],t.prototype,"toggleItemMonster",void 0),__decorate([S(cc.Node)],t.prototype,"toggleItemRes",void 0),__decorate([S(cc.Toggle)],t.prototype,"MonsterToggle",void 0),__decorate([S(cc.Toggle)],t.prototype,"ResToggle",void 0),__decorate([S(cc.Toggle)],t.prototype,"AssembleMonsterToggle",void 0),__decorate([S(cc.Label)],t.prototype,"timeLabel",void 0),t=a=__decorate([T],t)}(n.default);a.default=A,cc._RF.pop()},{"../../../../Core/Common/LocalManager":"LocalManager","../../../../Core/Common/TableManager":"TableManager","../../../../Core/Net/NetMgr":"NetMgr","../../../../fws/platforms/PlatformCore":"PlatformCore","../../../../fws/utils/FWSTool":"FWSTool","../../../../fws/utils/X":"X","../../../Common/BaseUI":"BaseUI","../../../Common/TaskGuide":"TaskGuide","../../../Common/UIManager":"UIManager","../../../Const/GameDefine":"GameDefine","../../../Const/RequestId":"RequestId","../../../Const/TableName":"TableName","../../../Data/DataCenter":"DataCenter","../../../Tools/GameTools":"GameTools","../../../controllers/ActivityController":"ActivityController","../WorldMapMsgs":"WorldMapMsgs","../controllers/WorldMapController":"WorldMapController","./WorldMapMonsterSearchCellComponent":"WorldMapMonsterSearchCellComponent"}],ActivityController:[function(e,t,a){"use strict";cc._RF.push(t,"8e5eec2vKlKApRYFOtF/Nnl","ActivityController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/mvc/FWSMvc"),n=e("../../fws/utils/FWSTool"),i=e("../Const/GameDefine"),r=e("../../Core/Common/TableManager"),s=e("../../Core/Net/NetMgr"),l=e("../Const/RequestId"),c=e("../Tools/GameTools"),d=e("../msgs/MvcMsgs"),p=e("../Common/UIManager"),u=e("../Const/UIDataInfo"),h=e("../Data/DataCenter"),m=e("../../Core/Event/EventCenter"),f=e("../Const/EventId"),_=e("./ExchangeController"),y=e("../../Core/Common/LocalManager"),g=e("../../fws/platforms/PlatformCore"),C=e("./RewardController"),v=e("../Module/UI/FreeGoldPanel"),I=e("../../fws/utils/X"),T=e("../Const/GameDefine"),S=e("../Const/TableName"),A=e("../Common/LoadManager"),D=e("../Tools/SubPackMsgs"),N=function(e){function t(){var t=e.call(this)||this;return t._casinoDayFreeCount=0,t._casinoDayCount=0,t._casinolastFreeTime=0,t._casinoFreeTimeOffset=0,t._onePrice=0,t._tenPrice=0,t._casinoFreeMax=0,t._casinoCostMax=0,t._casinoConfigRewardArray=[],t._isInitExchangeActivityConfig=!1,t._exchangeActivityConfigMap=cc.js.createMap(!0),t._activityList=[],t._activityMap={},t.guideReverseCard=!0,t._hammerBossRedPoint=!1,t._isHammerBossClicked=!1,t._hammerBossEndTime=0,t._hasOpenedActivity=!1,t.hasPlayActivityAni=!1,t._shareBoxChangeVal=0,t.initActivity(),t}return __extends(t,e),t.prototype.isActivityOpen=function(){for(var e=0,t=_.ExchangeController.Instance.canPay(),a=0;a<this._activityList.length;a++){var o=this._activityList[a];!t&&o.recharge>0||++e}return h.DATA.UserData.FunctionOn(i.FunctionKey.activity)&&e>0},t.prototype.isActivityOpenByType=function(e){for(var t=0,a=_.ExchangeController.Instance.canPay(),o=0;o<this._activityList.length;o++){var n=this._activityList[o];!a&&n.recharge>0||n.festivalEntrance==e&&++t}return h.DATA.UserData.FunctionOn(i.FunctionKey.activity)&&t>0},t.prototype.getActivityList=function(){return this._activityList},t.prototype.getActivityListShow=function(){for(var e=[],t=0;t<this._activityList.length;t++){var a=this._activityList[t];if(null==a.switch_control||""==a.switch_control||0!=h.DATA.UserData.FunctionOn(a.switch_control)){if(this.isActivityBoss(a.id)){if(!h.DATA.UserData.FunctionOn(i.FunctionKey.world_boss))continue}else if(this.isActivityFriendInviteShow(a.id))continue;0==g.instance.canShare()&&"104548"==a.name||e.push(a)}}return e},t.prototype.checkPopUpSevenDayReward=function(){return 0!=h.DATA.UserData.CheckHaveSevenDayReward()&&(0!=h.DATA.UserData.FunctionOn(i.FunctionKey.Seven_Day)&&(p.default.Instance().OpenUI(u.UIDataInfo.ActivityPanelNew,{activityId:i.FakeActivityId.SevenDayReward}),!0))},t.prototype.getClientActivityListShow=function(){var e=[];if(h.DATA.UserData.FunctionOn(i.FunctionKey.Seven_Day)&&!h.DATA.UserData.CheckSevenDayRewardFinished()){var t={id:i.FakeActivityId.SevenDayReward,showUiType:i.ActivityShowUIType.SevenDayReward,activityName:y.LOCAL.getText("102764"),iconStr:"activitySevenDayReward",isClientActivity:!0};e.push(t)}if(!g.instance.disablePubAddrActivity)do{if(0!==h.DATA.UserData.UID&&0!==h.DATA.UserData.SubWxPubAcctReward)break;t={id:i.FakeActivityId.PublicAddress,showUiType:i.ActivityShowUIType.PublicAddress,activityName:y.LOCAL.getText("100444"),iconStr:"activityPublicAddress",isClientActivity:!0};e.push(t)}while(0);if(!g.instance.disableFavWxActivity)do{if(0!==h.DATA.UserData.UID&&0!==h.DATA.UserData.FavWxReward)break;t={id:i.FakeActivityId.FavWx,showUiType:i.ActivityShowUIType.FavWx,activityName:y.LOCAL.getText("110127"),iconStr:"activityFavWx",isClientActivity:!0};e.push(t)}while(0);if(h.DATA.UserData.FunctionOn(i.FunctionKey.Community_link)){t={id:i.FakeActivityId.ACTIVITY_SOCIAL,showUiType:i.ActivityShowUIType.ActivitySocial,activityName:y.LOCAL.getText("Comm_link004"),iconStr:"activity_icon_707",isClientActivity:!0};e.push(t)}if(h.DATA.UserData.FunctionOn(i.FunctionKey.arena_activity_function)&&!h.DATA.UserData.FunctionOn(i.FunctionKey.key_novice_adjustments)){var a=c.default.getDataConfigData(930009)||"0";if(h.DATA.UserData.Level>=Number(a)){t={id:i.FakeActivityId.ARENA_ACTIVITY,showUiType:i.ActivityShowUIType.ACTIVITY_ARENA,activityName:y.LOCAL.getText("pve_arena_info_001"),iconStr:"activity_icon_arena",isClientActivity:!0,festivalEntrance:0};e.push(t)}}return e},t.prototype.onFMessage_SUBPACK_CALL_ACTIVITY_CONTROLL_getActivityByActivityId=function(e){return e.data=this.getActivityByActivityId(e.data),!0},t.prototype.getActivityByActivityId=function(e){if(n.Obj.isEmpty(e))return null;var t=e.toString();return n.Obj.getPropertyByNames(this._activityMap,null,t)},t.prototype.getActivityByActivitytype=function(e){if(n.Obj.isEmpty(e))return null;for(var t in this._activityMap)if(this._activityMap[t]&&this._activityMap[t].type&&this._activityMap[t].type==e)return this._activityMap[t];return null},t.prototype.getActivityByActivityUIType=function(e){if(n.Obj.isEmpty(e))return null;for(var t in this._activityMap)if(this._activityMap[t]&&this._activityMap[t].showUiType&&this._activityMap[t].showUiType==e)return this._activityMap[t];return null},t.prototype.getActivityTargetById=function(e,t){var a=null,o=this.getActivityByActivityId(e);if(null===o)return a;for(var n=o.atarget,i=0;i<n.length;i++){var r=n[i];if(r.id===t){a=r;break}}return a},t.prototype.getActivityTaskById=function(e,t){var a=null,o=this.getActivityByActivityId(e);if(null===o)return a;for(var n=o.task,i=0;i<n.length;i++){var r=n[i];if(r.id===t){a=r;break}}return a},t.prototype.getActivityRedPointNum=function(){for(var e=0,t=_.ExchangeController.Instance.canPay(),a=0;a<this._activityList.length;a++){var o=this._activityList[a];!t&&o.recharge>0||(e+=this.getActivityRedPointNumById(o.id))}var n=this.getClientActivityListShow();for(a=0;a<n.length;a++){o=n[a];e+=this.getClientActivityRedPointById(o.id)}return e},t.prototype.getActivityRedPointNumByType=function(e){for(var t=0,a=_.ExchangeController.Instance.canPay(),o=0;o<this._activityList.length;o++){var n=this._activityList[o];!a&&n.recharge>0||e==n.festivalEntrance&&(t+=this.getActivityRedPointNumById(n.id))}if(0==e){var i=this.getClientActivityListShow();for(o=0;o<i.length;o++){n=i[o];t+=this.getClientActivityRedPointById(n.id)}}return t},t.prototype.getActivityRedPointNumById=function(e){var a=0;do{var o=this.getActivityByActivityId(e);if(n.Obj.isEmpty(o))break;if(0==g.instance.canShare()&&"104548"==o.name)break;if(o.showUiType===i.ActivityShowUIType.ActivityDailyPurchace||o.showUiType===i.ActivityShowUIType.ActivityDailyRank||o.showUiType===i.ActivityShowUIType.Activitygiftboxtask||o.showUiType===i.ActivityShowUIType.ActivitySevenPurchace||o.showUiType===i.ActivityShowUIType.ActivityRecallTask||o.showUiType===i.ActivityShowUIType.ActivityReverseCard||o.showUiType===i.ActivityShowUIType.ActivitySummerDailyPurchace||o.showUiType===i.ActivityShowUIType.ActivityTaskGroup||o.showUiType===i.ActivityShowUIType.ActivityRndTask||o.showUiType===i.ActivityShowUIType.ActivityMonday||o.showUiType===i.ActivityShowUIType.ActivityLuckyBag||o.showUiType===i.ActivityShowUIType.ActivityNewYear||o.showUiType===i.ActivityShowUIType.ActivityItemUse||o.showUiType===i.ActivityShowUIType.ActivityEmotionTask||o.showUiType===i.ActivityShowUIType.ActivityWorldPurchace||o.showUiType===i.ActivityShowUIType.ActivityOneDayReward||o.showUiType===i.ActivityShowUIType.ActivityKingdomLegend){if(o.showUiType===i.ActivityShowUIType.ActivityRndTask)if(L=r.TABLE.getTableDataById(S.TableName.DATACONFIG,"121002")){var s=parseInt(L.value);if(o.extra.today_finished_count>=s)break}for(var l=o.atarget,d=0;d<l.length;d++){(A=l[d]).state===i.ActivityTargetState.FINISHED&&++a}o.showUiType===i.ActivityShowUIType.ActivityReverseCard&&h.DATA.UserData.getItemAmount(43e5)>0&&++a}else if(o.showUiType===i.ActivityShowUIType.newserverBP)for(l=o.task,d=0;d<l.length;d++){(A=l[d]).state===i.ActivityTargetState.FINISHED&&++a}else if(o.showUiType===i.ActivityShowUIType.ActivityAllianceBP){if(this.canAllianceBPGetReward(o)){var p=t.Instance.getActivityAllianceBPMaxPoint(o.id);if(o.extra&&o.extra.sc<p)for(l=o.task,d=0;d<l.length;d++){(A=l[d]).state===i.ActivityTargetState.FINISHED&&++a}for(var u=o.point,m=0;m<u.length;m++)1==this.getAllianceBPState(u[m],o.extra,o.adv)&&++a}}else if(o.showUiType===i.ActivityShowUIType.pioneerBP||o.showUiType===i.ActivityShowUIType.ActivityBeachLanding){if(o.showUiType!=i.ActivityShowUIType.ActivityBeachLanding){p=t.Instance.getActivityAllianceBPMaxPoint(o.id);if(o.extra&&o.extra.sc<p)for(l=o.task,d=0;d<l.length;d++){(A=l[d]).state===i.ActivityTargetState.FINISHED&&++a}}u=o.point;var f={};for(m=0;m<u.length;m++)1==this.getAllianceBPState(u[m],o.extra,o.adv)&&(f[u[m].pt]=1);for(var _ in f)1==f[_]&&a++}else if(o.showUiType===i.ActivityShowUIType.ActivityShareBox){((l=o.atarget)[0]&&l[0].state===i.ActivityTargetState.FINISHED||l[0].state===i.ActivityTargetState.UNFINISHED)&&++a}else if(o.showUiType===i.ActivityShowUIType.ActivityRecallExchange){var y=o.extra;null!=y&&0==y.status&&++a}else if(o.showUiType===i.ActivityShowUIType.ActivityHammerBoss)this._hammerBossRedPoint&&0==this._isHammerBossClicked&&++a;else if(o.showUiType===i.ActivityShowUIType.newActivityKingTask){var C=c.default.getDataConfigData(130015);""==C&&(C="0,0,0,1,2");var v=C.split(","),I=c.default.getZeroTimeByTime(o.begintime),T=Math.ceil((h.DATA.ServerTime-I)/86400);for(l=o.atarget,d=0;d<l.length;d++){var A,D=(A=l[d]).show_day,N=1;D-1<v.length&&(N=parseInt(v[D-1])+1),T<N||A.state===i.ActivityTargetState.FINISHED&&++a}}else if(o.showUiType===i.ActivityShowUIType.ActivityDefenderMonster){if(h.DATA.UserData.AllianceDefenderData.redDot)for(var d in h.DATA.UserData.AllianceDefenderData.redDot)a+=h.DATA.UserData.AllianceDefenderData.redDot[d]}else if(o.showUiType===i.ActivityShowUIType.ActivityHeroReturn)(""==o.switch_control||h.DATA.UserData.FunctionOn(o.switch_control))&&o.extra&&0==o.extra.dFreeCnt&&a++;else if(o.showUiType===i.ActivityShowUIType.ActivityLuckyDiscount)o.extra&&void 0!=o.extra.rc&&0==o.extra.rc&&a++;else if(o.showUiType===i.ActivityShowUIType.ActivityDeepSeaTreasure){if(o.extra&&o.extra.slots){var b=o.extra.slots;for(m=0;m<b.length;m++)1==b[m].s&&b[m].et<=h.DATA.ServerTime&&a++}var L,E=[];E=(L=c.default.getDataConfigData(930081)).split("|");for(m=0;m<E.length;m++){var P=E[m].split(",");P.length>1&&(a+=h.DATA.UserData.getItemAmount(Number(P[0])))}}}while(0);return a},t.prototype.getAllianceBPState=function(e,t,a){if(void 0===a&&(a=0),!e||!t||void 0==e.type||void 0==t.rap||void 0==t.rp)return 0;if(0==e.type&&t.rp.indexOf(e.pt)>-1)return 2;if(1==e.type){if(t.rap.indexOf(e.pt)>-1)return 2;if(0==a)return 0}return void 0!=t.sc&&t.sc>=e.pt?1:0},t.prototype.getClientActivityRedPointById=function(e){var t=0;if(e===i.FakeActivityId.PublicAddress)0!=h.DATA.UserData.UnionId&&0==h.DATA.UserData.SubWxPubAcctReward&&h.DATA.UserData.Level>=8&&(t=1);else if(e===i.FakeActivityId.FavWx)0==h.DATA.UserData.FavWxReward&&h.DATA.UserData.Level>=8&&(t=1);else if(e==i.FakeActivityId.ARENA_ACTIVITY){var a,o;if(h.DATA.UserData.FunctionOn(i.FunctionKey.pve_arena_function))if((a=Number(c.default.getDataConfigData(930010)))&&h.DATA.UserData.Level>a)(o=D.send(D.Names.SUBPACK_ARENA_PVE_TIME,0)).data>0&&(t+=1);if(h.DATA.UserData.FunctionOn(i.FunctionKey.pvp_arena_function))if((a=Number(c.default.getDataConfigData(930011)))&&h.DATA.UserData.Level>a)(o=D.send(D.Names.SUBPACK_ARENA_CONFIG,{})).data&&o.data.pvpTime&&(t+=1)}return t},t.prototype.updateFestivalIconByType=function(e,t,a,o){void 0===a&&(a="activity_festival_icon");for(var n=a,i="",r=_.ExchangeController.Instance.canPay(),s=0;s<this._activityList.length;s++){var l=this._activityList[s];if((r||!(l.recharge>0))&&e==l.festivalEntrance){if(""!=l.festivalPrefab){i=l.festivalPrefab;break}if(""!==l.festivalIcon){n=l.festivalIcon;break}}}if(t)if(i&&t.node){if(t.node.childrenCount>0&&t.node.children[0].name==i)return;A.LoadManager.loadPrefab("effect/activityIconEffect/"+i,function(e,a){if(a){var i=cc.instantiate(a);if(i)return t.node.safetyDestroyAllChildren(),i.parent=t.node,t.node&&t.node.getComponent(cc.Sprite)&&(t.node.getComponent(cc.Sprite).spriteFrame=null),void(o&&o(5))}t.url=g.instance.getDynResName(n)})}else t.url=g.instance.getDynResName(n);else I.log("icon\u8282\u70b9\u4e0d\u5b58\u5728\u4e86")},t.prototype.getActivityLeftTimeByType=function(e,t){var a=!1;if(void 0!=e&&t){for(var o=_.ExchangeController.Instance.canPay(),n=0,i=0;i<this._activityList.length;i++){var r=this._activityList[i];if((o||!(r.recharge>0))&&(e==r.festivalEntrance&&(""!=r.festivalPrefab||""!==r.festivalIcon))){n=r.endtime;break}}if(n&&n>h.DATA.ServerTime){var s=t.getChildByName("time1"),l=t.getChildByName("time2");if(s&&s.getComponent(cc.Label)&&l&&l.getComponent(cc.Label)){var d=Math.floor((n-h.DATA.ServerTime)/3600/24);s.active=d>0,l.active=d<=0,d>0?s.getComponent(cc.Label).string=y.LOCAL.getText("101134",d.toString()):l.getComponent(cc.Label).string=c.default.getSimpleTimeShow(n-h.DATA.ServerTime,!1),a=!0}}}t&&(t.active=a)},t.prototype.requestActivityData=function(){var e=this;s.NET.send(l.RequestId.GET_ACTIVITY_DATA,{},this,function(t){var a=c.default.JSON_PARSE(t.d);n.Obj.isEmpty(a)||(e.setActivityList(a),d.send(d.Names.MVC_ACTIVITY_DATA_UPDATE,null),m.EVENT.emit(f.EventId.ACTIVITY_ICON_UPDATE),d.send(d.Names.checkMonsterDefenderIsBegin,null))})},t.prototype.onFMessage_checkMonsterDefenderIsBegin=function(){var e=this.getActivityByActivityId(130),t=h.DATA.UserData.getLocalData(T.LocalDataKey.AttackWarnLevel,1),a=null;a=e&&e.userMonsterSiege&&!e.userMonsterSiege.isEnd?{attackState:1,uid:0,level:Number(t)+100}:{attackState:0,uid:0,level:Number(t)+100},h.DATA.UserData.updateAttackArmies(a),m.EVENT.emit(f.EventId.AttackingMarchUpdate)},t.prototype.getActivityReward=function(e,t,a){void 0===a&&(a=null);var o=this,i={aid:e,tid:t};s.NET.send(l.RequestId.GET_ACTIVITY_REWARD,i,this,function(e){var t=c.default.JSON_PARSE(e.d);if(n.Obj.isEmpty(t));else{o.activityStateUpdate(t);var i=n.Obj.getPropertyByNames(t,null,"reward");if(null!==i){var r={serverReward:i};p.default.Instance().OpenUI(u.UIDataInfo.CommonRewardPanel,r),a&&a()}}})},t.prototype.testData=function(){var e={},t=r.TABLE.getTableGroup("activity_day_target");for(var a in t)if(t.hasOwnProperty(a)){var o=t[a],i=this.convertToActivityDayTargetConfig(o);null!==e[i.type]&&void 0!==e[i.type]||(e[i.type]=[]),e[i.type].push(i)}t=r.TABLE.getTableGroup("activity");for(var a in t)if(t.hasOwnProperty(a)){o=t[a];var s=this.convertToActivityConfig(o),l=s.tableInfoType;s.atarget=n.Obj.getPropertyByNames(e,[],l),this._activityList.push(s);var c=s.id.toString();this._activityMap[c]=s}this._activityList.length>1&&(this._activityList=this._activityList.sort(function(e,t){return t.priority-e.priority}))},t.prototype.openActivityRank=function(e){var t=this.getActivityByActivityId(e);if(I.log(t),!(n.Obj.isEmpty(t)||t.atarget.length<=0)){var a=y.LOCAL.getText(t.name),o=t.atarget[0].targetType,i=y.LOCAL.getText(t.atarget[0].targetTypeTittle);s.NET.send(l.RequestId.GET_ACTIVITY_RANK,{aid:e,ttype:o,start:0,end:99},this,function(e){var t=c.default.JSON_PARSE(e.d);n.Obj.isEmpty(t)||(I.log(t),p.default.Instance().OpenUI(u.UIDataInfo.ActivityRankPanel,t.list,a,i))})}},t.prototype.openActivityServerRank=function(e,t){p.default.Instance().OpenUI(u.UIDataInfo.ActivityServerRankPanel,e,t)},t.prototype.openActivityRankWithOutType=function(e,t,a){s.NET.send(l.RequestId.ACTIVITY_DRAW_CARD_RANK,{aid:e,start:1,end:99},this,function(e){var o=c.default.JSON_PARSE(e.d);n.Obj.isEmpty(o)||(I.log(o),p.default.Instance().OpenUI(u.UIDataInfo.ActivityRankPanel,o.list,t,a))})},t.prototype.openActivityExchangeRank=function(e){s.NET.send(l.RequestId.ACTIVITY_DRAW_CARD_RANK,{aid:e,start:1,end:99},this,function(t){var a=c.default.JSON_PARSE(t.d);n.Obj.isEmpty(a)||(I.log(a),p.default.Instance().OpenUI(u.UIDataInfo.ActivityExchangeRankPanel,a,e))})},t.prototype.getActivityValentineRankData=function(e){s.NET.send(l.RequestId.GET_ACTIVITY_RANK,{aid:e,ttype:0,start:0,end:9},this,function(e){var t=c.default.JSON_PARSE(e.d);if(n.Obj.isEmpty(t));else{I.log(t);var a=n.Obj.getPropertyByNames(t,[],"list");d.send(d.Names.MVC_ACTIVITY_VALENTINE_MINI_RANK,a)}})},t.prototype.openActivityDetail=function(e){var t=this.getActivityByActivityId(e);c.default.ObjIsEmpty(t)||c.default.ObjIsEmpty(t.atarget)||s.NET.send(l.RequestId.GET_ACTIVITY_REWARD_RANK,{aid:e},this,function(t){var a=c.default.JSON_PARSE(t.d);n.Obj.isEmpty(a)||(I.log(a),c.default.ObjIsEmpty(a)||p.default.Instance().OpenUI(u.UIDataInfo.ActivityDeatilPanel,e,a))})},t.prototype.openActivityRankReward=function(e){var t=this.getActivityByActivityId(e);c.default.ObjIsEmpty(t)||c.default.ObjIsEmpty(t.atarget)||s.NET.send(l.RequestId.GET_ACTIVITY_REWARD_RANK,{aid:e},this,function(e){var a=c.default.JSON_PARSE(e.d);n.Obj.isEmpty(a)||(I.log(a),!c.default.ObjIsEmpty(a)&&a.rank&&p.default.Instance().OpenUI(u.UIDataInfo.ActivityRewardRankPanel,a.rank,t.name))})},t.prototype.setActivityList=function(e){this._activityList=[],this._activityMap={},this.updateActivityList(e),this.isActivityExchangeShow()},t.prototype.updateActivityList=function(e){for(var t=n.Obj.getPropertyByNames(e,[],"alist"),a=0;a<t.length;a++){var o=t[a],i=this.convertToActivityConfig(o);this._activityList.push(i);var r=i.id.toString();this._activityMap[r]=i}this._activityList.length>1&&(this._activityList=this._activityList.sort(function(e,t){return t.priority-e.priority}))},t.prototype.UpdateActivityData=function(e){if(null!=e){var t=this.convertToActivityConfig(e),a=t.id.toString();this._activityMap[a]=t;for(var o=0;o<this._activityList.length;o++)if(this._activityList[o].id==t.id){this._activityList[o]=t;break}}},t.prototype.UpdateActivityExtraData=function(e){if(e&&e.aid&&e.extra){for(var t=0;t<this._activityList.length;t++)if(this._activityList[t].id==e.aid){this._activityList[t].extra=e.extra;break}m.EVENT.emit(f.EventId.ACTIVITY_ICON_UPDATE,e.aid)}},t.prototype.UpdateActivityAllianceBPPoint=function(e){if(e&&e.aid&&e.extra&&void 0!=e.extra.sc)for(var t=0;t<this._activityList.length;t++)if(this._activityList[t].id==e.aid){this._activityList[t].extra.sc=e.extra.sc;break}},t.prototype.getActivityAllianceBPMaxPoint=function(e){var a=0,o=t.Instance.getActivityByActivityId(e);if(o&&o.point)for(var n=0;n<o.point.length;n++)o.point[n].pt&&o.point[n].pt>a&&(a=o.point[n].pt);return a},t.prototype.convertToActivityConfig=function(e){var t=n.Obj.getPropertyNumberByNames(e,-1,"id"),a=n.Obj.getPropertyStringByNames(e,"","name"),o=n.Obj.getPropertyStringByNames(e,"","icon"),r=n.Obj.getPropertyStringByNames(e,"","banner"),s=n.Obj.getPropertyStringByNames(e,"","showUiType"),l=n.Obj.getPropertyStringByNames(e,"","desc"),c=n.Obj.getPropertyNumberByNames(e,-1,"recharge"),d=n.Obj.getPropertyNumberByNames(e,-1,"type"),p=n.Obj.getPropertyNumberByNames(e,-1,"priority"),u=n.Obj.getPropertyNumberByNames(e,-1,"onoff"),m=n.Obj.getPropertyStringByNames(e,"","condition"),f=n.Obj.getPropertyNumberByNames(e,-1,"timeType"),_=n.Obj.getPropertyStringByNames(e,"","para1"),y=n.Obj.getPropertyStringByNames(e,"","para2"),g=n.Obj.getPropertyStringByNames(e,"","para3"),C=n.Obj.getPropertyStringByNames(e,"","para4"),v=n.Obj.getPropertyStringByNames(e,"","limitTime"),I=n.Obj.getPropertyStringByNames(e,"","tableInfo"),T=n.Obj.getPropertyNumberByNames(e,-1,"tableInfoType"),S=n.Obj.getPropertyNumberByNames(e,-1,"serverId"),A=n.Obj.getPropertyNumberByNames(e,-1,"today"),D=n.Obj.getPropertyNumberByNames(e,-1,"begintime"),N=n.Obj.getPropertyNumberByNames(e,-1,"endtime"),b=n.Obj.getPropertyStringByNames(e,"","bannerTittle"),L=n.Obj.getPropertyStringByNames(e,"","bannerDes"),E=n.Obj.getPropertyNumberByNames(e,0,"festivalEntrance"),P=n.Obj.getPropertyStringByNames(e,"","festivalIcon"),w=n.Obj.getPropertyStringByNames(e,"","dynamic_icon"),B=n.Obj.getPropertyStringByNames(e,"","switch_control"),M=n.Obj.getPropertyStringByNames(e,"","jumpTo"),U=n.Obj.getPropertyNumberByNames(e,0,"abTest"),R=n.Obj.getPropertyNumberByNames(e,0,"nowNum"),G=n.Obj.getPropertyNumberByNames(e,0,"todayTime"),O=n.Obj.getProperty(e,"userMonsterSiege",null),k=n.Obj.getPropertyNumberByNames(e,0,"versionLow"),x=n.Obj.getProperty(e,"alMonsterSiege",null),F=n.Obj.getPropertyStringByNames(e,"","extra1"),V=n.Obj.getPropertyStringByNames(e,"","extra2"),H=n.Obj.getPropertyStringByNames(e,"","rankReward"),W=n.Obj.getProperty(e,"siegeMonster",0),j=n.Obj.getProperty(e,"point",0),q=n.Obj.getPropertyNumberByNames(e,0,"adv"),K=n.Obj.getPropertyNumberByNames(e,0,"exchangeId"),Y=n.Obj.getPropertyStringByNames(e,"","delete_activity_item"),X=n.Obj.getPropertyNumberByNames(e,0,"jt"),J=n.Obj.getPropertyNumberByNames(e,0,"cost"),z=n.Obj.getPropertyByNames(e,[],"legendNotices"),Q=n.Obj.getPropertyNumberByName(e,0,"extra_display_hour");h.DATA.UserData.FunctionOn(i.FunctionKey.new_activity_entrance)&&(E=n.Obj.getPropertyNumberByNames(e,0,"event"));var Z=null;e.scoreShop&&(Z=this.convertToActivityScoreShop(e.scoreShop));for(var $=[],ee=n.Obj.getPropertyByNames(e,[],"atarget"),te=0;te<ee.length;te++){var ae=ee[te],oe=this.convertToActivityDayTargetConfig(ae);$.push(oe)}var ne=[],ie=n.Obj.getPropertyByNames(e,[],"task");for(te=0;te<ie.length;te++){ae=ie[te],oe=this.convertToActivityTaskConfig(ae);ne.push(oe)}var re=[],se=n.Obj.getPropertyStringByNames(e,"","rankType");se=se.split(",");for(var le=0;le<se.length;le++){ae=parseInt(se[le]);re.push(ae)}return{id:t,name:a,icon:o,banner:r,showUiType:s,desc:l,recharge:c,type:d,priority:p,onoff:u,condition:m,timeType:f,para1:_,para2:y,limitTime:v,tableInfo:I,tableInfoType:T,serverId:S,atarget:$,task:ne,today:A,begintime:D,endtime:N,bannerDes:L,scoreShop:Z,bannerTittle:b,extra:e.extra,festivalEntrance:E,festivalIcon:P,festivalPrefab:w,switch_control:B,jumpTo:M,abTest:U,nowNum:R,todayTime:G,para3:g,para4:C,userMonsterSiege:O,alMonsterSiege:x,versionLow:k,siegeMonster:W,extra1:F,extra2:V,rankReward:H,delete_activity_item:Y,point:j,adv:q,exchangeId:K,allianceJoinTime:X,rankType:re,cost:J,legendNotices:z,extra_display_hour:Q}},t.prototype.convertToActivityScoreShop=function(e){for(var t=n.Obj.getPropertyNumberByNames(e,0,"score"),a=n.Obj.getPropertyNumberByNames(e,0,"total"),o=n.Obj.getPropertyByNames(e,[],"buys"),i=[],r=0;r<o.length;r++){var s=o[r],l={id:n.Obj.getPropertyNumberByNames(s,0,"id"),val:n.Obj.getPropertyNumberByNames(s,0,"val")};i.push(l)}return{total:a,score:t,buys:i}},t.prototype.convertToActivityDayTargetConfig=function(e){var t=n.Obj.getPropertyNumberByNames(e,-1,"id"),a=n.Obj.getPropertyNumberByNames(e,-1,"type"),o=n.Obj.getPropertyNumberByNames(e,-1,"daily"),r=n.Obj.getPropertyNumberByNames(e,-1,"day"),s=n.Obj.getPropertyStringByNames(e,"","desc"),l=n.Obj.getPropertyNumberByNames(e,-1,"targetType"),c=n.Obj.getPropertyNumberByNames(e,-1,"target"),d=n.Obj.getPropertyStringByNames(e,"","target1"),p=n.Obj.getPropertyStringByNames(e,"","target2"),u=n.Obj.getPropertyNumberByNames(e,-1,"preId"),h=n.Obj.getPropertyNumberByNames(e,-1,"rewardId"),m=n.Obj.getPropertyNumberByNames(e,-1,"next_Id"),f=n.Obj.getPropertyNumberByNames(e,-1,"quality"),_=n.Obj.getPropertyNumberByNames(e,-1,"num"),y=n.Obj.getPropertyNumberByNames(e,i.ActivityTargetState.NONE,"state"),g=n.Obj.getPropertyByNames(e,{},"rewardXml");return{id:t,type:a,daily:o,day:r,desc:s,targetType:l,target:c,target1:d,target2:p,preId:u,rewardId:h,next_Id:m,quality:f,targetTypeTittle:n.Obj.getPropertyStringByNames(e,"","targetTypeTittle"),num:_,state:y,rewardXml:g,page:n.Obj.getPropertyNumberByNames(e,-1,"page"),guide_id:n.Obj.getPropertyNumberByNames(e,0,"guideId"),guide_para:n.Obj.getPropertyNumberByNames(e,0,"guidePara"),show_day:n.Obj.getPropertyNumberByNames(e,0,"showDay"),purpose:n.Obj.getPropertyNumberByNames(e,0,"purpose"),para:n.Obj.getPropertyNumberByNames(e,0,"para"),task_show_limit:n.Obj.getPropertyStringByNames(e,"","task_show_limit"),target_show_limit:n.Obj.getPropertyStringByNames(e,"","target_show_limit"),crossServerReward:n.Obj.getPropertyNumberByNames(e,0,"crossServerReward")}},t.prototype.convertToActivityTaskConfig=function(e){var t=n.Obj.getPropertyNumberByNames(e,-1,"id");return{tab:n.Obj.getPropertyNumberByNames(e,-1,"tab"),num:n.Obj.getPropertyNumberByNames(e,-1,"num"),targetType:n.Obj.getPropertyNumberByNames(e,-1,"targetType"),id:t,state:n.Obj.getPropertyNumberByNames(e,-1,"state"),point:n.Obj.getPropertyNumberByNames(e,-1,"point"),target:n.Obj.getPropertyNumberByNames(e,-1,"target"),order:n.Obj.getPropertyNumberByNames(e,-1,"order"),desc:n.Obj.getPropertyStringByNames(e,"","desc"),quality:n.Obj.getPropertyNumberByNames(e,-1,"quality")}},t.prototype.activityTaskUpdate=function(e){var t=n.Obj.getPropertyNumberByNames(e,null,"aid"),a=n.Obj.getPropertyNumberByNames(e,null,"tid");if(null!==t&&null!==a){var o=n.Obj.getPropertyNumberByNames(e,-1,"num"),r=n.Obj.getPropertyNumberByNames(e,i.ActivityTargetState.NONE,"state"),s=this.getActivityByActivityId(t),l=!1;if(s)for(var c=0;c<s.task.length;c++)s.task[c].id==a&&(s.task[c].num==o&&s.task[c].state==r||(l=!0,s.task[c].num=o,s.task[c].state=r));l&&(d.send(d.Names.MVC_ACTIVITY_STATE_UPDATE,e),m.EVENT.emit(f.EventId.ACTIVITY_ICON_UPDATE))}},t.prototype.activityStateUpdate=function(e){var t=n.Obj.getPropertyNumberByNames(e,null,"aid"),a=n.Obj.getPropertyNumberByNames(e,null,"tid");if(null!==t&&null!==a){for(var o=n.Obj.getPropertyNumberByNames(e,-1,"num"),r=n.Obj.getPropertyNumberByNames(e,i.ActivityTargetState.NONE,"state"),s=n.Obj.getPropertyByNames(e,0,"refreshNum"),l=this._activityList,c=!1,p=!1,u=0;u<l.length&&!p;u++){var h=l[u];if(h.id===t)for(var _=h.atarget,y=0;y<_.length;y++){var g=_[y];if(g.id===a){if(p=!0,g.num!==o||g.state!==r){c=!0,10===t&&(this._shareBoxChangeVal=o-g.num);try{g.num=o,g.state=r}catch(e){}}if(s)continue;break}s&&g.num!==o&&(g.num=o)}}if(c){this._activityMap={};for(u=0;u<l.length;u++){var C=l[u],v=C.id.toString();this._activityMap[v]=C}d.send(d.Names.MVC_ACTIVITY_STATE_UPDATE,e),m.EVENT.emit(f.EventId.ACTIVITY_ICON_UPDATE)}}},t.prototype.onFMessage_LOGIN_SUCCESS=function(e){return this.requestActivityData(),!0},t.prototype.onFMessage_LEVELUP_SUCCESS=function(e){return I.log("\u83b7\u53d6\u6d3b\u52a8\u6570\u636e \u7b49\u7ea7\u53d8\u5316"),this.requestActivityData(),!0},t.prototype.isActivityBoss=function(e){return 14===e||131===e||166===e},t.prototype.isActivityRefugee=function(e){return 59===e},t.prototype.isActivityRefugeeOpen=function(){for(var e=0;e<this._activityList.length;e++)if(59==this._activityList[e].id)return!0;return!1},t.prototype.isActivityExchangeShow=function(){var e=_.ExchangeController.Instance.getCanPayExchangeConfigArrayByType(T.GiftType.ACTIVITY_GIFT);if(!_.ExchangeController.Instance.canPay()||e.length<=0)for(var t=0;t<this._activityList.length;t++){var a=this._activityList[t];if(a.showUiType==i.ActivityShowUIType.ActivityGiftNode){this._activityMap[a.id]&&(this._activityMap[a.id]=null),this._activityList.splice(t,1);break}}},t.prototype.isActivityFriendInviteShow=function(e){return 19==e&&!g.instance.canShare()},t.prototype.isActivityThroneOpen=function(){if(c.default.isKVK())return!1;if(0==h.DATA.UserData.FunctionOn(i.FunctionKey.world_throne))return!1;var e=parseInt(c.default.getDataConfigData(70021));return!(h.DATA.UserData.FunctionOn(i.FunctionKey.CrossServerBattle)&&h.DATA.UserData.Level>=e&&h.DATA.UserData.ServerState!=T.ServerState.Normal)},t.prototype.isActivityCrossServerOpen=function(){var e=parseInt(c.default.getDataConfigData(70021));return!!(h.DATA.UserData.FunctionOn(i.FunctionKey.CrossServerBattle)&&h.DATA.UserData.Level>=e&&h.DATA.UserData.ServerState!=T.ServerState.Normal)},t.prototype.openExchangeActivity=function(e){void 0===e&&(e=[]);var t=null,a=this.getActivityListShow(),o=0;if(e.length>0)for(var n=0;n<e.length;n++){for(var i=parseInt(e[n]),r=0;r<a.length;r++){if((6===(s=this._activityList[r]).type||35===s.type)&&s.id==i){t=s.id,o=s.festivalEntrance;break}}if(t)break}else for(r=0;r<a.length;r++){var s;6!==(s=this._activityList[r]).type&&35!==s.type||(t=s.id,o=s.festivalEntrance)}null!==t?p.default.Instance().OpenUI(u.UIDataInfo.ActivityPanel,{activityId:t},o):p.default.Instance().OpenUI(u.UIDataInfo.ActivityPanel)},t.prototype.openActivityById=function(e,t){if(void 0===t&&(t=!1),e){var a=this.getActivityByActivityId(e);if(a){var o=p.default.Instance().getUIByUIData(u.UIDataInfo.ActivityPanelNew);if(o){var n=o.getComponent("DialogFrameComponent");if(n&&n.dialogContent){var i=n.dialogContent.getComponent("ActivityComponent");i&&i.onShow([{activityId:e},a.festivalEntrance])}}else p.default.Instance().OpenUI(u.UIDataInfo.ActivityPanelNew,{activityId:e},a.festivalEntrance);return}}t&&p.default.Instance().OpenUI(u.UIDataInfo.ActivityPanelNew)},t.prototype.requestExchangeActivity=function(e,t,a,o){void 0===o&&(o=null);var i=this,r={aid:e,tid:t,convertNum:a};s.NET.send(l.RequestId.GET_CONVERT_REWARD,r,this,function(e){var t=c.default.JSON_PARSE(e.d);if(I.log("GET_CONVERT_REWARD   ",t),n.Obj.isEmpty(t));else{i.activityStateUpdate(t);var a=n.Obj.getPropertyByNames(t,null,"reward");if(null!==a){var r={serverReward:a};p.default.Instance().OpenUI(u.UIDataInfo.CommonRewardPanel,r)}o&&o()}})},t.prototype.getExchangeActivityShowArr=function(e){var t=[],a=this.getActivityByActivityId(e);if(!a)return t;for(var o=a.atarget,i=0;i<o.length;i++){var r=o[i],s=r.id,l=this._exchangeActivityConfigMap[s];if(l){var d=l.needItem,p=c.default.convertStringToArray(d);if(!(p.length<2)){var u=parseInt(p[0]);parseInt(p[1]),h.DATA.UserData.getItemAmount(u);r.num,l.times,t.push(r)}}}return t=(t=t.concat([])).sort(function(e,t){if(null==t)return 1;if(null==e)return-1;var a=n.Obj.getProperty(t,"id",0);return n.Obj.getProperty(e,"id",0)-a})},t.prototype.getExchangeActivityConfigById=function(e){return this._exchangeActivityConfigMap[e]},t.prototype.upDataShopPointById=function(e){if(!n.Obj.isEmpty(e)){var t=n.Obj.getPropertyNumberByNames(e,-1,"aid"),a=n.Obj.getPropertyNumberByNames(e,-1,"score"),o=n.Obj.getPropertyNumberByNames(e,-1,"total_score"),i=this.getActivityByActivityId(t);i&&i.scoreShop&&(i.scoreShop.score=a,i.scoreShop.total=o)}},t.prototype.canAllianceBPGetReward=function(e){if(h.DATA.UserData.Alliance.isInAlliance()&&e&&0!=e.allianceJoinTime){var t=c.default.getDataConfigData(130202);if(!t)return!0;if(h.DATA.ServerTime-e.allianceJoinTime>=3600*Number(t))return!0}return!1},t.prototype.initActivityCasino=function(){var e=r.TABLE.getTableDataById(S.TableName.DATACONFIG,"23116");this._casinoFreeTimeOffset=n.Obj.getPropertyNumberByNames(e,0,"value");e=r.TABLE.getTableDataById(S.TableName.DATACONFIG,"23117");this._casinoFreeMax=n.Obj.getPropertyNumberByNames(e,0,"value");e=r.TABLE.getTableDataById(S.TableName.DATACONFIG,"23124");this._casinoCostMax=n.Obj.getPropertyNumberByNames(e,0,"value");e=r.TABLE.getTableDataById(S.TableName.DATACONFIG,"23119");this._onePrice=n.Obj.getPropertyNumberByNames(e,0,"value");e=r.TABLE.getTableDataById(S.TableName.DATACONFIG,"23120");this._tenPrice=n.Obj.getPropertyNumberByNames(e,0,"value");e=r.TABLE.getTableDataById(S.TableName.DATACONFIG,"23121");var t=n.Obj.getPropertyNumberByNames(e,0,"value"),a=C.RewardController.Instance.convertClientConfigRewardToCommonRewardById(t);this._casinoConfigRewardArray=C.RewardController.Instance.convertCommonRewardToArr(a)},t.prototype.casinoQuery=function(){var e=this;s.NET.send(l.RequestId.CASINO_QUERY,{},this,function(t){var a=c.default.JSON_PARSE(t.d);n.Obj.isEmpty(a)||(e._casinoDayFreeCount=n.Obj.getPropertyNumberByNames(a,0,"dayFreeCount"),e._casinoDayCount=n.Obj.getPropertyNumberByNames(a,0,"dayCount"),e._casinolastFreeTime=n.Obj.getPropertyNumberByNames(a,0,"lastFreeTime"),d.send(d.Names.MVC_CASINO_TURN_QUERY,null))})},t.prototype.casinoTrunGetReward=function(e){var t=!0,a=h.DATA.UserData.getItemAmount(930001);if(1===e){if(this._casinoCostMax-this._casinoDayCount<1)return t=!1,p.default.Instance().ShowTips(y.LOCAL.getText("activitySpin006")),t;if(this.getCasinoOneCost()>0){if(a<=0&&h.DATA.UserData.Resource.Gold<this._onePrice)return v.default.ShowView(),t=!1;this.doCasinoTurn(e)}else this.doCasinoTurn(e)}else{if(a<10&&h.DATA.UserData.Resource.Gold<this._tenPrice)return v.default.ShowView(),t=!1;if(this._casinoCostMax-this._casinoDayCount<10)return t=!1,p.default.Instance().ShowTips(y.LOCAL.getText("activitySpin006")),t;this.doCasinoTurn(e)}return t},t.prototype.doCasinoTurn=function(e){var t=this;s.NET.send(l.RequestId.CASINO_GET_REWARD,{type:e},this,function(e){var a=c.default.JSON_PARSE(e.d);if(n.Obj.isEmpty(a))d.send(d.Names.MVC_CASINO_TURN_FAIL,null);else{t._casinoDayFreeCount=n.Obj.getPropertyNumberByNames(a,0,"dayFreeCount"),t._casinoDayCount=n.Obj.getPropertyNumberByNames(a,0,"dayCount"),t._casinolastFreeTime=n.Obj.getPropertyNumberByNames(a,0,"lastFreeTime");var o=a.reward;Array.isArray(o)||(o=[o]),t.casinoRewardhandler(o)}})},t.prototype.casinoRewardhandler=function(e){for(var t=[],a=[],o=0;o<e.length;o++){var n=e[o],i=C.RewardController.Instance.convertServerRewardToCommonReward(n),r=C.RewardController.Instance.convertCommonRewardToArr(i);a=a.concat(r)}for(o=0;o<a.length;o++){n=a[o];for(var s=0;s<this._casinoConfigRewardArray.length;s++){var l=this._casinoConfigRewardArray[s];l.configId===n.configId&&l.rewardType===n.rewardType&&t.push(s)}}d.send(d.Names.MVC_CASINO_TURN_RESULT,{indexArr:t,rewardArr:e})},t.prototype.getCasinoConfigReward=function(){return this._casinoConfigRewardArray},t.prototype.getCasinoOneCost=function(){return this._casinoDayFreeCount>=this._casinoFreeMax||this._casinolastFreeTime+1e3*this._casinoFreeTimeOffset>1e3*h.DATA.ServerTime?this._onePrice:0},t.prototype.getCasinoPrice=function(){return[this._onePrice,this._tenPrice]},t.prototype.getCasinoTenCost=function(){return this._tenPrice},t.prototype.getCasinoLeftTime=function(){return this._casinoCostMax-this._casinoDayCount},t.prototype.getCasinoNextFreeTime=function(){return this._casinolastFreeTime+1e3*this._casinoFreeTimeOffset},Object.defineProperty(t.prototype,"GuideReverseCard",{get:function(){return this.guideReverseCard},set:function(e){this.guideReverseCard=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HammerBossRedPoint",{get:function(){return this._hammerBossRedPoint},set:function(e){this._hammerBossRedPoint=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsHammerBossClicked",{get:function(){return this._isHammerBossClicked},set:function(e){this._isHammerBossClicked=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HammerBossEndTime",{get:function(){return this._hammerBossEndTime},set:function(e){this._hammerBossEndTime=e},enumerable:!0,configurable:!0}),t.prototype.initActivity=function(){this._isInitExchangeActivityConfig||(this._isInitExchangeActivityConfig=!0,this.initActivityConvert(),this.initActivityCasino())},t.prototype.initActivityConvert=function(){var e=r.TABLE.getTableGroup(S.TableName.CONVERT);if(e)for(var t in e){var a=e[t],o={id:n.Obj.getPropertyNumberByNames(a,null,"id"),type:n.Obj.getPropertyNumberByNames(a,-1,"type"),needItem:n.Obj.getPropertyStringByNames(a,"","needItem"),reward:n.Obj.getPropertyNumberByNames(a,0,"reward"),times:n.Obj.getPropertyNumberByNames(a,0,"times"),convert_type:n.Obj.getPropertyNumberByNames(a,0,"convert_type")};this._exchangeActivityConfigMap[t]=o}},Object.defineProperty(t.prototype,"HasOpenedActivity",{get:function(){return this._hasOpenedActivity},set:function(e){this._hasOpenedActivity=e},enumerable:!0,configurable:!0}),t.prototype.getBossRankListByType=function(e){var t=r.TABLE.getTableGroup(S.TableName.BOSS_REWARD),a=new Array;for(var o in t){var i=t[o];n.Obj.isEmpty(i)||i.type!==e||(i.showLabel=!1,a.push(i))}return a},t.prototype.getLimitHammerBossExchangeActivityId=function(e){for(var t=-1,a=0;a<this._activityList.length;a++)this._activityList[a].showUiType==i.ActivityShowUIType.ActivityExchange&&this._activityList[a].jumpTo==e&&(t=this._activityList[a].id);return t},t.prototype.onFMessage_MVC_SHOW_ACTIVITY_PURCHACE_REWARD=function(e){if(h.DATA.UserData.FunctionOn(i.FunctionKey.LCJD)&&_.ExchangeController.Instance.canPay()){var t=null,a=this.getActivityByActivityUIType(i.ActivityShowUIType.ActivityWorldPurchace),o=this.getActivityByActivityUIType(i.ActivityShowUIType.ActivityDailyPurchace);if(a?t=a:o&&(t=o),t)for(var n=t.atarget.sort(function(e,t){return e?t?e.target-t.target:1:-1}),r=0;r<n.length;r++){var s=n[r];if(""!=s.task_show_limit){var l=c.default.convertStringToArray(s.task_show_limit);l.length>1&&Number(l[1])<=s.num&&0==s.state&&p.default.Instance().OpenUI(u.UIDataInfo.ActivityPurchaceRewardPanel,t,s)}else 0==s.state&&p.default.Instance().OpenUI(u.UIDataInfo.ActivityPurchaceRewardPanel,t,s)}}return!0},t.prototype.getShareBoxChangeVal=function(){return this._shareBoxChangeVal},t.prototype.resetShareBoxChangeVal=function(){this._shareBoxChangeVal=0},Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.purge=function(){t._instance=null},t}(o.FMessageConnectionAbstract);a.ActivityController=N,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/LoadManager":"LoadManager","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Module/UI/FreeGoldPanel":"FreeGoldPanel","../Tools/GameTools":"GameTools","../Tools/SubPackMsgs":"SubPackMsgs","../msgs/MvcMsgs":"MvcMsgs","./ExchangeController":"ExchangeController","./RewardController":"RewardController"}],ArmyEquipController:[function(e,t,a){"use strict";cc._RF.push(t,"c35b28WpWBBpYtsbrA/ve3H","ArmyEquipController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../Data/DataCenter"),i=e("../../fws/mvc/FWSMvc"),r=e("../Data/ArmyEquipData"),s=e("../Tools/GameTools"),l=e("../../Core/Net/NetMgr"),c=e("../Const/RequestId"),d=e("../../fws/utils/FWSTool"),p=e("../Const/TableName"),u=function(e){function t(){var t=e.call(this)||this;return t.equipGroupIndex=0,t.groups=[[],[],[],[]],t}return __extends(t,e),t.getArmyGroupData=function(){var e=s.default.getDataConfigData(11109);Number(e)>n.DATA.UserData.Level||l.NET.send(c.RequestId.GET_ARMY_EQUIP_GROUP,{},this,function(e){var a=s.default.JSON_PARSE(e.d);d.Obj.isEmpty(a)||t.getInstance().initEquipGroup(a)})},t.prototype.initEquipGroup=function(e){if(void 0!=e.nowIdx&&(this.equipGroupIndex=e.nowIdx),e.armyEquips){this.groups=[[],[],[],[]];for(var t=0;t<e.armyEquips.length;t++)if(this.groups[e.armyEquips[t].index]){var a=new r.default;a.UpdateData(e.armyEquips[t]),this.groups[e.armyEquips[t].index].push(a)}}},t.prototype.updateEquipData=function(e){if(void 0!=e.index&&this.groups[e.index]){for(var t=0;t<this.groups[e.index].length;t++)if(this.groups[e.index][t].ArmyType===e.armyType&&this.groups[e.index][t].Pos===e.pos)return void(this.groups[e.index][t].ItemId=e.itemId);var a=new r.default;a.UpdateData(e),this.groups[e.index].push(a)}},t.prototype.IsInstallSameGroup=function(e,t,a){var n=o.TABLE.getTableDataById(p.TableName.ITEM,a.toString());if(!n)return!1;for(var i=this.getNowGroupEquips(),r=0;r<i.length;r++){var s=i[r];if(s.ArmyType===e&&s.Pos!==t){var l=o.TABLE.getTableDataById(p.TableName.ITEM,s.ItemId.toString());if(l&&n.group===l.group)return!0}}return!1},t.prototype.isCanUnlock=function(e){var t=o.TABLE.getTableDataById(p.TableName.DATACONFIG,"11103"),a=o.TABLE.getTableDataById(p.TableName.DATACONFIG,"11104");if(t&&a){var i=t.value.split("|"),r=a.value.split("|");return!(e>=i.length||e>=r.length)&&!(n.DATA.UserData.Level<parseInt(i[e])||n.DATA.UserData.Resource.Coin<parseInt(r[e]))}},t.prototype.isCanCompose=function(e){var t=o.TABLE.getTableDataById(p.TableName.ITEM,e.toString());if(t&&n.DATA.UserData.getSameGroupItemIdByLv(t.group,t.level+1)<=0)return!1;var a=n.DATA.UserData.getItemAmount(e)+1,i=o.TABLE.getTableDataById(p.TableName.DATACONFIG,"11101");return!!i&&a>=i.value},t.prototype.isCanUpgrade=function(e){var t=o.TABLE.getTableDataById(p.TableName.ITEM,e.toString());if(!t)return!1;var a=!1,i=n.DATA.UserData.getSameGroupItemIdByLv(t.group,t.level+1),r=o.TABLE.getTableDataById(p.TableName.ENHANCE,i.toString());return r&&r.enhance_oila<=n.DATA.UserData.Resource.Oila&&r.enhance_metal<=n.DATA.UserData.Resource.Metal&&r.enhance_soil<=n.DATA.UserData.Resource.Soil&&r.enhance_coal<=n.DATA.UserData.Resource.Coal&&(a=!0),a},t.prototype.hasCanUpgrade=function(){for(var e=0;e<2;e++){var t=n.DATA.UserData.getArmyEquipIdByTypeAndPos(GameDefine.ArmyType.Land,e);if(this.isCanUpgrade(t))return!0}for(e=0;e<2;e++){t=n.DATA.UserData.getArmyEquipIdByTypeAndPos(GameDefine.ArmyType.Sea,e);if(this.isCanUpgrade(t))return!0}for(e=0;e<2;e++){t=n.DATA.UserData.getArmyEquipIdByTypeAndPos(GameDefine.ArmyType.Air,e);if(this.isCanUpgrade(t))return!0}return!1},t.prototype.hasCanUnlock=function(){for(var e=0;e<5;e++){if(-1==n.DATA.UserData.getArmyEquipIdByTypeAndPos(GameDefine.ArmyType.Land,e+2)&&this.isCanUnlock(e+2))return!0}for(e=0;e<5;e++){if(-1==n.DATA.UserData.getArmyEquipIdByTypeAndPos(GameDefine.ArmyType.Sea,e+2)&&this.isCanUnlock(e+2))return!0}for(e=0;e<5;e++){if(-1==n.DATA.UserData.getArmyEquipIdByTypeAndPos(GameDefine.ArmyType.Air,e+2)&&this.isCanUnlock(e+2))return!0}return!1},t.prototype.getBgStr=function(e){var t=o.TABLE.getTableDataById(p.TableName.ITEM,e.toString());return!t||t.quality>5||t.quality<1?"bg_icon6_3":"bg_icon6_"+t.quality},Object.defineProperty(t.prototype,"EquipGroupIndex",{get:function(){return this.equipGroupIndex},set:function(e){e<0||e>3||(this.equipGroupIndex=e)},enumerable:!0,configurable:!0}),t.prototype.getAllGroup=function(){return this.groups},t.prototype.getNowGroupEquips=function(){return this.groups[this.equipGroupIndex]?this.groups[this.equipGroupIndex]:[]},t.prototype.getArmyEquipIdByTypeAndPos=function(e,t){for(var a=!1,o=0;o<n.DATA.UserData.ArmyEquips.length;o++)if(n.DATA.UserData.ArmyEquips[o].ArmyType===e&&n.DATA.UserData.ArmyEquips[o].Pos===t){a=!0;break}if(a){var i=this.getNowGroupEquips();for(o=0;o<i.length;o++)if(i[o].ArmyType===e&&i[o].Pos===t)return i[o].ItemId;return 0}return-1},t.getInstance=function(){return this._instance||(this._instance=new t),window.ArmyEquipController=this._instance,this._instance},t.prototype.purge=function(){this.groups=[[],[],[],[]],this.equipGroupIndex=0},t}(i.FMessageConnectionAbstract);a.ArmyEquipController=u,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/utils/FWSTool":"FWSTool","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Data/ArmyEquipData":"ArmyEquipData","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools"}],BuildingController:[function(e,t,a){"use strict";cc._RF.push(t,"4bdc9E1eftCCZecK3cHk0Bl","BuildingController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../../fws/utils/ErrorReport"),i=e("../Const/TableName"),r=function(){function e(){this._buildingGroupLevelArrayMap=null,this._buildingGroupIdArray=null,this.inited=!1}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._instance=null},e.prototype.initBuildingStaticData=function(){var e=o.TABLE.getTableGroup(i.TableName.BUILDING);if(this._buildingGroupLevelArrayMap=this._buildingGroupLevelArrayMap||{},this._buildingGroupIdArray=this._buildingGroupIdArray||[],e&&!this.inited)for(var t in this.inited=!0,e){var a=e[t],n=a.group,r=this._buildingGroupLevelArrayMap[n];r||(this._buildingGroupLevelArrayMap[n]=r=[],this._buildingGroupIdArray.push(n)),r[a.level]=a}},e.prototype.getBuildingDataByGroupAndLevel=function(e,t){this.inited||n.custom("BuildingControllerError",{resp:"getBuildingDataByGroupAndLevel\u8c03\u7528\u524d\u672a\u521d\u59cb\u5316BuildingController"}),this.initBuildingStaticData();var a=this._buildingGroupLevelArrayMap[e];return a&&t<a.length?a[t]:null},e}();a.default=r,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../fws/utils/ErrorReport":"ErrorReport","../Const/TableName":"TableName"}],DevConfigController:[function(e,t,a){"use strict";cc._RF.push(t,"0af67ZNtV5JwaRIP33yQao8","DevConfigController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Common/UIManager"),n=e("../Const/UIDataInfo"),i=e("../msgs/MvcMsgs"),r=function(){function e(){this._devServerWXPay=!1,this._devShowDrawCall=!1,this._hideUI=!1,this._hideScene=!1,this._hideAll=!1}return e.prototype.openDevSwitchPanel=function(){this.isDevServer()&&o.default.Instance().OpenUI(n.UIDataInfo.DevSwitchPanel)},e.prototype.isDevServer=function(){var e=!1;return window.OnlineServer||(e=!0),e},Object.defineProperty(e.prototype,"devServerWXPay",{get:function(){return this._devServerWXPay},set:function(t){(this._devServerWXPay=t,t&&e.isFirst)&&(e.isFirst=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"devShowDrawCall",{get:function(){return this._devShowDrawCall},set:function(e){this._devShowDrawCall=e,cc.debug.setDisplayStats(this._devShowDrawCall)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideUI",{get:function(){return this._hideUI},set:function(e){this._hideUI=e,i.send(i.Names.DEBUG_HIDE_MAINUI,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideScene",{get:function(){return this._hideScene},set:function(e){this._hideScene=e,i.send(i.Names.DEBUG_HIDE_SCENE,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideAll",{get:function(){return this._hideAll},set:function(e){this._hideAll=e,i.send(i.Names.DEBUG_HIDE_ALL,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.isFirst=!0,e}();a.DevConfigController=r,cc._RF.pop()},{"../Common/UIManager":"UIManager","../Common/WXPayModel":"WXPayModel","../Const/UIDataInfo":"UIDataInfo","../msgs/MvcMsgs":"MvcMsgs"}],ExchangeController:[function(e,t,a){"use strict";cc._RF.push(t,"e9f39jc1QNKYIMnLBPbt0v/","ExchangeController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../fws/mvc/FWSMvc"),i=e("../../fws/utils/FWSTool"),r=e("../Data/DataCenter"),s=e("../Const/GameDefine"),l=e("../Tools/GameTools"),c=e("../Common/UIManager"),d=e("../Const/UIDataInfo"),p=e("../msgs/MvcMsgs"),u=e("../Common/BIManager"),h=e("../msgs/PayMsgs"),m=e("../../Core/Net/NetMgr"),f=e("../Const/RequestId"),_=e("../../fws/platforms/PlatformCore"),y=(e("../../fws/utils/X"),e("../../Core/Event/EventCenter")),g=e("../Const/EventId"),C=e("../Const/GameDefine"),v=e("../../Core/Common/TableManager"),I=e("../Const/TableName"),T=e("../Data/GlobalData"),S=e("../Common/PFOpenData"),A=e("../../fws/platforms/PlatformCore"),D=function(){function e(){}return e.getPropertyStringByNameFast=function(e,t,a){var o=e?e[a]:void 0;return void 0!==o&&null!==o?"string"==typeof o?o:o.toString():t},e.getPropertyNumberByNameFast=function(e,t,a){var o=e?e[a]:void 0;return void 0!==o&&null!==o?"number"==typeof o?o:parseInt(o):t},e}(),N=function(){function e(){this._map={},this._rawMap={},this._allExchangeConfigIdArray=[],this._firstSetData=!0,this._configVer=null}return Object.defineProperty(e.prototype,"configVer",{get:function(){return this._configVer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allExchangeConfigIds",{get:function(){return this._allExchangeConfigIdArray},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._map={},this._rawMap={},this._allExchangeConfigIdArray=[],this._firstSetData=!0},e.prototype.getOrCreateExchangConfig=function(e){var t=this._map[e];if(!t){var a=this._rawMap[e];a?(this._map[e]=t=this.createNewExchangeConfig(e,a),a[e]=void 0):t=null}return t},e.prototype.getExchangeConfigNumberProp=function(e,t,a,o){void 0===o&&(o=!1);var n=null;return o?n=this.getOrCreateExchangConfig(e):(n=this._map[e])||(n=this._rawMap[e]),D.getPropertyNumberByNameFast(n,a,t)},e.prototype.getExchangeConfigStringProp=function(e,t,a,o){void 0===o&&(o=!1);var n=null;return o?n=this.getOrCreateExchangConfig(e):(n=this._map[e])||(n=this._rawMap[e]),D.getPropertyStringByNameFast(n,a,t)},e.prototype.createNewExchangeConfig=function(e,t){var a=D.getPropertyNumberByNameFast,o=D.getPropertyStringByNameFast,n=parseInt(e),i=a(t,s.GiftType.NONE,"type"),r=a(t,0,"product_id"),l=a(t,0,"product_id_2"),c=a(t,0,"default_gold"),d=a(t,0,"gold"),p=a(t,0,"free_gold"),u=a(t,0,"reward"),h=o(t,"","condition"),m=a(t,0,"time_type"),f=o(t,"","para1"),_=o(t,"","para2"),y=o(t,"","para3"),g=a(t,0,"order"),C=a(t,-1,"previous"),v=a(t,0,"buy_times"),I=o(t,"","name"),T=o(t,"","desc"),S=o(t,"","desc2"),A=a(t,0,"is_open"),N=o(t,"","icon_big"),b=o(t,"","icon_small"),L=o(t,"","exchange_ui_effect"),E=a(t,-1,"alliance_gift"),P=a(t,0,"use_crystal"),w=a(t,0,"crystal"),B=a(t,0,"off"),M=o(t,"","channel"),U=a(t,0,"not_show"),R=a(t,0,"price"),G=a(t,0,"page_order"),O=a(t,0,"init_price"),k=o(t,"","foreign_price_id"),x=a(t,0,"mainUI_show"),F=a(t,0,"mainUI_weight"),V=o(t,"","ad_icon"),H=a(t,0,"money_score"),W=a(t,0,"eject_order"),j="",q=a(t,0,"pf_payid"),K=o(t,"","ad_icon_mainUi"),Y=a(t,0,"p1"),X=a(t,0,"p2");return N.length>0?j="exchange/"+N:i===s.GiftType.PREFERENTIAL_GIFT&&(j="exchange/exchange_default"),V.length>0&&(V="exchange/"+V),{id:n,type:i,product_id:r,product_id_2:l,default_gold:c,gold:d,free_gold:p,reward:u,condition:h,time_type:m,para1:f,para2:_,para3:y,p1:Y,p2:X,order:g,eject_order:W,previous:C,buy_times:v,name:I,desc:T,desc2:S,is_open:A,icon_big:N,icon_small:b,exchange_ui_effect:L,alliance_gift:E,use_crystal:P,crystal:w,off:B/10,channel:M,not_show:U,remoteImage:j,serverStartTime:0,serverEndTime:0,price:R,page_order:G,init_price:O,foreign_price_id:k,mainUI_show:x,mainUI_weight:F,adIcon:V,money_score:H,pf_payid:q,ad_icon_mainUi:K}},e.prototype.setExchangeConfig=function(e,t){if(!(i.Obj.isEmpty(e)||t&&t===this._configVer))if(this._configVer=t,this._firstSetData?this._firstSetData=!1:(this._map={},this._allExchangeConfigIdArray=null),i.Obj.isEmpty(e))this._rawMap={},this._allExchangeConfigIdArray=[];else{this._rawMap=e;this._allExchangeConfigIdArray=Object.keys(e)}},e.prototype.updateExchangeConfig=function(e,t){if(!(i.Obj.isEmpty(e)||t&&t===this._configVer)){this._configVer=t;var a=e;for(var o in this._firstSetData=!1,a)if(a.hasOwnProperty(o)){var n=a[o];this._map[o]?this._map[o]=this.createNewExchangeConfig(o,n):this._rawMap[o]?this._rawMap[o]=n:(this._rawMap[o]=n,this._allExchangeConfigIdArray[this._allExchangeConfigIdArray.length]=o)}}},e}(),b=function(t){function a(){var e=t.call(this)||this;return e.weeklyRewardShowed=!1,e.monthlyRewardShowed=!1,e._exchangeConfigMap=new N,e._exchangeReward={},e._serverExchangeCanPayMap={},e._serverOrderedExchangeIds=[],e._exchangeAllPrice={},e._exchangeAllPriceUnit={CNY:"",JPY:"",RUB:"",USD:""},e._exchangePlatformPayidMap={},o.LOCAL.moneyFormatMethod=e.getPriceTextWithExchageConfigForeignPriceId,Object.preventExtensions&&Object.preventExtensions(e._exchangeConfigMap),e}return __extends(a,t),a.AutoPopupView=function(){if(0==l.default.canPay())return!1;if(r.DATA.UserData.Level<6)return!1;var e=l.default.GetTimeOfDay(),t=r.DATA.UserData.getLocalData(s.LocalDataKey.PopupGiftShowDay,0),o=r.DATA.UserData.getLocalData(s.LocalDataKey.PopupGiftShowTime,0);if((0==t||e>t)&&(o=0),o>=3)return!1;r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowDay,e);var n=a.CheckHaveGiftToShow();if(n===s.GiftType.NONE)return!1;if(n==s.GiftType.WEEKLY_CARD){var i={tabType:s.GiftShopTabType.WEEKLY_CARD_GIFT};return c.default.Instance().OpenUI(d.UIDataInfo.GiftShopPanel,i),!0}return n==s.GiftType.MONTHLY_CARD?(a.Instance.openMonthlyCard(),!0):(a.tryShowByGiftType(n),r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowTime,o+1),!0)},a.canShowAutoPopup=function(){if(0==l.default.canPay())return!1;if(r.DATA.UserData.Level<6)return!1;var e=l.default.GetTimeOfDay(),t=r.DATA.UserData.getLocalData(s.LocalDataKey.PopupGiftShowDay,0),a=r.DATA.UserData.getLocalData(s.LocalDataKey.PopupGiftShowTime,0);return(0==t||e>t)&&(a=0),!(a>=999)},a.AutoPopupView2=function(){a.AutoPopedView=!0;var e=a.Instance.getFirstShowArr();if(e.length>0)for(var t=l.default.GetTimeOfDay(),o=r.DATA.UserData.getLocalData(s.LocalDataKey.PopupGiftShowTime,0),n=0;n<e.length;n++){var p=e[n];if(p.type==C.GiftType.FIRST){if((a.Instance.getCanPayExchangeConfigById(13003)||a.Instance.getCanPayExchangeConfigById(13005))&&a.Instance.canPay())return this.openFirstChargeBenefitPanel(),!0}else if(p.type==C.GiftType.HERO_GIFT||p.type==C.GiftType.HERO_FRAG_GIFT){var u=v.TABLE.getTableDataById(I.TableName.DATACONFIG,"44001"),h=parseInt(i.Obj.getProperty(u,"value",8));if(r.DATA.UserData.FunctionOn(s.FunctionKey.hero_gift_pop)&&a.Instance.isHeroGiftCanBuy()&&r.DATA.UserData.Level>=h&&r.DATA.UserData.FunctionOn(s.FunctionKey.hero_gift_icon_show))return c.default.Instance().OpenUI(d.UIDataInfo.HeroGiftSSRPanel),!0}else if(p.type===C.GiftType.WEEKLY_CARD){if(a.canShowAutoPopup()&&a.Instance.isWeeklyCardCanBuy()){r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowDay,t);var m={tabType:C.GiftShopTabType.WEEKLY_CARD_GIFT};return c.default.Instance().OpenUI(d.UIDataInfo.GiftShopPanel,m),r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowTime,o+1),!0}}else if(p.type==C.GiftType.MONTHLY_CARD){if(a.canShowAutoPopup()&&a.Instance.isMonthlyCardCanBuy())return r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowDay,t),a.Instance.openMonthlyCard(),r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowTime,o+1),!0}else if(p.type==C.GiftType.PREFERENTIAL_GIFT){if(a.canShowAutoPopup())return r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowDay,t),a.tryShowByGiftType(p.type),r.DATA.UserData.setLocalData(s.LocalDataKey.PopupGiftShowTime,o+1),!0}else if(p.type==C.GiftType.FIRST_PAGE_GIFT)return c.default.Instance().OpenUI(d.UIDataInfo.FirstPageGiftPanel),!0}return a.Instance.checkWeeklyCardReward(),!1},a.openFirstChargeBenefitPanel=function(e){void 0===e&&(e=!1),a.Instance.getCanPayExchangeConfigById(13005)?c.default.Instance().OpenUI(d.UIDataInfo.firstChargeBenefitPanelNew,e):(a.Instance.getCanPayExchangeConfigById(13003)||a.Instance.getCanPayExchangeConfigById(13004))&&c.default.Instance().OpenUI(d.UIDataInfo.firstChargeBenefitG123Panel,e)},a.CheckHaveGiftToShow=function(){var e=s.GiftType.NONE;return a.Instance.isWeeklyCardCanBuy()?e=s.GiftType.WEEKLY_CARD:a.Instance.isMonthlyCardCanBuy()?e=s.GiftType.MONTHLY_CARD:a.Instance.isHaveFirstPayGift()?e=s.GiftType.FIRST:a.Instance.isPreferentialCanBuy()&&(e=s.GiftType.PREFERENTIAL_GIFT),e},a.prototype.getFirstShowArr=function(){var e=this._serverExchangeCanPayMap,t=[];if(!this.canPay())return t;for(var a in e)if(e[a]&&e[a].eject_order>0&&this.isExchangeInTime(e[a])){if(e[a].type==s.GiftType.WEEKLY_CARD&&this.isWeeklyCardInTime())continue;if(e[a].type==s.GiftType.MONTHLY_CARD&&this.isMonthlyCardInTime(e[a].id))continue;t.push(e[a])}return t.sort(function(e,t){return e.eject_order==t.eject_order?e.id-t.id:t.eject_order-e.eject_order}),t},a.tryShowByGiftId=function(e){if(void 0!=e){var t=a.Instance.getCanPayExchangeConfigById(e);if(i.Obj.isEmpty(t))c.default.Instance().ShowTips(o.LOCAL.getText("skin_get_toast_001"));else{var n=a.Instance.getExchangeTypeById(e);a.tryShowByGiftType(n)}}},a.tryShowByGiftType=function(e){if(a.Instance.giftShopShow()){var t=a.getTabTypeByGiftType(e),o=c.default.Instance().getUIByUIData(d.UIDataInfo.GiftShopPanel);if(i.Obj.isEmpty(o)){var n={tabType:t};c.default.Instance().OpenUI(d.UIDataInfo.GiftShopPanel,n)}else{n={tabType:t};p.send(p.Names.MVC_GIFT_SHOP_TAB_UPDATE,n)}}},a.tryShowByGiftShopTabType=function(e){if(a.Instance.giftShopShow()){var t={tabType:e};c.default.Instance().OpenUI(d.UIDataInfo.GiftShopPanel,t)}},a.tryShow=function(e){void 0===e&&(e=null),a.Instance.giftShopShow()&&c.default.Instance().OpenUI(d.UIDataInfo.GiftShopPanel,e)},a.getTabTypeByGiftType=function(e){var t=s.GiftShopTabType.BASE_GIFT;switch(e){case s.GiftType.FIRST:t=s.GiftShopTabType.FIRST_GIFT;break;case s.GiftType.WEEKLY_CARD:t=s.GiftShopTabType.WEEKLY_CARD_GIFT;break;case s.GiftType.PREFERENTIAL_GIFT:t=s.GiftShopTabType.PREFERENTIAL_GIFT;break;case s.GiftType.GROWTH_FUND:t=s.GiftShopTabType.GROWTH_FUND_GIFT;break;case s.GiftType.ACTIVITY_GIFT:t=s.GiftShopTabType.ACTIVITY_GIFT;break;case s.GiftType.HERO_GIFT:t=s.GiftShopTabType.HERO_GIFT;break;case s.GiftType.HERO_SKIN_GIFT:t=s.GiftShopTabType.HEROSKIN_GIFT;break;case s.GiftType.LIMIT_GIFT:t=s.GiftShopTabType.LIMITED_SHOP}return t},a.prototype.getMonthlyCardDiscountID=function(e){switch(e){case a.MONTHLYCARD_SHIT_ID_2:return a.MONTHLYCARD_SHIT_ID_2_DISCOUNT;case a.ADVANCE_MONTHLYCARD_SHIT_ID_2:return a.ADVANCE_MONTHLYCARD_SHIT_ID_2_DISCOUNT;default:return e}},a.prototype.isGiftShopIconShow=function(){var e=r.DATA.UserData.Level>=2,t=this.giftShopShow();return e&&t},a.prototype.giftShopShow=function(){var e=!0;do{if(this.canPay())break;if(this.isHaveShop())break;if(this.isHaveFirstPayGift())break;if(this.isWeeklyCardShow())break;e=!1}while(0);return e},a.prototype.isHaveFirstPayGift=function(){return!1},a.prototype.isHaveAdvanceGiftPayGift=function(){var e=!1;do{if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.AdvanceGift))break;if(r.DATA.UserData.Level<6&&this.getCanPayExchangeConfigArrayByType(s.GiftType.FIRST).length>0)break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.AdvanceGift).length>0))break;e=!0}while(0);return e},a.prototype.isHaveLuxuryGiftPayGift=function(){var e=!1;do{if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.LuxuryGift))break;if(r.DATA.UserData.Level<10&&this.getCanPayExchangeConfigArrayByType(s.GiftType.AdvanceGift).length>0)break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.LuxuryGift).length>0))break;e=!0}while(0);return e},a.prototype.isWeeklyCardCanBuy=function(){var e=!1;do{if(this.isWeeklyCardInTime())break;if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.weekly_card))break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.WEEKLY_CARD).length>0))break;e=!0}while(0);return e},a.prototype.isWeeklyCardShow=function(){var e=!1;do{if(this.isWeeklyCardInTime()){e=!0;break}e=this.isWeeklyCardCanBuy()}while(0);return e},a.prototype.isPreferentialCanBuy=function(e){void 0===e&&(e=s.GiftType.PREFERENTIAL_GIFT);var t=!1;do{if(!this.canPay())break;if(!(this.getCanPayExchangeConfigArrayByType(e).length>0))break;t=!0}while(0);return t},a.prototype.isHeroGiftCanBuy=function(){var e=!1;do{if(!this.canPay())break;var t=this.getCanPayExchangeConfigArrayByType(s.GiftType.HERO_GIFT),a=this.getCanPayExchangeConfigArrayByType(s.GiftType.HERO_FRAG_GIFT);if(!(t.concat(a).length>0))break;e=!0}while(0);return e},a.prototype.isFirstPageGiftCanBuy=function(){var e=!1;do{if(!this.canPay())break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.FIRST_PAGE_GIFT).length>0))break;e=!0}while(0);return e},a.prototype.isHeroSkinGiftCanBuy=function(){var e=!1;do{if(!this.canPay())break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.HERO_SKIN_GIFT).length>0))break;e=!0}while(0);return e},a.prototype.isCrystalGiftCanBuy=function(){var e=!1;if("appiosglobal"===_.instance.platformSID&&T.GLOBAL.IsReviewVersion)return!1;do{if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.crystal))break;if(r.DATA.UserData.FunctionOn(s.FunctionKey.crystal_vip_unlock)){var t=0,a=v.TABLE.getTableDataById(I.TableName.DATACONFIG,"31003");if(a&&(t=parseInt(a.value)),r.DATA.UserData.VipLevel<t)break}if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.CRYSTAL_GIFT).length>0))break;e=!0}while(0);return e},a.prototype.isDubbingGiftCanBuy=function(){var e=!1;do{if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.system_voice_pack))break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.DUBBING_GIFT).length>0))break;e=!0}while(0);return e},a.prototype.isEmotionGiftCanBuy=function(){var e=!1;do{if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.emotion_new))break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.EMOTION_GIFT).length>0))break;e=!0}while(0);return e},a.prototype.isActivityGiftCanShow=function(){do{if(!this.canPay())break;if(!(this.getCanPayExchangeConfigArrayByType(s.GiftType.ACTIVITY_GIFT).length>0))break;!0}while(0);return!1},a.prototype.isDailyGoodyBagCanBuy=function(){return!0},a.prototype.isGrowthFundCanBuy=function(){var t=!1;do{if(e("./GrowthFundController").GrowthFundController.Instance.isGrowthFundBuy())break;if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.growth_fund))break;if(this.getCanPayExchangeConfigArrayByType(s.GiftType.GROWTH_FUND).length>0){t=!0;break}}while(0);return t},a.prototype.isSkinPatchCanBuyById=function(e){var t=!1;do{if(!this.canPay())break;var a=this.getCanPayExchangeConfigById(e);if(i.Obj.isEmpty(a))break;t=!0}while(0);return t},a.prototype.isGrowthFundShow=function(){var t=!1;do{if(e("./GrowthFundController").GrowthFundController.Instance.isGrowthFundBuy()){t=!0;break}t=this.isGrowthFundCanBuy()}while(0);return t},a.prototype.isHaveShop=function(){var e=!1;do{if(!r.DATA.UserData.FunctionOn(s.FunctionKey.buy_prop))break;e=!0}while(0);return e},a.prototype.buyMonthlyCard=function(){this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_NEW)?this.openMonthlyCardById(a.MONTHLYCARD_SHIT_ID_NEW):this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_1)?this.openMonthlyCardById(a.MONTHLYCARD_SHIT_ID_1):(this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_2)||this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_2_DISCOUNT))&&this.openMonthlyCardById(a.MONTHLYCARD_SHIT_ID_2)},a.prototype.buyForeverCard=function(){this.isMonthlyCardCanBuyById(a.FOREVER_CARD)&&this.openMonthlyCardById(a.FOREVER_CARD)},a.prototype.openMonthlyCard=function(){this.isMonthlyCardShowById(a.MONTHLYCARD_SHIT_ID_NEW)?this.openMonthlyCardById(a.MONTHLYCARD_SHIT_ID_NEW):this.isMonthlyCardShowById(a.MONTHLYCARD_SHIT_ID_1)?this.openMonthlyCardById(a.MONTHLYCARD_SHIT_ID_1):this.isMonthlyCardShowById(a.MONTHLYCARD_SHIT_ID_2)&&this.openMonthlyCardById(a.MONTHLYCARD_SHIT_ID_2)},a.prototype.openMonthlyCardById=function(e){e==a.MONTHLYCARD_SHIT_ID_NEW?c.default.Instance().OpenUI(d.UIDataInfo.PrefabMonthlyCardNew,a.MONTHLYCARD_SHIT_ID_NEW):e==a.FOREVER_CARD?c.default.Instance().OpenUI(d.UIDataInfo.PrefablifetimeCardNew,a.FOREVER_CARD):this.isMonthlyCardInTime(e)||this.isMonthlyCardInTime(a.ADVANCE_MONTHLYCARD_SHIT_ID_2)?c.default.Instance().OpenUI(d.UIDataInfo.monthlyAdvanceCardPanel,e):c.default.Instance().OpenUI(d.UIDataInfo.MonthlyCardPanel,e)},a.prototype.isForeverCardCanBuy=function(){return this.isMonthlyCardCanBuyById(a.FOREVER_CARD)},a.prototype.isMonthlyCardCanBuy=function(){return this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_NEW)||this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_1)||this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_2)||this.isMonthlyCardCanBuyById(a.MONTHLYCARD_SHIT_ID_2_DISCOUNT)},a.prototype.isMonthlyCardCanBuyById=function(e){var t=!1;do{if(this.isMonthlyCardInTime(e))break;if(!this.canPay())break;if(!r.DATA.UserData.FunctionOn(s.FunctionKey.monthly_card))break;var a=this.getCanPayExchangeConfigById(e);if(i.Obj.isEmpty(a))break;if(r.DATA.UserData.WorldCoord.x<0||r.DATA.UserData.WorldCoord.y<0)break;if(r.DATA.UserData.Level<5)break;t=!0}while(0);return t},a.prototype.isMonthlyCardShow=function(){return this.isMonthlyCardShowById(a.MONTHLYCARD_SHIT_ID_1)||this.isMonthlyCardShowById(a.MONTHLYCARD_SHIT_ID_2)},a.prototype.isMonthlyCardShowById=function(e){var t=!1;do{if(this.isMonthlyCardInTime(e)){t=!0;break}if(!(t=this.isMonthlyCardCanBuyById(e))){var a=this.getMonthlyCardDiscountID(e);if(a!=e)this.isMonthlyCardCanBuyById(a)&&(t=!0)}}while(0);return t},a.prototype.checkWeeklyCardReward=function(){var e=this;if(r.DATA.UserData.FunctionOn(s.FunctionKey.MonthlyCardRewardPop))if(a.AutoPopedView){var t=r.DATA.ServerTime,o=0,n=0,l=this.getWeeklyCard();i.Obj.isEmpty(l)||(o=i.Obj.getPropertyByNames(l,0,"endTime"),n=i.Obj.getPropertyByNames(l,0,"nextRewardTime")),t<o&&t>n&&!this.weeklyRewardShowed?setTimeout(function(){var t={tabType:C.GiftShopTabType.WEEKLY_CARD_GIFT};c.default.Instance().OpenUI(d.UIDataInfo.GiftShopPanel,t),e.weeklyRewardShowed=!0},.5):(!this.monthlyRewardShowed&&(this.isMonthlyCardHaveReward(a.MONTHLYCARD_SHIT_ID_1)||this.isMonthlyCardHaveReward(a.MONTHLYCARD_SHIT_ID_2)||this.isMonthlyCardHaveReward(a.ADVANCE_MONTHLYCARD_SHIT_ID_2))&&(this.openMonthlyCard(),this.monthlyRewardShowed=!0),a.AutoPopedView=!1)}else a.AutoPopedView=!1;else a.AutoPopedView=!1},a.prototype.openBasePayView=function(){a.tryShowByGiftShopTabType(s.GiftShopTabType.BASE_GIFT)},a.prototype.checkGoldEnough=function(e,t){void 0===t&&(t=!1);var a;return(a=r.DATA.UserData.Resource.getResource(s.ResourceType.Gold)>=e)||t&&this.openBasePayView(),a},a.prototype.getPriceShow=function(e){return e?_.instance.getPayPriceShow(e.id):"1"},a.prototype.getPriceWithUnit=function(e){if(!e)return"1";if("g123"===_.instance.platformSID){if("en"===o.LOCAL.getLanguage()){var t=parseInt(_.instance.getPayPriceShow(e.id))/100,a=t.toFixed(2);return 0===t&&(t=1),"$"+a}return"\uffe5"+_.instance.getPayPriceShow(e.id)}return this.getPriceTextWithExchageConfigForeignPriceId(e.foreign_price_id,e)},a.prototype.getCanPayExchangeConfigArrayByType=function(e){if(e==s.GiftType.EQUIP_GIFT){var t=[],a=this._serverExchangeCanPayMap;for(var o in a)if(a.hasOwnProperty(o)){var n=a[o];i.Obj.getPropertyByNames(n,s.GiftType.NONE,"type")===e&&this.isExchangeInTime(n)&&(_.instance.checkExchangeIdForbidden(n.id)||t.push(n))}return t}var l=r.DATA.UserData.FunctionOn(s.FunctionKey.AIGiftOrder),c=[],d=this._serverExchangeCanPayMap;for(var o in d)if(d.hasOwnProperty(o)){n=d[o];if(i.Obj.getPropertyByNames(n,s.GiftType.NONE,"type")===e&&this.isExchangeInTime(n)&&!_.instance.checkExchangeIdForbidden(n.id)){if(e===s.GiftType.PREFERENTIAL_GIFT&&l)if(this._serverOrderedExchangeIds&&this._serverOrderedExchangeIds.length>0){var p=this._serverOrderedExchangeIds.indexOf(n.id);n.aiOrder=p+1}else n.aiOrder=0;c.push(n)}}return e===s.GiftType.PREFERENTIAL_GIFT&&l&&(c.sort(function(e,t){return e.aiOrder==t.aiOrder?e.order-t.order:e.aiOrder-t.aiOrder}),window.OnlineServer||console.log("getCanPayExchangeConfigArrayByType === ",JSON.stringify(c))),c},a.prototype.getExchangeConfigArrayByType=function(e){for(var t=[],a=this._exchangeConfigMap,o=a.allExchangeConfigIds,n=o.length,i=0;i<n;++i){var r=o[i];a.getExchangeConfigNumberProp(r,"type",s.GiftType.NONE,!1)===e&&t.push(a.getOrCreateExchangConfig(r))}return t},a.prototype.getCanPayExchangeConfigById=function(e){var t=null,a=e.toString(),o=i.Obj.getPropertyByNames(this._serverExchangeCanPayMap,null,a);return!i.Obj.isEmpty(o)&&this.isExchangeInTime(o)&&(t=o),t},a.prototype.getExchangeConfigById=function(e){if(!e)return null;var t=e.toString();return this._exchangeConfigMap.getOrCreateExchangConfig(t)},a.prototype.getExchangePlatformPayidByExchangeId=function(e){var t=this.getExchangeConfigById(e);return this.getExchangePaltformPayidByPFPayid(t.pf_payid)},a.prototype.getExchangePaltformPayidByPFPayid=function(e){return i.Obj.getPropertyStringByNames(this._exchangePlatformPayidMap,"",e)},a.prototype.getExchangeTypeById=function(e){var t=e.toString();return this._exchangeConfigMap.getExchangeConfigNumberProp(t,"type",s.GiftType.NONE,!1)},a.prototype.getFirstExchangeConfig=function(){for(var e=[3001,13001,13002],t=null,a=this.getCanPayExchangeConfigArrayByType(s.GiftType.FIRST),o=0;o<a.length;o++){var n=a[o];if(e.indexOf(n.id)>=0){t=n;break}}return t},a.prototype.getSecondExchangeConfig=function(){for(var e=null,t=this.getCanPayExchangeConfigArrayByType(s.GiftType.FIRST),a=0;a<t.length;a++){var o=t[a];if(190114101===o.id){var n=r.DATA.ServerTime,i=o.serverStartTime,l=o.serverEndTime;if(i>n||l<=n)break;e=o;break}}return e},a.prototype.isExchangeInTime=function(e){var t=!0;do{if(i.Obj.isEmpty(e))break;var a=r.DATA.ServerTime,o=e.serverEndTime;if(o<=0)break;o<=a&&(t=!1)}while(0);return t},a.prototype.getTimeCardById=function(e){if(!i.Obj.isEmpty(e)){var t=r.DATA.UserData.TimeCards;if(i.Obj.isEmpty(t))return null;for(var a=0;a<t.length;a++){var o=t[a];if(o.cardId===e)return o}return null}},a.prototype.isWeeklyCardInTime=function(){var e=!1,t=this.getWeeklyCard();if(t){var a=i.Obj.getPropertyByNames(t,0,"endTime");r.DATA.ServerTime<a&&(e=!0)}return e},a.prototype.getWeeklyCard=function(){var e=null;do{var t=this.getCanPayExchangeConfigArrayByType(s.GiftType.WEEKLY_CARD);if(t.length<=0)break;var a=t[0],o=i.Obj.getPropertyByNames(a,null,"id");e=this.getTimeCardById(o)}while(0);return e},a.prototype.isMonthlyCardInTime=function(e){var t=!1,a=this.getMonthlyCard(e);if(a){var o=i.Obj.getPropertyByNames(a,0,"endTime");r.DATA.ServerTime<o&&(t=!0)}return t},a.prototype.isMonthlyCardHaveReward=function(e){var t=!1,a=this.getMonthlyCard(e);if(a){var o=i.Obj.getPropertyByNames(a,0,"endTime"),n=i.Obj.getPropertyByNames(a,0,"nextRewardTime"),s=r.DATA.ServerTime;s<o&&s>n&&(t=!0)}return t},a.prototype.getMonthlyCard=function(e){var t=null;do{var o=s.GiftType.MONTHLY_CARD;e==a.ADVANCE_MONTHLYCARD_SHIT_ID_2&&(o=s.GiftType.ADVANCE_MONTH);var n=this.getCanPayExchangeConfigArrayByType(o);if(n.length<=0)break;for(var i=0;i<n.length;i++){var r=n[i];if(r.id===e||r.id===this.getMonthlyCardDiscountID(e)){t=this.getTimeCardById(e);break}}}while(0);return t},a.prototype.getPriceWithExchageConfig_foreign_priceId=function(e){var t;if(t=i.Obj.getPropertyByNames(this._exchangeAllPrice,null,e)){var a=_.instance.getStoreCurrentType(),o=i.Obj.getPropertyStringByNames(t,"",a),n=i.Obj.getPropertyStringByNames(this._exchangeAllPriceUnit,"",a);if(o&&""!=o&&n&&""!=n)return{price:o,priceUnit:n};var r=this.getPriceKeyUseLanguage();if(o=i.Obj.getPropertyStringByNames(t,"",r),n=i.Obj.getPropertyStringByNames(this._exchangeAllPriceUnit,"",r),""!=o&&""!=n)return{price:o,priceUnit:n}}return{price:"",priceUnit:""}},a.prototype.getPriceWithExchageConfig_foreign_priceID_v1=function(e){var t=_.instance.getStorePriceRateWithRMB()||0;if(0==t){var o=a.Instance.getPriceWithExchageConfig_foreign_priceId(e);return""+o.priceUnit+o.price}var n=(Number(e)*t).toFixed(2),i=_.instance.replaceMoneyUnit();return A.RGSymbolLayout.left==_.instance.getStorePriceUnitLayout()?""+i+n:""+n+i},a.prototype.getPriceTextWithExchageConfigForeignPriceId=function(e,t){if("g123"===_.instance.platformSID){var n=Number(e);if("en"===o.LOCAL.getLanguage()){var i=20*n/100,r=i.toFixed(2);return 0===i&&(i=1),"$"+r}return"\uffe5"+20*n}if(_.instance.canUseNativeNewPayMethod()){var s=-1;if(t&&(s=t.id),-1!==s){var l=a.Instance.getExchangePlatformPayidByExchangeId(s),c=_.instance.getPayNativeStorePriceWithUnit(l);if(c&&""!==c)return c;""===c&&C.customReport("GetStorePrice",{resp:"id "+e+" SoreP not gotXX"})}return a.Instance.getPriceWithExchageConfig_foreign_priceID_v1(e)}return a.Instance.getPriceWithExchageConfig_foreign_priceID_v1(e)},a.prototype.getPriceKeyUseLanguage=function(){var e=o.LOCAL.CurrLang;return"zh_cn"===e?"CNY":"zh_tw"==e?"CNY":"en"===e?"USD":"ja"===e||"jp"===e?"JPY":"ru"===e?"RUB":"de"===e||"fr"===e||"es"===e?"EUR":"ui"===e?"USD":"CNY"},a.prototype.payByExchangeId=function(e,t){void 0===t&&(t=null);var a=this.getCanPayExchangeConfigById(e);return this.payBuyExchangeConfig(a,t)},a.prototype.payByGiftType=function(e,t){void 0===t&&(t=null);var a=!1;do{var o=this.getCanPayExchangeConfigArrayByType(e);if(o.length<=0)break;var n=o[0];a=this.payBuyExchangeConfig(n,t)}while(0);return a},a.prototype.payBuyExchangeConfig=function(e,t){void 0===t&&(t=null);var a=!1;do{if(i.Obj.isEmpty(e))break;var n=i.Obj.getPropertyNumberByNames(e,null,"id");if(null===n)break;var r=Number(this.getPriceShow(e));if(null===r||void 0===r)break;if(_.instance.checkChargeVerification(r)){c.default.Instance().ShowTips(o.LOCAL.getText("101164"));break}if(!l.default.AtiIndulgedPayEnable(e))break;null!==t&&u.default.Instance.PostAction(t);var s={id:n,product_id:r,price:r,name:e.name};h.send(h.Names.PayMsgsRequestPrev,s),a=!0}while(0);return a},a.prototype.crystalPayByExchangeId=function(e,t){void 0===t&&(t=null),m.NET.send(f.RequestId.CRYSTAL_SendPayToServer,{exchangeId:e},this,function(e){var t=l.default.JSON_PARSE(e.d);if(i.Obj.isEmpty(t));else{var n=i.Obj.getPropertyNumberByNames(t,0,"use"),r=i.Obj.getPropertyNumberByNames(t,0,"exchangeId");if(n>0){var s=a.Instance.getExchangeConfigById(r);s&&c.default.Instance().ShowTips(o.LOCAL.getText("crystal_005",n.toString(),o.LOCAL.getText(s.name)))}}})},a.prototype.onFMessage_PayToServerPush=function(e){var t=e.data;if(i.Obj.isEmpty(t))return!0;var a=0,o=-1,n=null;do{if(null===t)break;1===i.Obj.getPropertyByNames(t,0,"result")&&(a=1),o=i.Obj.getPropertyByNames(t,-1,"exchangeId"),n=t.resource}while(0);if(1===a){var r=this.getExchangeTypeById(o);if(s.GiftType.BASE===r||s.GiftType.WEEKLY_CARD===r||s.GiftType.FIRST===r||s.GiftType.MONTHLY_CARD===r||s.GiftType.AdvanceGift===r||s.GiftType.LuxuryGift===r||s.GiftType.PREFERENTIAL_GIFT===r||s.GiftType.ACTIVITY_GIFT===r||s.GiftType.ADVENTURE_GIFT===r||s.GiftType.HERO_GIFT===r||s.GiftType.HERO_FRAG_GIFT===r||s.GiftType.CRYSTAL_GIFT===r||s.GiftType.VIP_GIFT===r||s.GiftType.ADVANCE_MONTH===r||s.GiftType.LIMIT_GIFT===r||s.GiftType.SKINPATCH_GIFT===r||s.GiftType.RETURN_GIFT===r||s.GiftType.DAILY_BAG===r||s.GiftType.WORKAWARD_GIFT===r||s.GiftType.LEGEND_GIFT===r||s.GiftType.HERO_SKIN_GIFT===r||s.GiftType.FIRST_PAGE_GIFT===r||s.GiftType.EASTER_GIFT===r||s.GiftType.POINT_GIFT===r||s.GiftType.GIFTBOX_GIFT===r||s.GiftType.NEEDITEM_GIFT===r||s.GiftType.RECHARGESCORESHOP_GIFT===r||s.GiftType.RECHARGESCORESPIN_GIFT===r||s.GiftType.BLACK_FRIDAY===r||s.GiftType.EQUIP_GIFT===r||s.GiftType.RED_BLUE_GIFT===r||C.GiftType.SHOW_HAND_GIFT===r||C.GiftType.FOREVER_CARD===r){var l={serverReward:n,isPay:!0};c.default.Instance().OpenUI(d.UIDataInfo.CommonRewardPanel,l)}else p.send(p.Names.MVC_SHOW_ACTIVITY_PURCHACE_REWARD,null)}var u={exchangeId:o,isSuc:a,reward:n};return p.send(p.Names.MVC_PAY_EXCHANGE_RESULT,u),!0},a.prototype.canPay=function(){return l.default.canPay()},a.prototype.onFMessage_LOGIN_SUCCESS=function(e){return this.requestServerExchange(),this.requestOrderedExchange(),!0},a.prototype.requestServerExchange=function(){var e=this;m.NET.send(f.RequestId.GET_SERVER_EXCHANGE,{exchangeConfigVer:e._exchangeConfigMap?e._exchangeConfigMap.configVer:null},this,function(t){var a=l.default.JSON_PARSE(t.d);i.Obj.isEmpty(a)||e.setExchangeByServerData(a)})},a.prototype.setExchangeByServerData=function(e){var t=e.exchangeConfig,a=e.exchangeConfigVer;this._exchangeConfigMap.setExchangeConfig(t,a);var o=e.rewardConfig;this.setExchangeReward(o);var n=e.exchange;this.setCanPayExchange(n);var i=e.priceConfig;this.setExchangePriceConfig(i);var r=e.currencyConfig;this.setExchangePriceUnitConfig(r);var s=e.exchangePlatformPayIDConfig;this.setExchangePlatformPayidConfig(s)},a.prototype.requestOrderedExchange=function(){r.DATA.UserData.FunctionOn(s.FunctionKey.AIGiftOrder)&&m.NET.send(f.RequestId.GET_SERVER_ORDERED_EXCHANGE,{},this,function(e){var t=l.default.JSON_PARSE(e.d);i.Obj.isEmpty(t)})},a.prototype.updateOrderedExchangeIds=function(e){this._serverOrderedExchangeIds=e.orderList,window.OnlineServer||console.log("updateOrderedExchangeId = "+JSON.stringify(this._serverOrderedExchangeIds))},Object.defineProperty(a.prototype,"OrderedExchangeIds",{get:function(){return this._serverOrderedExchangeIds},enumerable:!0,configurable:!0}),a.prototype.serverExchangeListPush=function(e){this.setExchangeByServerData(e)},a.prototype.setExchangePriceConfig=function(e){i.Obj.isEmpty(e)||this.updateExchangePrice(e)},a.prototype.setExchangePriceUnitConfig=function(e){i.Obj.isEmpty(e)||this.updateExchangePriceUnit(e)},a.prototype.setExchangePlatformPayidConfig=function(e){i.Obj.isEmpty(e)||this.updateExchangePlatformPayidConfig(e)},a.prototype.setExchangeReward=function(e){i.Obj.isEmpty(e)||(this._exchangeReward={},this.updateExchangeReward(e))},a.prototype.updateExchangeReward=function(e){if(!i.Obj.isEmpty(e)){D.getPropertyNumberByNameFast;var t=D.getPropertyStringByNameFast;for(var a in e)if(e.hasOwnProperty(a)){var o=e[a],n=t(o,null,"id");if(null!==n){var r=Object.assign({},o),s=t(o,"0","coin"),l=t(o,"0","wood"),c=t(o,"0","oil"),d=t(o,"0","gold"),p=t(o,"0","energy"),u=t(o,"0","exp");r.coin=parseFloat(s),r.wood=parseFloat(l),r.oil=parseFloat(c),r.gold=parseFloat(d),r.energy=parseFloat(p),r.exp=parseFloat(u),this._exchangeReward[n]=r}}}},a.prototype.updateExchangePrice=function(e){if(!i.Obj.isEmpty(e))for(var t in this._exchangeAllPrice={},e){var a=e[t],o=Object.assign({},a),n=i.Obj.getPropertyStringByNames(a,"","CNY"),r=i.Obj.getPropertyStringByNames(a,"","JPY"),s=i.Obj.getPropertyStringByNames(a,"","RUB"),l=i.Obj.getPropertyStringByNames(a,"","USD"),c=i.Obj.getPropertyStringByNames(a,"","id"),d=i.Obj.getPropertyStringByNames(a,"","score"),p=i.Obj.getPropertyStringByNames(a,"","payid");o.CNY=n,o.JPY=r,o.SUR=s,o.USD=l,o.id=c,o.score=d,o.payid=p,this._exchangeAllPrice[c]=o}},a.prototype.updateExchangePriceUnit=function(e){i.Obj.isEmpty(e)||(this._exchangeAllPriceUnit={CNY:"",JPY:"",RUB:"",USD:""},this._exchangeAllPriceUnit=e)},a.prototype.updateExchangePlatformPayidConfig=function(e){if(!i.Obj.isEmpty(e)&&("appiosglobal"===_.instance.platformSID||"appios"===_.instance.platformSID||"googleplay"===_.instance.platformSID))for(var t in e)if(e.hasOwnProperty(t)){var a=e[t],o=i.Obj.getPropertyStringByNames(a,"",_.instance.platformSID);""!==o&&(this._exchangePlatformPayidMap[t]=o)}},a.prototype.setCanPayExchange=function(e){if(!i.Obj.isEmpty(e)&&Array.isArray(e)){this._serverExchangeCanPayMap={};for(var t=D.getPropertyNumberByNameFast,a=D.getPropertyStringByNameFast,o=0;o<e.length;o++){var n=e[o],r=a(n,null,"id");if(null!==r){var s=t(n,0,"multiple"),l=i.Obj.getPropertyByNames(n,-1,"bt"),c=i.Obj.getPropertyByNames(n,-1,"et"),d=this._exchangeConfigMap.getOrCreateExchangConfig(r);if(null!==d&&(d.serverStartTime=l,d.serverEndTime=c,d.multiple=s,this.isExchangeInTime(d))){var p=Object.assign({},d);this._serverExchangeCanPayMap[r]=p}}}y.EVENT.emit(g.EventId.MainUI_Update)}},a.prototype.getExchangeRewardByRewardId=function(e){var t=e.toString();return i.Obj.getPropertyByNames(this._exchangeReward,null,t)},a.prototype.getExternalActivityExchange=function(){var e=0;return"cost"==S.default.Instance.Activity?e=9202117:"come"==S.default.Instance.Activity&&(e=9202118),e>0?a.Instance.getCanPayExchangeConfigById(e):null},a.prototype.requestDynamicExchangeByType=function(e){var t=this,a=this;m.NET.send(f.RequestId.GET_SERVER_EXCHANGE,{type:e,exchangeConfigVer:a._exchangeConfigMap?a._exchangeConfigMap.configVer:null},this,function(o){var n=l.default.JSON_PARSE(o.d);if(i.Obj.isEmpty(n));else{var r=n.exchangeConfig,s=n.exchangeConfigVer;t._exchangeConfigMap.updateExchangeConfig(r,s);var c=n.rewardConfig;t.updateExchangeReward(c);var d=n.exchange;a.setCanPayExchange(d);var u=n.priceConfig;a.updateExchangePrice(u);var h=n.currencyConfig;a.updateExchangePriceUnit(h);var m=n.serverPlatformPayidConfig;t.updateExchangePlatformPayidConfig(m),p.send(p.Names.MVC_EXCHANGE_DYNAMIC_UPDATE,e)}})},Object.defineProperty(a,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),a.prototype.purge=function(){o.LOCAL.moneyFormatMethod=null,a._instance=null},a.MONTHLYCARD_SHIT_ID_1=5e3,a.MONTHLYCARD_SHIT_ID_2=5001,a.MONTHLYCARD_SHIT_ID_NEW=5003,a.FOREVER_CARD=25001,a.ADVANCE_MONTHLYCARD_SHIT_ID_2=15001,a.MONTHLYCARD_SHIT_ID_2_DISCOUNT=5002,a.ADVANCE_MONTHLYCARD_SHIT_ID_2_DISCOUNT=15002,a.AutoPopedView=!1,a}(n.FMessageConnectionAbstract);a.ExchangeController=b,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/PFOpenData":"PFOpenData","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Data/GlobalData":"GlobalData","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs","../msgs/PayMsgs":"PayMsgs","./GrowthFundController":"GrowthFundController"}],G123IPContentProvider:[function(e,t,a){"use strict";cc._RF.push(t,"9d746GDg+9AfrwLmc8CZ8Qs","G123IPContentProvider"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./G123IPTimeChecker"),n=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._instance=null},e.prototype.getBattleBoss=function(e){if("boss_zhizhu_tutorial"===e&&o.default.Instance.isInYamatoTime())return"boss_zhizhu_tutorial_Yamato"},e.prototype.getPCBg=function(){var e="image/large/loading/pc_bg_normal.jpg";return o.default.Instance.isGineidenPreview()&&(e="image/large/loading/pc_bg_Geneiden.jpg"),o.default.Instance.isRainbowPreview()&&(e="image/large/loading/pc_bg_Rainbow.jpg"),e},e.prototype.getLoadingBg=function(){var e="image/large/loading/Loading_normal.jpg";return o.default.Instance.isInGineiden()&&(e="image/large/loading/Loading_in_Gineiden.jpg"),o.default.Instance.isRainbowNotEnd()&&(e="image/large/loading/Loading_in_Rainbow.jpg"),e},e.prototype.getImagePath=function(e){var t=e;return o.default.Instance.isInGineiden()&&("image/item/item_5900001"===e&&(t="image/item/item_5900001_Gineiden"),"UI/ea_icon_army/shijieboss"!==e&&"image/icon_army/shijieboss"!==e||(t="image/icon_army/shijieboss_Gineiden"),"image/item/item_39200075"===e&&(t="image/item/item_39200075_Gineiden")),t},e.prototype.getPrefabPath=function(e){var t=e;return o.default.Instance.isInYamatoTime()&&("ea_prefab/world/enemy/PrefabWmBoss2"===e?t="ea_prefab/world/enemy/PrefabWmBoss2_Yamato":"ea_prefab/army/boss_zhizhu_tutorial"===e&&(t="ea_prefab/army/boss_zhizhu_tutorial_Yamato")),t},e.prototype.getText=function(e,t){return o.default.Instance.isInGineiden()&&"item_name_39200075"===e?"\u9ec4\u91d1\u7345\u5b50":t},e}();a.default=n,cc._RF.pop()},{"./G123IPTimeChecker":"G123IPTimeChecker"}],G123IPTimeChecker:[function(e,t,a){"use strict";cc._RF.push(t,"49d0bbSN15JYJugYy0lw2Ef","G123IPTimeChecker"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Data/DataCenter"),n=e("../../fws/utils/FWSTool"),i=e("../../fws/utils/LocalStorageUtils"),r=function(){function e(){this.GineidenShowTime="2020-9-3-00-00",this.GineidenStarTime="2020-9-17-00-00",this.GineidenMidTime="2020-9-24-00-00",this.GineidenEndTime="2020-10-1-00-00",this.PlayerStarTime="2020-9-10-00-00",this.PlayerEndTime="2020-10-17-00-00",this.RainbowShowTime="2020-8-24-00-00",this.RaindowShowEndTime="2020-9-3-00-00",this.RainbowEndTime="2020-9-10-00-00"}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._instance=null},e.prototype.getCurrentTimeStamp=function(){if(!window.OnlineServer){if("1"===i.get("GM_vivid_IP_Time"))return o.DATA.getLocalTime()}return o.DATA.ServerTime},e.prototype.isInUltraManTime=function(){return!1},e.prototype.isInYamatoTime=function(){return!1},e.prototype.isInYamatoFirstStep=function(){return!1},e.prototype.isInYamatoSecondStep=function(){return!1},e.prototype.isYamatoTimeEnd=function(){return!1},e.prototype.isYamatoTimePreview=function(){return!1},e.prototype.isInGineiden=function(){var e=n.Str.customDateToTimestamp(this.GineidenStarTime),t=n.Str.customDateToTimestamp(this.GineidenEndTime),a=this.getCurrentTimeStamp();return a>=e&&a<=t},e.prototype.isInGineidenFirst=function(){var e=n.Str.customDateToTimestamp(this.GineidenStarTime),t=n.Str.customDateToTimestamp(this.GineidenMidTime),a=this.getCurrentTimeStamp();return a>=e&&a<=t},e.prototype.isInGineidenSecond=function(){var e=n.Str.customDateToTimestamp(this.GineidenMidTime),t=n.Str.customDateToTimestamp(this.GineidenEndTime),a=this.getCurrentTimeStamp();return a>=e&&a<=t},e.prototype.isGineidenEnd=function(){var e=n.Str.customDateToTimestamp(this.GineidenEndTime);return this.getCurrentTimeStamp()>e},e.prototype.isGineidenPreview=function(){var e=n.Str.customDateToTimestamp(this.GineidenShowTime),t=n.Str.customDateToTimestamp(this.GineidenEndTime),a=this.getCurrentTimeStamp();return a>=e&&a<=t},e.prototype.isInPlayer=function(){var e=n.Str.customDateToTimestamp(this.PlayerStarTime),t=n.Str.customDateToTimestamp(this.PlayerEndTime),a=this.getCurrentTimeStamp();return a>=e&&a<=t},e.prototype.isPlayerEnd=function(){var e=n.Str.customDateToTimestamp(this.PlayerEndTime);return this.getCurrentTimeStamp()>e},e.prototype.isRainbowPreview=function(){var e=n.Str.customDateToTimestamp(this.RainbowShowTime),t=n.Str.customDateToTimestamp(this.RaindowShowEndTime),a=this.getCurrentTimeStamp();return a>=e&&a<=t},e.prototype.isRainbowNotEnd=function(){var e=n.Str.customDateToTimestamp(this.RainbowEndTime);return this.getCurrentTimeStamp()<=e},e}();a.default=r,cc._RF.pop()},{"../../fws/utils/FWSTool":"FWSTool","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../Data/DataCenter":"DataCenter"}],GrowthFundController:[function(e,t,a){"use strict";cc._RF.push(t,"f6546SXbm9E0baj/vjqfM99","GrowthFundController"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../../fws/utils/FWSTool"),i=e("../../Core/Common/TableManager"),r=e("../Data/DataCenter"),s=e("../Const/GameDefine"),l=e("../Tools/GameTools"),c=e("./ExchangeController"),d=e("../Const/TableName");(function(e){e[e.UNDONE=0]="UNDONE",e[e.DONE=1]="DONE",e[e.RECEIVED=2]="RECEIVED"})(o=a.GrowthFundRewardState||(a.GrowthFundRewardState={}));var p=function(){function e(){this.configData=[]}return e.prototype.isGrowthFundBuy=function(){return r.DATA.UserData.GrowthFundOpen>0},e.prototype.getGrowthFundCfg=function(){return c.ExchangeController.Instance.getCanPayExchangeConfigArrayByType(s.GiftType.GROWTH_FUND)},e.prototype.buyGrowthFund=function(){return c.ExchangeController.Instance.payByGiftType(s.GiftType.GROWTH_FUND,"ExBuyGrowthFund")},e.prototype.buyAdvanceGiftFund=function(){return c.ExchangeController.Instance.payByGiftType(s.GiftType.AdvanceGift,"ExBuyAdvanceGift")},e.prototype.buyLuxuryGiftFund=function(){return c.ExchangeController.Instance.payByGiftType(s.GiftType.LuxuryGift,"ExBuyLuxuryGift")},e.prototype.getConfigData=function(){return this.configData},e.prototype.ifHaveCanGet=function(){var t=e.Instance.getConfigData();if(n.Obj.isEmpty(t))return!1;for(var a=[],i=0;i<t.length;i++){var r=t[i],s=r.level;e.Instance.getRewardStateByLevel(s)===o.DONE&&a.push(r)}return a.length>0},e.prototype.getRewardStateByLevel=function(e){return r.DATA.UserData.Level<e?o.UNDONE:r.DATA.UserData.GrowthFundGet.indexOf(e)>=0?o.RECEIVED:o.DONE},e.prototype.getGoldNums=function(e){void 0===e&&(e=!1);for(var t=0,a=this.configData.length,n=0;n<a;n++){var i=this.configData[n];e?this.getRewardStateByLevel(i.level)===o.DONE&&(t+=i.gold):t+=i.gold}return t},e.prototype.updateConfig=function(){var e;if(this.configData=[],this.serverConfig)e=this.serverConfig;else{var t=i.TABLE.getTableDataById(d.TableName.DATACONFIG,"5013");t&&(e=n.Obj.getPropertyByNames(t,"","value"))}if(e)for(var a=l.default.convertStringToTwoDimensionalArray(e),o=0;o<a.length;o++){var r=a[o];if(r.length>=2){var s={level:parseInt(r[0]),gold:parseInt(r[1])};this.configData.push(s)}}},Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._instance=null},e}();a.GrowthFundController=p,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../fws/utils/FWSTool":"FWSTool","../Const/GameDefine":"GameDefine","../Const/TableName":"TableName","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools","./ExchangeController":"ExchangeController"}],ItemMergeController:[function(e,t,a){"use strict";cc._RF.push(t,"e50c5K4yI9Mza+UVzL8pj7J","ItemMergeController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../fws/mvc/FWSMvc"),i=e("../../Core/Common/SoundManager"),r=e("../../Core/Event/EventCenter"),s=e("../Common/UIManager"),l=e("../Const/EventId"),c=e("../Const/GameDefine"),d=e("../Const/SoundPath"),p=e("../Data/DataCenter"),u=e("../Tools/GameTools"),h=e("../../fws/utils/FWSTool"),m=e("../../Core/Common/TableManager"),f=e("../components/unlock/UnLockPanelComponent"),_=e("../../System/JSWrap"),y=(e("../../fws/utils/X"),e("../../fws/platforms/PlatformCore")),g=e("../Const/TableName"),C=e("../Data/UserStaticData"),v=e("../Common/BIManager"),I=function(e){function t(){var t=e.call(this)||this;return t._batchMergeItemIds=[],t._batchMergeAllItemIds=[],t._adjoin1Pts=[new cc.Vec2(-1,1),new cc.Vec2(-1,-1),new cc.Vec2(1,-1),new cc.Vec2(1,1)],t._adjoin2Pts=[new cc.Vec2(-2,2),new cc.Vec2(-2,-2),new cc.Vec2(2,-2),new cc.Vec2(2,2)],t._adjoin3Pts=[new cc.Vec2(-3,3),new cc.Vec2(-2,-2),new cc.Vec2(3,-3),new cc.Vec2(2,2)],t._mergeMaxNum=50,t._prevCanMergeBuildingID="",t._prevCanMergeArmyID="",t._mergeBuildingItemID="",t._mergeArmyItemID="",t._isBuildingAndMerge=!1,t}return __extends(t,e),t.prototype.checkItemMerge=function(e,t){var a=-1,o=-1,n=!1;e.ItemType===c.BaseItemType.Building?a=e.BuildingId:e.ItemType===c.BaseItemType.Army&&(o=e.ArmyID,n=!0),this._isBuildingAndMerge=!e.isInServer();for(var i=p.DATA.UserData.HomeItemPoints,r={},l={},d=0;d<t.length;d++){var f=t[d],_=i[f];if(!h.Obj.isEmpty(_)){var y=s.default.Instance().HomeMap.getBaseItemByRealPos(u.default.getMapPosByPosId(f));if(null!=y&&y.ItemType==e.ItemType&&y.ID!=e.ID)if(n){var C=y;if(!y.isLogicCanMerge())continue;if(null==C.ArmyData||C.ArmyData.ArmyId!=o||0==C.ArmyData.Normal)continue;var v=C.ID;h.Obj.isEmpty(l[v])&&(l[v]=0),++l[v]}else{v=(N=y).ID;if(null==N.BuildingData||N.BuildingData.BuildingId!=a)continue;if(!y.isLogicCanMerge())continue;h.Obj.isEmpty(r[v])&&(r[v]=0),++r[v]}}}var I=Object.keys(r),T=Object.keys(l),S=!1,A=!1,D=-1;if(0==n){var N=e,b=m.TABLE.getTableDataById(g.TableName.BUILDING,N.BuildingId.toString());null!=b&&(D=b.type)}S=!n&&I.length>=1&&0===T.length&&D!==c.BuildingType.Ornament&&D!==c.BuildingType.OrnamentFloor,A=n&&0===I.length&&T.length>=1;var L=null;(S?L=this.getMaxValueKey(r):A&&(L=this.getMaxValueKey(l)),e.DragCanMerge=(S||A)&&null!==L,e.DragCanMerge)&&(e.MergeTargetID=L,S?this._prevCanMergeBuildingID=L:A&&(this._prevCanMergeArmyID=L),this.mergeIntersectEnter(e),e.hideCanMergeAni())},t.prototype.checkItemCanMerge=function(e){if(0!=u.default.checkCanBatchMerge()){var t=e;if(t){var a=this.findSameItem(e);a>=0?t.showCanMergeAni(a):t.hideCanMergeAni()}}},t.prototype.getMaxValueKey=function(e){var t=null;do{if(h.Obj.isEmpty(e))break;var a=null,o=-1;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];h.Obj.isNumber(i)&&i>o&&(o=i,a=n)}t=a}while(0);return t},t.prototype.checkItemMerge_deprecated=function(e,t){},t.prototype.mergeArmyCallback=function(e){y.instance.postStatsEvent("merge_army");var t=!1,a=function(){if(0!==e.s)return"break";var a=u.default.JSON_PARSE(e.d);if("suc"!==a.res)return"break";var o=a.armyId;p.DATA.UserData.MaxItemData.CheckHaveArmy(o)&&_.default.setTimeout(function(){f.default.unlockArmy(o)},100);var n="";if(null!=a.targetId?n=a.targetId:null!=a.targetIds&&a.targetIds.length>0&&(n=a.targetIds[0]+""),h.Obj.isEmpty(n)||h.Obj.isEmpty(o))return"break";if(null!=a.targetIds){for(var s=0;s<a.targetIds.length;s++){var c=a.targetIds[s]+"";r.EVENT.emit(l.EventId.Army_Update,c)}r.EVENT.emit(l.EventId.Army_Batch_Merge_Suc,a.targetIds)}else""!=n&&(p.DATA.UserData.updateArmyById(n,o),r.EVENT.emit(l.EventId.Army_Update,n),r.EVENT.emit(l.EventId.Army_Merge_Suc,n),v.default.postBI("merge_army",{success:1,army_id:o.toString()}));t=!0,i.SOUND.playClip(d.SoundPath.army_merge_success)};do{if("break"===a())break}while(0);t?r.EVENT.emit(l.EventId.Armys_Update):(s.default.Instance().ShowTips(o.LOCAL.getText("100508")),this.mergeFailResetArmyItem())},t.prototype.mergeBuildingCallback=function(e){y.instance.postStatsEvent("merge_build");var t=!1,a=function(){if(0!==e.s)return"break";var a=u.default.JSON_PARSE(e.d);if("suc"!==a.res)return"break";var o=a.buidingId,n=m.TABLE.getTableDataById(g.TableName.BUILDING,o.toString());p.DATA.UserData.MaxItemData.CheckHaveBuilding(o)&&null!=n&&n.level>5&&_.default.setTimeout(function(){f.default.unlockBuilding(a.buidingId)},100);var s="";null!=a.targetId?s=a.targetId:null!=a.targetIds&&a.targetIds.length>0&&(s=a.targetIds[0]+""),h.Obj.isEmpty(s)||(null!=a.targetIds?r.EVENT.emit(l.EventId.Building_Batch_Merge_Suc,a.targetIds):""!=s&&r.EVENT.emit(l.EventId.Building_Merge_Suc,s),v.default.postBI("merge_building",{success:1,building_id:o&&o.toString()})),t=!0,i.SOUND.playClip(d.SoundPath.building_merge_success)};do{if("break"===a())break}while(0);t||(s.default.Instance().ShowTips(o.LOCAL.getText("100509")),this.mergeFailResetBuildingItem())},t.prototype.resetMerge=function(){this._prevCanMergeArmyID="",this._prevCanMergeBuildingID=""},t.prototype._setPrevCanMergeShow=function(e){if(u.default.verifyComponent(s.default.Instance())&&u.default.verifyComponent(s.default.Instance().HomeMap)){var t;if(this._prevCanMergeArmyID.length>0)null!==(t=s.default.Instance().HomeMap.getArmyItemByID(this._prevCanMergeArmyID))&&t.setMergeCostShow(e,this._isBuildingAndMerge);if(this._prevCanMergeBuildingID.length>0)null!==(t=s.default.Instance().HomeMap.getBuildingItemById(this._prevCanMergeBuildingID))&&t.setMergeCostShow(e,this._isBuildingAndMerge)}},t.prototype.GetBatchMergeItems=function(){return[this._batchMergeItemIds.slice(0,this._batchMergeItemIds.length),this._batchMergeAllItemIds.slice(0,this._batchMergeAllItemIds.length)]},t.prototype.findSameArmyItem=function(e,t,a){this._batchMergeItemIds=[],this._batchMergeAllItemIds=[];var o=p.DATA.UserData.getArmyByPosId(e);o&&this._batchMergeItemIds.push(o.Id);var n=!1,i=[];i.push(e);var r=this._adjoin3Pts,s=m.TABLE.getTableDataById(g.TableName.ARMY,t.toString());s&&(s.height&&1==s.height&&s.height==s.width?r=this._adjoin1Pts:s.height&&2==s.height&&s.height==s.width&&(r=this._adjoin2Pts));for(var l=0;l<i.length;){for(var d=i[l],h=0;h<r.length;h++){var f,_=d+1e3*r[h].x+r[h].y;if(_!=a){if(!(i.indexOf(_)>=0)){var y=this.checkArmyData(_,t);""!=y&&(i.push(_),this._batchMergeItemIds.push(y))}}else 0==n&&(n=!0,(f=p.DATA.UserData.getArmyByPosId(a))&&this._batchMergeItemIds.push(f.Id))}if(l++,!C.USData.UnlimitedMerge)if(n){if(i.length>=this._mergeMaxNum)break}else if(i.length>=this._mergeMaxNum-1)break}(i.shift(),0==n)&&(n=!0,(f=p.DATA.UserData.getArmyByPosId(a))&&this._batchMergeItemIds.push(f.Id));if(this._batchMergeAllItemIds=this._batchMergeItemIds.concat(),p.DATA.UserData.FunctionOn(c.FunctionKey.item_merge_all)&&!C.USData.UnlimitedMerge&&p.DATA.UserData.Level>=parseInt(u.default.getDataConfigData(950014)))for(h=0;h<p.DATA.UserData.Armys.length;h++){var v=p.DATA.UserData.Armys[h];if(this._batchMergeAllItemIds.length>=this._mergeMaxNum)break;v.ArmyId==t&&0===v.March&&v.Normal&&"0"==v.WarehouseId&&(this._batchMergeItemIds.indexOf(v.Id)>-1||(this._batchMergeAllItemIds.push(v.Id),i.push(v.Pos)))}return i},t.prototype.findSameBuildItem=function(e,t,a){this._batchMergeItemIds=[];var o=p.DATA.UserData.getBuildingByPosId(e);o&&this._batchMergeItemIds.push(o.Id);var n=!1,i=[];i.push(e);for(var r=this._adjoin2Pts,s=0;s<i.length;){for(var l=i[s],d=0;d<r.length;d++){var h,m=l+1e3*r[d].x+r[d].y;if(m!=a){if(!(i.indexOf(m)>=0)){var f=this.checkBuildData(m,t);""!=f&&(i.push(m),this._batchMergeItemIds.push(f))}}else 0==n&&(n=!0,(h=p.DATA.UserData.getBuildingByPosId(m))&&this._batchMergeItemIds.push(h.Id))}if(s++,n){if(i.length>=this._mergeMaxNum)break}else if(i.length>=this._mergeMaxNum-1)break}(i.shift(),0==n)&&(n=!0,(h=p.DATA.UserData.getBuildingByPosId(a))&&this._batchMergeItemIds.push(h.Id));if(this._batchMergeAllItemIds=this._batchMergeItemIds.concat(),p.DATA.UserData.FunctionOn(c.FunctionKey.item_merge_all)&&p.DATA.UserData.Level>=parseInt(u.default.getDataConfigData(950014)))for(d=0;d<p.DATA.UserData.Buildings.length;d++){var _=p.DATA.UserData.Buildings[d];if(this._batchMergeAllItemIds.length>=this._mergeMaxNum)break;_.BuildingId==t&&1!=_.Broken&&(_.ProductId==c.ResourceType.Army&&_.CurProductNum>0||this._batchMergeItemIds.indexOf(_.Id)>-1||(this._batchMergeAllItemIds.push(_.Id),i.push(_.Pos)))}return i},t.prototype._dragMergeIntersectItem=function(e,t){var a;if(this._prevCanMergeArmyID.length>0&&(null!==(a=s.default.Instance().HomeMap.getArmyItemByID(this._prevCanMergeArmyID))&&a.dragMergeIntersect(e),u.default.checkCanBatchMerge())){var o=a;if(e&&o){var n=this.findSameArmyItem(o.Pos,o.ArmyID,t);o.palyWillMerge(o.Pos);for(var i=0;i<n.length;i++){(d=s.default.Instance().HomeMap.getArmyItemByPosIdx(n[i]))&&d.palyWillMerge(o.Pos)}}}if(this._prevCanMergeBuildingID.length>0&&(null!==(a=s.default.Instance().HomeMap.getBuildingItemById(this._prevCanMergeBuildingID))&&a.dragMergeIntersect(e),u.default.checkCanBatchMerge())){var c=a;if(e&&c){n=this.findSameBuildItem(c.Pos,c.BuildingId,t);c.palyWillMerge(c.Pos);for(i=0;i<n.length;i++){var d;(d=s.default.Instance().HomeMap.getBuildItemByPosIdx(n[i]))&&d.palyWillMerge(c.Pos)}}}0==e&&u.default.checkCanBatchMerge()&&r.EVENT.emit(l.EventId.StopMergeAni)},t.prototype.mergeIntersectExit=function(e){void 0===e&&(e=null),this._setPrevCanMergeShow(!1);var t=e,a=0;t&&void 0!=t.OriginalPos&&(a=t.OriginalPos),this._dragMergeIntersectItem(!1,a),this.resetMerge(),e&&e.setSelfShow(!0)},t.prototype.mergeIntersectEnter=function(e){void 0===e&&(e=null),this._setPrevCanMergeShow(!0);var t=e,a=0;t&&void 0!=t.OriginalPos&&(a=t.OriginalPos),this._dragMergeIntersectItem(!0,a),e&&e.setSelfShow(!1)},t.prototype.findSameItem=function(e){if(void 0===e&&(e=null),e){var t=this._adjoin3Pts,a=0,o=0,n=!1,i="";if(e.ArmyID>0){var r=e;a=r.Pos,o=r.ArmyID,n=!0,i=r.ArmyData.Id;var s=m.TABLE.getTableDataById(g.TableName.ARMY,r.ArmyID.toString());s&&(s.height&&1==s.height&&s.height==s.width?t=this._adjoin1Pts:s.height&&2==s.height&&s.height==s.width&&(t=this._adjoin2Pts))}if(e.BuildingId>0){var l=e;a=l.Pos,o=l.BuildingId,t=this._adjoin2Pts,i=l.BuildingData.Id}if(0==o)return-1;for(var c=0;c<t.length;c++){var d=a+1e3*t[c].x+t[c].y;if(n){var p=this.checkArmyData(d,o);if(""!=p&&p!=i)return c}else{var u=this.checkBuildData(d,o);if(""!=u&&u!=i)return c}}return-1}},t.prototype.checkBuildData=function(e,t){var a=p.DATA.UserData.getBuildingByPosId(e);return null==a?"":a.BuildingId!=t||1==a.Broken?"":a.ProductId==c.ResourceType.Army&&a.CurProductNum>0?"":a.Id},t.prototype.checkArmyData=function(e,t){var a=p.DATA.UserData.getArmyByPosId(e);return null==a?"":a.ArmyId==t&&0===a.March&&a.Normal?a.Id:""},t.prototype.getMinDisDoubleItem=function(e,t){var a=[];if(0==t)for(var o=p.DATA.UserData.Armys,n=0;n<o.length;n++){var i=o[n];i.ArmyId==e&&0===i.March&&i.Normal&&a.push(i.Pos)}else{var r=p.DATA.UserData.Buildings;for(n=0;n<r.length;n++){var s=r[n];s.BuildingId==e&&1!=s.Broken&&(s.ProductId==c.ResourceType.Army&&s.CurProductNum>0||a.push(s.Pos))}}if(a.length<2)return[];var l=0,d=0,h=!1,m=99999999;for(n=0;n<a.length;n++){for(var f=u.default.getMapPosByPosId(a[n]),_=0;_<a.length;_++)if(a[n]!=a[_]){var y=u.default.getMapPosByPosId(a[_]).sub(f).mag();if(m>y&&(m=y,l=n,d=_,y<=2)){h=!0;break}}if(h)break}return 0==l&&0==d&&a.length>=2&&(d=1),[a[l],a[d]]},t.prototype.getCoinCideItem=function(e){return s.default.Instance().HomeMap.getCoinCideItem(e)},t.prototype.setMergeBuildingItemID=function(e){this._mergeBuildingItemID=e},t.prototype.setMergeArmyItemID=function(e){this._mergeArmyItemID=e},t.prototype.mergeFailResetBuildingItem=function(){this._mergeBuildingItemID.length>0&&r.EVENT.emit(l.EventId.Building_Update_Pos,this._mergeBuildingItemID),this._mergeBuildingItemID=""},t.prototype.mergeFailResetArmyItem=function(){this._mergeArmyItemID.length>0&&r.EVENT.emit(l.EventId.Army_Update_Pos,this._mergeArmyItemID),this._mergeArmyItemID=""},Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.purge=function(){t._instance=null},t}(n.FMessageConnectionAbstract);a.ItemMergeController=I,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/SoundManager":"SoundManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../System/JSWrap":"JSWrap","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/SoundPath":"SoundPath","../Const/TableName":"TableName","../Data/DataCenter":"DataCenter","../Data/UserStaticData":"UserStaticData","../Tools/GameTools":"GameTools","../components/unlock/UnLockPanelComponent":"UnLockPanelComponent"}],MailController:[function(e,t,a){"use strict";cc._RF.push(t,"10f52IpfJVABJaz3/5WaCpj","MailController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/mvc/FWSMvc"),n=e("../../Core/Event/EventCenter"),i=e("../../Core/Net/NetMgr"),r=e("../Const/EventId"),s=e("../Const/GameDefine"),l=e("../Const/RequestId"),c=e("../Data/DataCenter"),d=e("../Data/MailData"),p=e("../../fws/utils/FWSTool"),u=e("../../Core/Common/TableManager"),h=e("../../fws/platforms/PlatformCore"),m=e("../Data/MailData"),f=e("../Const/TableName"),_=function(e){function t(){var t=e.call(this)||this;return t._unReadNum=0,t}return __extends(t,e),t.prototype.requestMailList=function(){c.DATA.UserData.FunctionOn(s.FunctionKey.Mail)&&(m.USE_NEW_MAIL_MODEL||(i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_system}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_war}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_attack_monster}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_owner}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_store}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_collect}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_boss}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_alliance}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_scout}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_new_battle_report}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_AssemblyBoss}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_throne_attack}),i.NET.send(l.RequestId.MAIL_GET_LIST,{mailType:d.MailType.type_plat_pay_reward})))},t.prototype.onFMessage_LOGIN_SUCCESS=function(e){return m.mailSetNewModelSwitch(c.DATA.UserData.FunctionOn(s.FunctionKey.mail_pagination_new)),m.USE_NEW_MAIL_MODEL?(m.mailManager.loadUnreadMailCountByServer(),m.mailManager.gameServerConnectSuccess(),!0):(this.requestMailList(),!0)},t.prototype.updateMailUnReadNum=function(){if(!m.USE_NEW_MAIL_MODEL){for(var e=0,t=c.DATA.UserData.getAllMailArray(),a=0;a<t.length;a++){var o=t[a];0===p.Obj.getPropertyNumberByNames(o,-1,"status")&&++e}this._unReadNum=e}this.updateMainUIUnreadNumbers()},t.prototype.updateMainUIUnreadNumbers=function(){n.EVENT.emit(r.EventId.UpdateMailList),n.EVENT.emit(r.EventId.UpdateMailDetailPanel),n.EVENT.emit(r.EventId.UpdateUnReadMailNum)},t.prototype.getMailUnReadNum=function(){return m.USE_NEW_MAIL_MODEL?m.mailManager.getAllUnread():this._unReadNum},t.prototype.isPlatCanGetReward=function(e){var t=u.TABLE.getTableDataById(f.TableName.MAIL,e.toString());if(!t)return!0;if(void 0==t.reward_plat||""==t.reward_plat)return!0;for(var a=t.reward_plat.split("|"),o=0;o<a.length;o++)if(a[o]==h.instance.platformSID)return!0;return!1},Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.purge=function(){t._instance=null},t}(o.FMessageConnectionAbstract);a.MailController=_,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Data/DataCenter":"DataCenter","../Data/MailData":"MailData"}],QuestController:[function(e,t,a){"use strict";cc._RF.push(t,"80fcas21e5N4qBFjUicHhIv","QuestController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/mvc/FWSMvc"),n=e("../Data/DataCenter"),i=e("../Const/GameDefine"),r=e("../../fws/utils/FWSTool"),s=e("../../Core/Common/TableManager"),l=e("../Tools/GameTools"),c=e("../../Core/Net/NetMgr"),d=e("../Const/RequestId"),p=e("../Module/UI/FreeGoldPanel"),u=e("../Common/UIManager"),h=e("../Const/UIDataInfo"),m=e("../msgs/MvcMsgs"),f=e("./ActivityController"),_=e("../../Core/Event/EventCenter"),y=e("../Const/EventId"),g=e("./RewardController"),C=e("../Const/TableName"),v=e("../Common/BIManager"),I=function(e){function t(){var t=e.call(this)||this;return t._isInitConfig=!1,t._dailyQuestMaxCounts=0,t._dailyQuestMaxRefreshCounts=0,t._dailyQuestRefreshPrice=0,t._dailyQuestBoxCountsArray=[],t._dailyQuestBoxRewardIdArray=null,t._dailyQuestLimitLevel=0,t._bountyQuestLimitLevel=0,t._showRefugee=!1,t.initConfig(),t}return __extends(t,e),t.prototype.getShowMainQuest=function(){var e=[],t=n.DATA.UserData.Quests.slice(0);t.sort(this.questSort);for(var a=[],o=[],r=0;r<t.length;r++)t[r].State===i.QuestState.CAN_REWARD?a.push(t[r]):t[r].State==i.QuestState.UN_FINISHED&&o.push(t[r]);return(e=a.concat(o)).length>20&&(e=e.slice(0,19)),e},t.prototype.questSort=function(e,t){return e.Order>t.Order?1:e.Order<t.Order?-1:e.Id-t.Id},t.prototype.getShowDailyQuest=function(){return n.DATA.UserData.DailyQuests.slice(0)},t.prototype.canGetReward=function(){for(var e=this.getShowDailyQuest(),t=0;t<e.length;t++)if(1==e[t].State)return!0;return!1},t.prototype.getDailyQuestByIndex=function(e){var t=n.DATA.UserData.DailyQuests.slice(0);return e<0||e>=t.length?null:t[e]},t.prototype.getMaxCounts=function(){return this._dailyQuestMaxCounts},t.prototype.getRefreshMaxFreeCounts=function(){return this._dailyQuestMaxRefreshCounts},t.prototype.getRrefreshPrice=function(){return this._dailyQuestRefreshPrice},t.prototype.getDailyQuestLimitLevel=function(){return this._dailyQuestLimitLevel},t.prototype.getBountyQuestLimitLevel=function(){return this._bountyQuestLimitLevel},t.prototype.getCanRewardDailyQuestArray=function(){for(var e=[],t=n.DATA.UserData.DailyQuests.slice(0),a=0;a<t.length;a++){var o=t[a];o.State===i.QuestState.CAN_REWARD&&e.push(o)}return e},t.prototype.checkDailyQuestCanReward=function(){var e=!1;do{if(this.getCanRewardDailyQuestArray().length>0){e=!0;break}for(var t=0;t<n.DATA.UserData.dailyQuestBoxStateArray.length;t++){if(n.DATA.UserData.dailyQuestBoxStateArray[t]===i.DailyQuestBoxState.CAN_REWARD){e=!0;break}}}while(0);return e},t.prototype.refreshWorldTreasureQuest=function(e){c.NET.send(d.RequestId.REFRESH_WORLD_TREASURE_QUEST,{questId:e},this,function(e){e.s})},t.prototype.recevieWorldTreasureQuest=function(e){c.NET.send(d.RequestId.RECEIVE_WORLD_TREASURE_QUEST,{questId:e},this,function(e){if(0==e.s){var t={serverReward:l.default.JSON_PARSE(e.d).reward};u.default.Instance().OpenUI(h.UIDataInfo.CommonRewardPanel,t),_.EVENT.emit(y.EventId.UpdateSharkMoneyTreeData),_.EVENT.emit(y.EventId.UPDATE_COLLECTION_MACHINE_INFO)}})},t.prototype.requestRefreshDailyQuest=function(e){for(var t=!1,a=1,o=n.DATA.UserData.DailyQuests.slice(0),s=0;s<o.length;s++){var l=o[s];if(e===l.Id){var c=l.Data;a=r.Obj.getPropertyNumberByNames(c,1,"reward_multiple"),l.State===i.QuestState.UN_FINISHED&&(t=!0);break}}if(t){var d=this.getRefreshCost();n.DATA.UserData.Resource.Gold<d?p.default.ShowView():a>=5?u.default.Instance().OpenUI(h.UIDataInfo.DailyQuestRefreshConfirmComponent,{questId:e,multiple:a}):this.doRefreshDailyQuest(e)}},t.prototype.doRefreshDailyQuest=function(e){var t={questId:e};c.NET.send(d.RequestId.DAILY_QUEST_REFRESH,t,this,function(e){var t=l.default.JSON_PARSE(e.d);if(r.Obj.isEmpty(t));else{var a=r.Obj.getPropertyNumberByNames(t,null,"dailyQuestDelId"),o=r.Obj.getPropertyByNames(t,null,"newDailyQuest"),i=r.Obj.getPropertyNumberByNames(t,null,"dailyQuestFreeRefreshCount");null!==i&&n.DATA.UserData.setDailyQuestFreeRefreshCount(i),n.DATA.UserData.deleteAndAddDailyQuest(a,o),v.default.postBI("quest_refresh")}})},t.prototype.doFastFinishDailyQuest=function(e){var t={questId:e};c.NET.send(d.RequestId.FAST_FINISH_DAILY_QUEST,t,this,function(e){var t=l.default.JSON_PARSE(e.d);r.Obj.isEmpty(t)||n.DATA.UserData.pushUpdateDailyQuest(t)})},t.prototype.requestGetDailyQuestReward=function(e){for(var t=!1,a=n.DATA.UserData.DailyQuests.slice(0),o=0;o<a.length;o++){var s=a[o];e===s.Id&&s.State===i.QuestState.CAN_REWARD&&(t=!0)}if(t){var p={questId:e};c.NET.send(d.RequestId.GET_DAILY_QUEST_REWARD,p,this,function(t){var a=l.default.JSON_PARSE(t.d);if(r.Obj.isEmpty(a));else{var o=r.Obj.getPropertyNumberByNames(a,null,"dailyQuestDelId"),i=r.Obj.getPropertyByNames(a,null,"newDailyQuest"),s=r.Obj.getPropertyNumberByNames(a,null,"dailyQuestFinishCount");null!==s&&n.DATA.UserData.setDailyQuestFinishCount(s),n.DATA.UserData.deleteAndAddDailyQuest(o,i),n.DATA.UserData.updateDailyQuestBoxState(a),v.default.postBI("quest_complete",{quest_id:e.toString()});var c=r.Obj.getPropertyByNames(a,null,"reward");if(null!==c){var d={serverReward:c};u.default.Instance().OpenUI(h.UIDataInfo.CommonRewardPanel,d)}m.send(m.Names.MVC_DAILY_QUEST_MAINUI_UPDATE,null)}})}},t.prototype.requestGetDailyQuestBoxRewawrd=function(e){var t=n.DATA.UserData.dailyQuestBoxStateArray[e-1];if(!r.Obj.isEmpty(t)&&t===i.DailyQuestBoxState.CAN_REWARD){var a={boxId:e};c.NET.send(d.RequestId.GET_DAILY_QUEST_BOX_REWARD,a,this,function(e){var t=l.default.JSON_PARSE(e.d);if(r.Obj.isEmpty(t));else{var a=r.Obj.getPropertyNumberByNames(t,null,"boxId"),o=r.Obj.getPropertyNumberByNames(t,null,"status");if(null!==a&&null!==o){var i=a-1;n.DATA.UserData.setDailyQuestBoxState(i,o)}var s=r.Obj.getPropertyByNames(t,null,"reward");if(null!==s){var c={serverReward:s};u.default.Instance().OpenUI(h.UIDataInfo.CommonRewardPanel,c)}m.send(m.Names.MVC_DAILY_QUEST_MAINUI_UPDATE,null)}})}},t.prototype.getRefreshCost=function(){var e=0;return n.DATA.UserData.getDailyQuestFreeRefreshCount()>=this._dailyQuestMaxRefreshCounts&&(e=this._dailyQuestRefreshPrice),e},t.prototype.getFinishedCost=function(){return this._dailyQuestRefreshPrice},t.prototype.initConfig=function(){var e=s.TABLE.getTableDataById(C.TableName.DATACONFIG,"21001"),t=r.Obj.getPropertyNumberByNames(e,0,"value");this._dailyQuestMaxCounts=t;e=s.TABLE.getTableDataById(C.TableName.DATACONFIG,"21002"),t=r.Obj.getPropertyNumberByNames(e,0,"value");this._dailyQuestMaxRefreshCounts=t;e=s.TABLE.getTableDataById(C.TableName.DATACONFIG,"21003"),t=r.Obj.getPropertyNumberByNames(e,0,"value");this._dailyQuestRefreshPrice=t,this._dailyQuestBoxCountsArray=[];e=s.TABLE.getTableDataById(C.TableName.DATACONFIG,"21004"),t=r.Obj.getPropertyStringByNames(e,"","value");for(var a=l.default.convertStringToArray(t),o=0;o<a.length;o++){var n=parseInt(a[o]);this._dailyQuestBoxCountsArray.push(n)}this._dailyQuestLimitLevel=0;e=s.TABLE.getTableDataById(C.TableName.DATACONFIG,"21006"),t=r.Obj.getPropertyNumberByNames(e,0,"value");this._dailyQuestLimitLevel=t,this._bountyQuestLimitLevel=0;var i=s.TABLE.getTableDataById(C.TableName.DATACONFIG,"61041"),c=r.Obj.getPropertyNumberByNames(i,0,"value");this._bountyQuestLimitLevel=c},t.prototype.showBountyReward=function(e,t){if(e&&t){var a=r.Obj.getPropertyNumberByNames(e.Data,null,"reward_id");if(null===a)return;var o=r.Obj.getPropertyNumberByNames(e.Data,1,"reward_multiple"),l=g.RewardController.Instance.convertClientConfigRewardToCommonRewardById(a);if(l&&e.QuestType===i.QuestType.DAILY){var c=n.DATA.UserData.Level,d=s.TABLE.getTableDataById(C.TableName.PLAYER_LEVEL,c.toString()),p=r.Obj.getPropertyNumberByNames(d,0,"dailyTask_exp");p*=o;var m=r.Obj.getPropertyNumberByNames(d,0,"dailyTask_gold");m*=o,l.exp={rewardType:i.ResourceType.Exp,configId:-1,count:p,serverId:-1},l.coin={rewardType:i.ResourceType.Coin,configId:-1,count:m,serverId:-1};var _=f.ActivityController.Instance.isActivityRefugeeOpen(),y=t.parent.convertToWorldSpaceAR(t.position);u.default.Instance().OpenUI(h.UIDataInfo.BountyQuestRewardPreviewPanel,{ClientCommonReward:l,tips:"",refugee:_,box:e,pos:y})}}},Object.defineProperty(t.prototype,"dailyQuestBoxCountsArray",{get:function(){return this._dailyQuestBoxCountsArray},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dailyQuestBoxRewardIdArray",{get:function(){if(!this._dailyQuestBoxRewardIdArray){this._dailyQuestBoxRewardIdArray=[];var e="21005";f.ActivityController.Instance.getActivityByActivityId(59)&&(e="31105");for(var t=s.TABLE.getTableDataById(C.TableName.DATACONFIG,e),a=r.Obj.getPropertyStringByNames(t,"","value"),o=l.default.convertStringToArray(a),n=0;n<o.length;n++){var i=parseInt(o[n]);this._dailyQuestBoxRewardIdArray.push(i)}}return this._dailyQuestBoxRewardIdArray},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showRefugee",{get:function(){return this._showRefugee},set:function(e){this._showRefugee=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.purge=function(){t._instance=null},t}(o.FMessageConnectionAbstract);a.QuestController=I,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/utils/FWSTool":"FWSTool","../Common/BIManager":"BIManager","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Module/UI/FreeGoldPanel":"FreeGoldPanel","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs","./ActivityController":"ActivityController","./RewardController":"RewardController"}],RGShareSDKController:[function(e,t,a){"use strict";cc._RF.push(t,"bc302XgcmpAZZWMHA122LF9","RGShareSDKController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../ShareSDK/RGShareInterface"),n=e("../Data/DataCenter"),i=e("../Data/GlobalData"),r=e("../../fws/platforms/PlatformCore"),s=e("../../Core/Net/WebClient"),l=e("../Common/BIManager"),c=e("../../Core/Common/LocalManager"),d=e("../../fws/mvc/FWSMvc"),p=e("../../fws/utils/X"),u=e("../../System/JSWrap"),h=e("../../fws/utils/ErrorReport"),m=e("../Common/PFOpenData"),f=e("../Tools/GameTools"),_=function(){return function(){this.resultcallbackList=[]}}();a.RGVideoModel=_,a.RGShareStatus={share_doing:"share_doing",share_cannel:"share_cannel",share_Finish:"share_Finish"};var y=function(){return function(){}}();a.RGCurrentShare=y;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rg_currentShareModel=null,t.rg_video_download=!1,t.rg_videoCloseCallFunc=null,t.__initFinish=!1,t.iVideoMap={},t}return __extends(t,e),t.rg_getInstance=function(){return null==this.rg_instance&&(this.rg_instance=new t,this.rg_instance.connect()),this.rg_instance},t.prototype.onFMessage_MVC_AppOnShow=function(e){var t=this;p.log("app onShow"),u.default.setTimeout(function(){t.rg_currentShareModel&&(t.rg_currentShareModel.shareAppbackTime=Date.now(),"share_Finish"!=t.rg_currentShareModel.shareStatus&&(p.log("RGShareController  openWXTime: "+t.rg_currentShareModel.shareOpenWXTime+"  appBackTime : "+t.rg_currentShareModel.shareAppbackTime),t.rg_currentShareModel.shareAppbackTime-t.rg_currentShareModel.shareOpenWXTime>1e3?t.rg_currentShareModel.shareMsg.success&&t.rg_currentShareModel.shareMsg.success():t.rg_currentShareModel.shareMsg.fail&&t.rg_currentShareModel.shareMsg.fail(o.IShareErrorCode.Share_Fail_Retry)))},200),this.rg_video_download=!0},t.prototype.onFMessage_MVC_AppOnHide=function(e){p.log("app onHide")},t.rg_doShareSDkInit=function(){this.rg_getInstance().__initFinish?t.rg_doUserInfoUpdate():(console.log("RGShareSDKController rg_doShareSDkInit"),this.rg_getInstance().rigisterSomeFunc(),this.rg_getInstance().shareInit())},t.rg_doUserInfoUpdate=function(){var e={userName:n.DATA.UserData.PlayerInfoData.playerInfo.getDisplayName(),userLevel:n.DATA.UserData.Level,userSex:n.DATA.UserData.PlayerInfoData.playerInfo.gender||0,userRegTime:n.DATA.UserData.RegTime,userAvatarUrl:n.DATA.UserData.PlayerInfoData.playerInfo.getDisplayAvatarUrl(),userPayCNYTotal:n.DATA.UserData.PayCNYTotal,userSeverId:n.DATA.UserData.OriginServerId,userId:n.DATA.UserData.UID.toString()};o.default.RGShareSDKUserInfoUpdate(e)},t.prototype.shareInit=function(){var e=window.OnlineServer;1!=e&&(e=!1);var a="";r.instance.isAndroid()?a="android":r.instance.isIos()?a="ios":r.instance.isWindows()&&(a="windows");var s=this,l={appId:o.RGShareSDkAppId,targetRelease:e,serverId:n.DATA.UserData.OriginServerId,shareImgPath:i.GLOBAL.ResourceUrl+"/Image/",platform:r.instance.platformSID,system:a,country:r.instance.getCurrentCountry(),initFinishCB:function(){s.__initFinish=!0,r.instance.onShareAppMessage(function(){p.log("RGShareSDKController  PlatformCore.instance.onShareAppMessage");var e=o.default.RGShareSDKGetOnShareMessage(o.RGSharePoint.SP_RightTopButton);return p.log("shareData:  ",e),e}),t.rg_doUserInfoUpdate(),n.DATA.UserData.Level>=3&&u.default.setTimeout(function(){o.default.RGCheckAllAd()},1e4),m.default.Instance.wxOnShow(null)}};o.default.RGShareSDKInit(l)},t.prototype.rigisterSomeFunc=function(){var e=this;o.default.RGShareSDK_registFunc_canUseShareSDK(function(){return!0}),o.default.RGShareSDK_registFunc_canShare(function(){return r.instance.canShare()}),o.default.RGShareSDK_registFunc_canWatchAd(function(){return r.instance.canRewardVideoAd()}),o.default.RGShareSDK_registFunc_doMd5(function(e){return f.default.doMd5(e)}),o.default.RGShareSDK_registFunc_doGet(function(t){s.get(t.url,{},e,function(e){var a=e.responseText;t.success&&t.success(JSON.parse(a))},function(e){t.fail&&t.fail()})}),o.default.RGShareSDK_registFunc_loadLocalStorage(function(e){return n.DATA.UserData.getLocalData(e.itemKey,"")}),o.default.RGShareSDK_registFunc_saveLocalStorage(function(e){return n.DATA.UserData.setLocalData(e.itemKey,e.itemValue),!0}),o.default.RGShareSDK_registFunc_checkHasAd(function(t){if(p.log("checkHasAd adid:"+t.adid),e.iVideoMap[t.adid]){var a=e.iVideoMap[t.adid];if("loadFinish"===a.loadStatus)return p.log("ad loadFinish adid:"+t.adid),void t.complete(!0);if("loading"===a.loadStatus)return p.log("ad loading adid:"+t.adid),void a.resultcallbackList.push(t.complete)}else{var o=null;if(o=r.instance.createRewardedVideoAd({adUnitId:t.adid,appSid:r.instance.platformSID})){var n=new _;e.iVideoMap[t.adid]=n,n.iVideo=o,n.adUnitId=t.adid,n.resultcallbackList.push(t.complete),p.log("ad loadStart adid:"+t.adid),o.onLoad(function(){p.log("\u89c6\u9891\u9884\u52a0\u8f7d\u6210\u529f ~~~~ onLoad")}),o.onError(function(e){p.log("\u89c6\u9891\u9884\u52a0\u8f7d\u5931\u8d25-err:"+e)}),n.loadStatus="loading",o.load().then(function(){n.loadStatus="loadFinish",p.log("\u89c6\u9891\u9884\u52a0\u8f7d\u6210\u529f\uff1a  ~~~ then");do{var e=n.resultcallbackList.shift();e&&e(!0)}while(n.resultcallbackList.length>0)}).catch(function(e){p.log("\u89c6\u9891\u9884\u52a0\u8f7d\u5931\u8d25 catch"+e.errMsg),t.complete&&t.complete(!1)})}else t.complete&&t.complete(!1)}});var t=this;o.default.RGShareSDK_registFunc_doShare(function(e){p.log("ShareMsg :",e),t.rg_currentShareModel=new y,t.rg_currentShareModel.shareMsg=e,t.rg_currentShareModel.shareStatus="share_doing",t.rg_currentShareModel.shareOpenWXTime=Date.now(),r.instance.shareAppMessage({title:e.title,imageUrl:e.imageUrl,imageUrlId:e.imageUrlId,query:"&"+e.query,success:function(){t.rg_currentShareModel&&(t.rg_currentShareModel.shareStatus="share_Finish",t.rg_currentShareModel=null,e.success&&e.success())},fail:function(){t.rg_currentShareModel&&(t.rg_currentShareModel.shareStatus="share_Finish",t.rg_currentShareModel=null,e.fail&&e.fail(o.IShareErrorCode.Share_Fail_Retry))}})}),o.default.RGShareSDK_registFunc_doWatchAdMob(function(t){var a;t.popTime>0&&(a=setTimeout(function(){r.instance.showModal({content:c.LOCAL.getText("public408")})},1e3*t.popTime)),e.rg_video_download=!1;var n=null,i=function(n){p.log("timeoutId",a),a&&clearTimeout(a),n?t.success&&t.success(e.rg_video_download):t.fail&&t.fail(o.IShareErrorCode.Share_Fail_CancalSeeVideo,e.rg_video_download),delete e.iVideoMap[t.adid]};e.iVideoMap[t.adid]&&"loadFinish"===e.iVideoMap[t.adid].loadStatus?(p.log("\u89c6\u9891\u64ad\u653e\u76f4\u63a5\u5f00\u59cb call show"),n=e.iVideoMap[t.adid].iVideo,e.rg_videoCloseCallFunc=function(t){"toutiao"!=r.instance.platformSID&&n.offClose(e.rg_videoCloseCallFunc),t&&t.isEnded||void 0===t?i(!0):i(!1),e.rg_videoCloseCallFunc=null},n.onClose(e.rg_videoCloseCallFunc),n.show()):((n=r.instance.createRewardedVideoAd({adUnitId:t.adid,appSid:r.instance.platformSID})).onLoad(function(){p.log("\u89c6\u9891\u64ad\u653e\u76f4\u63a5\u65b0\u52a0\u8f7d  \u5b8c\u6210")}),n.onError(function(e){p.log("\u89c6\u9891\u52a0\u8f7d\u5931\u8d25-err:"+e)}),n.load().then(function(){n&&(e.rg_videoCloseCallFunc=function(t){"toutiao"!=r.instance.platformSID&&n.offClose(e.rg_videoCloseCallFunc),t&&t.isEnded||void 0===t?i(!0):i(!1),e.rg_videoCloseCallFunc=null},n.onClose(e.rg_videoCloseCallFunc),n.show())}).catch(function(n){a&&clearTimeout(a),p.log("\u89c6\u9891\u62c9\u53d6\u5931\u8d25\u4e86\uff1a"+n.errMsg),t.fail&&t.fail(o.IShareErrorCode.Share_Fail_SeeVideoFail,e.rg_video_download)}))}),o.default.RGShareSDK_registFunc_doBI(function(e){if("SeeVideoRet"==e.name||"SeeVideoPre"==e.name||"SeeVideo"==e.name)l.default.Instance.PostExtraAction(e.name,e.params);else{var t=0,a="",o=0,n=0;e.params&&(e.params.shareId&&(t=e.params.shareId),e.params.shareLogId&&(a=e.params.shareLogId),e.params.shareGroupId&&(o=e.params.shareGroupId),e.params.shareType&&(n=e.params.shareType)),l.default.Instance.PostShareData(e.name,t,a,n,o)}}),o.default.RGShareSDK_registFunc_doErrorReport(function(e){e&&e.name&&(e.params?h.trace({resp:e.name,data:JSON.stringify(e.params)},"video"):h.trace({resp:e.name},"video"))}),o.default.RGShareSDK_registerFunc_LangFunc(function(e){return c.LOCAL.getText?c.LOCAL.getText(e):(p.log("LOCAL.getText   \u65b9\u6cd5\u53d6\u4e0d\u5230"),e)})},t.rg_instance=null,t}(d.FMessageConnectionAbstract);a.default=g,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Net/WebClient":"WebClient","../../System/JSWrap":"JSWrap","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/ErrorReport":"ErrorReport","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/PFOpenData":"PFOpenData","../Data/DataCenter":"DataCenter","../Data/GlobalData":"GlobalData","../ShareSDK/RGShareInterface":"RGShareInterface","../Tools/GameTools":"GameTools"}],RewardController:[function(e,t,a){"use strict";cc._RF.push(t,"1a9f9x7TqND25qtrsQdSbe0","RewardController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/mvc/FWSMvc"),n=e("../../fws/utils/FWSTool"),i=e("../Const/GameDefine"),r=e("../Tools/GameTools"),s=e("../../Core/Utils/UpdateSpriteFrame"),l=e("../../Core/Common/TableManager"),c=e("../Module/Item/PropItem"),d=e("../../Core/Common/LocalManager"),p=e("../Data/DataCenter"),u=e("../../fws/utils/X"),h=e("../Const/TableName"),m=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.convertClientConfigRewardToCommonRewardById=function(e){if(n.Obj.isEmpty(e))return null;var t=l.TABLE.getTableDataById(h.TableName.REWARD,e.toString());return n.Obj.isEmpty(t)?null:this.convertClientConfigRewardToCommonReward(t)},t.prototype.convertClientConfigRewardToCommonReward=function(e){var t=n.Obj.getPropertyStringByNames(e,"0","coin"),a=parseFloat(t),o=n.Obj.getPropertyStringByNames(e,"0","wood"),s=parseFloat(o),l=n.Obj.getPropertyStringByNames(e,"0","oil"),c=parseFloat(l),d=n.Obj.getPropertyStringByNames(e,"0","soil"),h=parseFloat(d),m=n.Obj.getPropertyStringByNames(e,"0","gold"),f=parseFloat(m),_=n.Obj.getPropertyStringByNames(e,"0","energy"),y=parseFloat(_),g=n.Obj.getPropertyStringByNames(e,"0","exp"),C=parseFloat(g),v=n.Obj.getPropertyStringByNames(e,"0","military"),I=parseFloat(v);p.DATA.UserData.FunctionOn(i.FunctionKey.key_novice_adjustments)?a+=this.getNewRewardCoinByUserLevel(e):a+=this.getNewRewardCoin(e);var T=[],S=n.Obj.getPropertyStringByNames(e,"","item"),A=n.Obj.getPropertyStringByNames(e,"","num");if("number"==typeof S&&(S=S.toString()),"number"==typeof A&&(A=A.toString()),S.length>0&&A.length>0)for(var D=r.default.convertStringToArray(S),N=r.default.convertStringToArray(A),b=Math.min(D.length,N.length),L=0;L<b;L++){var E=parseInt(D[L]),P=parseInt(N[L]);if(!n.Obj.isEmpty(E)&&!n.Obj.isEmpty(P)){var w={rewardType:i.ResourceType.Item,configId:E,count:P,serverId:-1};T.push(w)}}var B=[],M=n.Obj.getPropertyStringByNames(e,"","resource"),U=n.Obj.getPropertyStringByNames(e,"","resource_num");if("number"==typeof M&&(M=U.toString()),"number"==typeof U&&(U=U.toString()),M.length>0&&U.length>0)for(D=r.default.convertStringToArray(M),N=r.default.convertStringToArray(U),b=Math.min(D.length,N.length),L=0;L<b;L++){var R=D[L],G=(P=parseFloat(N[L]),-1);if("coin"==R)G=i.ResourceType.Coin;else if("wood"==R)G=i.ResourceType.Wood;else if("oil"==R)G=i.ResourceType.Wood;else if("Oil"==R)G=i.ResourceType.Wood;else if("soil"==R)G=i.ResourceType.Soil;else if("gold"==R)G=i.ResourceType.Gold;else if("energy"==R)G=i.ResourceType.Energy;else if("exp"==R)G=i.ResourceType.Exp;else{if("military"!=R){u.log("\u6682\u4e0d\u652f\u6301\u663e\u793a\u7c7b\u578b"+R);continue}G=i.ResourceType.BountyCount}if(!n.Obj.isEmpty(G)&&!n.Obj.isEmpty(P)){w={rewardType:G,configId:-1,count:P,serverId:-1};B.push(w)}}var O=[],k=n.Obj.getPropertyStringByNames(e,"","army_id"),x=n.Obj.getPropertyStringByNames(e,"","army_num");if(k.length>0&&x.length>0)for(D=r.default.convertStringToArray(k),N=r.default.convertStringToArray(x),b=Math.min(D.length,N.length),L=0;L<b;L++){E=parseInt(D[L]),P=parseInt(N[L]);if(!n.Obj.isEmpty(E)&&!n.Obj.isEmpty(P)){w={rewardType:i.ResourceType.Army,configId:E,count:P,serverId:-1};O.push(w)}}var F=[],V=n.Obj.getPropertyStringByNames(e,"","building"),H=n.Obj.getPropertyStringByNames(e,"","building_num");if(V.length>0&&H.length>0)for(D=r.default.convertStringToArray(V),N=r.default.convertStringToArray(H),b=Math.min(D.length,N.length),L=0;L<b;L++){E=parseInt(D[L]),P=parseInt(N[L]);if(!n.Obj.isEmpty(E)&&!n.Obj.isEmpty(P)){w={rewardType:i.ResourceType.Building,configId:E,count:P,serverId:-1};F.push(w)}}var W={coin:{rewardType:i.ResourceType.Coin,count:a,configId:-1,serverId:-1},wood:{rewardType:i.ResourceType.Wood,count:s,configId:-1,serverId:-1},oil:{rewardType:i.ResourceType.Oil,count:c,configId:-1,serverId:-1},soil:{rewardType:i.ResourceType.Soil,count:h,configId:-1,serverId:-1},gold:{rewardType:i.ResourceType.Gold,count:f,configId:-1,serverId:-1},energy:{rewardType:i.ResourceType.Energy,count:y,configId:-1,serverId:-1},exp:{rewardType:i.ResourceType.Exp,count:C,configId:-1,serverId:-1},bountyCount:{rewardType:i.ResourceType.BountyCount,count:I,configId:-1,serverId:-1},items:T,armys:O,buildings:F};return B.length>0&&(W.randomResources=B),W},t.prototype.getNewRewardCoin=function(e){var t=0,a=n.Obj.getPropertyStringByNames(e,"","newReward");do{if(a.length<=0)break;var o=r.default.convertStringToArray(a);if(o.length<2)break;var i=o[0],s=o[1];if("1"===i){for(var c=0,d=p.DATA.UserData.Buildings,u=0;u<d.length;u++){if(!d[u].Data||1===d[u].Data.produce_type)if(!((f=n.Obj.getPropertyNumberByNames(d[u].Data,0,"produce_time"))<=0))(_=n.Obj.getPropertyNumberByNames(d[u].Data,0,"para")/f)<0||(c+=_)}var h=p.DATA.UserData.Level,m=l.TABLE.getTableByKey("building","produce_type",1,"level",h);if(m&&m.length>0){var f,_,y=m[0];if((f=n.Obj.getPropertyNumberByNames(y,0,"produce_time"))>0)(_=n.Obj.getPropertyNumberByNames(y,0,"para")/f)>=0&&(c=Math.max(Math.min(20*_,c),.2*_))}t=c=c*(2+h)/9.5*10*parseInt(s)}}while(0);return t},t.prototype.getNewRewardCoinByUserLevel=function(e){var t=0,a=n.Obj.getPropertyStringByNames(e,"","newReward");if(a.length<=0)return t;var o=a.split(",");if(0==o.length)return t;var i=o.length>=2?parseInt(o[1]):999,s=r.default.convertStringToArray(o[0]);if(s.length<2)return t;var c=parseInt(s[0]),d=parseInt(s[1]);if(1===c){var u=l.TABLE.getTableDataById(h.TableName.DATACONFIG,"5087"),m=n.Obj.isEmpty(u)?1:Number(n.Obj.getProperty(u,"value",0));i=Math.min(p.DATA.UserData.Level,i);var f=l.TABLE.getTableByKey(h.TableName.BUILDING,"produce_type",1,"level",i);if(f&&f.length>0){var _=f[0];t=(_.para_v1?_.para_v1:_.para)/_.produce_time*60*m*d}}return t},t.prototype.convertServerRewardToCommonReward=function(e){for(var t=n.Obj.getPropertyByNames(e,0,"resource","coin"),a=n.Obj.getPropertyByNames(e,0,"resource","kvk_res"),o=n.Obj.getPropertyByNames(e,0,"resource","wood"),r=n.Obj.getPropertyByNames(e,0,"resource","oil"),s=n.Obj.getPropertyByNames(e,0,"resource","oila"),l=n.Obj.getPropertyByNames(e,0,"resource","soil"),c=n.Obj.getPropertyByNames(e,0,"resource","gold"),d=n.Obj.getPropertyByNames(e,0,"resource","honor"),p=n.Obj.getPropertyByNames(e,0,"resource","voucher"),u=n.Obj.getPropertyByNames(e,0,"resource","military"),h=n.Obj.getPropertyByNames(e,0,"exp"),m=n.Obj.getPropertyByNames(e,0,"energy"),f=n.Obj.getPropertyByNames(e,0,"islandPoint"),_=n.Obj.getPropertyByNames(e,0,"giftExp"),y=n.Obj.getPropertyByNames(e,0,"giftKey"),g=[],C=n.Obj.getPropertyByNames(e,[],"items"),v=0;v<C.length;v++){var I=C[v],T=n.Obj.getPropertyByNames(I,null,"itemId"),S=n.Obj.getPropertyByNames(I,null,"itemCount");if(null!==T&&null!==S){var A={rewardType:i.ResourceType.Item,configId:T,count:S,serverId:-1};g.push(A)}}var D=[],N=n.Obj.getPropertyByNames(e,[],"armys");for(v=0;v<N.length;v++){I=N[v],T=n.Obj.getPropertyByNames(I,null,"itemId"),S=n.Obj.getPropertyByNames(I,null,"itemCount");if(null!==T&&null!==S){A={rewardType:i.ResourceType.Army,configId:T,count:S,serverId:-1};D.push(A)}}var b=[],L=n.Obj.getPropertyByNames(e,[],"build");for(v=0;v<L.length;v++){I=L[v],T=n.Obj.getPropertyByNames(I,null,"itemId"),S=n.Obj.getPropertyByNames(I,null,"itemCount");if(null!==T&&null!==S){A={rewardType:i.ResourceType.Building,configId:T,count:S,serverId:-1};b.push(A)}}var E=[],P=n.Obj.getPropertyByNames(e,[],"kvkSecret");for(v=0;v<P.length;v++){I=P[v],T=n.Obj.getPropertyByNames(I,null,"itemId"),S=n.Obj.getPropertyByNames(I,null,"itemCount");if(null!==T&&null!==S){A={rewardType:i.ResourceType.SpItem,configId:T,count:S,serverId:-1};E.push(A)}}return{coin:{rewardType:i.ResourceType.Coin,count:t,configId:-1,serverId:-1},kvkRes:{rewardType:i.ResourceType.kvk_res,count:a,configId:-1,serverId:-1},wood:{rewardType:i.ResourceType.Wood,count:o,configId:-1,serverId:-1},oil:{rewardType:i.ResourceType.Oil,count:r,configId:-1,serverId:-1},oila:{rewardType:i.ResourceType.Oila,count:s,configId:-1,serverId:-1},soil:{rewardType:i.ResourceType.Soil,count:l,configId:-1,serverId:-1},gold:{rewardType:i.ResourceType.Gold,count:c,configId:-1,serverId:-1},energy:{rewardType:i.ResourceType.Energy,count:m,configId:-1,serverId:-1},exp:{rewardType:i.ResourceType.Exp,count:h,configId:-1,serverId:-1},honor:{rewardType:i.ResourceType.Honor,count:d,configId:-1,serverId:-1},islandPoint:{rewardType:i.ResourceType.islandPoint,count:f,configId:-1,serverId:-1},bountyCount:{rewardType:i.ResourceType.BountyCount,count:u,configId:-1,serverId:-1},items:g,armys:D,spItems:E,buildings:b,agExp:{rewardType:i.ResourceType.AGExp,count:_,configId:-1,serverId:-1},agKey:{rewardType:i.ResourceType.AGKey,count:y,configId:-1,serverId:-1},voucher:{rewardType:i.ResourceType.Voucher,count:p,configId:-1,serverId:-1}}},t.prototype.convertCommonRewardToArr=function(e){for(var t=[],a=["coin","wood","oil","soil","gold","energy","exp","islandPoint"],o=0;o<a.length;o++){var i=n.Obj.getPropertyByNames(e,null,a[o]);i&&i.count>0&&t.push(i)}var r=["items","armys","buildings","randomResources"];for(o=0;o<r.length;o++){var s=n.Obj.getPropertyByNames(e,[],r[o]);s.length>0&&(t=t.concat(s))}return t},t.prototype.setRewardItems=function(e,t,a,o){if(void 0===o&&(o=null),a&&e&&e.isValid&&t){var r=[],s=function(e,t,a,o){void 0===o&&(o=0),null!==a&&void 0!==a&&0!==a&&e.push({type:t,count:a,itemID:o})};if(s(r,i.ResourceType.Coin,a.coin),s(r,i.ResourceType.Gold,a.gold),s(r,i.ResourceType.Honor,a.honor),s(r,i.ResourceType.Oil,a.oil),s(r,i.ResourceType.Wood,a.wood),s(r,i.ResourceType.Oila,a.oila),s(r,i.ResourceType.Metal,a.metal),s(r,i.ResourceType.Soil,a.soil),s(r,i.ResourceType.Coal,a.coal),e.destroyAllChildren(),o)for(var l=0;l<o.length;l++){var d=o[l],p=n.Obj.getProperty(d,"amount",0),u=n.Obj.getProperty(d,"itemId",0);s(r,i.ResourceType.Item,p,u)}for(var h=0;h<r.length;h++){var m=r[h],f=cc.instantiate(t);if(f){var _=f.getComponent(c.default);_&&(m.type==i.ResourceType.Item?_.UpdateItem(m.itemID,m.count):_.UpdateRes(m.type,m.count)),e.addChild(f)}}}},t.prototype.setSingleReward=function(e,t,a,o){if(void 0===o&&(o=1),!n.Obj.isEmpty(e)){var c=n.Obj.getPropertyByNames(e,0,"itemId"),d=n.Obj.getPropertyByNames(e,0,"itemCount"),p=n.Obj.getPropertyByNames(e,0,"type"),u=function(e,t,a){null!==e&&void 0!==e&&(t.node.active=e>0,e>0&&(t.string=r.default.GetLargeNumberShow(e),a===i.ResourceType.Army&&(t.string="x"+t.string)))};if(p===i.ResourceType.Army){var m=l.TABLE.getTableDataById(h.TableName.ARMY,c.toString());m&&r.default.UpdateArmyIcon(m,t),u(d,a,p)}else if(this.isResourceType(p))s.UpdateSpriteFrame(r.default.getResourceIcon(c),t),u(d,a,p);else if(p===i.ResourceType.Item){var f=l.TABLE.getTableDataById(h.TableName.ITEM,c.toString());n.Obj.isEmpty(f)||s.UpdateSpriteFrame(f.icon,t),u(d,a,p)}t.node.scale=o}},t.prototype.isResourceType=function(e){return[i.ResourceType.Energy,i.ResourceType.Coin,i.ResourceType.Gold,i.ResourceType.Wood,i.ResourceType.Oil,i.ResourceType.Exp].indexOf(e)>=0},t.prototype.getRewardsArrById=function(e){var a=t.Instance.convertClientConfigRewardToCommonRewardById(e);return t.Instance.getRewardsArr(a)},t.prototype.getRewardsArr=function(e){var t=[],a=function(e,t,a,o,n){null!==o&&void 0!==o&&0!==o&&e.push({type:t,id:a,count:o,name:n})};if(e.armys.length>0)for(var o=0;o<e.armys.length;++o){if((C=e.armys[o]).count>0){var n="",s=C.configId;l.TABLE.getTableDataById(h.TableName.ARMY,s.toString())&&(n=r.default.getArmyName(s)),a(t,i.ResourceType.Army,s,C.count,n)}}for(var c=[e.energy,e.coin,e.gold,e.wood,e.oil,e.exp],p=[i.ResourceType.Energy,i.ResourceType.Coin,i.ResourceType.Gold,i.ResourceType.Wood,i.ResourceType.Oil,i.ResourceType.Exp],u=Math.min(c.length,p.length),m=0;m<u;m++){var f=p[m],_=c[m];if(_.count>0){var y=_.rewardType,g=d.LOCAL.getText(i.ResourceNameConst[f.toString()]);a(t,f,y,_.count,g)}}if(e.items.length>0)for(o=0;o<e.items.length;++o){var C;if((C=e.items[o]).count>0){y=C.configId;var v=l.TABLE.getTableDataById(h.TableName.ITEM,y.toString());g="";r.default.ObjIsEmpty(v)||(g=v.name),a(t,i.ResourceType.Item,y,C.count,g)}}return t},t.prototype.setRewardComponent=function(e,t,a,o){if(void 0===o&&(o=1),a.armys.length>0)for(var n=0;n<a.armys.length;n++){if((p=a.armys[n]).count>0)if(u=cc.instantiate(t))(h=u.getComponent(c.default))&&h.UpdateArmyItem(p.configId,p.count),e.addChild(u),u.scale=o}var r=[a.energy,a.coin,a.gold,a.wood,a.oil,a.exp,a.bountyCount],s=[i.ResourceType.Energy,i.ResourceType.Coin,i.ResourceType.Gold,i.ResourceType.Wood,i.ResourceType.Oil,i.ResourceType.Exp,i.ResourceType.BountyCount],l=Math.min(r.length,s.length);for(n=0;n<l;n++){var d=r[n];if(d.count>0)if(u=cc.instantiate(t))(h=u.getComponent(c.default))&&h.UpdateRes(d.rewardType,d.count),e.addChild(u),u.scale=o}if(a.items.length>0)for(n=0;n<a.items.length;n++){if((p=a.items[n]).count>0)if(u=cc.instantiate(t))(h=u.getComponent(c.default))&&h.UpdateItem(p.configId,p.count),e.addChild(u),u.scale=o}if(a.randomResources&&a.randomResources.length>0)for(n=0;n<a.randomResources.length;n++){var p,u,h;if((p=a.randomResources[n]).count>0)if(u=cc.instantiate(t))(h=u.getComponent(c.default))&&h.UpdateRes(p.rewardType,p.count),e.addChild(u),u.scale=o}},Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t}(o.FMessageConnectionAbstract);a.RewardController=m,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Const/GameDefine":"GameDefine","../Const/TableName":"TableName","../Data/DataCenter":"DataCenter","../Module/Item/PropItem":"PropItem","../Tools/GameTools":"GameTools"}],ScienceController:[function(e,t,a){"use strict";cc._RF.push(t,"b8eda3D4MBOJahQ8b/8voGb","ScienceController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/TableManager"),n=e("../../fws/utils/FWSTool"),i=e("../Data/DataCenter"),r=e("../Tools/GameTools"),s=e("../../Core/Common/LocalManager"),l=e("../Const/GameDefine"),c=e("../Const/TableName"),d=e("../Const/UIDataInfo"),p=e("../Common/UIManager"),u=e("../Const/GameDefine"),h=e("../../Core/Utils/UpdateSpriteFrame"),m=e("../Module/UI/HeadquartersPanel"),f=e("../Module/UI/SciencePanel"),_=function(){function e(){this._scienceUnlockMaxLevel=0,this._scienceGroupLevelArrayMap=null,this._scienceGroupIdArray=null,this._scienceGroupMinLevelMap=null}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._instance=null},e.prototype.initScienceStaticData=function(){this._scienceUnlockMaxLevel=parseInt(r.default.getDataConfigData(2008));var e=o.TABLE.getTableGroup(i.DATA.UserData.scienceTableName);for(var t in this._scienceGroupLevelArrayMap={},this._scienceGroupIdArray=[],this._scienceGroupMinLevelMap={},e){var a=e[t],s=a.group_id,l=this._scienceGroupLevelArrayMap[s];if(l||(this._scienceGroupLevelArrayMap[s]=l=[],this._scienceGroupIdArray.push(s)),(!this._scienceGroupMinLevelMap.hasOwnProperty(s)||a.level<this._scienceGroupMinLevelMap[s])&&(this._scienceGroupMinLevelMap[s]=a.level),l[a.level]=a,a.item_data=o.TABLE.getTableDataById(c.TableName.ITEM,a.item_id.toString()),!n.Str.isEmpty(a.condition_science)&&"0"!==a.condition_science){for(var d=[],p=a.condition_science.split(","),u=0,h=p.length;u<h;++u)d.push(o.TABLE.getTableDataById(i.DATA.UserData.scienceTableName,p[u]));a.conditions=d}}},e.prototype.getScienceUnlockMaxLevel=function(){return this._scienceUnlockMaxLevel},e.prototype.visitScienceGroup=function(e){for(var t=0,a=this._scienceGroupIdArray.length;t<a;++t){if(e(this._scienceGroupIdArray[t]))break}},e.prototype.getScienceDataByGroupAndLevel=function(e,t){t<0&&(t=this._scienceGroupMinLevelMap.hasOwnProperty(e)?this._scienceGroupMinLevelMap[e]:0);var a=this._scienceGroupLevelArrayMap[e];return a&&t<a.length?a[t]:null},e.getScienceArrByType=function(e){var t=o.TABLE.getTableGroup(i.DATA.UserData.scienceTableName),a={};for(var r in t){var s=t[r];if(s.tree_type===e){var l=s.group_id,c=a[l];if(n.Obj.isEmpty(c)){var d=i.DATA.UserData.getScienceByGroupId(l);null!==d?(d.ScienceId<s.id||d.ScienceId===s.id&&s.level===s.max_level)&&(a[l]=s):a[l]=s}}}return a},e.GetNextScienceDataByGroupId=function(e){var t=o.TABLE.getTableGroup(i.DATA.UserData.scienceTableName),a=i.DATA.UserData.getScienceByGroupId(e),r=!n.Obj.isEmpty(a);for(var s in t){var l=t[s];if(l.group_id===e){if(!r)return l;if(l.id>a.ScienceId)return l}}return null},e.GetScienceDataByGroupId=function(e,t){var a=[],r=o.TABLE.getTableGroup(i.DATA.UserData.scienceTableName),s=i.DATA.UserData.getScienceByGroupId(e),l=!n.Obj.isEmpty(s);for(var c in r){var d=r[c];d.group_id===e&&(l?d.id>s.ScienceId&&d.level<=t&&a.push(d):d.level<=t&&a.push(d))}return a},e.GetCurScienceDataByGroupId=function(e){var t=o.TABLE.getTableGroup(i.DATA.UserData.scienceTableName),a=i.DATA.UserData.getScienceByGroupId(e);if(n.Obj.isEmpty(a))return null;for(var r in t){var s=t[r];if(s.group_id===e&&a.ScienceId===s.id)return s}return null},e.GetScienceCanLearnByGroupId=function(t){312e3===t&&console.log("scienceGroupID ====");var a=e.GetNextScienceDataByGroupId(t);if(r.default.ObjIsEmpty(a))return{result:!1,errStr:s.LOCAL.getText("100087")};if(0===a.is_open)return{result:!1,errStr:s.LOCAL.getText("100088")};if(i.DATA.UserData.Level<a.unlock_level){var l=i.DATA.UserData.getMaxLevel();return a.unlock_level>l?{result:!1,errStr:s.LOCAL.getText("100089")}:{result:!1,errStr:s.LOCAL.getText("100090",a.unlock_level+"")}}if(0!==a.condition_science)for(var d=(a.condition_science+"").split(","),p=0;p<d.length;p++){var u=o.TABLE.getTableDataById(i.DATA.UserData.scienceTableName,d[p]);if(!n.Obj.isEmpty(u)){var h=i.DATA.UserData.getScienceByGroupId(u.group_id);if(n.Obj.isEmpty(h)||h.Data.level<u.level)return{result:!1,errStr:s.LOCAL.getText("100091",u.level,s.LOCAL.getText(u.name))}}}var m=o.TABLE.getTableDataById(c.TableName.ITEM,a.item_id.toString());return n.Obj.isEmpty(m)?{result:!1,errStr:s.LOCAL.getText("101064")}:a.item_amount>i.DATA.UserData.getItemAmount(a.item_id)?{result:!1,errStr:s.LOCAL.getText("101064")}:i.DATA.UserData.Resource.Coin<a.coin?{result:!1,errStr:s.LOCAL.getText("101064")}:{result:!0,errStr:""}},e.hasCanLearnScience=function(){var t=o.TABLE.getTableGroup("science"),a=[];for(var n in t){var i=t[n].group_id;if(a.indexOf(i)<0){if(e.GetScienceCanLearnByGroupId(i).result)return!0;a.push(i)}}return!1},e.openMainSciencePanel=function(e){if(void 0===e&&(e=!1),e){var t=i.DATA.UserData.FunctionOn(u.FunctionKey.key_novice_adjustments)?3900:1900;i.DATA.UserData.checkBuildingGroupExists(t)?i.DATA.UserData.FunctionOn(u.FunctionKey.key_novice_adjustments)?m.default.ShowView():f.default.ShowView():p.default.Instance().ShowTips(s.LOCAL.getText("112352"))}else i.DATA.UserData.FunctionOn(u.FunctionKey.key_novice_adjustments)?m.default.ShowView():f.default.ShowView()},e.openScienceLearnPanel=function(e,t,a){"number"==typeof e&&(e={id:e,conditions:[]}),i.DATA.UserData.FunctionOn(l.FunctionKey.key_novice_adjustments)?p.default.Instance().OpenUI(d.UIDataInfo.HeadquartersLearnPanel,e,t,a):p.default.Instance().OpenUI(d.UIDataInfo.ScienceLearnPanel,e,t,a)},e.UpdateScienceIcon=function(e,t,a){if(r.default.verifyComponent(t)&&t.node.safetyDestroyAllChildren(),null!==e&&void 0!==e)if(t.node.scale=1,e.type==l.ScienceType.BuildBuilding||e.type==l.ScienceType.MergeBuilding){var n=o.TABLE.getTableDataById(c.TableName.BUILDING,e.para.toString());if(!n)return;r.default.UpdateBuildingIcon(n,t,a)}else if(e.type==l.ScienceType.MergeArmy){var i=o.TABLE.getTableDataById(c.TableName.ARMY,e.para.toString());if(!i)return;r.default.UpdateArmyIcon(i,t,a)}else{var s="image/science/science_group_"+e.group_id;h.UpdateSpriteFrame(s,t,a),t.node.scale=1.5}},e.UpdateHeadquartersIcon=function(e,t,a){if(r.default.verifyComponent(t)&&t.node.safetyDestroyAllChildren(),null!==e&&void 0!==e)if(t.node.scale=1,i.DATA.UserData.FunctionOn(u.FunctionKey.key_novice_adjustments)&&e.type==l.ScienceType.Headquarters){var n=o.TABLE.getTableDataByKeyValue(c.TableName.BUILDING,"group",e.bound_buildinglevel);if(!n)return;for(var s in n)if(n[s].level==e.level){r.default.UpdateBuildingIcon(n[s],t,a);break}}else if(e.type==l.ScienceType.BuildBuilding||e.type==l.ScienceType.MergeBuilding){var d=o.TABLE.getTableDataById(c.TableName.BUILDING,e.para.toString());if(!d)return;r.default.UpdateBuildingIcon(d,t,a),t.node.scale=.8}else if(e.type==l.ScienceType.MergeArmy){var p=o.TABLE.getTableDataById(c.TableName.ARMY,e.para.toString());if(!p)return;r.default.UpdateArmyIcon(p,t,a),t.node.scale=.8}else{var m="image/science/science_group_"+e.group_id;h.UpdateSpriteFrame(m,t,a),t.node.scale=1}},e.guideLearnScienceById=function(t,a,n){void 0===n&&(n=null);var l=null,c=o.TABLE.getTableDataById(i.DATA.UserData.scienceTableName,t.toString());if(null!=c)if(i.DATA.UserData.Level<c.unlock_level){var d=s.LOCAL.getText("science_unlock_level_tip",String(c.unlock_level),String(c.level),s.LOCAL.getText(c.name));p.default.Instance().ShowTips(d)}else if(l=n?{id:c.id,conditionOfId:n,conditions:[]}:{id:c.id,conditions:[]},0!=parseInt(c.condition_science))for(var u=(c.condition_science+"").split(","),h=0;h<u.length;h++){var m=o.TABLE.getTableDataById(i.DATA.UserData.scienceTableName,u[h]);if(!r.default.ObjIsEmpty(m)&&m.group_id!=a)for(var f=e.GetScienceDataByGroupId(m.group_id,m.level),_=0;_<f.length;_++){var y=f[_];if(!(null!=y&&m.level>=y.level))break;if(!e.scienceIds[y.id]){var g=this.guideLearnScienceById(y.id,y.group_id,t);g&&!e.scienceIds[g.id]&&(l.conditions.push(g),e.scienceIds[y.id]=1)}}}return l},e.GuideLearnScience=function(t){e.scienceIds={};var a=null,o=e.GetNextScienceDataByGroupId(t);return null!=o&&(e.scienceIds[o.id]=1,a=this.guideLearnScienceById(o.id,t)),a},e.ShowLearnGuidScience=function(t,a){void 0===a&&(a=null);var o=e.GuideLearnScience(t);return!!o&&(e.openScienceLearnPanel(o,a,this),!0)},e.getScienceLevelUpCoin=function(e,t){void 0===t&&(t=!0);var a=e.coin;if(i.DATA.UserData.FunctionOn(u.FunctionKey.ScienceCostNew)&&e.coin_tuning&&(a=e.coin_tuning),e.type==l.ScienceType.BuildBuilding){var n=o.TABLE.getTableDataById(c.TableName.BUILDING,e.para);if(null==n)return a;for(var r=i.DATA.UserData.Buildings,s=0;s<r.length;s++){var d=r[s];null!=d.Data&&(d.Data.group==n.group&&(d.Data.level>=n.level||(a+=d.Data.build_coin)))}}return t&&(a=Math.ceil(i.DATA.UserData.Buff.getValueWithBuff(a,l.BuffType.PlayerScienceReduceGold,!1))),a},e.prototype.GetRedPoint=function(){var t=this.getScienceUnlockMaxLevel(),a=!1,o=this;return this.visitScienceGroup(function(n){var r=i.DATA.UserData.getScienceByGroupId(n),s=r?o.getScienceDataByGroupAndLevel(n,r.Data.level+1):o.getScienceDataByGroupAndLevel(n,-1);if(!s||i.DATA.UserData.Level<s.unlock_level||0===s.is_open||s.unlock_level>t)return!1;var c=s.conditions,d=c?c.length:0;if(d>0){for(var p=!1,u=0;u<d;++u){var h=c[u];if(h){var m=i.DATA.UserData.getScienceByGroupId(h.group_id);if(null==m||m.Data.level<h.level){p=!0;break}}}if(p)return!1}if(s.item_data&&s.item_amount>i.DATA.UserData.getItemAmount(s.item_id))return!1;return!(e.getScienceLevelUpCoin(s)>i.DATA.UserData.Resource.getResource(l.ResourceType.Coin))&&(a=!0,!0)}),a},e.scienceIds={},e}();a.default=_,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Utils/UpdateSpriteFrame":"UpdateSpriteFrame","../../fws/utils/FWSTool":"FWSTool","../Common/UIManager":"UIManager","../Const/GameDefine":"GameDefine","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Module/UI/HeadquartersPanel":"HeadquartersPanel","../Module/UI/SciencePanel":"SciencePanel","../Tools/GameTools":"GameTools"}],ShopController:[function(e,t,a){"use strict";cc._RF.push(t,"9a130mEoKxKsKGpZjzeyDBV","ShopController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../Core/Common/TableManager"),i=e("../../Core/Net/NetMgr"),r=e("../Common/UIManager"),s=e("../Const/RequestId"),l=e("../Const/UIDataInfo"),c=e("../Data/DataCenter"),d=e("../Tools/GameTools"),p=e("./ExchangeController"),u=e("../../fws/utils/FWSTool"),h=e("../msgs/MvcMsgs"),m=e("../../Core/Event/EventCenter"),f=e("../Const/EventId"),_=e("../../fws/utils/X"),y=e("../Const/TableName"),g=e("../Const/GameDefine"),C=function(){function e(){this.initConfig()}return e.prototype.goldBuyItemByVipShopId=function(e,t,a){void 0===a&&(a=!0);var c=n.TABLE.getTableDataById(y.TableName.VIP_SHOP,String(e));if(!u.Obj.isEmpty(c)){var p={shopId:e,amount:t,isVip:1};i.NET.send(s.RequestId.GoldBuyItem,p,null,function(e){var t=d.default.JSON_PARSE(e.d);if(null!==t){var i=u.Obj.getPropertyByNames(t,"","failReason");if(i.length>0)r.default.Instance().ShowTips(o.LOCAL.getNetMsgText(i));else{var s=u.Obj.getPropertyByNames(t,null,"reward");if(null!==s){var p=u.Obj.getPropertyByNames(c,0,"item_id"),_=n.TABLE.getTableDataById(y.TableName.ITEM,p);if(0!=p&&_&&25!==_.type&&27!==_.type&&29!==_.type){var g={serverReward:s,isPay:!1,btnName:o.LOCAL.getText("101036"),canclose:!1};1==a&&r.default.Instance().OpenUI(l.UIDataInfo.CommonRewardPanel,g)}else{var C={serverReward:s,isPay:!1};1==a&&r.default.Instance().OpenUI(l.UIDataInfo.CommonRewardPanel,C)}m.EVENT.emit(f.EventId.Item_Buy_CallBack),h.send(h.Names.GOLD_BUY_ITEM_SUC,_),h.send(h.Names.MVC_CHECK_CLOSE_GETMORE_VIEW,{})}}}})}},e.prototype.limitedShopBuy=function(e,t,a){void 0===a&&(a=!0);var o=n.TABLE.getTableDataById(y.TableName.SHOP_LIMIT,e.toString());o&&this.doBuyByConfig(o,t,a,!0)},e.prototype.goldBuyItemByShopId=function(e,t,a){void 0===a&&(a=!0);var o=this.getShopConfigByShopId(e);u.Obj.isEmpty(o)||this.doBuyByConfig(o,t,a)},e.prototype.goldBuyItem=function(e,t,a){void 0===a&&(a=!0);var o=this.getGoldShopConfigByItemId(e);u.Obj.isEmpty(o)?_.log("\u6211\u8981\u4e70\u5230\u805a\u805a\u805a\u805a-\u4e0d\u8ba9\u4e70\uff1a"+e):this.doBuyByConfig(o,t,a)},e.prototype.TreasureMapShopBuyItem=function(e,t,a,o){var i=n.TABLE.getTableDataById(y.TableName.TREASURE_SHOP,e.toString());i&&this.doBuyByConfig(i,t,a,!1,g.ConfigBuyType.TREASURE_MAP,o)},e.prototype.doBuyByConfig=function(e,t,a,c,_,C){void 0===a&&(a=!0),void 0===c&&(c=!1),void 0===_&&(_=-1),void 0===C&&(C=null);var v=function(){if(u.Obj.isEmpty(e))return"break";if(0===u.Obj.getPropertyByNames(e,0,"is_open"))return"break";var v=u.Obj.getPropertyByNames(e,0,"id");if(null===v)return"break";var T=u.Obj.getPropertyByNames(e,0,"price_shop"),S=t*T,A=u.Obj.getPropertyByNames(e,0,"type");if(I.isUseGold(A)){if(!p.ExchangeController.Instance.checkGoldEnough(S,!0))return"break"}else I.isUseMilitary(A);var D=u.Obj.getPropertyByNames(e,0,"item_id"),N={shopId:v,amount:t},b=s.RequestId.GoldBuyItem;if(c?b=s.RequestId.Limit_Shop_Buy:_==g.ConfigBuyType.TREASURE_MAP&&(b=s.RequestId.BUY_IN_TREASURE_MAP_WORLD_SHOP),C)for(var L in C)N[L]=C[L];i.NET.send(b,N,null,function(t){do{var i=d.default.JSON_PARSE(t.d);if(null===i)break;var s=u.Obj.getPropertyByNames(i,"","failReason");if(s.length>0){r.default.Instance().ShowTips(o.LOCAL.getNetMsgText(s));break}var c=u.Obj.getPropertyByNames(i,null,"reward");if(null===c)break;var p=n.TABLE.getTableDataById(y.TableName.ITEM,D);if(0!=D&&p&&25!==p.type&&27!==p.type&&29!==p.type){var _={serverReward:c,isPay:!1,btnName:o.LOCAL.getText("101036"),canclose:!1};if(8==p.type){var g={can:!0};h.send(h.Names.IS_SEND_ROSE_ALIVE,g),a=g.can}a&&r.default.Instance().OpenUI(l.UIDataInfo.CommonRewardPanel,_)}else if(!e.type||4!=e.type){var C={serverReward:c,isPay:!1};a&&r.default.Instance().OpenUI(l.UIDataInfo.CommonRewardPanel,C)}d.default.playG123SoundPathByName("buy_item"),m.EVENT.emit(f.EventId.Item_Buy_CallBack),h.send(h.Names.GOLD_BUY_ITEM_SUC,p),h.send(h.Names.MVC_CHECK_CLOSE_GETMORE_VIEW,{})}while(0)})},I=this;do{if("break"===v())break}while(0)},e.prototype.canGoldBuyItem=function(t){var a={config:null,canBuy:!1};do{var o=u.Obj.getPropertyByNames(e.GOLD_SHOP_CONFIG_BY_ITEMID,null,t);if(null===o)break;if(a.config=o,0===u.Obj.getPropertyByNames(o,0,"is_open"))break;var n=u.Obj.getPropertyByNames(o,-1,"buy_limit");if(n>=0){var i=u.Obj.getPropertyByNames(o,-1,"id");if(this.getBuyTimes(i)>=n)break}a.canBuy=!0}while(0);return a},e.prototype.getBuyTimes=function(e){return u.Obj.getPropertyByNames(c.DATA.UserData.shopBuyLimitMapping,0,e)},e.prototype.getGoldShopConfigByItemId=function(t){var a=u.Obj.getPropertyByNames(e.GOLD_SHOP_CONFIG_BY_ITEMID,null,t);return Object.freeze(a)},e.prototype.getGoldShopItemPriceByItemId=function(t){var a=u.Obj.getPropertyByNames(e.GOLD_SHOP_CONFIG_BY_ITEMID,null,t);return u.Obj.getPropertyNumberByNames(a,-1,"price_shop")},e.prototype.getShopConfigByShopId=function(t){var a=u.Obj.getPropertyByNames(e.SHOP_CONFIG_BY_SHOPID,null,t);return Object.freeze(a)},e.prototype.getGoldCanBuyItem=function(){var t=[];for(var a in e.SHOP_CONFIG_BY_SHOPID)if(e.SHOP_CONFIG_BY_SHOPID.hasOwnProperty(a)){var o=e.SHOP_CONFIG_BY_SHOPID[a],i=u.Obj.getPropertyByNames(o,0,"is_open"),r=u.Obj.getPropertyByNames(o,0,"type"),s=u.Obj.getPropertyByNames(o,0,"tab");if(0===i||!this.isUseGold(r)||999===s)continue;var l=n.TABLE.getTableDataById(y.TableName.DATACONFIG,"30009"),d=parseInt(u.Obj.getProperty(l,"value","0")),p=c.DATA.UserData.Level;if(4==r&&d>p)continue;t.push(o)}return t=t.sort(function(e,t){return e.order-t.order})},e.prototype.getMilitaryCanBuyItem=function(){return[]},e.prototype.initConfig=function(){if(!e.CONFIG_INIT){e.CONFIG_INIT=!0,e.GOLD_SHOP_CONFIG_BY_ITEMID={},e.SHOP_CONFIG_BY_SHOPID={};var t=n.TABLE.getTableGroup(y.TableName.SHOP);if(t)for(var a in t){var o=t[a],i=u.Obj.getPropertyByNames(o,null,"item_id"),r=u.Obj.getPropertyByNames(o,0,"type");null!==i&&this.isUseGold(r)&&(e.GOLD_SHOP_CONFIG_BY_ITEMID[i]=o),null!==u.Obj.getPropertyByNames(o,null,"id")&&(e.SHOP_CONFIG_BY_SHOPID[a]=o)}}},e.prototype.isUseGold=function(e){return 14!==e&&101!==e&&303!==e&&!this.ifSixteenScoreBuy(e)},e.prototype.isUseMilitary=function(e){return 14===e},e.prototype.isUseAllianceScore=function(e){return 101===e},e.prototype.isUseIslandScore=function(e){return 303===e},e.prototype.ifSixteenScoreBuy=function(e){return 99==e},Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.CONFIG_INIT=!1,e.SHOP_CONFIG_BY_SHOPID=null,e.GOLD_SHOP_CONFIG_BY_ITEMID=null,e}();a.ShopController=C,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/X":"X","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs","./ExchangeController":"ExchangeController"}],ThroneController:[function(e,t,a){"use strict";cc._RF.push(t,"04275bnI0VC8aZPfNHJ1EcE","ThroneController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/utils/FWSTool"),n=e("../Data/DataCenter"),i=e("../Tools/GameTools"),r=e("../../fws/mvc/FWSMvc"),s=e("../../Core/Net/NetMgr"),l=e("../Const/RequestId"),c=e("../Common/UIManager"),d=e("../Const/UIDataInfo"),p=e("../../Core/Event/EventCenter"),u=e("../Const/EventId"),h=e("../components/worldmap/controllers/WorldMapController"),m=e("../../Core/Common/LocalManager"),f=e("../Data/BattleData"),_=e("../components/worldmap/WorldMapCommon"),y=e("../msgs/MvcMsgs"),g=e("../Data/ThroneGiftData"),C=function(e){function t(){var t=e.call(this)||this;return t._ThroneGifts={},t._officials=[],t}return __extends(t,e),t.prototype.createAssembly=function(e,t,a){if(h.getInstance().myMarchNum>=h.getInstance().myMarchNumMAX)i.default.checkAddWorldMarchQueue(!0);else{var r=n.DATA.UserData.getBuildingByBuildingId(2501);if(o.Obj.isEmpty(r))c.default.Instance().ShowTips(m.LOCAL.getText("assembly_buildinghelpinfo"));else{if(null!=n.DATA.UserData.Alliance&&n.DATA.UserData.Alliance.isInAlliance()){var s=cc.v2(e,t),l=function(){var o=h.model.getTileIdByCoord(e,t),i=h.model.getThroneInfoByTileId(o),r={targetPos:s,enemyInfo:i,marchType:_.MarchType.ALLIANCE_RALLY_BATTLE},l=new Array;if(n.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&l.push(new f.BattleArmyData(e.ArmyId,e.Id))}),0==l.length)return c.default.Instance().ShowTips(m.LOCAL.getText("100272")),{value:void 0};var p=new f.BattleItemData(n.DATA.UserData.UID,n.DATA.UserData.Name,0,null,n.DATA.UserData.ICONURL,l),u=new f.BattleItemData(0,"",null,"",null,null),y=f.BattleType.PVP_Alliance_Assembly_Create;a&&(y=f.BattleType.PVP_Alliance_Supper_Assembly_Create),n.DATA.CurBattleData=new f.BattleData(y,p,u,r),c.default.Instance().OpenUI(d.UIDataInfo.BattleMainPanel),c.default.Instance().CloseUI(d.UIDataInfo.WorldThronePopup)}();return"object"==typeof l?l.value:void 0}c.default.Instance().ShowTips(m.LOCAL.getText("assembly_alliancehelpinfo"))}}},t.prototype.doAttack=function(e,t){if(h.getInstance().myMarchNum>=h.getInstance().myMarchNumMAX)i.default.checkAddWorldMarchQueue(!0);else{var a={targetPos:new cc.Vec2(e,t)},o=new Array;n.DATA.UserData.Armys.forEach(function(e){0===e.March&&e.Normal&&o.push(new f.BattleArmyData(e.ArmyId,e.Id))});var r=m.LOCAL.getText("kingdom_002"),s=new f.BattleItemData(n.DATA.UserData.UID,n.DATA.UserData.Name,0,null,n.DATA.UserData.ICONURL,o),l=new f.BattleItemData(0,r,1,"",null,null);n.DATA.CurBattleData=new f.BattleData(f.BattleType.Throne,s,l,a),c.default.Instance().OpenUI(d.UIDataInfo.BattleMainPanel),c.default.Instance().CloseUI(d.UIDataInfo.WorldThronePopup)}},t.prototype.requestOfficialInfo=function(){var e=this;s.NET.send(l.RequestId.THRONE_GET_OFFICIAL_LIST,null,this,function(t){var a=i.default.JSON_PARSE(t.d);if(!i.default.ObjIsEmpty(a)){e._officials=[];for(var o=0;o<a.titles.length;o++){var n=a.titles[o];e._officials[n.id]=n}y.send(y.Names.MVC_THRONE_VIEW_REFRESH,{})}})},t.prototype.getOfficialInfoById=function(e){return this._officials[e]},t.prototype.UpdateThroneGiftData=function(){var e=this;s.NET.send(l.RequestId.THRONE_GIFT_DATA,{},this,function(t){if(0==t.s){var a=i.default.JSON_PARSE(t.d);if(a&&a.gifts)for(var o=a.gifts,n=0;n<o.length;n++)e.UpdateOneThroneGiftData(o[n]);p.EVENT.emit(u.EventId.ThroneGiftDataUpdate)}})},t.prototype.UpdateOneThroneGiftData=function(e){var t=e.id;if(null==this._ThroneGifts[t]){var a=new g.default;this._ThroneGifts[t]=a}this._ThroneGifts[t].UpdateData(e)},t.prototype.getThroneGiftDataByGiftId=function(e){return this._ThroneGifts[e]},t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t}(r.FMessageConnectionAbstract);a.ThroneController=C,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/utils/FWSTool":"FWSTool","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/RequestId":"RequestId","../Const/UIDataInfo":"UIDataInfo","../Data/BattleData":"BattleData","../Data/DataCenter":"DataCenter","../Data/ThroneGiftData":"ThroneGiftData","../Tools/GameTools":"GameTools","../components/worldmap/WorldMapCommon":"WorldMapCommon","../components/worldmap/controllers/WorldMapController":"WorldMapController","../msgs/MvcMsgs":"MvcMsgs"}],WelcomeRewardController:[function(e,t,a){"use strict";cc._RF.push(t,"8c424qN1tZBFLxP4vXw13M1","WelcomeRewardController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../Core/Common/LocalManager"),n=e("../../fws/utils/FWSTool"),i=e("../Data/DataCenter"),r=e("../Common/UIManager"),s=e("../msgs/MvcMsgs"),l=e("../Const/GameDefine"),c=e("../../Core/Net/NetMgr"),d=e("../Const/RequestId"),p=e("../Tools/GameTools"),u=e("../Const/UIDataInfo"),h=e("../ShareSDK/RGShareInterface"),m=e("../../fws/platforms/PlatformCore"),f=function(){function e(){this._shareId=h.RGSharePoint.SP_WelcomeReward,this._shareBoxId=-1,this.init()}return e.prototype.isWelcomeRewardShow=function(){var e=!1;do{if(!i.DATA.UserData.FunctionOn(l.FunctionKey.newbie_reward))break;if(this.isGetWelcomeReward())break;e=!0}while(0);return e},e.prototype.getShareId=function(){return this._shareId},e.prototype.getShareBoxId=function(){return this._shareBoxId},e.prototype.isHaveWelcomeRewardShareBox=function(){return null!==this.getWelcomeRewardShareBox()},e.prototype.getWelcomeRewardShareBox=function(){var e=null;do{var t=this.getShareBoxId();if(-1===t)break;var a=i.DATA.UserData.getShareBoxDataById(t);if(n.Obj.isEmpty(a))break;e=a}while(0);return e},e.prototype.checkWelcomeReward=function(e){e||this.isHaveWelcomeRewardShareBox()&&(this.canUseVideoReward()||r.default.Instance().ShowTips(o.LOCAL.getText("100504")),s.send(s.Names.MVC_WELCOME_REWARD_INVITE_UPDATE,null))},e.prototype.getRewardByShareBox=function(e){void 0===e&&(e=!1);var t=0,a="0",o=0;if(e)t=this.getShareBoxId(),a=i.DATA.UserData.UID+"",o=1;else{var l=this.getWelcomeRewardShareBox();if(null===l)return;var h=l.PlayerList;if(n.Obj.isEmpty(h)||h.length<=0)return;t=l.Id,a=h[0].Uid+"",o=0}var m={id:t,uid:a,skip_click_verify:o};c.NET.send(d.RequestId.GetShareBoxReward,m,this,function(e){var t=p.default.JSON_PARSE(e.d);if(n.Obj.isEmpty(t));else{var a={serverReward:t};r.default.Instance().OpenUI(u.UIDataInfo.CommonRewardPanel,a)}},!0),s.send(s.Names.MVC_WELCOME_REWARD_GET_RESULT,null)},e.prototype.getRewardByGold=function(){c.NET.send(d.RequestId.GoldGetWelcomeReward,{},this,function(e){var t=p.default.JSON_PARSE(e.d);if(n.Obj.isEmpty(t));else{var a={serverReward:t};r.default.Instance().OpenUI(u.UIDataInfo.CommonRewardPanel,a)}s.send(s.Names.MVC_WELCOME_REWARD_GET_RESULT,null)})},e.prototype.isGetWelcomeReward=function(){return i.DATA.UserData.IsGetMunitions>0},e.prototype.init=function(){var e=h.default.RGShareSDK_GetShareCfgById(this._shareId);e&&(this._shareBoxId=e.share_box_id)},e.prototype.canUseVideoReward=function(){return"googleplay"===m.instance.platformSID},Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.purge=function(){e._instance=null},e}();a.WelcomeRewardController=f,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Net/NetMgr":"NetMgr","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../Common/UIManager":"UIManager","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/UIDataInfo":"UIDataInfo","../Data/DataCenter":"DataCenter","../ShareSDK/RGShareInterface":"RGShareInterface","../Tools/GameTools":"GameTools","../msgs/MvcMsgs":"MvcMsgs"}],WorkerController:[function(e,t,a){"use strict";cc._RF.push(t,"ac56bk15TtFZb/P0Fcc8Jy7","WorkerController"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../fws/mvc/FWSMvc"),n=e("../Const/GameDefine"),i=e("../msgs/WorkerMsgs"),r=e("../../fws/utils/FWSTool"),s=e("../../fws/platforms/PlatformCore"),l=function(e){function t(){var t=e.call(this)||this;return t._workerState=n.WorkerState.Idle,t._curToBeWorkContent=null,t._saved=!1,t._tobeWorkContentList=[],t}return __extends(t,e),t.prototype.handleWork=function(e){var t=e.pos;this.canHandlWork()&&(0<=this._checkPointDataIn(t)||(r.Obj.isEmpty(this._curToBeWorkContent)||this._curToBeWorkContent.workType!==e.workType||this._curToBeWorkContent.pos!==e.pos)&&(this._tobeWorkContentList.push(e),this.checkWorkerWork()))},t.prototype.cancelHandleWork=function(e){var t=this._checkPointDataIn(e);0>t||this._tobeWorkContentList.splice(t,1)},t.prototype.checkWorkerWork=function(){if(this._tobeWorkContentList.length<=0)this.stopWork();else if(n.WorkerState.Idle===this._workerState){var e=this._tobeWorkContentList.shift();this._workerState=n.WorkerState.Working,this._curToBeWorkContent=e,i.send(i.MsgNames.WorkerMsgsMoveToWork,e)}},t.prototype.canHandlWork=function(){return n.WorkerState.NoWorker!==this._workerState},t.prototype.canWork=function(){return n.WorkerState.Idle===this._workerState},t.prototype.workFinished=function(){i.send(i.MsgNames.WorkerMsgsWorkFinished),this._workerState=n.WorkerState.Idle,this.checkWorkerWork()},t.prototype.useNewWorkeModel=function(){return"g123"===s.instance.platformSID},t.prototype.stopWork=function(){this._tobeWorkContentList=[],this._workerState=n.WorkerState.Idle,this._curToBeWorkContent=null,i.send(i.MsgNames.WorkerMsgsStopWork)},t.prototype.workError=function(){this.stopWork()},t.prototype._checkPointDataIn=function(e){for(var t=-1,a=0;a<this._tobeWorkContentList.length;++a)if(e===this._tobeWorkContentList[a].pos){t=a;break}return t},t.prototype.setCanWork=function(e){this._workerState=e?n.WorkerState.Idle:n.WorkerState.NoWorker},t.prototype.setSaved=function(e){this._saved=e},t.prototype.isSaved=function(){return this._saved},Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.purge=function(){t._instance=null},t}(o.FMessageConnectionAbstract);a.WorkerController=l,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../Const/GameDefine":"GameDefine","../msgs/WorkerMsgs":"WorkerMsgs"}],HeroController:[function(e,t,a){"use strict";cc._RF.push(t,"9c392rFVu1KdLHSNfB0x4kD","HeroController"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../../Core/Common/LocalManager"),i=e("../../fws/utils/FWSTool"),r=e("../../Core/Common/TableManager"),s=e("../Data/DataCenter"),l=e("../Tools/GameTools"),c=e("../../fws/mvc/FWSMvc"),d=e("../../Core/Net/NetMgr"),p=e("../Const/RequestId"),u=e("../Common/UIManager"),h=e("../Const/UIDataInfo"),m=e("../Const/GameDefine"),f=e("../Data/HeroData"),_=e("../msgs/MvcMsgs"),y=e("../Common/ConfirmPanel"),g=e("../Module/UI/FreeGoldPanel"),C=e("../controllers/ShopController"),v=e("../battle/NBattleModel"),I=e("../../fws/utils/LocalStorageUtils"),T=e("../../Core/Event/EventCenter"),S=e("../Const/EventId"),A=e("../Common/BIManager"),D=e("../Const/TableName"),N=e("../../fws/platforms/PlatformCore"),b=e("../Data/BattleData"),L=e("../Tools/SubPackMsgs"),E=e("../Const/SoundPath"),P=e("../../Core/Common/SoundManager"),w=e("../Const/GameDefine"),B=e("../../fws/utils/X");(function(e){e[e.Default=0]="Default",e[e.March=1]="March"})(o=a.HeroState||(a.HeroState={}));var M=function(e){function t(){var t=e.call(this)||this;return t.hero1FreeEndTime=0,t.hero2FreeEndTime=0,t.hero1FreeTodayNum=0,t._lastRecruitId=1,t._lastRecruitNum=1,t._superLeastTimes=0,t._eliteLeastTimes=0,t._advancedExtractNum=0,t._skillRecruitLeastTimes=0,t._heroSkillLotteryTodayNum=0,t._heroSkillFreeEndTime=0,t._effectiveHeroIds=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"SuperLeastTimes",{get:function(){return this._superLeastTimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SkillRecruitLeastTimes",{get:function(){return this._skillRecruitLeastTimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HeroSkillLotteryTodayNum",{get:function(){return this._heroSkillLotteryTodayNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HeroSkillFreeEndTime",{get:function(){return this._heroSkillFreeEndTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EliteLeastTimes",{get:function(){return this._eliteLeastTimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AdvancedExtractNum",{get:function(){return this._advancedExtractNum},enumerable:!0,configurable:!0}),t.prototype.requestHeroData=function(){var e=this;d.NET.send(p.RequestId.HERO_GET_DATA,{},this,function(t){var a=l.default.JSON_PARSE(t.d);if(!i.Obj.isEmpty(a)){for(var o in a.effectiveHeroIds&&(e._effectiveHeroIds=a.effectiveHeroIds),s.DATA.UserData.Heros)delete s.DATA.UserData.Heros[o];for(var o in s.DATA.UserData.UpdateHeros(a),s.DATA.UserData.HerosSkin)delete s.DATA.UserData.HerosSkin[o];s.DATA.UserData.initHeroSkin(a),_.send(_.Names.MVC_HERO_LIST_REFRESH,{})}})},t.prototype.doRecruit=function(e,t,a){var o;(void 0===a&&(a=!1),4==e)?o=1===t&&(r.TABLE.getTableDataById(D.TableName.DATACONFIG,"20009").value-this._skillRecruitLeastTimes>0&&this._heroSkillFreeEndTime<s.DATA.ServerTime):o=1===t&&(1===e?this.hero1FreeTodayNum>0&&this.hero1FreeEndTime<s.DATA.ServerTime:this.hero2FreeEndTime<s.DATA.ServerTime);3!=e&&5!=e&&6!=e&&7!=e||(o=!1),a&&(o=!0);var c=r.TABLE.getTableDataById(D.TableName.EXTRACT,e.toString());if(c){var m=t-Math.max(0,s.DATA.UserData.getItemAmount(c.itemId));if(this._lastRecruitId=e,this._lastRecruitNum=t,!o&&m>0){var f=m*c.price,v=r.TABLE.getTableDataById(D.TableName.ITEM,c.itemId);if(!v)return;y.default.ShowView(n.LOCAL.getText("hero_UI064",f.toString(),m.toString(),n.LOCAL.getText(v.name)),n.LOCAL.getText("101154"),this,function(e){var t=r.TABLE.getTableGroup(D.TableName.SHOP),a=null;for(var o in t)if(t[o].item_id===c.itemId){a=t[o];break}a&&(a.price_shop>s.DATA.UserData.Resource.Gold?g.default.ShowView():C.ShopController.Instance.goldBuyItemByShopId(a.id,m,!1))},null,n.LOCAL.getText("100194"),"",!1,!1,f)}else{P.SOUND.playClip(E.SoundPath.Draw_Card);var I={extractId:e,num:t,useDiamond:!1,isFree:o,useHaveNum:a};d.NET.send(p.RequestId.HERO_RECRUIT,I,this,function(e){B.log(e);var t=l.default.JSON_PARSE(e.d);if(!i.Obj.isEmpty(t)){var a=i.Obj.getProperty(t,"rewards",[]);u.default.Instance().OpenUI(h.UIDataInfo.HeroRecruitResultPopup,{extractId:I.extractId,num:I.num,rewards:a}),_.send(_.Names.MVC_HERO_REFRESH,{}),T.EVENT.emit(S.EventId.MainUI_Update)}}),A.default.Instance.PostAction("HeroRecruit",I)}}},t.prototype.getHaveHeroList=function(){var e=[];for(var t in s.DATA.UserData.Heros)1===s.DATA.UserData.Heros[t].Is_show&&e.push(s.DATA.UserData.Heros[t]);return e=e.sort(this.sortHandle)},t.prototype.getNotHaveHeroList=function(){var e=[],t=r.TABLE.getTableGroup(D.TableName.HERO);for(var a in t)if(this.checkInPlat(t[a].plat)&&!s.DATA.UserData.Heros.hasOwnProperty(a)&&this._effectiveHeroIds.indexOf(t[a].id)>-1){var o=new f.default;o.UpdateData(t[a]),e.push(o)}return e=e.sort(this.sortHandle)},t.prototype.getHaveHeroCanMarchList=function(){var e=!0;s.DATA.CurBattleData&&s.DATA.CurBattleData.Type==b.BattleType.Adventure_Boss&&(e=!1);var t=[];for(var a in s.DATA.UserData.Heros)e&&s.DATA.UserData.Heros[a].State!==o.Default||t.push(s.DATA.UserData.Heros[a]);return t=t.sort(this.sortHandle2)},t.prototype.getHeroAll=function(){var e=[];for(var t in s.DATA.UserData.Heros)e.push(s.DATA.UserData.Heros[t]);return e=e.sort(this.sortHandle2)},t.prototype.getHeroDataById=function(e){for(var t=this.getHaveHeroList().concat(this.getNotHaveHeroList()),a=0;a<t.length;a++)if(t[a].Id===e)return t[a];return null},t.prototype.getUserHeroDataById=function(e){for(var t=this.getHaveHeroList(),a=0;a<t.length;a++)if(t[a].Id===e)return t[a];return null},t.prototype.hasHeroSkinById=function(e){return!!s.DATA.UserData.HerosSkin[e]&&(!(s.DATA.UserData.HerosSkin[e].endTime>0)||s.DATA.ServerTime<s.DATA.UserData.HerosSkin[e].endTime)},t.prototype.getHeroBySkinId=function(e){var t=0,a=s.DATA.UserData.Heros;for(var o in a)if(a[o].SkinId>0&&a[o].SkinId==e){t=a[o].Id;break}return t},t.prototype.checkHeroSkinShowEnable=function(e){var t=r.TABLE.getTableDataById(D.TableName.HEROSKIN,e.toString());if(null==t)return!1;if(this.hasHeroSkinById(e))return!0;var a=l.default.ChangeStrTimeToNumTime(t.time),o=l.default.ChangeStrTimeToNumTime(t.endtime);return!(a>0&&s.DATA.ServerTime<a)&&!(o>0&&s.DATA.ServerTime>o)},t.prototype.getPreHeroData=function(e){for(var t=this.getHaveHeroList().concat(this.getNotHaveHeroList()),a=0;a<t.length;a++)if(t[a].Id===e)return 0===a?t[t.length-1]:t[a-1];return null},t.prototype.getNextHeroData=function(e){for(var t=this.getHaveHeroList().concat(this.getNotHaveHeroList()),a=0;a<t.length;a++)if(t[a].Id===e)return a===t.length-1?t[0]:t[a+1];return null},t.prototype.getCanLvUpItems=function(e){for(var t={},a=e.NeedExp-e.Exp,o=e.Level+1;o<e.MaxLevel;o++){var n=r.TABLE.getTableDataById(D.TableName.HERO_LEVEL,o.toString());n&&(a+=i.Obj.getProperty(n,"exp"+e.Quality,0))}var l=s.DATA.UserData.getItemsByType(m.ItemType.HeroExpItem);l=l.sort(function(e,t){return t.Data.quality-e.Data.quality});for(o=0;o<l.length;o++)for(t[l[o].ItemId]=0;t[l[o].ItemId]<l[o].Amount&&a>=l[o].Data.para1;)t[l[o].ItemId]+=1,a-=l[o].Data.para1;for(o=l.length-1;o>=0;o--)for(;t[l[o].ItemId]<l[o].Amount&&a>0;)t[l[o].ItemId]+=1,a-=l[o].Data.para1;for(var c in t)0===t[c]&&delete t[c];return t},t.prototype.getItemIdByHeroSkill=function(e,t){var a=0,o=r.TABLE.getTableGroup(D.TableName.ITEM);for(var n in o){var i=o[n];if(42==i.type&&i.para1==e.toString()&&i.level==t){a=i.id;break}}return a},t.prototype.getItemsCanLvUp=function(e,t){var a=0;for(var o in t){(s=r.TABLE.getTableDataById(D.TableName.ITEM,o))&&s.type==m.ItemType.HeroExpItem&&(a+=s.para1*t[o])}a+=e.Exp;for(var n=e.Level;n<e.MaxLevel;n++){var s;if((s=r.TABLE.getTableDataById(D.TableName.HERO_LEVEL,n.toString()))&&(a-=i.Obj.getProperty(s,"exp"+e.Quality,0)),a<0)return n;if(0===a)return n+1}return e.MaxLevel},t.prototype.getMarchHeroArmyAdd=function(){var e=0,t=r.TABLE.getTableDataById(D.TableName.DATACONFIG,"20006");if(!t)return 0;for(var a=v.instance.attackerHeros,o=0;o<a.length;o++){var n=a[o],i=null;if(s.DATA.CurBattleData&&s.DATA.CurBattleData.Type&&[b.BattleType.ARENA_PVP_BATTLE,b.BattleType.ARENA_PVP_DEFEND_BATTLE].indexOf(s.DATA.CurBattleData.Type)>=0)i=L.send(L.Names.SUBPACK_ARENA_PVP_HERO_CONFIG,a[o]).data;else s.DATA.UserData.Heros.hasOwnProperty(n)&&(i=s.DATA.UserData.Heros[n]);if(i){e+=Math.floor(i.Command*t.value);var l=i.ExtraSkill.concat(i.BuffSkills);if(l.length>0)for(var c=0;c<l.length;c++)if(l[c].skillId){var d=r.TABLE.getTableDataById(D.TableName.HEROSKILL,l[c].skillId);if(d)153==r.TABLE.getTableDataById(D.TableName.EFFECTBUFF,d.effect).type&&(e+=Number(d.para)+this.getSkillBuff(d.para_equip_skill,l[c].level))}}}return e},t.prototype.getHeroSkillTalantBuffAdd=function(e,t,a){void 0===a&&(a=-1);var o=0;return o+=this.getHeroSkillsBuffAdd(e,t,a),o+=this.getHeroBindActiveSkillAdd(e,t,a),o+=this.getHeroTalentsBuffAdd(e,t,a)},t.prototype.getHeroBindActiveSkillAdd=function(e,a,o){void 0===o&&(o=-1);var n=0;if(e){var i=t.getInstance().getHeroDataByHeroId(e);if(i.ActiveSkill){var r=s.DATA.UserData.HeroActiveSkills[i.ActiveSkill];r&&0==r.skillUse&&s.DATA.ServerTime<r.skillCdEndTime&&(n=this.getHeroSkillBuffAdd(e,i.ActiveSkill,a,1,o))}}return n},t.prototype.getHeroTalentsBuffAdd=function(e,a,o){void 0===o&&(o=-1);var n=0,i=t.getInstance().getHeroDataByHeroId(e);if(i)for(var s=0;s<i.Talents.length;s++){var l=r.TABLE.getTableDataById(D.TableName.TALENT,i.Talents[s].talentId);if(l){var c=r.TABLE.getTableDataById(D.TableName.EFFECTBUFF,l.buff);if(c&&c.type==a&&(""==c.para1||c.para1==o)){var d=Math.max(i.Quality-3,0);n+=i.Talents[s].ttsr*(l.max_num+l.add_num*d)/1e8}}}return n},t.prototype.getHeroSkillsBuffAdd=function(e,a,o){void 0===o&&(o=-1);var n=0,i=t.getInstance().getHeroDataByHeroId(e);if(i){n+=t.getInstance().getHeroSkillBuffAdd(e,i.Skill,a,1,o);for(var r=i.ExtraSkill.concat(i.BuffSkills),s=0;s<r.length;s++)n+=t.getInstance().getHeroSkillBuffAdd(e,r[s].skillId,a,r[s].level,o)}return n},t.prototype.getHeroSkillBuffAdd=function(e,a,o,n,i){void 0===i&&(i=-1);var l=s.DATA.UserData.Heros[e],c=r.TABLE.getTableDataById(D.TableName.HEROSKILL,a.toString());if(null==c||null==c.effect)return 0;var d=0,p=c.effect.split("|"),u=c.para.split("|"),h=c.para_add.split(",");if(p.length>0)for(var m=0;m<p.length;m++)if(null!=u[m]){var f=r.TABLE.getTableDataById(D.TableName.EFFECTBUFF,p[m]);if(null!=f&&f.type==o&&(!f.para1||-1==i||f.para1==i)){var _=0;if(h.length>m){var y=h[m].split("|");y.length>0&&l&&("0"===y[0]?_=parseInt(u[m]):"1"===y[0]?_=parseInt(u[m])+l.War/100*parseInt(y[1]):"2"===y[0]?_=parseInt(u[m])+l.Def/100*parseInt(y[1]):"3"===y[0]&&(_=parseInt(u[m])+l.Command/100*parseInt(y[1])))}d+=Number(_)/1e4,d+=t.getInstance().getSkillBuff(c.para_equip_skill,n)/1e4}}return d},t.prototype.getSkillBuff=function(e,t){var a=e.split("|");return a[t-1]?Number(a[t-1]):0},t.prototype.saveMarchHeroToLocalByBattleType=function(e,t){var a=t+"MarchSaveHero"+s.DATA.UserData.UID;I.set(a,e)},t.prototype.getSaveMarchHeroByBattleType=function(e){var t=e+"MarchSaveHero"+s.DATA.UserData.UID,a=I.get(t),o=!1,n=r.TABLE.getTableDataById("data_config","61002"),l=i.Obj.getPropertyNumberByNames(n,2,"value");l+=s.DATA.UserData.Buff.getBuffAddValue(m.BuffType.BattleHeroAddNum);var c=0,d=[];if([b.BattleType.ARENA_PVP_BATTLE,b.BattleType.ARENA_PVP_DEFEND_BATTLE].indexOf(s.DATA.CurBattleData.Type)>=0){var p=r.TABLE.getTableDataById(D.TableName.ARENA_THEME,String(s.DATA.CurBattleData.otherData.theme));if(p&&p.hero)for(var u=p.hero.split("|"),h=0;h<u.length;h++){var _=r.TABLE.getTableDataById(D.TableName.ARENA_THEME_HERO,u[h]);(g=new f.default).UpdateData({id:Number(_.hero),level:_.hero_level,star:_.hero_star}),d.push(g)}else d=this.getHeroAll()}if(a){for(h=0;h<a.length;h++)for(var y=h+1;y<a.length;y++)if(a[h]!=a[y]){var g=r.TABLE.getTableDataById(D.TableName.HERO,a[h]+""),C=r.TABLE.getTableDataById(D.TableName.HERO,a[y]+"");if(g&&C&&(g.exclude==C.id||C.exclude==g.id)){o=!0;break}}c=l<a.length?l:a.length,o||d.length&&a.length>0&&((a=this.judgeIfCanBattleHero(d,a)).length||(o=!0))}else o=!0;if(o){var v=[],T=this.getHeroAll();[b.BattleType.ARENA_PVP_BATTLE,b.BattleType.ARENA_PVP_DEFEND_BATTLE].indexOf(s.DATA.CurBattleData.Type)>=0&&(T=d);for(h=0;h<T.length&&!(v.length>=l);h++){var S=!1;for(y=0;y<v.length;y++){g=r.TABLE.getTableDataById(D.TableName.HERO,T[h].Id+""),C=r.TABLE.getTableDataById(D.TableName.HERO,v[y]+"");if(g&&C&&(g.exclude==C.id||C.exclude==g.id)){S=!0;break}}S||v.push(T[h].Id)}return v}return a.length>c&&a.splice(c,a.length-c),a},t.prototype.getHeroDataByHeroId=function(e){var t=null;if(s.DATA.CurBattleData&&s.DATA.CurBattleData.otherData&&s.DATA.CurBattleData.Type&&[b.BattleType.ARENA_PVP_BATTLE,b.BattleType.ARENA_PVP_DEFEND_BATTLE].indexOf(s.DATA.CurBattleData.Type)>=0){var a=r.TABLE.getTableDataById(D.TableName.ARENA_THEME,String(s.DATA.CurBattleData.otherData.theme));if(a&&a.hero)for(var o=a.hero.split("|"),n=0;n<o.length;n++){var i=r.TABLE.getTableDataById(D.TableName.ARENA_THEME_HERO,o[n]);if(Number(i.hero)==e){var l=[];if(i.hero_skil)for(var c=i.hero_skil.split(","),d=0;d<c.length;d++){var p=c[d].split("|"),u={skillId:Number(p[1]),level:Number(p[2])};l.push(u)}var h=new f.default;h.UpdateData({id:Number(i.hero),level:i.hero_level,star:i.hero_star,skills:l}),t=h;break}}}return t||(t=s.DATA.UserData.Heros[e]),t},t.prototype.judgeIfCanBattleHero=function(e,t){for(var a=t.length-1;a>=0;a--){for(var o=!1,n=0;n<e.length;n++)if(e[n].Id==t[a]){o=!0;break}o||t.splice(a,1)}return t},t.prototype.saveMarchHeroToLocal=function(e){var t="MarchSaveHero"+s.DATA.UserData.UID;I.set(t,e)},t.prototype.getSaveMarchHero=function(){var e="MarchSaveHero"+s.DATA.UserData.UID,t=I.get(e),a=!1,n=r.TABLE.getTableDataById(D.TableName.DATACONFIG,"61002"),l=i.Obj.getPropertyNumberByNames(n,2,"value");l+=s.DATA.UserData.Buff.getBuffAddValue(m.BuffType.BattleHeroAddNum);var c=0;if(t){for(var d=0;d<t.length;d++){var p=s.DATA.UserData.Heros[t[d]];if(!p||p.State===o.March){a=!0;break}for(var u=d+1;u<t.length;u++)if(t[d]!=t[u]){var h=r.TABLE.getTableDataById(D.TableName.HERO,t[d]+""),f=r.TABLE.getTableDataById(D.TableName.HERO,t[u]+"");if(h&&f&&(h.exclude==f.id||f.exclude==h.id)){a=!0;break}}}c=l<t.length?l:t.length}else a=!0;if(a){var _=[],y=this.getHaveHeroCanMarchList();for(d=0;d<y.length&&!(_.length>=l);d++){var g=!1;for(u=0;u<_.length;u++){h=r.TABLE.getTableDataById(D.TableName.HERO,y[d].Id+""),f=r.TABLE.getTableDataById(D.TableName.HERO,_[u]+"");if(h&&f&&(h.exclude==f.id||f.exclude==h.id)){g=!0;break}}g||_.push(y[d].Id)}return _}return t.length>c&&t.splice(c,t.length-c),t},t.prototype.sortHandle=function(e,t){if(!e||!t)return 0;if(!e.CanStarRise&&t.CanStarRise)return 1;if(!e.CanStarRise&&!t.CanStarRise||e.CanStarRise&&t.CanStarRise){if(e.Quality<t.Quality)return 1;if(e.Quality===t.Quality){if(e.Star<t.Star)return 1;if(e.Star===t.Star){if(e.Level<t.Level)return 1;if(e.Level===t.Level&&e.Id<t.Id)return 1}}}return-1},t.prototype.sortHandle2=function(e,t){if(!e||!t)return 0;if(e.Quality<t.Quality)return 1;if(e.Quality===t.Quality){if(e.Star<t.Star)return 1;if(e.Star===t.Star){if(e.Level<t.Level)return 1;if(e.Level===t.Level&&e.Id<t.Id)return 1}}return-1},t.prototype.getNameColorByQuality=function(e){var t="";switch(e){case 1:t="#000000";break;case 2:t="#8afo9d";break;case 3:t="#69d2f3";break;case 4:t="#f2b0f7";break;case 5:t="#f9c657";break;default:t="#000000"}return t},t.prototype.getBgNameByQuality=function(e,t){void 0===t&&(t=!1);var a="image/heroBatch/";if(t)switch(a="image/battle_field/",e){case 1:a+="bg_Battle_hero1";break;case 2:a+="bg_Battle_hero2";break;case 3:a+="bg_Battle_hero1";break;case 4:a+="bg_Battle_hero2";break;case 5:a+="bg_Battle_hero3";break;default:a+="bg_Battle_hero1"}else switch(e){case 1:a+="hero_bg_1";break;case 2:a+="hero_bg_2";break;case 3:a+="hero_bg_3";break;case 4:a+="hero_bg_4";break;case 5:a+="hero_bg_5";break;default:a+="hero_bg_1"}return a},t.prototype.updateFreeInfo=function(e){this.hero1FreeEndTime=i.Obj.getProperty(e,"hero1FreeEndTime",0),this.hero2FreeEndTime=i.Obj.getProperty(e,"hero2FreeEndTime",0),this.hero1FreeTodayNum=i.Obj.getProperty(e,"hero1FreeTodayNum",0),this._superLeastTimes=i.Obj.getProperty(e,"heroSuperRecruit",0),this._skillRecruitLeastTimes=i.Obj.getProperty(e,"heroSkillFreeTodayNum",0),this._heroSkillLotteryTodayNum=i.Obj.getProperty(e,"heroSkillLotteryTodayNum",0),this._heroSkillFreeEndTime=i.Obj.getProperty(e,"heroSkillFreeEndTime",0),this._eliteLeastTimes=i.Obj.getProperty(e,"heroEliteNum",0),this._advancedExtractNum=i.Obj.getProperty(e,"hero2Num",0)},t.getGetSkinArr=function(e){var t=[],a=r.TABLE.getTableGroup(D.TableName.HEROSKIN);for(var o in a)if(a[o].hero_id==e)if(void 0!=a[o].plat&&""!=a[o].plat){for(var n=a[o].plat.split("|"),i=0;i<n.length;i++)if(n[i]==N.instance.platformSID){t.push(a[o].id);break}}else t.push(a[o].id);return t},t.prototype.getHeroSkillBaseInfo=function(e,t){var a;void 0===t&&(t=null);var o="",n="",l="",c=r.TABLE.getTableDataById(D.TableName.HERO,e.toString());if(i.Obj.isEmpty(c))return[o,n,l];var d=new f.default;null!=t?d.UpdateData(t):d.UpdateData(c);var p=r.TABLE.getTableDataById(D.TableName.HEROSKILL,d.Skill.toString());if(i.Obj.isEmpty(p))return[o,n,l];if(!t){var u=s.DATA.UserData.Heros[e];u&&(d=u)}return[o=(a=this.getSkillBaseInfo(p,d))[0],n=a[1],l=a[2]]},t.prototype.getHeroActiveSkillBaseInfo=function(e,t){var a;void 0===t&&(t=!0);var o="",n="",l="",c=r.TABLE.getTableDataById(D.TableName.HERO,e.toString());if(i.Obj.isEmpty(c))return[o,n,l];var d=new f.default;d.UpdateData(c);var p=r.TABLE.getTableDataById(D.TableName.HEROSKILL,d.ActiveSkill.toString());if(i.Obj.isEmpty(p))return[o,n,l];if(t){var u=s.DATA.UserData.Heros[e];u&&(d=u)}return[o=(a=this.getSkillBaseInfo(p,d))[0],n=a[1],l=a[2]]},t.prototype.getFetterSkillBaseInfo=function(e,a){var o="",i="",s="";if(e){var l=r.TABLE.getTableDataById(D.TableName.HEROSKILL,e.toString());if(l){var c=null;if(l.effect_type&&1==l.effect_type){var d=r.TABLE.getTableDataById(D.TableName.STATUS,l.effect);d&&(c=r.TABLE.getTableDataById(D.TableName.EFFECTBUFF,d.buffid))}else c=r.TABLE.getTableDataById(D.TableName.EFFECTBUFF,l.effect);c&&(i=1e4==c.value_type?n.LOCAL.getText(l.desc,String((Number(l.para)+t.getInstance().getSkillBuff(l.para_equip_skill,a))/100)):n.LOCAL.getText(l.desc,String(Number(l.para)+t.getInstance().getSkillBuff(l.para_equip_skill,a)))),o=n.LOCAL.getText(l.name),s=l.skill_icon}}return[o,i,s]},t.prototype.getSkillBaseInfo=function(e,t){for(var a="",o=e.para.split("|"),i=e.para_add.split(","),r=[],s=0;s<Math.min(o.length,i.length);s++){var l=i[s].split("|");if(!(l.length<1)){var c=0;"0"===l[0]?c=parseInt(o[s]):"1"===l[0]?c=parseInt(o[s])+t.War/100*parseInt(l[1]):"2"===l[0]?c=parseInt(o[s])+t.Def/100*parseInt(l[1]):"3"===l[0]&&(c=parseInt(o[s])+t.Command/100*parseInt(l[1])),c=1==e.para_desc?c/100:c,r.push(c.toFixed(1))}}switch(r.length){case 0:a=n.LOCAL.getText(e.desc);break;case 1:a=n.LOCAL.getText(e.desc,r[0]);break;case 2:a=n.LOCAL.getText(e.desc,r[0],r[1]);break;case 3:a=n.LOCAL.getText(e.desc,r[0],r[1],r[2]);break;default:a=n.LOCAL.getTextWithParas(e.desc,r)}return[n.LOCAL.getText(e.name),a,e.skill_icon]},t.prototype.isHaveFreeTimes=function(){return this.hero1FreeTodayNum>0&&this.hero1FreeEndTime<=s.DATA.ServerTime||this.hero2FreeEndTime<=s.DATA.ServerTime},t.prototype.onFMessage_GOLD_BUY_ITEM_SUC=function(e){return e.data&&[m.ItemType.HeroRecruit,45].indexOf(e.data.type)>-1&&this.doRecruit(this._lastRecruitId,this._lastRecruitNum),!0},t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.purge=function(){t._instance=null},t.prototype.getProtectHeroList=function(){var e=[];for(var t in s.DATA.UserData.Heros)1===s.DATA.UserData.Heros[t].ServerDef&&e.push(s.DATA.UserData.Heros[t]);return e=e.sort(this.sortHandle2)},t.prototype.getProtectHeroListId=function(){var e=[];for(var t in s.DATA.UserData.Heros)1===s.DATA.UserData.Heros[t].ServerDef&&e.push(s.DATA.UserData.Heros[t].Id);return e},t.prototype.getArenaPvPHeroListId=function(){var e=[];if(s.DATA.UserData.pvpDefender&&s.DATA.UserData.pvpDefender.heroList)for(var t=0;t<s.DATA.UserData.pvpDefender.heroList.length;t++)e.push(s.DATA.UserData.pvpDefender.heroList[t].id);if(e.length>0){var a=r.TABLE.getTableDataById(D.TableName.ARENA_THEME,String(s.DATA.CurBattleData.otherData.theme));if(a&&a.hero)for(var o=a.hero.split("|"),n=e.length-1;n>=0;n--){var i=!1;for(t=0;t<o.length;t++){if(r.TABLE.getTableDataById(D.TableName.ARENA_THEME_HERO,o[t]).hero==e[n]){i=!0;break}}i||e.splice(n,1)}else{var l=this.getHeroAll();for(n=e.length-1;n>=0;n--){for(i=!1,t=0;t<l.length;t++)if(l[t].Id==e[n]){i=!0;break}i||e.splice(n,1)}}}return e.length||(e=this.getSaveMarchHeroByBattleType("PVP_SUGGEST_HERO_NO_EXIT")),e},t.prototype.hasDubbling=function(e){var t=r.TABLE.getTableGroup(D.TableName.HERO_VOICE_PACK);for(var a in t){var o=t[a];if(o.hero_id===e&&this.checkInPlat(o.platform))return!0}return!1},t.prototype.hasSkinDubbling=function(e){var t=r.TABLE.getTableGroup(D.TableName.HERO_VOICE_PACK);for(var a in t){var o=t[a];if(o.skin_id===e&&this.checkInPlat(o.platform))return!0}return!1},t.prototype.checkInPlat=function(e){void 0===e&&(e="");var t=!1;if(e)for(var a=e.split("|"),o=0;o<a.length;o++){if("g123"===N.instance.platformSID&&"G123"===a[o]){t=!0;break}if(a[o]==N.instance.platformSID){t=!0;break}}else t=!0;return t},t.prototype.checkHeroExclude=function(){return s.DATA.UserData.FunctionOn(m.FunctionKey.Hero_Exclude_New)&&(l.default.isKVK()||s.DATA.UserData.ServerState==w.ServerState.Fight)},t}(c.FMessageConnectionAbstract);a.HeroController=M,window.HeroController=M,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/SoundManager":"SoundManager","../../Core/Common/TableManager":"TableManager","../../Core/Event/EventCenter":"EventCenter","../../Core/Net/NetMgr":"NetMgr","../../fws/mvc/FWSMvc":"FWSMvc","../../fws/platforms/PlatformCore":"PlatformCore","../../fws/utils/FWSTool":"FWSTool","../../fws/utils/LocalStorageUtils":"LocalStorageUtils","../../fws/utils/X":"X","../Common/BIManager":"BIManager","../Common/ConfirmPanel":"ConfirmPanel","../Common/UIManager":"UIManager","../Const/EventId":"EventId","../Const/GameDefine":"GameDefine","../Const/RequestId":"RequestId","../Const/SoundPath":"SoundPath","../Const/TableName":"TableName","../Const/UIDataInfo":"UIDataInfo","../Data/BattleData":"BattleData","../Data/DataCenter":"DataCenter","../Data/HeroData":"HeroData","../Module/UI/FreeGoldPanel":"FreeGoldPanel","../Tools/GameTools":"GameTools","../Tools/SubPackMsgs":"SubPackMsgs","../battle/NBattleModel":"NBattleModel","../controllers/ShopController":"ShopController","../msgs/MvcMsgs":"MvcMsgs"}],MvcMsgs:[function(e,t,a){"use strict";cc._RF.push(t,"01b57NmqjJD25m5oisSs0/J","MvcMsgs");var o,n=e("../../fws/mvc/FWSMvc");(function(e){var t;(function(e){e[e.DEV_LOGIN_ITEM_SELECT=0]="DEV_LOGIN_ITEM_SELECT",e[e.DEV_LOGIN_OK=1]="DEV_LOGIN_OK",e[e.PLATFROM_INITED=2]="PLATFROM_INITED",e[e.AppConfigProcessOK=3]="AppConfigProcessOK",e[e.LOGIN_SUCCESS=4]="LOGIN_SUCCESS",e[e.CHANGE_TO_PRESERVER=5]="CHANGE_TO_PRESERVER",e[e.LEVELUP_SUCCESS=6]="LEVELUP_SUCCESS",e[e.RESOURCE_LOAD_COMPLETE=7]="RESOURCE_LOAD_COMPLETE",e[e.BEGIN_LOGINFLOW=8]="BEGIN_LOGINFLOW",e[e.START_GETSERVERLIST=9]="START_GETSERVERLIST",e[e.GOTO_CONNECT=10]="GOTO_CONNECT",e[e.START_LOGIN=11]="START_LOGIN",e[e.LOGIN_RETURN=12]="LOGIN_RETURN",e[e.LOGIN_DataInitFinish=13]="LOGIN_DataInitFinish",e[e.UPDATE_PROGRESS=14]="UPDATE_PROGRESS",e[e.RELOGIN=15]="RELOGIN",e[e.FIRST_LOGIN_SERVER_COMPLETE=16]="FIRST_LOGIN_SERVER_COMPLETE",e[e.GOLD_BUY_ITEM_SUC=17]="GOLD_BUY_ITEM_SUC",e[e.MVC_PAY_EXCHANGE_RESULT=18]="MVC_PAY_EXCHANGE_RESULT",e[e.MVC_PAY_CHECK_NOT_ENOUGH=19]="MVC_PAY_CHECK_NOT_ENOUGH",e[e.MVC_EXCHANGE_LIST_UPDATE=20]="MVC_EXCHANGE_LIST_UPDATE",e[e.MVC_EXCHANGE_DYNAMIC_UPDATE=21]="MVC_EXCHANGE_DYNAMIC_UPDATE",e[e.MVC_WELCOME_REWARD_INVITE_UPDATE=22]="MVC_WELCOME_REWARD_INVITE_UPDATE",e[e.MVC_WELCOME_REWARD_GET_RESULT=23]="MVC_WELCOME_REWARD_GET_RESULT",e[e.MVC_TIME_CARDS_UPDATE=24]="MVC_TIME_CARDS_UPDATE",e[e.MVC_GROWTH_FUND_UPDATE=25]="MVC_GROWTH_FUND_UPDATE",e[e.MVC_SHOP_BUY_LIMIT_UPDATE=26]="MVC_SHOP_BUY_LIMIT_UPDATE",e[e.MVC_SHOP_BUY_LIMIT_TIME_UPDATE=27]="MVC_SHOP_BUY_LIMIT_TIME_UPDATE",e[e.MVC_GIFT_SHOP_TAB_UPDATE=28]="MVC_GIFT_SHOP_TAB_UPDATE",e[e.MVC_SHOW_LOADING_PROGRESS=29]="MVC_SHOW_LOADING_PROGRESS",e[e.MVC_SET_LOADING_TEXT=30]="MVC_SET_LOADING_TEXT",e[e.SHOW_ALLIANCE_LIST=31]="SHOW_ALLIANCE_LIST",e[e.SHOW_ALLIANCE_INFO=32]="SHOW_ALLIANCE_INFO",e[e.SHOW_ALLIANCE_ROLES=33]="SHOW_ALLIANCE_ROLES",e[e.RELOAD_ALLIANCE_INFO_PANEL=34]="RELOAD_ALLIANCE_INFO_PANEL",e[e.SHOW_ALLIANCE_CURRENT=35]="SHOW_ALLIANCE_CURRENT",e[e.ALLIANCE_ROLE_CHALLENGE_RESULT=36]="ALLIANCE_ROLE_CHALLENGE_RESULT",e[e.ALLIANCE_COLOR_CHANGED=37]="ALLIANCE_COLOR_CHANGED",e[e.ALLIANCE_NOTICE_CHANGED=38]="ALLIANCE_NOTICE_CHANGED",e[e.ALLIANCE_ROLE_BUF_GOLD_GETED=39]="ALLIANCE_ROLE_BUF_GOLD_GETED",e[e.MVC_MILITARY_RANK_DATA_UPDATE=40]="MVC_MILITARY_RANK_DATA_UPDATE",e[e.MVC_MILITARY_RANK_BATTLE_RECORD=41]="MVC_MILITARY_RANK_BATTLE_RECORD",e[e.MVC_REWARD_PANEL_ANIMA=42]="MVC_REWARD_PANEL_ANIMA",e[e.MVC_ARMY_EQUIP_COMPOSE_ITEM_CLCIK=43]="MVC_ARMY_EQUIP_COMPOSE_ITEM_CLCIK",e[e.MVC_ARMY_EQUIP_PRODUCT_ITEM_CLCIK=44]="MVC_ARMY_EQUIP_PRODUCT_ITEM_CLCIK",e[e.MVC_ARMY_EQUIP_INSTALL_ITEM_CLCIK=45]="MVC_ARMY_EQUIP_INSTALL_ITEM_CLCIK",e[e.MVC_ARMY_EQUIP_TURN_ITEM_CLCIK=46]="MVC_ARMY_EQUIP_TURN_ITEM_CLCIK",e[e.MVC_ARMY_EQUIP_INSTALL_VIEW_REFRESH=47]="MVC_ARMY_EQUIP_INSTALL_VIEW_REFRESH",e[e.MVC_ARMY_EQUIP_INSTALL_ITEM=48]="MVC_ARMY_EQUIP_INSTALL_ITEM",e[e.MVC_CASTLE_FACE_VIEW_REFRESH=49]="MVC_CASTLE_FACE_VIEW_REFRESH",e[e.MVC_CASTLE_NAMEPLATE_VIEW_REFRESH=50]="MVC_CASTLE_NAMEPLATE_VIEW_REFRESH",e[e.MVC_CASTLE_ARMYLINE_VIEW_REFRESH=51]="MVC_CASTLE_ARMYLINE_VIEW_REFRESH",e[e.MVC_CASTLE_EFFECT_VIEW_REFRESH=52]="MVC_CASTLE_EFFECT_VIEW_REFRESH",e[e.MVC_HEADFRAMES_VIEW_REFRESH=53]="MVC_HEADFRAMES_VIEW_REFRESH",e[e.MVC_HERO_REFRESH=54]="MVC_HERO_REFRESH",e[e.MVC_HERO_LIST_REFRESH=55]="MVC_HERO_LIST_REFRESH",e[e.MVC_HERO_MARCH_PRE_SELECT=56]="MVC_HERO_MARCH_PRE_SELECT",e[e.MVC_HERO_MARCH_SELECT=57]="MVC_HERO_MARCH_SELECT",e[e.MVC_HERO_SKIN_REFRESH=58]="MVC_HERO_SKIN_REFRESH",e[e.MVC_HERO_ACTIVE_SKILL_REFRESH=59]="MVC_HERO_ACTIVE_SKILL_REFRESH",e[e.MVC_ACTIVITY_SET_SOME_ACTIVITY=60]="MVC_ACTIVITY_SET_SOME_ACTIVITY",e[e.MVC_ACTIVITY_DATA_UPDATE=61]="MVC_ACTIVITY_DATA_UPDATE",e[e.MVC_ACTIVITY_STATE_UPDATE=62]="MVC_ACTIVITY_STATE_UPDATE",e[e.MVC_ACTIVITY_VALENTINE_MINI_RANK=63]="MVC_ACTIVITY_VALENTINE_MINI_RANK",e[e.MVC_ACTIVITY_VALENTINE_GIVE_SUC=64]="MVC_ACTIVITY_VALENTINE_GIVE_SUC",e[e.MVC_SHOW_ACTIVITY_PURCHACE_REWARD=65]="MVC_SHOW_ACTIVITY_PURCHACE_REWARD",e[e.MVC_CHECK_CLOSE_GETMORE_VIEW=66]="MVC_CHECK_CLOSE_GETMORE_VIEW",e[e.MVC_SHOW_ATTACK_MONSTER_MAIL_TIPS=67]="MVC_SHOW_ATTACK_MONSTER_MAIL_TIPS",e[e.MVC_SHOW_Assembly_MAIL_TIPS=68]="MVC_SHOW_Assembly_MAIL_TIPS",e[e.MVC_UPDATE_DAILY_QUEST=69]="MVC_UPDATE_DAILY_QUEST",e[e.MVC_UPDATE_DAILY_QUEST_ANIM=70]="MVC_UPDATE_DAILY_QUEST_ANIM",e[e.MVC_UPDATE_ALL_DAILY_QUEST=71]="MVC_UPDATE_ALL_DAILY_QUEST",e[e.MVC_UPDATE_BOUNTY_QUEST=72]="MVC_UPDATE_BOUNTY_QUEST",e[e.MVC_UPDATE_BOUNTY_SHOP=73]="MVC_UPDATE_BOUNTY_SHOP",e[e.MVC_DAILY_QUEST_REFRESH_UPDATE=74]="MVC_DAILY_QUEST_REFRESH_UPDATE",e[e.MVC_DAILY_QUEST_FINISHED_UPDATE=75]="MVC_DAILY_QUEST_FINISHED_UPDATE",e[e.MVC_DAILY_QUEST_BOX_UPDATE=76]="MVC_DAILY_QUEST_BOX_UPDATE",e[e.MVC_DAILY_QUEST_MAINUI_UPDATE=77]="MVC_DAILY_QUEST_MAINUI_UPDATE",e[e.MVC_DAILY_BUILDING_VIEW_RED_DOT_UPDATE=78]="MVC_DAILY_BUILDING_VIEW_RED_DOT_UPDATE",e[e.MVC_HOSPITAL_SEL=79]="MVC_HOSPITAL_SEL",e[e.MVC_BATTLE_MAIL_SHARE_VS_NAME=80]="MVC_BATTLE_MAIL_SHARE_VS_NAME",e[e.MVC_BATTLE_MAIL_SHARE_ICON=81]="MVC_BATTLE_MAIL_SHARE_ICON",e[e.MVC_BATTLE_MAIL_SHARE_VSUID=82]="MVC_BATTLE_MAIL_SHARE_VSUID",e[e.MVC_CASINO_TURN_QUERY=83]="MVC_CASINO_TURN_QUERY",e[e.MVC_CASINO_TURN_RESULT=84]="MVC_CASINO_TURN_RESULT",e[e.MVC_CASINO_TURN_FAIL=85]="MVC_CASINO_TURN_FAIL",e[e.MVC_THRONE_VIEW_REFRESH=86]="MVC_THRONE_VIEW_REFRESH",e[e.DEBUG_HIDE_MAINUI=87]="DEBUG_HIDE_MAINUI",e[e.DEBUG_HIDE_SCENE=88]="DEBUG_HIDE_SCENE",e[e.DEBUG_HIDE_ALL=89]="DEBUG_HIDE_ALL",e[e.IS_SEND_ROSE_ALIVE=90]="IS_SEND_ROSE_ALIVE",e[e.MVC_Record_Start=91]="MVC_Record_Start",e[e.MVC_Record_OnStart=92]="MVC_Record_OnStart",e[e.MVC_Record_Stop=93]="MVC_Record_Stop",e[e.MVC_Record_OnStop=94]="MVC_Record_OnStop",e[e.MVC_Record_Share=95]="MVC_Record_Share",e[e.MVC_Record_SaveAlbum=96]="MVC_Record_SaveAlbum",e[e.MVC_WareHouseCell_Move=97]="MVC_WareHouseCell_Move",e[e.MVC_WareHouseCell_Touch=98]="MVC_WareHouseCell_Touch",e[e.MVC_WareHouseData=99]="MVC_WareHouseData",e[e.MVC_StrengthenItemSel=100]="MVC_StrengthenItemSel",e[e.MVC_AppOnShow=101]="MVC_AppOnShow",e[e.MVC_AppOnHide=102]="MVC_AppOnHide",e[e.MVC_StrengthenItemExchangeAdd=103]="MVC_StrengthenItemExchangeAdd",e[e.MVC_StrengthenItemExchangeUpdate=104]="MVC_StrengthenItemExchangeUpdate",e[e.MVC_SET_ONWHEEL_CALLBACK=105]="MVC_SET_ONWHEEL_CALLBACK",e[e.MVC_GROW_ROAD_CELL_CLICK=106]="MVC_GROW_ROAD_CELL_CLICK",e[e.GROW_ROAD_CELL_STATE_CHANGE=107]="GROW_ROAD_CELL_STATE_CHANGE",e[e.ITEM_CLICK_CHANGE=108]="ITEM_CLICK_CHANGE",e[e.MVC_REBUILD_HOME_MAP_AREAS=109]="MVC_REBUILD_HOME_MAP_AREAS",e[e.MVC_ACTIVITY_SUMMER_LOTTERY_INFO=110]="MVC_ACTIVITY_SUMMER_LOTTERY_INFO",e[e.MVC_ACTIVITY_REVERSE_CARD_INFO=111]="MVC_ACTIVITY_REVERSE_CARD_INFO",e[e.JUDGE_IF_CAN_PUT_ON_HERO=112]="JUDGE_IF_CAN_PUT_ON_HERO",e[e.JUDGE_IF_HAVE_SAME_HEROID=113]="JUDGE_IF_HAVE_SAME_HEROID",e[e.checkMonsterDefenderIsBegin=114]="checkMonsterDefenderIsBegin",e[e.MVC_BATTLE_TRAP_CHANGE=115]="MVC_BATTLE_TRAP_CHANGE",e[e.MVC_DIM_INFO_UPDATE=116]="MVC_DIM_INFO_UPDATE",e[e.MVC_DIM_UPDATE_ATTACK_COUNT=117]="MVC_DIM_UPDATE_ATTACK_COUNT",e[e.MVC_DIM_MAIL_UPDATE=118]="MVC_DIM_MAIL_UPDATE",e[e.MVC_DIM_REFRESH=119]="MVC_DIM_REFRESH",e[e.NEW_MAIL_DATA_LOADED=120]="NEW_MAIL_DATA_LOADED",e[e.MVC_EC_PREPARE_INFO_DATA=121]="MVC_EC_PREPARE_INFO_DATA",e[e.MVC_EC_PREPARE_ARMY_SELECTED=122]="MVC_EC_PREPARE_ARMY_SELECTED",e[e.INIT_NEW_ARMY_EQUIPLIST=123]="INIT_NEW_ARMY_EQUIPLIST",e[e.MVC_MAIL_SINGLE_PUSH=124]="MVC_MAIL_SINGLE_PUSH",e[e.MVC_NET_TIPS=125]="MVC_NET_TIPS",e[e.New_Mail_UnreadCountChanged=126]="New_Mail_UnreadCountChanged",e[e.New_Mail_MailDeleted=127]="New_Mail_MailDeleted",e[e.MVC_EC_PREPARE_ARMY_CELL_SELECTED=128]="MVC_EC_PREPARE_ARMY_CELL_SELECTED"})(t=e.Names||(e.Names={})),function(e){e[e.ShowTips=0]="ShowTips",e[e.SetWaitStatus=1]="SetWaitStatus",e[e.MsgBoxAlert=2]="MsgBoxAlert",e[e.MsgBoxConfirm=3]="MsgBoxConfirm",e[e.MsgBoxClearById=4]="MsgBoxClearById"}(e.MvcUIType||(e.MvcUIType={})),e.send=function(e,a,o){void 0===o&&(o="");var i=t[e],r=new n.FMessage(i,a,o);return r.send(),r}})(o||(o={})),window.MvcMsgs=o,t.exports=o,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc"}],PayMsgs:[function(e,t,a){"use strict";cc._RF.push(t,"d51ffzEG1dOZpFVOnOqAufj","PayMsgs");var o,n=e("../../fws/mvc/FWSMvc");(function(e){var t;(function(e){e[e.PayMsgsRequestPrev=0]="PayMsgsRequestPrev",e[e.PayMsgsRequest=1]="PayMsgsRequest",e[e.PayMsgsRequestSuccess=2]="PayMsgsRequestSuccess",e[e.PayMsgsRequestFail=3]="PayMsgsRequestFail",e[e.PayMsgsRequestDebug=4]="PayMsgsRequestDebug",e[e.PayToServerPush=5]="PayToServerPush",e[e.Dev_PayMsgsRequest=6]="Dev_PayMsgsRequest",e[e.ResendServerPay=7]="ResendServerPay",e[e.REWARD_VIEW_CLOSED=8]="REWARD_VIEW_CLOSED"})(t=e.Names||(e.Names={})),function(e){e[e.Gifts=0]="Gifts"}(e.PayCategory||(e.PayCategory={})),e.send=function(e,a,o){void 0===a&&(a=null),void 0===o&&(o="");var i=t[e];new n.FMessage(i,a,o).send()}})(o||(o={})),window.PayMsgs=o,t.exports=o,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc"}],WorkerMsgs:[function(e,t,a){"use strict";cc._RF.push(t,"34a0ffjC7ZDG61tLGlgQbuH","WorkerMsgs");var o,n=e("../../fws/mvc/FWSMvc");(function(e){var t;(function(e){e[e.WorkerMsgsToWork=0]="WorkerMsgsToWork",e[e.WorkerMsgsMoveToWork=1]="WorkerMsgsMoveToWork",e[e.WorkerMsgsWorking=2]="WorkerMsgsWorking",e[e.WorkerMsgsWorkFinished=3]="WorkerMsgsWorkFinished",e[e.WorkerMsgsStopWork=4]="WorkerMsgsStopWork",e[e.WorkerMsgsMoveToAutoCollectBuilding=5]="WorkerMsgsMoveToAutoCollectBuilding"})(t=e.MsgNames||(e.MsgNames={})),e.send=function(e,a,o){void 0===a&&(a=null),void 0===o&&(o="");var i=t[e];new n.FMessage(i,a,o).send()}})(o||(o={})),window.WorkerMsgs=o,t.exports=o,cc._RF.pop()},{"../../fws/mvc/FWSMvc":"FWSMvc"}],PlatformHttpUtils:[function(e,t,a){"use strict";cc._RF.push(t,"ec7fdC0ax9P3JOlHeyFbZc7","PlatformHttpUtils"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../Game/Tools/GameTools"),n={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,a,o,i,r,s,l,c="",d=0;for(e=n._utf8_encode(e);d<e.length;)i=(t=e.charCodeAt(d++))>>2,r=(3&t)<<4|(a=e.charCodeAt(d++))>>4,s=(15&a)<<2|(o=e.charCodeAt(d++))>>6,l=63&o,isNaN(a)?s=l=64:isNaN(o)&&(l=64),c=c+this._keyStr.charAt(i)+this._keyStr.charAt(r)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return c},decode:function(e){var t,a,o,i,r,s,l="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(i=this._keyStr.indexOf(e.charAt(c++)))>>4,a=(15&i)<<4|(r=this._keyStr.indexOf(e.charAt(c++)))>>2,o=(3&r)<<6|(s=this._keyStr.indexOf(e.charAt(c++))),l+=String.fromCharCode(t),64!=r&&(l+=String.fromCharCode(a)),64!=s&&(l+=String.fromCharCode(o));return l=n._utf8_decode(l)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",a=0;a<e.length;a++){var o=e.charCodeAt(a);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},_utf8_decode:function(e){for(var t="",a=0,o=0,n=0,i=0;a<e.length;)(o=e.charCodeAt(a))<128?(t+=String.fromCharCode(o),a++):o>191&&o<224?(n=e.charCodeAt(a+1),t+=String.fromCharCode((31&o)<<6|63&n),a+=2):(n=e.charCodeAt(a+1),i=e.charCodeAt(a+2),t+=String.fromCharCode((15&o)<<12|(63&n)<<6|63&i),a+=3);return t}},i=function(){function e(){this.requestOb={}}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.make_base_auth=function(e,t){var a=e+":"+t;return"Basic "+n.encode(a)},e.prototype.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},e.prototype.get=function(e,t,a,o,n,i,r){var s=new XMLHttpRequest;t.appId&&(e+="?"+Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&"));if(s.onreadystatechange=function(){if(4==s.readyState)if(0===s.status){var e=s.responseText;try{e=JSON.parse(s.responseText)}catch(t){e=s.responseText}i&&i(e)}else console.error("platform http xhr.status:"+s.status,null),r&&r()}.bind(this),s.open("GET",e,!0),a&&""!=a){var l=this.make_base_auth(a,o);s.setRequestHeader("Authorization",l)}s.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),s.send(),s.ontimeout=function(){console.error("platform httpRequest timeout"),r&&r()},s.onerror=function(e){}},e.prototype.post=function(e){var t=new XMLHttpRequest;t.open("POST",e,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),t.send(),t.ontimeout=function(){console.error("platform httpRequest post timeout")},t.onerror=function(e){console.error("platform http post \u8fde\u63a5\u9519\u8bef"+e.type,null)},t.onreadystatechange=function(){t.readyState}},e.prototype.getShortUrl=function(t,a){var n={longDynamicLink:"https://worldbattle.page.link/?link="+encodeURIComponent(t)},i=JSON.stringify(n);e.getInstance().postJson("https://firebasedynamiclinks.googleapis.com/v1/shortLinks?key=AIzaSyDaj95SWJUFfPmBk7Dtl0xkdF1dVbjNjhk",i,function(e){var n=o.default.JSON_PARSE(e);n.shortLink?a(n.shortLink):a(t)})},e.prototype.postJson=function(e,t,a){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/json"),o.send(t),o.ontimeout=function(){console.error("platform httpRequest post timeout")},o.onerror=function(e){console.error("platform http post \u8fde\u63a5\u9519\u8bef"+e.type,null)},o.onreadystatechange=function(){4===o.readyState&&a&&a(o.response)}},e.prototype.getVersion=function(e,t,a){var o=null;try{o=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{o=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}o||(o=new XMLHttpRequest),o.onreadystatechange=function(){if(4==o.readyState)if(0===o.status){var e=o.responseText;try{e=JSON.parse(o.responseText)}catch(t){e=o.responseText}t&&t(e)}else console.error("platform http xhr.status:"+o.status,null),a&&a()}.bind(this),o.open("GET",e,!0),o.setRequestHeader("Content-Type","text/plain"),o.send(),o.ontimeout=function(){console.error("platform httpRequest timeout"),a&&a()},o.onerror=function(e){}},e.reqId=0,e}();a.default=i,cc._RF.pop()},{"../Game/Tools/GameTools":"GameTools"}],river_bi:[function(e,t,a){"use strict";cc._RF.push(t,"1bf0cDD7YhJ6JBZfQnzNfgd","river_bi"),cc._RF.pop()},{}],CocosWrap:[function(e,t,a){"use strict";cc._RF.push(t,"083a28yBtNGgrM2IzQAv854","CocosWrap"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./ErrorUtils"),n=e("../fws/utils/X"),i=function(){function e(){this._scheduleList=[],this._ccEventList=[]}return e.bindEditorEvent=function(){0==e.CocosWrapInited&&(e.CocosWrapInited=!0,e._emitEvents=cc.Component.EventHandler.emitEvents,cc.Component.EventHandler.emitEvents=e.emitEvents)},e.callFunc=function(e,t,a,n){return cc.callFunc(function(a){try{t?e&&e.call(t,a):e&&e(a)}catch(e){var i=new o.ErrorInfo;i.errMsgType=o.eErrorTypes.Catch,i.funcName="callFunc",i.errMsgInfo=e,i.component=o.ErrorUtils.getComponentName(t),i.customInfo=o.ErrorUtils.getComponentName(n),o.ErrorUtils.errorMessage(i)}},null,a)},e.prototype.scheduleFunction=function(e,t,a,i,s){var l=this;if(e&&e.isLive()&&t){var c=new r;c.target=e,c.name=e.getName(),c.cb=t,c.repeat=i,c.tempCb=function(t){try{c.cb&&c.target.isLive()&&c.cb.call(c.target,t),c.repeat!==cc.macro.REPEAT_FOREVER&&(++c.repeatCur,c.repeatCur>=c.repeat&&l.unscheduleFunction(c.cb))}catch(t){var n=e.getError(t,"scheduleFunction");n.customInfo="interval?: "+a+", repeat?: "+i+", delay?: "+s,o.ErrorUtils.errorMessage(n)}},e.schedule(c.tempCb,a,i,s),this._scheduleList.push(c)}else n.error("scheduleFunction param error or target is destory")},e.prototype.unscheduleAllFunction=function(){this._scheduleList.splice(0,this._scheduleList.length),this._scheduleList=[]},e.prototype.unscheduleFunction=function(e){for(var t=0;t<this._scheduleList.length;t++){var a=this._scheduleList[t];if(a.cb==e){if(a.target.isLive())a.target.unschedule(a.tempCb);return void this._scheduleList.splice(t,1)}}},e.prototype.ccNodeOn=function(e,t,a,n){var i=this;if(void 0===n&&(n=null),!e||0==e.isValid||!a||!t){var r=new o.ErrorInfo;return r.errMsgType=o.eErrorTypes.Inner,r.errMsgInfo=new Error("event:"+t+" cb:"+!!a+" node:"+!!e),r.funcName="cpnNodeOn",r.component=n&&n.isLive()?n.getName():"null",r.customInfo="param error",void o.ErrorUtils.errorMessage(r)}for(var l=0;l<this._ccEventList.length;l++)if(this._ccEventList[l].node==e&&this._ccEventList[l].eventType==t&&this._ccEventList[l].cb==a&&this._ccEventList[l].target==n)return;var c=new s;c.node=e,c.eventType=t,c.info="owner:"+(n?n.getName():"null")+"node:"+e.name,c.target=n,c.cb=a,c.tempCb=function(e,t,a,n){try{i.exeEvent(c,e,t,a,n)}catch(e){var r=null;c.target&&c.target.isLive()&&c.target.getError?r=c.target.getError(e,"cpnNodeOn"):((r=new o.ErrorInfo).errMsgInfo=e,r.funcName="cpnNodeOn"),r.customInfo=" event:"+c.eventType+" info:"+c.info,o.ErrorUtils.errorMessage(r)}},e.on(t,c.tempCb,null),this._ccEventList.push(c)},e.prototype.ccNodeOff=function(e,t,a){void 0===a&&(a=null);for(var o=0;o<this._ccEventList.length;o++){var n=this._ccEventList[o];if(n.cb===t&&n.eventType===e&&(!a||n.target===a))return n.target&&0==n.target.isLive()?(this._ccEventList.splice(o,1),!0):n.node&&0==n.node.isValid?(this._ccEventList.splice(o,1),!0):(n.node&&n.node.off(n.eventType,n.tempCb,null),this._ccEventList.splice(o,1),!0)}return!1},e.prototype.exeEvent=function(e,t,a,o,n){e.cb&&(e.target?e.target&&e.target.isLive()&&e.cb.call(e.target,t,a,o,n):e.cb(t,a,o,n))},e.emitEvents=function(t){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];if(t)try{for(var i=[t],r=0;r<a.length;r++)i.push(a[r]);e._emitEvents.apply(cc.Component.EventHandler,i)}catch(e){var s=new o.ErrorInfo;s.errMsgInfo=e,s.customInfo="editor event callback";for(r=0;r<t.length;r++){var l=t[r];l&&(l.component&&(s.component+=" "+l.component),l.handler&&(s.funcName+=" "+l.handler),l.target&&l.target.name&&(s.node+=" "+l.target.name))}o.ErrorUtils.errorMessage(s)}},e.empty=new e,e.CocosWrapInited=!1,e._emitEvents=null,e}();a.default=i;var r=function(){return function(){this.repeatCur=0}}(),s=function(){return function(){this.cb=null,this.tempCb=null,this.node=null,this.target=null,this.eventType=null}}();cc._RF.pop()},{"../fws/utils/X":"X","./ErrorUtils":"ErrorUtils"}],ComponentBase:[function(e,t,a){"use strict";cc._RF.push(t,"a002difi+NNfq/mRiGUgXX7","ComponentBase"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./ErrorUtils"),n=e("./CocosWrap"),i=e("./JSWrap"),r=e("../fws/utils/X"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=e.call(this)||this;t.__isDestroy=!1,t.__runTime=0,t.__runTime100=0,t.__cocos=null;for(var o=a.nativeList,n=a.customNativeList,i=a.prototype,r=0;r<o.length;r++){var s=n[r];t[s]!=i[s]||"update"==o[r]&&(t.cpnUpdate1000MS!=i.cpnUpdate1000MS||t.cpnUpdate100MS!=i.cpnUpdate100MS)?t[o[r]]=t["__"+o[r]]:"update"==o[r]&&(t[o[r]]=void 0)}return t}var a;return __extends(t,e),a=t,t.prototype.isLive=function(){return this&&this.node&&this.node.isValid&&this.isValid&&!this.__isDestroy},t.prototype.getName=function(){return this.isLive()?this.name:"destroy"},t.prototype.cpnStart=function(){},t.prototype.cpnUpdate=function(e){},t.prototype.cpnLoad=function(){},t.prototype.cpnDestroy=function(){},t.prototype.cpnEnable=function(){},t.prototype.cpnDisable=function(){},t.prototype.cpnUpdate1000MS=function(e){},t.prototype.cpnUpdate100MS=function(e){},t.prototype.cpnCallFunc=function(e,t,a){return n.default.callFunc(e,t,a,this)},t.prototype.cpnSchedule=function(e,t,a,o,n){this.getWarp("cpnSchedule",e).scheduleFunction(e,t,a,o,n)},t.prototype.cpnScheduleOnce=function(e,t,a){this.getWarp("cpnScheduleOnce",e).scheduleFunction(e,t,0,1,a)},t.prototype.cpnUnschedule=function(e){this.getWarp("cpnUnschedule",null,e).unscheduleFunction(e)},t.prototype.cpnUnscheduleAllCallbacks=function(){this.getWarp("cpnUnscheduleAllCallbacks",null).unscheduleAllFunction(),this.unscheduleAllCallbacks()},t.prototype.cpnNodeOn=function(e,t,a,o){void 0===o&&(o=null),this.getWarp("cpnNodeOn",o).ccNodeOn(e,t,a,o)},t.prototype.cpnNodeOff=function(e,t,a){void 0===a&&(a=null),this.getWarp("cpnNodeOff",a).ccNodeOff(e,t,a)},t.prototype.cpnSetTimeout=function(e,t){return i.default.setTimeout(e,t,this)},t.prototype.cpnClearTimeout=function(e){i.default.clearTimeout(e)},t.prototype.__onLoad=function(){this.functionCall("cpnLoad",this.cpnLoad)},t.prototype.__start=function(){this.functionCall("cpnStart",this.cpnStart)},t.prototype.__update=function(e){this.__runTime100+=e,this.__runTime100>=.1&&(this.functionCall("cpnUpdate100MS",this.cpnUpdate100MS,this.__runTime100),this.__runTime100=0),this.__runTime+=e,this.__runTime>=1&&(this.functionCall("cpnUpdate1000MS",this.cpnUpdate1000MS,this.__runTime),this.__runTime=0),this.functionCall("cpnUpdate",this.cpnUpdate,e)},t.prototype.__onDestroy=function(){this.functionCall("cpnDestroy",this.cpnDestroy),this.__isDestroy=!0},t.prototype.__onEnable=function(){this.functionCall("cpnEnable",this.cpnEnable)},t.prototype.__onDisable=function(){this.functionCall("cpnDisable",this.cpnDisable)},t.prototype.getError=function(e,t){var a=new o.ErrorInfo;return a.errMsgInfo=e,a.funcName=t,a.component=this.getName(),a.node=o.ErrorUtils.getNodeName(this.node),a.customInfo="Component",a},t.prototype.functionCall=function(e,t,a){try{if(this.__isDestroy)throw"\u5bf9\u8c61\u5df2\u7ecf\u88ab\u50ac\u6bc1";t.call(this,a)}catch(t){r.error(t);var n=this.getError(t,e);this.name&&(n.customInfo=this.name+"@"+(n.customInfo||"")),o.ErrorUtils.errorMessage(n)}},t.prototype.getWarp=function(e,t,a){return this.isLive()?(this.__cocos||(this.__cocos=new n.default),this.__cocos):(r.error("(getWarp) already delete"),n.default.empty)},t.nativeList=["onLoad","onDisable","onEnable","update","start","onDestroy"],t.customNativeList=["cpnLoad","cpnDisable","cpnEnable","cpnUpdate","cpnStart","cpnDestroy"],t=a=__decorate([l],t)}(cc.Component));a.default=c,cc._RF.pop()},{"../fws/utils/X":"X","./CocosWrap":"CocosWrap","./ErrorUtils":"ErrorUtils","./JSWrap":"JSWrap"}],ErrorUtils:[function(e,t,a){"use strict";cc._RF.push(t,"5543eqFkMJGgbOQBtBB5j9j","ErrorUtils"),Object.defineProperty(a,"__esModule",{value:!0});var o,n=e("../fws/utils/X");(function(e){e.Catch="Catch",e.Login="Login",e.Server="Server",e.Inner="Inner"})(o=a.eErrorTypes||(a.eErrorTypes={}));var i=function(){function e(){this.errType="game",this.errMsgType=o.Catch,this.timeGame=Date.now()-r._gameStartTime,this.timeStamp=Date.now(),r.setupGameInfo(this)}return Object.defineProperty(e.prototype,"errMsgInfo",{get:function(){return this._errMsgInfo},set:function(e){"string"==typeof e&&(e=new Error(e)),this._errMsgInfo=e},enumerable:!0,configurable:!0}),e}();a.ErrorInfo=i;var r=function(){function e(){}return e.getComponentName=function(e){return e&&e.name?e.name:""},e.setupFunction=function(e,t){this._setupGameInfoFunc=e,this._errorMessageFunc=t},e.getNodeName=function(e){if(!e)return"null";if(!e.isValid)return"Already Destory";for(var t=0,a=[e.name];e.parent&&e.parent.isValid&&(a.push(e.parent.name),e=e.parent,!(t++>=4)););return a.reverse().join("/")},e.setupGameInfo=function(e){this._setupGameInfoFunc&&this._setupGameInfoFunc(e)},e.errorMessage=function(e){n.error(e.errMsgInfo),this._errorMessageFunc&&this._errorMessageFunc(e)},e._gameStartTime=Date.now(),e._errorMap={},e._setupGameInfoFunc=null,e._errorMessageFunc=null,e}();a.ErrorUtils=r,cc._RF.pop()},{"../fws/utils/X":"X"}],JSWrap:[function(e,t,a){"use strict";cc._RF.push(t,"ab3a6O3qRNMu6AZzxpWtiLV","JSWrap"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./ErrorUtils"),n=function(){function e(){}return e.setTimeout=function(t,a,n){void 0===n&&(n=null);var r=new i;return r.handle=setTimeout(function(){if(t)try{t()}catch(e){var i=new o.ErrorInfo;i.errMsgInfo=e,i.funcName="setTimeout",i.component=o.ErrorUtils.getComponentName(n),i.customInfo="\u56de\u8c03\u51fd\u6570\u9519\u8bef time:"+a,o.ErrorUtils.errorMessage(i)}delete e._handleMap[r.handleIdx]},a),e._handleMap[r.handleIdx]=r,r},e.clearTimeout=function(t){if(t)if(t instanceof i){var a=t;if(-1===a.handleIdx)return;if(void 0===e._handleMap[a.handleIdx])return;clearTimeout(a.handle),delete e._handleMap[a.handleIdx],a.handleIdx=-1}else{var n=new o.ErrorInfo;n.errMsgType=o.eErrorTypes.Inner,n.errMsgInfo=new Error("clearTimeout error \u6ca1\u4e0esetTimeout\u914d\u5bf9\u4f7f\u7528"),o.ErrorUtils.errorMessage(n)}},e.clearTimeoutAll=function(){try{for(var t in e._handleMap){var a=e._handleMap[t];a&&a.handle&&(clearTimeout(a.handle),a.handleIdx=-1,delete e._handleMap[t])}}catch(e){}},e._handleMap={},e}();a.default=n;var i=function(){function e(){this.handle=null,this.handleIdx=e.handleStartIdx++}return e.handleStartIdx=1,e}();cc._RF.pop()},{"./ErrorUtils":"ErrorUtils"}],FWSEnv:[function(e,t,a){"use strict";var o;cc._RF.push(t,"8a503NmhYdKFqWWOHmsvDlO","FWSEnv"),function(e){e.DEBUG=!1,e.LogFilters=[],e.SIMULATOR=!1,e.DEBUG_ADVANCED=!1,e.DEBUG_MVC_TRACE=e.DEBUG&&!1,e.DEBUG_CONTEXT_TRACE=e.DEBUG&&!1,e.DEBUG_REMOTE_LOADER_OVER_TIME_MODE=!0,e.HTTP_CACHE_ENABLED=!e.DEBUG&&!0,e.USE_NEW_PVP_BATTLE=!0,e.USE_NEW_BATTLE_SYSTEM=!0,e.USE_PROFESS_MODEL=!1,e.LAYOUT_RT_ENABLED=!0}(o||(o={})),window.FWSEnv=o,t.exports=o,cc._RF.pop()},{}],FWSData:[function(e,t,a){"use strict";var o;cc._RF.push(t,"89ca3nwRmhH9q6EcA0Yk/TZ","FWSData"),function(e){e.setValueFromPath=function(e,t,a,o){if(e&&a)try{a[o]=e[t]}catch(e){}};var t=function(){function e(e){if(void 0===e&&(e=null),this._dict=new Object,e)for(var t in e){var a=e[t];this._dict[t]=a}}return e.prototype.getItem=function(e){return this._dict[e]},e.prototype.setItem=function(e,t){this._dict[e]!==t&&(this._dict[e]=t)},e.prototype.deleteKey=function(e){this.containKey(e)&&delete this._dict[e]},e.prototype.containKey=function(e){return this.keys.indexOf(e)>=0},e.prototype.containValue=function(e){return this.values.indexOf(e)>=0},e.prototype.clear=function(){if(0!=this.count)for(var e in this._dict)delete this._dict[e]},e.prototype.toObject=function(){var e=new Object;for(var t in this._dict){var a=this._dict[t];e[t]=a}return e},e.prototype.toString=function(){return"Dict "+JSON.stringify(this._dict)},Object.defineProperty(e.prototype,"keys",{get:function(){var e=new Array;for(var t in this._dict)e.push(t);return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var e=new Array;for(var t in this._dict)e.push(this._dict[t]);return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),e.prototype.foreachValue=function(e){for(var t in this._dict)e(this._dict[t])},e}();e.Dict=t;var a=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=!1),this.eventEnabled=!1,this._list=null!=e?t?e.slice(0):e:new Array}return e.prototype.sort=function(e){try{this._list.sort(e)}catch(e){}},e.prototype.sync=function(e){if(null!==e&&void 0!==e){for(var t=this._list.length-1;t>=0;t--){var a=this._list[t];e.indexOf(a)<0&&this.removeAt(t)}for(t=0;t<e.length;t++){a=e[t];this._list.indexOf(a)<0&&this.add(a)}}},e.prototype.at=function(e){return e>=0&&e<this._list.length?this._list[e]:null},e.prototype.modify=function(e,t){t<0||t>=this._list.length||this._list[t]!==e&&(this._list[t]=e)},e.prototype.add=function(e){return this._list.push(e),e},e.prototype.addArray=function(e){for(var t=0;t<e.length;t++)this.add(e[t]);return e.length},e.prototype.remove=function(e){var t=this._list.indexOf(e);if(!(t<0))return this._list.splice(t,1),e},e.prototype.insert=function(e,t){if(this._list.length>0){if(t<0||t>this._list.length-1)return;this._list.splice(t,0,e)}else this._list.push(e);return e},e.prototype.removeAt=function(e){var t=this._list[e];return this._list.splice(e,1),t},e.prototype.clear=function(){0!=this._list.length&&this._list.splice(0,this._list.length)},e.prototype.indexOf=function(e){return this._list.indexOf(e)},e.prototype.toArray=function(){return this._list.slice(0)},e.prototype.toString=function(){return"List ["+this._list.toString()+"]"},e.prototype.join=function(e){return this._list.join(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e}();e.List=a;var o=function(){function e(){this._list=new Array}return e.prototype.clone=function(t){for(var a=new e,o=0;o<this._list.length;o++)a.add(this._list[o]);return a},e.prototype.add=function(e){this._list.push(e)},e.prototype.remove=function(){return this._list.length>0?this._list.shift():null},e.prototype.clear=function(){this._list.splice(0,this._list.length)},e.prototype.toArray=function(){return this._list.slice(0)},e.prototype.toString=function(){return"Queue["+this._list.toString()+"]"},Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return 0==this._list.length?null:this._list[0]},enumerable:!0,configurable:!0}),e}();e.Queue=o;var n=function(){function e(e){this._nodes=new a,this._id=e}return e.prototype.clone=function(t){for(var a=new e(this._id),o=0;o<this._nodes.length;o++){var n=this._nodes.at(o);t&&(n=n.clone(t)),a.add(n)}return a},e.prototype.clear=function(){for(var e=0;e<this._nodes.length;e++){this._nodes[e]._parentNode=null}this._nodes.clear()},e.prototype.add=function(e){return e._parentNode=this,this._nodes.add(e)},e.prototype.insert=function(e,t){var a=e;return e._parentNode=this,a},e.prototype.remove=function(e){return e._parentNode=null,this._nodes.remove(e)},e.prototype.removeAt=function(e){var t=this._nodes.at(e);return this._nodes.removeAt(e),t._parentNode=null,t},e.prototype.removeFromParent=function(){this._parentNode&&this._parentNode.remove(this)},e.prototype.at=function(e){return this._nodes.at(e)},e.prototype.indexOf=function(e){return this._nodes.indexOf(e)},e.prototype.find=function(e){if(this._id===e)return this;for(var t=0;t<this._nodes.length;t++){var a=this._nodes.at(t);if(a.id===e)return a;var o=a.find(e);if(o)return o}return null},e.prototype.findData=function(e){if(this._data===e)return this;for(var t=0;t<this._nodes.length;t++){var a=this._nodes.at(t);if(a.data===e)return a;var o=a.findData(e);if(o)return o}return null},e.prototype.getParentNodes=function(){for(var e=new Array,t=this;t;)e.splice(0,0,t),t=t.parentNode;return e},e.prototype.getParentByOtherNode=function(e){for(var t=this.getParentNodes(),a=e.getParentNodes(),o=null,n=0;n<t.length;n++){var i=t[n],r=null;if(n<a.length&&(r=a[n]),i!==r)break;o=i}return o},Object.defineProperty(e.prototype,"firstChild",{get:function(){return this._nodes.length>0?this._nodes.at(0):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this._nodes.length>0?this._nodes.at(this._nodes.length-1):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstNode",{get:function(){return this._parentNode?this._parentNode.firstChild:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prevNode",{get:function(){if(this._parentNode){var e=this._parentNode.indexOf(this);if(e>0)return this._parentNode.at(e-1)}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextNode",{get:function(){if(this._parentNode){var e=this._parentNode.indexOf(this);return e>=this._parentNode.length?null:e<0?null:this._parentNode.at(e+1)}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastNode",{get:function(){return this._parentNode?this._parentNode.lastChild:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),e.prototype.toString=function(){var e=this._data;return e||0===e||!1===e?"Node "+JSON.stringify(this._data):"Node {}"},Object.defineProperty(e.prototype,"length",{get:function(){return this._nodes.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this._parentNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){for(var e=0,t=this;t.parentNode;)t=t.parentNode,e++;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rootNode",{get:function(){for(var e=this;e.parentNode;)e=e.parentNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){for(var e=new Array,t=this;t;)e.splice(0,0,t.id),t=t.parentNode;return e.join("/")},enumerable:!0,configurable:!0}),e}();e.Node=n;var i=function(){function e(){this._list=new Array}return e.prototype.clone=function(t){for(var a=new e,o=0;o<this._list.length;o++)a.add(this._list[o]);return a},e.prototype.clear=function(){this._list.splice(0,this._list.length)},e.prototype.add=function(e){return this._list.push(e),e},e.prototype.remove=function(){return this._list.length>0?this._list.pop():null},e.prototype.toArray=function(e){return void 0===e&&(e=!0),e?this._list.slice(0):this._list},e.prototype.indexOf=function(e){return this._list.indexOf(e)},e.prototype.toString=function(){return"Stack["+this._list.toString()+"]"},Object.defineProperty(e.prototype,"current",{get:function(){return this._list.length>0?this._list[this._list.length-1]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e}();e.Stack=i,function(e){e[e.LESS=-1]="LESS",e[e.EQUAL=0]="EQUAL",e[e.GREATER=1]="GREATER"}(e.CompareResult||(e.CompareResult={}))}(o||(o={})),t.exports=o,cc._RF.pop()},{}],FWSComponent:[function(e,t,a){"use strict";cc._RF.push(t,"6bdf3qrlVZAPpPBQS4mVQtC","FWSComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../System/ComponentBase"),n=cc._decorator.ccclass,i=e("../mvc/FWSMvc"),r=function(e){function t(){var t=e.call(this)||this;return t.mvcDelegate=new i.FMessageConnectionDelegate(t),t}return __extends(t,e),t.prototype.cpnEnable=function(){e.prototype.cpnEnable.call(this),this.mvcDelegate.connect()},t.prototype.cpnDisable=function(){this.mvcDelegate.disconnect(),e.prototype.cpnDisable.call(this)},t=__decorate([n],t)}(o.default);a.default=r,cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase","../mvc/FWSMvc":"FWSMvc"}],FWSNodePool:[function(e,t,a){"use strict";var o;cc._RF.push(t,"0b750FJHvtNOrs1UK6Y2gfc","FWSNodePool"),function(e){var t=function(){function e(e,t,a,o,n,i){void 0===t&&(t=0),void 0===a&&(a=-1),void 0===o&&(o=null),void 0===n&&(n=null),void 0===i&&(i=null),this._putCallback=null,this.used=[],this._pool=new cc.NodePool(i),this.creator=e,this._initedCount=t,this._limitCount=a,this._creatorTarget=o,this._putCallback=n,this.createHandler()}return e.prototype.clearHandler=function(){this.putAllHandler(),this._pool.clear()},e.prototype.createHandler=function(){if(this.creator)for(var e=0;e<this._initedCount;e++){var t=null;(t=this._creatorTarget?this.creator.call(this._creatorTarget,this):this.creator(this))&&this._pool.put(t)}},e.prototype.getHandler=function(){var e=null;return this._pool.size()>0&&((e=this._pool.get()).isValid||(e=null)),!e&&this._limitCount<=0&&this.creator&&(e=this._creatorTarget?this.creator.call(this._creatorTarget,this):this.creator(this)),e&&this.used.push(e),e},e.prototype.putHandler=function(e){if(e){var t=this.used.indexOf(e);t>=0&&(this.used.splice(t,1),e.isValid&&(this._putCallback&&this._putCallback.handler.call(this._putCallback.target,e),this._pool.put(e)))}},e.prototype.putAllHandler=function(){for(var e=0;e<this.used.length;e++){var t=this.used[e];t.isValid&&this._pool.put(t)}this.used.splice(0,this.used.length)},Object.defineProperty(e.prototype,"limitCount",{get:function(){return this._limitCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initedCount",{get:function(){return this._initedCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usedCount",{get:function(){return this.used.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"freedCount",{get:function(){return this._pool.size()},enumerable:!0,configurable:!0}),e.prototype.getNode=function(){return this.getHandler()},e.prototype.putNode=function(e){this.putHandler(e)},e.prototype.putAllNodes=function(){this.putAllHandler()},e.prototype.reset=function(){this.clearHandler(),this.createHandler()},e.prototype.clear=function(){this.clearHandler()},e.prototype.destory=function(){this.putAllHandler();for(var e=this._pool.size(),t=0;t<e;t++){this._pool.get().destroy()}this._pool.clear()},e}();e.NodePool=t,e.createPrefabPool=function(e,a){var o=e;return new t(function(e){return o?cc.instantiate(o):null},0,-1,null,a)}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],FWSTableView:[function(e,t,a){"use strict";cc._RF.push(t,"a4ca0V6dmNKHZKPxGTwcDe+","FWSTableView"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../utils/X"),n=e("../../Game/Tools/GameTools"),i=e("../../Game/Common/ListView/FrameTaskManager"),r=e("../utils/FWSTool"),s=e("./FWSNodePool"),l=function(e){function t(t,a){void 0===a&&(a=!1);var o=e.call(this)||this;return o._delegate=null,o._frameCreateCell=!1,o._isDirtyUpdate=!0,o._prevShowBeginIndex=null,o._prevShowEndIndex=null,o._itemNodeMapping={},o._posAccumulate=[],o._posAccumulateTopToBottom=[],o._viewPortSize=cc.Size.ZERO,o._cellPosCache={},o._cellNodePool=null,o._beforeAnimPosXOffset=588,o._frameTaskKey="createTableViewCell",o._delegate=t,o._frameCreateCell=a,o.init(),o}return __extends(t,e),t.createTableView=function(e,a,o){return void 0===o&&(o=!0),r.Obj.isEmpty(e)&&(e=new t(a,o)),e},t.prototype.init=function(){if(this.checkValid()){var e=this._delegate.content.getComponent(cc.Layout);e&&(e.enabled=!1,e.destroy()),this._delegate.content.safetyDestroyAllChildren(),this._delegate.content.parent&&this._delegate.content.parent.getComponent(cc.Widget)&&this._delegate.content.parent.getComponent(cc.Widget).updateAlignment(),this.initFrameTaskKey();var t=0;this._delegate.preCreateCellNums&&(t=this._delegate.preCreateCellNums()),this._frameCreateCell?this._cellNodePool=new s.NodePool(this.createCellNode,0,-1,this,{target:this,handler:this.nodePoolPutCallback}):(this.preCreateCellNode(t),this._cellNodePool||(this._cellNodePool=new s.NodePool(this.createCellNode,0,-1,this,{target:this,handler:this.nodePoolPutCallback}))),this._isDirtyUpdate=!0,this._delegate.scrollview.horizontal?this._delegate.scrollview.scrollToLeft():this._delegate.scrollview.scrollToTop(),this._delegate.scrollview.node.on("scrolling",this.scrollingEvent,this)}},t.prototype.resetAllCell=function(){this._cellNodePool&&this._cellNodePool.putAllNodes()},t.prototype.reloadDataByIndex=function(e){if(this.reloadData(!0),!(e<0||e>=this._posAccumulateTopToBottom.length)){var t=this._posAccumulateTopToBottom[e],a=this._delegate.scrollview.getScrollOffset();a.x+=t.x,a.y+=t.y,this._delegate.scrollview.scrollToOffset(a),this._isDirtyUpdate=!0,this.reloadUpdateCellShow()}},t.prototype.reloadData=function(e){if(void 0===e&&(e=!1),this.checkValid()){for(var t in this._delegate.scrollview.stopAutoScroll(),this._itemNodeMapping)if(this._itemNodeMapping.hasOwnProperty(t)){var a=this._itemNodeMapping[t];a&&this.removeCellNode(a)}this._itemNodeMapping={},this._cellPosCache={};var o=this._delegate.scrollview.getScrollOffset();this.resetContentSize(),this.resetCellPositionAccumulate(),e?this._delegate.scrollview.horizontal?this._delegate.scrollview.scrollToLeft():this._delegate.scrollview.scrollToTop():this._delegate.scrollview.scrollToOffset(o),this._isDirtyUpdate=!0,this.reloadUpdateCellShow()}},t.prototype.initFrameTaskKey=function(){this._frameTaskKey="createTableViewCell";var e=this._delegate.node;cc.isValid(e)&&(this._frameTaskKey+=e.uuid)},t.prototype.resetContentSize=function(){var e=this._delegate.scrollview.horizontal;this._delegate.content.width=0,this._delegate.content.height=0;for(var t=0,a=0,o=this._delegate.numberOfCellsInTableView(),n=0;n<o;n++){var i=this._delegate.tableCellSizeForIndex(n);t+=i.width,a+=i.height}e?(this._delegate.content.width=t,this._delegate.content.height=this._delegate.scrollview.node.getBoundingBox().height):(this._delegate.content.width=this._delegate.scrollview.node.getBoundingBox().width,this._delegate.content.height=a)},t.prototype.resetCellPositionAccumulate=function(){var e=this._delegate.scrollview.horizontal,t=0,a=0;this._posAccumulate=[],this._posAccumulateTopToBottom=[];for(var o=this._delegate.numberOfCellsInTableView(),n=0;n<o;n++)if(e){this._posAccumulate[n]=new cc.Vec2(t,0),t+=(r=this._delegate.tableCellSizeForIndex(n)).width}else{this._posAccumulateTopToBottom[n]=new cc.Vec2(0,a);var i=o-n-1,r=this._delegate.tableCellSizeForIndex(i);this._posAccumulate[i]=new cc.Vec2(0,a),a+=r.height}},t.prototype.scrollingEvent=function(){this.touchUpdateCellShow()},t.prototype.touchUpdateCellShow=function(){this.updateCellShow()},t.prototype.reloadUpdateCellShow=function(){this.updateCellShow()},t.prototype.updateCellShow=function(){var e=this._delegate.numberOfCellsInTableView();if(e<=0)i.FrameTaskManager.getInstance().removeTask(this._frameTaskKey);else{var t,a,o=this._delegate.content.getBoundingBox(),n=o.x,r=o.y,s=o.width,l=o.height,c=this._delegate.content.parent,d=c.anchorX,p=c.anchorY,u=c.getBoundingBox(),h=new cc.Size(u.width,u.height),m=n+h.width*d,f=r+h.height*p,_=-1,y=-1;this._delegate.scrollview.horizontal?(_=0-m,y=s-this._viewPortSize.width-Math.abs(m)):(_=l-this._viewPortSize.height-Math.abs(f),y=0-f);var g=this.getShowIndex(_,y);t=g.showBeginIndex,a=g.showEndIndex;var C=this._isDirtyUpdate||null===this._prevShowBeginIndex||null===this._prevShowEndIndex,v=null!==this._prevShowBeginIndex&&null!==this._prevShowEndIndex&&(this._prevShowBeginIndex!==t||this._prevShowEndIndex!==a),I=C||v,T=[];if(C)for(var S=t;S<=a;S++)T.push(S);else if(v)for(S=t;S<=a;S++)if(S>this._prevShowEndIndex||S<this._prevShowBeginIndex)T.push(S);else{var A=S.toString();(D=this._itemNodeMapping[A])||T.push(S)}if(this._isDirtyUpdate=!1,this._prevShowBeginIndex=t,this._prevShowEndIndex=a,I){i.FrameTaskManager.getInstance().removeTask(this._frameTaskKey);for(S=0;S<t;S++){A=S.toString();(D=this._itemNodeMapping[A])&&(this.removeCellNode(D),this._itemNodeMapping[A]=null)}for(S=a+1;S<e-1;S++){var D;A=S.toString();(D=this._itemNodeMapping[A])&&(this.removeCellNode(D),this._itemNodeMapping[A]=null)}for(S=0;S<T.length;S++){var N=T[S];this.createCell(N)}}}},t.prototype.createCell=function(e){var t=function(e){if(n.default.verifyComponent(this._delegate)){var t=e.toString(),a=this._itemNodeMapping[t];if(!a){var o=this.getCellNode();if(!o)return;this._itemNodeMapping[t]=o,this._delegate.content.addChild(o),(a=o).opacity=0}var i=this.getCellPosByIndex(a,e);this._delegate.scrollview.horizontal?a.x=i.x:a.y=i.y,this._delegate.tableCellAtIndex(a,e),a.opacity=255}}.bind(this,e);if(this._frameCreateCell){var a=new i.FrameTask(t,this._frameTaskKey);i.FrameTaskManager.getInstance().addTask(a)}else t()},t.prototype.getCellPosByIndex=function(e,t){if(this._cellPosCache[t])return this._cellPosCache[t];var a=cc.Vec2.ZERO;this._cellPosCache[t]=a;var o=this._delegate.content.width,n=this._delegate.content.height,i=this._delegate.content.anchorX,r=this._delegate.content.anchorY;if(t<0||t>=this._posAccumulate.length)return a;var s=this._delegate.scrollview.horizontal,l=this._posAccumulate[t],c=this._delegate.tableCellSizeForIndex(t),d=e.anchorX,p=e.anchorY;return s?a.x=l.x+c.width*d:a.y=l.y+c.height*p,s?a.x=a.x-o*i:a.y=a.y-n*r,a},t.prototype.getShowIndex=function(e,t){var a={showBeginIndex:-1,showEndIndex:-1},o=this._delegate.numberOfCellsInTableView();if(o<=0)return a;var n=0,i=o-1;if(e>0)for(var r=0,s=0;s<o;s++){var l=this._delegate.tableCellSizeForIndex(s),c=0;if(r+(c=this._delegate.scrollview.horizontal?l.width:l.height)>e){n=s;break}r+=c}if(t>0)for(r=0,s=o-1;s>=0;s--){l=this._delegate.tableCellSizeForIndex(s),c=0;if(r+(c=this._delegate.scrollview.horizontal?l.width:l.height)>t){i=s;break}r+=c}if(a.showBeginIndex=n,a.showEndIndex=i,this._delegate.resizeShowNums){var d=this._delegate.resizeShowNums();a.showBeginIndex=Math.max(0,a.showBeginIndex-d[0]),a.showEndIndex=Math.min(o-1,a.showEndIndex+d[1])}return a},t.prototype.checkValid=function(){var e=!1;do{if(!this._delegate)break;if(!this._delegate.scrollview)break;if(!this._delegate.content)break;if(!this._delegate.itemPrefabNode)break;if(!this._delegate.tableCellAtIndex)break;if(!this._delegate.tableCellSizeForIndex)break;if(!this._delegate.numberOfCellsInTableView)break;if(!1!==this._delegate.scrollview.horizontal&&this._delegate.scrollview.vertical)break;this._viewPortSize.width=this._delegate.scrollview.node.width,this._viewPortSize.height=this._delegate.scrollview.node.height,e=!0}while(0);return e},t.prototype.preCreateCellNode=function(e){e<=0||this._delegate&&this._delegate.itemPrefabNode&&(this._cellNodePool=new s.NodePool(this.createCellNode,e,-1,this,{target:this,handler:this.nodePoolPutCallback}))},t.prototype.getCellNode=function(){return this._cellNodePool.getNode()},t.prototype.removeCellNode=function(e){this._cellNodePool.putNode(e)},t.prototype.nodePoolPutCallback=function(e){e&&e.isValid&&e.removeComponent(cc.Animation)},t.prototype.cpnDisable=function(){this.onDisableTableView()},t.prototype.onDestroyTableView=function(){this._cellNodePool&&(this._cellNodePool.destory(),this._cellNodePool=null),this._itemNodeMapping={}},t.prototype.onDisableTableView=function(){try{if(this._delegate.scrollview.node)this._delegate.scrollview.horizontal?this._delegate.scrollview.scrollToLeft():this._delegate.scrollview.scrollToTop()}catch(e){o.log("onDisableTableView catch error",e)}this._cellNodePool&&this._cellNodePool.putAllNodes()},t.prototype.createCellNode=function(e){if(!e)return null;var t=cc.instantiate(this._delegate.itemPrefabNode);if(t){t.active=!0;var a=t.getComponent(cc.Animation);a&&a.destroy()}return t},t}(e("../../System/ComponentBase").default);a.FWSTableView=l,cc._RF.pop()},{"../../Game/Common/ListView/FrameTaskManager":"FrameTaskManager","../../Game/Tools/GameTools":"GameTools","../../System/ComponentBase":"ComponentBase","../utils/FWSTool":"FWSTool","../utils/X":"X","./FWSNodePool":"FWSNodePool"}],MsgBox:[function(e,t,a){"use strict";cc._RF.push(t,"64af0d/b3FDMoGOCkIDi6Ld","MsgBox");var o,n=e("../utils/X"),i=e("../../Core/Common/LocalManager"),r=e("./factory/LocalAssertLoader"),s=e("./factory/FWSAssertCaches");(function(e){var t;(function(e){e[e.Green=0]="Green",e[e.Blue=1]="Blue",e[e.Red=2]="Red",e[e.Orange=3]="Orange"})(t=e.MsgBoxButtonStyle||(e.MsgBoxButtonStyle={})),e.fontReady=!1;var a,o=!0,l="100127",c="102252",d="102251",p="ea_prefab/ui/comm/MsgBoxComponent",u=[],h=!1,m=0;function f(){h||(e.container=_(),e.container.zIndex=2e3,e.container.setPosition(cc.winSize.width/2,cc.winSize.height/2),cc.director.getScene().addChild(e.container),cc.game.addPersistRootNode(e.container))}function _(){var e=new cc.Node;return e.setContentSize(cc.winSize),e}function y(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(e){0==t.length&&t.push({text:"OK",callback:function(){}});var o={instanceId:++m,options:e,buttons:t};return u.push(o),g(),m}}function g(){if(f(),0!=u.length){var t=u[0];if(!t.node){if(t.node=_(),e.container.addChild(t.node),n.log("(MsgBox)",t),o&&a)return a.show(t),t.component=a,void t.node.addChild(a.node);var i=new r.LocalAssertLoader(p,cc.Prefab);i.onCompleted={target:null,handler:function(){if(u.indexOf(t)>=0){var e=s.getPrefab(p),n=cc.instantiate(e),i=n.getComponent("MsgBoxComponent");i&&(t.component=i,i.show(t)),t.node.addChild(n),o&&(a=i)}}},i.onError={target:null,handler:function(){u.indexOf(t)>=0&&(i.reset(),i.begin())}},i.begin()}}}e.init=f,e.clear=function(){for(var e=0;e<u.length;e++){var t=u[e];t.component&&(o?t.component.node&&t.component.node.removeFromParent(!1):t.component.node&&t.component.node.destroy())}u.length=0},e.clearById=function(e){for(var t=-1,a=0;a<u.length;a++){var n=u[a];if(n.instanceId===e){t=a,o?n.component.node&&n.component.node.removeFromParent(!1):n.component.node&&n.component.node.destroy();break}}t>=0&&u.splice(t,1)},e.show=y,e.close=function(e){o?e.node.removeFromParent(!1):e.node.destroy(),e.ownerCaller.node.destroy(),u.splice(0,1),g()},e.next=g,e.alert=function(e,a,o,n){return void 0===a&&(a=null),void 0===o&&(o=null),void 0===n&&(n=null),y({title:a||i.LOCAL.getTextOrEmpty(l)||"Tips",content:e,target:o},{text:i.LOCAL.getTextOrEmpty(c)||"Ok",style:t.Blue,callback:n})},e.confirm=function(e,a,o,n,r,s,p){void 0===a&&(a=null),void 0===o&&(o=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===p&&(p=null),y({title:a||i.LOCAL.getTextOrEmpty(l)||"Tips",content:e,target:o},{text:s||i.LOCAL.getTextOrEmpty(c)||"Ok",style:t.Blue,callback:n},{text:p||i.LOCAL.getTextOrEmpty(d)||"Cancel",style:t.Orange,callback:r})}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../utils/X":"X","./factory/FWSAssertCaches":"FWSAssertCaches","./factory/LocalAssertLoader":"LocalAssertLoader"}],DialogContentComponent:[function(e,t,a){"use strict";cc._RF.push(t,"ea8337z5d5PUp9DfRi7rYy6","DialogContentComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../System/ComponentBase"),n=e("../../../Core/Event/EventCenter"),i=e("../../../Game/Const/EventId"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onShow=function(e){n.EVENT.emit(i.EventId.GuideNodeOnUI,this.node)},t.prototype.afterFrameClose=function(){},t.prototype.onResourceLoadProgress=function(){},t.prototype.onResourceLoadCompleted=function(){},t=__decorate([s],t)}(o.default));a.default=l,cc._RF.pop()},{"../../../Core/Event/EventCenter":"EventCenter","../../../Game/Const/EventId":"EventId","../../../System/ComponentBase":"ComponentBase"}],DialogFrameComponent:[function(e,t,a){"use strict";cc._RF.push(t,"9135506FW1AFad2X1yr1kkF","DialogFrameComponent"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../../../Game/Common/BaseUI"),n=e("../../../Core/Common/LocalManager"),i=e("../../task/FWSTask"),r=e("../../../Game/Tools/GameTools"),s=e("../factory/LocalAssertLoader"),l=e("../factory/FWSAssertCaches"),c=e("../../utils/FWSTool"),d=e("../../utils/X"),p=e("../../../System/ErrorUtils"),u=e("../MsgBox"),h=cc._decorator,m=h.ccclass,f=h.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dfcTitle=null,t.dfcContent=null,t.dfcFrame=null,t.dfcTip=null,t.topBG=null,t}return __extends(t,e),t.prototype.onFrameLoad=function(e){d.log("DialogFrameComponent::onFrameLoad",e)},t.prototype.onShow=function(t){e.prototype.onShow.call(this,t),this.showParams=t,this.loadResources()},t.prototype.afterClose=function(){this.dialogContent&&this.dialogContent.afterFrameClose&&this.dialogContent.afterFrameClose()},t.prototype.cpnDisable=function(){e.prototype.cpnDisable.call(this),this.loadingTasks&&(this.loadingTasks.onError=this.loadingTasks.onCompleted=this.loadingTasks.onProgress=null,this.loadingTasks.cancel(),this.loadingTasks=null),1!==this.dataInfo.initType&&this.dfcContent.safetyDestroyAllChildren()},t.prototype.loadResources=function(){this.dataInfo&&this.dataInfo.frameOptions&&this.dfcTitle&&(this.dfcTitle.string=n.LOCAL.getText(this.dataInfo.frameOptions.title||"")),this.loadingTasks||(this.loadingTasks=new i.TaskList,this.loadingTasks.onError={target:this,handler:this.onLoadingError},this.loadingTasks.onCompleted={target:this,handler:this.onLoadingComplete},this.loadingTasks.onProgress={target:this,handler:this.onLoadingProgress},this.getDialogContentUrl(),d.log("\u52a0\u8f7d\u5bf9\u8bdd\u6846\u5185\u5bb9:",this.dialogContentUrl),this.loadingTasks.add(new s.LocalAssertLoader(this.dialogContentUrl,cc.Prefab,!this.dataInfo||1!==this.dataInfo.initType)),this.loadingTasks.add(new i.FunctionTask(function(){try{this.onContentLoaded()}catch(t){var e=new p.ErrorInfo;e.errMsgInfo=t,e.funcName="DialogFrameComponent@onContentLoaded",e.customInfo=this.dialogContentUrl,p.ErrorUtils.errorMessage(e)}},this,"")),this.resourceTasks=new i.TaskList,this.resourceTasks.asyncMode=!0,this.loadingTasks.add(this.resourceTasks),this.loadingTasks.begin())},t.prototype.getDialogContentUrl=function(){if(this.dialogContentUrl="",this.dataInfo){this.dataInfo.uiPath?this.dialogContentUrl="ea_prefab/"+this.dataInfo.uiPath+"/"+this.dataInfo.name:this.dialogContentUrl="ea_prefab/"+this.dataInfo.name}},t.prototype.onContentLoaded=function(){if(r.default.verifyComponent(this)){var e=null;if(this.dfcContent.childrenCount<=0){var t=l.getPrefab(this.dialogContentUrl);if(!t)return;if(!(a=cc.instantiate(t)))return;(e=a.getComponent("DialogContentComponent"))&&(e.ownerDialogFrame=this),this.dfcContent.addChild(a),d.log("DialogFrameComponent \u521b\u5efa\u5185\u5bb9")}else{var a;(e=(a=this.dfcContent.children[0]).getComponent("DialogContentComponent"))&&(e.ownerDialogFrame=this),d.log("DialogFrameComponent \u590d\u7528\u5185\u5bb9")}if(e&&this.dfcFrame&&this.dataInfo&&this.dataInfo.frameOptions&&(c.Obj.isEmpty(this.dataInfo.frameOptions.width)||(this.dfcFrame.width=this.dataInfo.frameOptions.width),c.Obj.isEmpty(this.dataInfo.frameOptions.height)||(this.dfcFrame.height=this.dataInfo.frameOptions.height)),this.dialogContent=e,e&&e.needResources)for(var o=0;o<e.needResources.length;o++){var n=e.needResources[o];this.resourceTasks.add(new s.LocalAssertLoader(n,cc.Prefab,!this.dataInfo||1!==this.dataInfo.initType))}e&&e.onShow&&e.onShow(this.showParams),this.dfcTip&&e&&e.UIDescription?(this.dfcTip.active=!0,this.uides=e.UIDescription):this.dfcTip&&(this.dfcTip.active=!1)}},t.prototype.onLoadingError=function(){r.default.verifyComponent(this)},t.prototype.onLoadingProgress=function(){r.default.verifyComponent(this)},t.prototype.onLoadingComplete=function(){r.default.verifyComponent(this)},t.prototype.showUITips=function(){this.uides&&u.alert(this.uides,n.LOCAL.getText("100127"),this)},__decorate([f(cc.Label)],t.prototype,"dfcTitle",void 0),__decorate([f(cc.Node)],t.prototype,"dfcContent",void 0),__decorate([f(cc.Node)],t.prototype,"dfcFrame",void 0),__decorate([f(cc.Node)],t.prototype,"dfcTip",void 0),__decorate([f(cc.Sprite)],t.prototype,"topBG",void 0),t=__decorate([m],t)}(o.default);a.default=_,cc._RF.pop()},{"../../../Core/Common/LocalManager":"LocalManager","../../../Game/Common/BaseUI":"BaseUI","../../../Game/Tools/GameTools":"GameTools","../../../System/ErrorUtils":"ErrorUtils","../../task/FWSTask":"FWSTask","../../utils/FWSTool":"FWSTool","../../utils/X":"X","../MsgBox":"MsgBox","../factory/FWSAssertCaches":"FWSAssertCaches","../factory/LocalAssertLoader":"LocalAssertLoader"}],FWSAssertCaches:[function(e,t,a){"use strict";cc._RF.push(t,"6f943sHaGFH+piPs2HVb09l","FWSAssertCaches");var o,n=e("../../data/FWSData"),i=e("../../utils/FWSTool");(function(e){var t=function(){function e(){this._items=new n.Dict}return e.prototype.get=function(e){return this._items.getItem(e)},e.prototype.set=function(e,t){return this._items.setItem(e,t),t},e.prototype.del=function(e){var t=this._items.getItem(e);return this._items.deleteKey(e),t},e.prototype.clear=function(){this._items.clear()},e.prototype.getKeys=function(){return this._items.keys},e.prototype.getValues=function(){return this._items.values},e}();e.FWSAssertCacheItem=t;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.enabledAutoRelease=!0,t._autoReleaseMap=cc.js.createMap(!0),t._autoReleaseList=[],t._checkHandle=null,t}return __extends(t,e),t.prototype.deleteFromAutoReleaseList=function(e){var t=this._autoReleaseMap[e];if(t){var a=t.index,o=this._autoReleaseList.length-1;this._autoReleaseList[a]=this._autoReleaseList[o],this._autoReleaseList[a].index=a,this._autoReleaseList.length=o,delete this._autoReleaseMap[t.key]}},t.prototype.addToReleaseList=function(e){var t=this._autoReleaseMap[e];if(!t){var a=this._autoReleaseList.length;t={key:e,index:a,deadTime:-1},this._autoReleaseMap[e]=t,this._autoReleaseList[a]=t}return t},t.prototype.set=function(e,t){return this.setWithOption(e,t,!1)},t.prototype.setWithOption=function(e,t,a){this.enabledAutoRelease&&this.startCheck(),a=!!t&&a;var o=this.doSet(e,t);return this.enabledAutoRelease&&(a?this.addToReleaseList(e).deadTime=-1:this.deleteFromAutoReleaseList(e)),o},t.prototype.doSet=function(t,a){if(a)a.autoRelease=!1;else{var o=this.get(t);o&&this.releasePrefab(o)}return e.prototype.set.call(this,t,a)},t.prototype.del=function(t){var a=e.prototype.del.call(this,t);return a&&(this.enabledAutoRelease&&this.deleteFromAutoReleaseList(t),this.releasePrefab(a)),a},t.prototype.clear=function(){this._items.foreachValue(this.releasePrefab),e.prototype.clear.call(this),this._autoReleaseList.length=0,this._autoReleaseMap=cc.js.createMap(!0)},t.prototype.releasePrefab=function(e){e.autoRelease=!0},t.prototype.startCheck=function(){if(cc.renderer.jyCustom){if(null===this._checkHandle){var e=this;this._checkHandle=setInterval(function(){if(e.enabledAutoRelease)for(var t=e._autoReleaseList,a=0;a<t.length;){var o=t[a],n=e.get(o.key);if(n){if(n.refCount>0)o.deadTime=-1;else{if(o.deadTime>0&&performance.now()-o.deadTime>3e4){e.del(o.key);continue}-1===o.deadTime&&(o.deadTime=performance.now())}++a}else e.deleteFromAutoReleaseList(o.key)}else e.stopCheck()},5e3)}}},t.prototype.releaseAllDeadPrefab=function(){if(this.enabledAutoRelease)for(var e=this._autoReleaseList,t=0;t<e.length;){var a=e[t],o=this.get(a.key);if(o){if(0===o.refCount){this.del(a.key);continue}++t}else this.deleteFromAutoReleaseList(a.key)}},t.prototype.stopCheck=function(){null!==this._checkHandle&&(clearInterval(this._checkHandle),this._checkHandle=null)},t}(t);e.PrefabCaches=new a,e.TextureCaches=new t,e.AudioCaches=new t,e.ParticleCaches=new t,e.BitmapFontCaches=new t,e.SpriteFrameCaches=new t,e.SpriteAtlasCaches=new t,e.RemoteAtlasCaches=new t,e.RemoteParticleCaches=new t,e.GeneralFileCaches=new t,e.getPrefab=function(t){return e.PrefabCaches.get(t)},e.getTexture=function(t){return e.TextureCaches.get(t)},e.getAudio=function(t){return e.AudioCaches.get(t)},e.getText=function(t){return e.GeneralFileCaches.get(t)},e.getParticle=function(t,a){return void 0===a&&(a=null),e.ParticleCaches.get(t)},e.getBitmapFont=function(t){return e.BitmapFontCaches.get(t)},e.getSpriteFrame=function(t,a,o){void 0===a&&(a=null),void 0===o&&(o=!1);var n=e.SpriteFrameCaches.get(t),r=!o&&i.Str.isEmpty(a);if(!n)for(var s=e.SpriteAtlasCaches.getKeys(),l=0;l<s.length;l++){var c=s[l];if((r||c===a)&&(n=e.SpriteAtlasCaches.get(c).getSpriteFrame(t)))return n}if(!n)for(s=e.RemoteAtlasCaches.getKeys(),l=0;l<s.length;l++)if(c=s[l],(r||c===a)&&(n=e.RemoteAtlasCaches.get(c).frames.get(t)))return n;return n}})(o||(o={})),window.FWSAssertCaches=o,t.exports=o,cc._RF.pop()},{"../../data/FWSData":"FWSData","../../utils/FWSTool":"FWSTool"}],LocalAssertLoader:[function(e,t,a){"use strict";cc._RF.push(t,"2c9b0izjcpPhKpbS22E9qFY","LocalAssertLoader");var o,n=e("../../utils/X"),i=e("../../task/FWSTask"),r=e("./FWSAssertCaches");(function(e){var t=function(e){function t(t,a,o,n){void 0===o&&(o=!1),void 0===n&&(n=!0);var i=e.call(this,"\u6b63\u5728\u52a0\u8f7d\u6e38\u620f\u8d44\u6e90",n)||this;return i._autoRelease=!1,i._key=t,i._type=a,i._autoRelease=o,i}return __extends(t,e),Object.defineProperty(t,"loadCostTime",{get:function(){return t._loadCostTime},enumerable:!0,configurable:!0}),t.prototype.toStringAddon=function(){return"("+this._key+")"},t.prototype.getOverTimeSetting=function(){return 3e4},t.prototype.begin=function(){if(e.prototype.begin.call(this),!this._alreadyBegin){this._alreadyBegin=!0;var a=this;this._beginTimer=(new Date).getTime(),this.callListener(this.onProgress),null!==this._key&&void 0!==this._key&&""!==this._key||n.error("LocalAssertLoader","\u65e0\u6548\u7684\u8d44\u6e90\u8bf7\u6c42");if(this._type){if(t.getFromCache(this._key,this._type)){var o=performance.now();return this.callListener(this.onCompleted,!0),void((i=performance.now())>o&&(t._loadCostTime+=i-o))}cc.loader.loadRes(this._key,this._type,function(e,o){var i=performance.now();e?(n.warn("LocalAssertLoader","\u52a0\u8f7d\u8d44\u6e90\u5931\u8d25",e),a.callListener(a.onError)):(a.addToCache(a._key,o,a._type),a._alreadyCompoleted=!0,a._endTimer=(new Date).getTime(),a.callListener(a.onCompleted,!1));var r=performance.now();r>i&&(t._loadCostTime+=r-i)})}else{if(t.getFromCache(this._key,cc.Prefab)){var i;o=performance.now();return this.callListener(this.onCompleted,!0),void((i=performance.now())>o&&(t._loadCostTime+=i-o))}cc.loader.loadRes(this._key,cc.Asset,function(e,o){var i=performance.now();e?(n.error("LocalAssertLoader","\u52a0\u8f7d\u8d44\u6e90\u5931\u8d25",e),a.callListener(a.onError)):(a.addToCache(a._key,o,cc.Prefab),a._alreadyCompoleted=!0,a._endTimer=(new Date).getTime(),a.callListener(a.onCompleted,!1));var r=performance.now();r>i&&(t._loadCostTime+=r-i)})}}},t.prototype.addToCache=function(e,t,a){a===cc.Prefab?r.PrefabCaches.setWithOption(e,t,this._autoRelease):a===cc.Texture2D?r.TextureCaches.set(e,t):a===cc.ParticleSystem?r.ParticleCaches.set(e,t):a===cc.BitmapFont?r.BitmapFontCaches.set(e,t):a===cc.AudioClip?r.AudioCaches.set(e,t):a===cc.SpriteAtlas?r.SpriteAtlasCaches.set(e,t):a===cc.TextAsset?r.GeneralFileCaches.set(e,t):a===cc.SpriteFrame&&r.SpriteFrameCaches.set(e,t)},t.getFromCache=function(e,t){return t===cc.Prefab?r.PrefabCaches.get(e):t===cc.Texture2D?r.TextureCaches.get(e):t===cc.ParticleSystem?r.ParticleCaches.get(e):t===cc.BitmapFont?r.BitmapFontCaches.get(e):t===cc.AudioClip?r.AudioCaches.get(e):t===cc.SpriteAtlas?r.SpriteAtlasCaches.get(e):t===cc.TextAsset?r.GeneralFileCaches.get(e):t===cc.SpriteFrame?r.SpriteFrameCaches.get(e):null},t.prototype.release=function(){},Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),t.prototype.getResource=function(e){return t.getFromCache(this._key,e)},t._loadCostTime=0,t}(i.Task);e.LocalAssertLoader=t;var a=function(e){function a(){return e.call(this,"\u6b63\u5728\u52a0\u8f7d\u6e38\u620f\u8d44\u6e90")||this}return __extends(a,e),a.prototype.addTask=function(e,a){void 0===a&&(a=null),this._tasks.push(new t(e,a))},a.prototype.addTaskConfig=function(e){if(null!==e&&void 0!==e&&0!==e.length)for(var t=0;t<e.length;t++){var a=e[t];this.addTask(a.key,a.type)}},a.prototype.getItem=function(e,t){for(var a=0;a<this._tasks.length;a++){var o=this._tasks[a];if(o&&o.key===e){var n=o.getResource(t);if(n instanceof t)return n}}return null},a.prototype.getBitmapFont=function(e){return this.getItem(e,cc.BitmapFont)},a.prototype.getPrefab=function(e){return this.getItem(e,cc.Prefab)},a.prototype.getSpriteAtlas=function(e){return this.getItem(e,cc.SpriteAtlas)},a.prototype.getSpriteFrame=function(e,t){var a=this.getSpriteAtlas(e);return a?a.getSpriteFrame(t):null},a.prototype.setSprite=function(e,t,a){if(e&&e.isValid){var o=this.getSpriteFrame(t,a);e.spriteFrame=o}},a.prototype.getSprite=function(e,t){var a=(new cc.Node).addComponent(cc.Sprite);return this.setSprite(a,e,t),a},a.prototype.exist=function(e){for(var t=0;t<this._tasks.length;t++){if(this._tasks[t].key===e)return!0}return!1},a.prototype.release=function(){for(var e=0;e<this._tasks.length;e++){this._tasks[e].release()}},a}(i.TaskList);e.LocalAssertLoaderManager=a})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../task/FWSTask":"FWSTask","../../utils/X":"X","./FWSAssertCaches":"FWSAssertCaches"}],RemoteAssertLoader:[function(e,t,a){"use strict";cc._RF.push(t,"f3fa7pstJNMe5WJ4DoCHIoF","RemoteAssertLoader");var o,n=e("../../task/FWSTask"),i=e("../../utils/FWSTool"),r=e("../../utils/X"),s=e("../../FWSEnv"),l=e("../../../Core/Net/WebClient"),c=e("../../data/FWSData"),d=e("../../utils/HttpUtils"),p=e("./FWSAssertCaches"),u=e("../../../Game/Data/GlobalData"),h=e("../../../Game/Common/LoadManager"),m=e("../../../Core/Common/TableManager"),f=e("../../../System/ErrorUtils");(function(e){e.LARGE_TEXTURE_LOAD_TIME=30,e.SMALL_TEXTURE_LOAD_TIME=20;var t=function(t){function a(e){var a=t.call(this,"\u6b63\u5728\u52a0\u8f7d\u56fe\u7247\u8d44\u6e90")||this;return a._pro=0,a._frames=new c.Dict,a._config=e,a._key=i.Str.getFilename(e.jsonFile),null!==e.imgFile&&void 0!==e.imgFile&&""!==e.imgFile||(e.imgFile=a._key+".png"),a}return __extends(a,t),Object.defineProperty(a.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"progress",{get:function(){return this._pro},enumerable:!0,configurable:!0}),a.prototype.toStringAddon=function(){return"("+this._key+")"},a.prototype.getOverTimeSetting=function(){return 1e3*e.LARGE_TEXTURE_LOAD_TIME},a.prototype.begin=function(){(t.prototype.begin.call(this),null!==this._config.baseUrl&&void 0!==this._config.baseUrl&&""!==this._config.baseUrl||(this._config.baseUrl=u.GLOBAL.ResourceUrl+"/DynRes/"+u.GLOBAL.DynResVer+"/assets/textures/"),this._alreadyBegin)||(this._alreadyBegin=!0,this._pro=0,p.RemoteAtlasCaches.get(this._key)?this.callListener(this.onCompleted):this.onHttpResponsed()||(this.callListener(this.onProgress),this.loadTexture(),this.loadAtlas()))},a.prototype.loadTexture=function(){var e=this;this.onHttpResponsed();var t=this._config.baseUrl+this._config.imgFile,a=t.toString();t=d.getTargetUrl(a),h.LoadManager.load(t,function(o,n){o?(r.error("RemoteAssertLoader","\u52a0\u8f7d\u8d44\u6e90\u5931\u8d25",o),e.callListener(e.onError)):(d.setTargetUrl(a,t),e._texture||(e._texture=n),e._pro+=.5,e.onHttpResponsed())})},a.prototype.afterOverTime=function(){this._req&&this._req.abort(),this._req=null},a.prototype.loadAtlas=function(){var e=this,t=this._config.baseUrl+this._config.jsonFile+".json",a=t.toString();if(t=d.getTargetUrl(a),s.HTTP_CACHE_ENABLED){var o=d.getHttpCache(a);if(!i.Str.isEmpty(o))return this._atlas=JSON.parse(o),this._pro+=.5,void this.onHttpResponsed()}var n=this;this._req&&this._req.abort(),this._req=l.get(t,{},this,function(o){try{n._atlas=JSON.parse(o.responseText),n._pro+=.5,d.setTargetUrl(a,t),s.HTTP_CACHE_ENABLED&&d.setHttpCache(a,o.responseText),e.onHttpResponsed()}catch(e){r.error("RemoteAssertLoader","\u52a0\u8f7d\u8d44\u6e90\u5931\u8d25",e),n.callListener(n.onError)}},function(){n.callListener(n.onError)})},a.prototype.onHttpResponsed=function(){return null!==this._atlas&&void 0!==this._atlas&&(null!==this._texture&&void 0!==this._texture&&(this.parseFrames(),this._alreadyCompoleted=!0,this._pro=1,this.callListener(this.onCompleted),!0))},a.prototype.parseFrames=function(){var e={texture:this._texture,frames:new p.FWSAssertCacheItem};for(var t in this._atlas.frames){var a=i.Str.getFilename(t.toString()),o=this._atlas.frames[t],n=new cc.SpriteFrame(this._texture,cc.rect(o.frame.x,o.frame.y,o.frame.w,o.frame.h),o.rotated,new cc.Vec2(o.spriteSourceSize.x,o.spriteSourceSize.y),new cc.Size(o.sourceSize.w,o.sourceSize.h));n.name=t,e.frames.set(i.Str.getFilename(t),n),this._frames.setItem(a,n)}p.RemoteAtlasCaches.set(this._key,e)},Object.defineProperty(a.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),a.prototype.getSpriteFrame=function(e){return p.getSpriteFrame(e,this._key)},a.prototype.release=function(){this._frames.clear(),this._texture&&(this._texture.destroy(),this._texture=null)},a}(n.Task);e.RemoteTextureLoader=t;var a=function(t){function a(e){var a=t.call(this,"\u6b63\u5728\u52a0\u8f7d\u56fe\u7247\u8d44\u6e90")||this;return a._key=e,a}return __extends(a,t),Object.defineProperty(a.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),a.prototype.toStringAddon=function(){return"("+this._key+")"},a.prototype.notifyError=function(){this.onError&&this.onError.handler&&this.onError.handler.call(this.onError.target,this,this)},a.prototype.getOverTimeSetting=function(){return 1e3*e.SMALL_TEXTURE_LOAD_TIME},a.prototype.begin=function(){if(t.prototype.begin.call(this),!this._alreadyBegin)if(this._alreadyBegin=!0,this._texture)this.callListener(this.onCompleted);else{this.callListener(this.onProgress);var e=this,a=this._key+"";d.isUrl(a)||(a=v(a,g.Image)),h.LoadManager.load(a,function(t,a){t?(r.error("RemoteSingleTextureLoader","\u52a0\u8f7d\u8d44\u6e90\u5931\u8d25",t),e.notifyError()):(e._texture||(e._texture=a),e._alreadyCompoleted=!0,p.TextureCaches.set(e._key,a),e.callListener(e.onCompleted))})}},a.prototype.release=function(){this._texture&&(this._texture.destroy(),this._texture=null)},a}(n.Task);e.RemoteSingleTextureLoader=a;var o=function(t){function a(e){var a=t.call(this,"\u6b63\u5728\u52a0\u8f7dSpriteFrame\u8d44\u6e90")||this;return a._loadingTimestamp=-1,a._key=e,a}return __extends(a,t),Object.defineProperty(a.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"frame",{get:function(){return this._spriteFrame},enumerable:!0,configurable:!0}),a.prototype.toStringAddon=function(){return"("+this._key+")"},a.prototype.notifyError=function(){this.onError&&this.onError.handler&&this.onError.handler.call(this.onError.target,this,this)},a.prototype.getOverTimeSetting=function(){return 1e3*e.SMALL_TEXTURE_LOAD_TIME},a.prototype.begin=function(){if(t.prototype.begin.call(this),!this._alreadyBegin)if(this._alreadyBegin=!0,this._spriteFrame)this.callListener(this.onCompleted,!0);else{this._spriteFrame=p.getSpriteFrame(this._key),this.callListener(this.onProgress);var e=this,a=this._key+"";d.isUrl(a)||(a=v(a,g.Image));var o=performance.now();this._loadingTimestamp=o,h.LoadManager.load(a,function(t,a){o===e._loadingTimestamp&&(e._loadingTimestamp=-1,t?(r.error("RemoteSingleTextureLoader","\u52a0\u8f7d\u8d44\u6e90\u5931\u8d25",t),e.notifyError()):(e._spriteFrame=new cc.SpriteFrame(a),e._alreadyCompoleted=!0,p.SpriteFrameCaches.set(e._key,e._spriteFrame),e.callListener(e.onCompleted)))})}},a.prototype.reset=function(){t.prototype.reset.call(this),this._loadingTimestamp=-1,this._spriteFrame=null},a.prototype.cancel=function(){t.prototype.cancel.call(this),this._loadingTimestamp=-1,this._spriteFrame=null},a}(n.Task);e.RemoteSpriteFrameLoader=o;var _=function(e){function t(t,a,o){var n=e.call(this,"\u6b63\u5728\u52a0\u8f7d\u6587\u672c\u8d44\u6e90")||this;return n._key=t,n._type=a,n._cb=o,n}return __extends(t,e),t.prototype.toStringAddon=function(){return"("+this._key+")"},Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),t.prototype.notifyError=function(){this.onError&&this.onError.handler&&this.onError.handler.call(this.onError.target,this,this)},t.prototype.changeKey=function(e){e&&(this._key=e)},t.prototype.afterOverTime=function(){this._req&&this._req.abort(),this._req=null},t.prototype.begin=function(){var t=this;if(e.prototype.begin.call(this),!this._alreadyBegin)if(this._alreadyBegin=!0,this._text)this.callListener(this.onCompleted);else{this.callListener(this.onProgress);var a=this,o=v(this._key,this._type);this._req&&this._req.abort(),this._req=l.get(o,{},this,function(e){try{t._text=e.responseText,t._alreadyCompoleted=!0,t._text&&t._cb&&t._cb.func.call(t._cb.target,t._key,t._text)?t.callListener(t.onCompleted):t.notifyError()}catch(e){r.error("RemoteTextLoader","\u52a0\u8f7d\u8fdc\u7a0b\u6587\u672c\u5931\u8d25",e),t.notifyError()}a._req=null},function(){t.notifyError(),a._req=null})}},t}(n.Task);e.RemoteTextLoader=_;var y=function(e){function t(t,a,o){var n=e.call(this,"\u6b63\u5728\u52a0\u8f7d\u6587\u672c\u8d44\u6e90")||this;return n._key=t,n._type=a,n._cb=o,n._useCache=!0,n}return __extends(t,e),t.prototype.notifyError=function(){this.onError&&this.onError.handler&&this.onError.handler.call(this.onError.target,this,this)},t.prototype.afterOverTime=function(){this._req&&this._req.abort(),this._req=null},t.prototype.begin=function(){var t=this;if(e.prototype.begin.call(this),!this._alreadyBegin)if(this._alreadyBegin=!0,this._text)this.callListener(this.onCompleted);else{this.callListener(this.onProgress);var a=this,o=v(this._key,this._type);this._req&&this._req.abort(),this._req=l.get(o,{},this,function(e){try{var o=e.responseText;if(o){var n=o.split("^--");n&&3==n.length?(a._text=n[1],t._cb&&t._cb.func&&t._cb.func.call(t._cb.target,n[1]),a.callListener(a.onCompleted)):a.notifyError()}else a.notifyError()}catch(e){var i=new f.ErrorInfo;i.funcName="BatchTableCompleteCallback",i.errMsgInfo=e,i.customInfo="batchTable parse error!",f.ErrorUtils.errorMessage(i),a._text=null,a._useCache=!1,a.notifyError()}a._req=null},function(){a.notifyError(),a._req=null},this._useCache,45e3)}},t}(n.Task);e.RemoteBatchTableLoader=y;var g,C=function(e){function t(t,a,o){var n=e.call(this,"\u6b63\u5728\u52a0\u8f7d\u6587\u672c\u8d44\u6e90")||this;return n._debugStatusInfo="\u5931\u8d25",n._key=t,n._type=a,n._cb=o,n}return __extends(t,e),t.prototype.getDebugStatusInfo=function(){return this._debugStatusInfo},t.prototype.notifyError=function(){this.onError&&this.onError.handler&&this.onError.handler.call(this.onError.target,this,this)},t.prototype.afterOverTime=function(){this._req&&this._req.abort(),this._req=null},t.prototype.begin=function(){var t=this;if(e.prototype.begin.call(this),!this._alreadyBegin)if(this._alreadyBegin=!0,this._text)this.callListener(this.onCompleted);else{this.callListener(this.onProgress);var a=this,o=v(this._key,this._type);this._req&&this._req.abort(),this._req=l.get(o,{},this,function(e){try{a._text=e.responseText,a._alreadyCompoleted=!0,a._text&&m.TABLE.parseTable(a._text,a._key)?a.callListener(a.onCompleted):(t._debugStatusInfo="\u89e3\u91ca\u5931\u8d25,\u6587\u672c\u5b57\u957f"+(a._text?a._text.length:0),a.notifyError())}catch(e){t._debugStatusInfo="\u89e3\u91ca\u62a5\u9519,\u8bf7\u67e5\u9605type:CodeError";var o=new f.ErrorInfo;o.funcName="SingleTableCompleteCallback",o.errMsgInfo=e,o.customInfo="singleTable parse error!",f.ErrorUtils.errorMessage(o),a.notifyError()}a._req=null},function(e){t._debugStatusInfo="http\u8bf7\u6c42\u5931\u8d25, \u8bf7\u67e5\u9605type:http",a.notifyError(),a._req=null})}},t}(n.Task);function v(e,t){var a="",o="",n="";switch(t){case g.Table:a=".txt",o="/assets/table/",n=u.GLOBAL.ResourceUrl+"/DynRes/"+u.GLOBAL.DynResVer+o+e+"_"+u.GLOBAL.DynResVer+a;break;case g.Locale:a=".txt",o="/assets/locale/",n=u.GLOBAL.ResourceUrl+"/DynRes/"+u.GLOBAL.LangVer+o+e+"_"+u.GLOBAL.LangVer+a;break;case g.Image:a="",new RegExp(/\.\w+$/).test(e)||(a=".png"),o="images/",n=u.GLOBAL.ResourceUrl+"/DynRes/"+o+e+a;break;default:a=".png",o="images/",n=u.GLOBAL.ResourceUrl+"/DynRes/"+o+e+a}return!1===window.OnlineServer&&console.log(n),n}e.RemoteTableLoader=C,function(e){e[e.Image=0]="Image",e[e.Table=1]="Table",e[e.Locale=2]="Locale"}(g=e.RemoteAssetType||(e.RemoteAssetType={})),e.GetDynImageResUrl=function(e){return u.GLOBAL.ResourceUrl+"/DynRes/images/"+e},e.GetDynResUrl=v})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../../Core/Common/TableManager":"TableManager","../../../Core/Net/WebClient":"WebClient","../../../Game/Common/LoadManager":"LoadManager","../../../Game/Data/GlobalData":"GlobalData","../../../System/ErrorUtils":"ErrorUtils","../../FWSEnv":"FWSEnv","../../data/FWSData":"FWSData","../../task/FWSTask":"FWSTask","../../utils/FWSTool":"FWSTool","../../utils/HttpUtils":"HttpUtils","../../utils/X":"X","./FWSAssertCaches":"FWSAssertCaches"}],FWSMvc:[function(e,t,a){"use strict";cc._RF.push(t,"7de0axu3EdDGZ9RuPPl6lNK","FWSMvc");var o,n=e("../data/FWSData"),i=e("../utils/X"),r=e("../FWSEnv"),s=e("../../System/ErrorUtils"),l=e("../../System/ComponentBase");(function(e){e.MVC_MSG_HANDLER_TRACE=!1,e.MVC_CONNECTION_TRACE=!1,e.MVC_CONTEXT_TRY_CATCH=!0,e.MVC_CONTEXT_TRACE_TIME=!0;var t=function(){function e(e,t,a){void 0===a&&(a=""),this._key=e,this._queue=a,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._sended=!1,this._completed=!1},e.prototype.send=function(){this._sended||(d().send(this),this._sended=!0)},e.prototype.complete=function(){this._completed||(this._completed=!0,d().complete(this))},Object.defineProperty(e.prototype,"key",{get:function(){return this._key},set:function(e){this._key=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queue",{get:function(){return this._queue},set:function(e){this._queue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){return this._completed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sended",{get:function(){return this._sended},enumerable:!0,configurable:!0}),e.prototype.toString=function(){var e=this._key+", ";for(var t in this._data){var a=this._data[t];a=null===a?"null":void 0===a?"undefined":a.toString(),e.length>0&&(e+=","),e+=t+"="+a}return e},e}();e.FMessage=t;var a=function(){function e(){this._messageConnectionActived=!1}return e.prototype.connect=function(){d().connect(this),this.onConnect()},e.prototype.disconnect=function(){d().disconnect(this),this.onDisconnect()},e.prototype.onConnect=function(){},e.prototype.onDisconnect=function(){},e.prototype.onFMessage=function(e){var t="onFMessage_"+e.key,a=this[t];if(a)try{return!a.call(this,e)}catch(e){var o=new s.ErrorInfo;return o.funcName=t,o.errMsgInfo=e,o.customInfo="FMessageConnectionAbstract onFMessage",s.ErrorUtils.errorMessage(o),!1}return!1},e.prototype.onEnterContextMember=function(){this._messageConnectionActived=!0,this.connect()},e.prototype.onLeaveContextMember=function(){this._messageConnectionActived=!1,this.disconnect()},Object.defineProperty(e.prototype,"messageConnectionActived",{get:function(){return this._messageConnectionActived},enumerable:!0,configurable:!0}),e}();e.FMessageConnectionAbstract=a;var o=function(){function e(e){this._owner=e}return e.prototype.connect=function(){d().connect(this),this.onConnect()},e.prototype.disconnect=function(){d().disconnect(this),this.onDisconnect()},e.prototype.onConnect=function(){},e.prototype.onDisconnect=function(){},e.prototype.onFMessage=function(e){var t="onFMessage_"+e.key,a=this._owner[t];if(a)try{return!a.call(this._owner,e)}catch(e){var o=new s.ErrorInfo;return o.funcName=t,this._owner&&this._owner instanceof l.default&&(o.component=this._owner.getName()),o.errMsgInfo=e,o.customInfo="FMessageConnectionDelegate onFMessage",s.ErrorUtils.errorMessage(o),!1}return!1},e.prototype.onEnterContextMember=function(){this._messageConnectionActived=!0,this.connect()},e.prototype.onLeaveContextMember=function(){this._messageConnectionActived=!1,this.disconnect()},Object.defineProperty(e.prototype,"messageConnectionActived",{get:function(){return this._messageConnectionActived},enumerable:!0,configurable:!0}),e}();e.FMessageConnectionDelegate=o;var c=function(){function t(){if(t._router)throw"FMessageRouter\u88ab\u8bbe\u8ba1\u4e3a\u5355\u4f8b, \u4e0d\u80fd\u521b\u5efa\u591a\u4e2a\u5b9e\u4f8b";this._queues=new n.Dict,this._connections=new n.List}return t.prototype.createQueue=function(e){this._queues.containKey(e)||this._queues.setItem(e,new n.Queue)},t.prototype.removeQueue=function(e){this._queues.containKey(e)&&this._queues.deleteKey(e)},t.prototype.removeAllQueues=function(){this._queues.clear()},t.prototype.getQueue=function(e){return this._queues.containKey(e)?this._queues.getItem(e):null},t.prototype.clearQueueMessages=function(e){i.log("FMessage","clearQueueMessages",e),this._queues.containKey(e)&&this._queues.getItem(e).clear()},t.prototype.clearAllQueueMessages=function(){for(var e=this._queues.keys,t=0;t<e.length;t++){var a=e[t];this._queues.getItem(a).clear()}},t.prototype.connect=function(t){this._connections.indexOf(t)>=0||(this._connections.add(t),e.MVC_CONNECTION_TRACE&&i.log("(\u8def\u7531) \u63a5\u5165",t))},t.prototype.disconnect=function(t){this._connections.indexOf(t)>=0&&(this._connections.remove(t),e.MVC_CONNECTION_TRACE&&i.log("(\u8def\u7531) \u65ad\u5f00",t))},t.prototype.disconnectAll=function(){this._connections.clear()},t.prototype.send=function(t){if(!t.sended)if(this._queues.containKey(t.queue)){var a=this._queues.getItem(t.queue);a.add(t),1===a.length?this.push(t):e.Router().update()}else this.push(t)},t.prototype.push=function(t){r.DEBUG_MVC_TRACE&&(e.mvcMsgTraceChecker&&e.mvcMsgTraceChecker(t)||i.log("(FMessage)\u63a8\u9001",t.queue,t));for(var a=this._connections.toArray(),o=0,n=0;n<a.length;n++){var s=a[n];try{s.onFMessage(t)&&(o++,e.MVC_MSG_HANDLER_TRACE&&(e.mvcMsgTraceChecker&&e.mvcMsgTraceChecker(t)||r.DEBUG_MVC_TRACE&&i.log("(FMessage)\u5904\u7406",s)))}catch(e){i.error(e)}}0===o&&t.complete()},t.prototype.complete=function(t){this._queues.keys.indexOf(t.queue),e.Router().update()},t.prototype.update=function(){for(var e=this._queues.keys,t=0;t<e.length;t++){var a=e[t],o=this._queues.getItem(a);o.current&&o.current.completed&&(o.remove(),o.current&&d().push(o.current))}},t}();function d(){return c._router||(c._router=new c),c._router}e.Router=d})(o||(o={})),window.MVC=o,o.mvcMsgTraceChecker=function(e){return",LoadingMsgsProgress,onWSCmdBeep,".indexOf(e.key)>=0||("WebSocketSend"===e.key&&10101===e.data.id||"WebSocketOnReceive"===e.key&&10101===e.data.id)},t.exports=o,cc._RF.pop()},{"../../System/ComponentBase":"ComponentBase","../../System/ErrorUtils":"ErrorUtils","../FWSEnv":"FWSEnv","../data/FWSData":"FWSData","../utils/X":"X"}],AIEventDefine:[function(e,t,a){"use strict";cc._RF.push(t,"31af39Rbs5BfKilBeDAH4Xn","AIEventDefine");var o,n=e("../../Game/Const/GameDefine"),i=e("../../Core/Common/LocalManager"),r=e("../../Game/controllers/ExchangeController"),s=e("../../Core/Common/TableManager"),l=e("../../Game/controllers/RewardController"),c=e("../../Game/Data/DataCenter"),d=e("../utils/LocalStorageUtils"),p=e("../../Game/Const/TableName");(function(e){var t=function(){function e(){}return e.available=function(){return c.DATA.UserData.FunctionOn(n.FunctionKey.g123_record_click_view)},e.MainUIButtonClick=function(e,t){if(this.available())return{action:"g_click",data:{item_id:"btn_"+t,item_type:"menu",item_name:e,item_referer:"MainUI"}}},e.FirstGiftShowEvent=function(e){if(this.available()){var t=13005,a=r.ExchangeController.Instance.getCanPayExchangeConfigById(t);return a||(t=13003,(a=r.ExchangeController.Instance.getCanPayExchangeConfigById(13003))||(t=13004)),this.CommonGiftShowEvent(t,e)}},e.CommonGiftShowEvent=function(e,t){if(this.available()&&r.ExchangeController.Instance.getCanPayExchangeConfigById(e)){var a=this.GiftBaseEventData(e);if(void 0!==t){var o={item_referer:t};Object.assign(a.data,o)}return a}},e.GiftBaseEventData=function(e){if(this.available()&&e){var t=r.ExchangeController.Instance.getCanPayExchangeConfigById(e);if(t){var a=t.reward,o=r.ExchangeController.Instance.getExchangeRewardByRewardId(a),s=l.RewardController.Instance.convertClientConfigRewardToCommonReward(o);s.gold.count+=t.gold;for(var c=[s.coin,s.wood,s.oil,s.gold,s.energy,s.exp],d=[n.ResourceType.Coin,n.ResourceType.Wood,n.ResourceType.Oil,n.ResourceType.Gold,n.ResourceType.Energy,n.ResourceType.Exp],p="",u=Math.min(c.length,d.length),h=0;h<u;h++){var m=c[h];m.count>0&&(p=""==p?m.rewardType+"/"+m.count:p+","+m.rewardType+"/"+m.count)}if(s.items.length>0)for(h=0;h<s.items.length;h++){(f=s.items[h]).count>0&&(p=""==p?f.configId+"/"+f.count:p+","+f.configId+"/"+f.count)}if(s.armys.length>0)for(h=0;h<s.armys.length;h++){(f=s.armys[h]).count>0&&(p=""==p?f.configId+"/"+f.count:p+","+f.configId+"/"+f.count)}if(s.buildings.length>0)for(h=0;h<s.buildings.length;h++){var f;(f=s.buildings[h]).count>0&&(p=""==p?f.configId+"/"+f.count:p+","+f.configId+"/"+f.count)}return{action:"g_view",data:{item_id:e,item_type:"gift",item_name:i.LOCAL.getText(t.name),item_content:p}}}}},e.GiftShowEvent=function(e){if(this.available()){var t=r.ExchangeController.Instance.getCanPayExchangeConfigById(e);if(t){var a=this.GiftBaseEventData(e),o=t.type,n={item_referer:"GiftTab_"+r.ExchangeController.getTabTypeByGiftType(o)};return Object.assign(a.data,n),a}}},e.ItemShowEvent=function(e,t,a){this.available()},Object.defineProperty(e,"ProfessionId",{get:function(){return this.professionId},set:function(e){this.professionId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LatestProfessionId",{get:function(){return this.latestProfessionId},set:function(e){this.latestProfessionId=e},enumerable:!0,configurable:!0}),e.getArmyName=function(e,t){void 0===t&&(t=-1);var a=s.TABLE.getTableDataById(p.TableName.ARMY,String(e));if(!a)return"";var o=t;-1==t&&(o=this.ProfessionId);var n=a.name;o>0&&a.new_name&&(n=a.new_name);var r=a.orign_model;o>0&&a.pro_model&&(r=a.pro_model);var l=s.TABLE.getTableDataById(p.TableName.MODEL,String(r));return l&&l.name&&(n=l.name),i.LOCAL.getText(n)},e.getResourceNameKey=function(e){return e==n.ResourceType.Gold?"100017":e==n.ResourceType.Wood?"100018":e==n.ResourceType.Oil?"100019":e==n.ResourceType.Coin?"100020":e==n.ResourceType.Energy?"resource_energy":e==n.ResourceType.Exp?"100492":e==n.ResourceType.Honor?"100021":e==n.ResourceType.Power?"100022":e==n.ResourceType.Oila?"110118":e==n.ResourceType.Metal?"110120":e==n.ResourceType.Soil?"110121":e==n.ResourceType.Coal?"110122":e==n.ResourceType.AdventureCoin?"adventure118":""},e.ItemClickEvent=function(e,t,a){if(this.available()){var o="",r=a;if(a===n.ResourceType.Army)o=this.getArmyName(t),r=n.ResourceType.Army;else if(a===n.ResourceType.Item){var l=s.TABLE.getTableDataById("item",t.toString());l&&(o=i.LOCAL.getText(l.name),r=n.ResourceType.Item)}else if(a===n.ResourceType.Building){var c=s.TABLE.getTableDataById("building",t.toString());c&&(o=i.LOCAL.getText(c.name),r=n.ResourceType.Building)}else o=i.LOCAL.getText(this.getResourceNameKey(t)),r=t;var d="";return e&&e.exchangeId&&(d=e.exchangeId),{action:"g_click",data:{item_id:t,item_type:"item",item_name:o,item_desc:r+"",item_referer:d+""}}}},e.GiftBuyEvent=function(e,t,a){if(this.available()&&(e&&r.ExchangeController.Instance.getCanPayExchangeConfigById(e))){var o="BuyBtn";return t&&(o=t.string),{action:"g_click",data:{item_id:"btn_"+a,item_type:"button",item_name:o,item_referer:e+""}}}},e.BackButtonEvent=function(e){if(this.available())return{action:"g_click",data:{item_type:"button",item_name:"back",item_referer:e}}},e.GiftShopEntranceEvent=function(e){if(this.available()){for(var t="",a=0;a<e.length;a++){var o=e[a];if(o.tabType){var n="GiftTab_"+o.tabType;t=""===t?n+"/1":t+","+n+"/1"}}return{action:"g_click",data:{item_id:"GiftShop_Main",item_type:"menu",item_name:"\u30ae\u30d5\u30c8\u5546\u5e97",item_content:t,item_referer:"MainUI"}}}},e.GiftTabEvent=function(e){if(this.available()){for(var t=Number(e),a=this.getGiftTabName(t),o="",n=this.getGiftTypeByTabType(t),i=0;i<n.length;i++){var s=n[i];if(-1!=s){var l=r.ExchangeController.Instance.getCanPayExchangeConfigArrayByType(s);if(l&&l.length>0)for(var c=0;c<l.length;c++){var d=l[c];o=""==o?d.id+"/1":o+","+d.id+"/1"}}}return{action:"g_click",data:{item_id:"GiftTab_"+t,item_type:"tab",item_name:a,item_content:o,item_referer:"GiftShop_Main"}}}},e.getGiftTabName=function(e){var t="";switch(e){case n.GiftShopTabType.FIRST_GIFT:t=i.LOCAL.getText("102094");break;case n.GiftShopTabType.SECOND_GIFT:t=i.LOCAL.getText("102095");break;case n.GiftShopTabType.WEEKLY_CARD_GIFT:t=i.LOCAL.getText("102097");break;case n.GiftShopTabType.PREFERENTIAL_GIFT:t=i.LOCAL.getText("102096");break;case n.GiftShopTabType.BASE_GIFT:t=i.LOCAL.getText("102098");break;case n.GiftShopTabType.ITEM_SHOP:t=i.LOCAL.getText("102099");break;case n.GiftShopTabType.GROWTH_FUND_GIFT:t=i.LOCAL.getText("107203");break;case n.GiftShopTabType.ACTIVITY_GIFT:t=i.LOCAL.getText("convert_001");break;case n.GiftShopTabType.HERO_GIFT:t=i.LOCAL.getText("exchange_name_12001");break;case n.GiftShopTabType.CRYSTAL_GIFT:t=i.LOCAL.getText("crystal_004");break;case n.GiftShopTabType.SUPPLY_GIFT:t=i.LOCAL.getText("public122");break;case n.GiftShopTabType.VIP_SHOP:t=i.LOCAL.getText("vip005");break;case n.GiftShopTabType.LIMITED_SHOP:t=i.LOCAL.getText("shop_limit_name");break;case n.GiftShopTabType.DAILY_BAG:t=i.LOCAL.getText("daily_gift");break;case n.GiftShopTabType.HEROSKIN_GIFT:case n.GiftShopTabType.BASE_GIFT:t=i.LOCAL.getText("public406");break;case n.GiftShopTabType.LEGION_SHOP:t=i.LOCAL.getText("BountyQuest011");break;case n.GiftShopTabType.DUBBING_PACK:t=i.LOCAL.getText("system_voice_pack_001");break;case n.GiftShopTabType.GROW_ROAD_PREFAB:t=i.LOCAL.getText("new_king_page_1_2")}return t},e.getGiftTypeByTabType=function(e){var t=[];switch(e){case n.GiftShopTabType.FIRST_GIFT:t.push(n.GiftType.FIRST);break;case n.GiftShopTabType.WEEKLY_CARD_GIFT:t.push(n.GiftType.WEEKLY_CARD);break;case n.GiftShopTabType.PREFERENTIAL_GIFT:t.push(n.GiftType.PREFERENTIAL_GIFT);break;case n.GiftShopTabType.GROWTH_FUND_GIFT:t.push(n.GiftType.GROWTH_FUND);break;case n.GiftShopTabType.ACTIVITY_GIFT:t.push(n.GiftType.ACTIVITY_GIFT);break;case n.GiftShopTabType.HERO_GIFT:t.push(n.GiftType.HERO_GIFT),t.push(n.GiftType.HERO_FRAG_GIFT);break;case n.GiftShopTabType.HEROSKIN_GIFT:t.push(n.GiftType.HERO_SKIN_GIFT);break;case n.GiftShopTabType.LIMITED_SHOP:t.push(n.GiftType.LIMIT_GIFT);break;case n.GiftShopTabType.DUBBING_PACK:t.push(n.GiftType.DUBBING_GIFT);break;case n.GiftShopTabType.SUPPLY_GIFT:t.push(n.GiftType.LuxuryGift),t.push(n.GiftType.AdvanceGift),t.push(n.GiftType.DAILY_BAG);break;case n.GiftShopTabType.GROW_ROAD_PREFAB:t.push(n.GiftType.GROW_ROAD);break;case n.GiftShopTabType.BASE_GIFT:t.push(n.GiftType.BASE);break;case n.GiftShopTabType.CRYSTAL_GIFT:t.push(n.GiftType.CRYSTAL_GIFT)}return t},e.professionId=0,e.latestProfessionId=0,e}();e.EventDataGenetor=t;var a=function(){function t(){}return t.available=function(){return!0},t.sendTutorialMsg=function(t,a,o){void 0===a&&(a=-1),void 0===o&&(o=!1);var n="t_recoder_"+c.DATA.UserData.UID;try{var i=[],r=d.get(n);if(r&&Array.isArray(r)){if(r.indexOf(t)>=0)return;for(var s=0;s<r.length;s++){var l=r[s];i.push(l)}i.push(t)}else i.push(t);d.set(n,i)}catch(e){console.log("localstorage not available!!!")}var p="unknown";if(a>=2)p=o?"\u7b2c"+a+"\u7ae0\u958b\u59cb":"\u7b2c"+a+"\u7ae0\u30af\u30ea\u30a2";else{if(t<1||t>this.tutorialStep.length)return;p=this.tutorialStep[t-1]}this.available()&&window.top.postMessage(JSON.stringify({action:"g_tutorial",data:{game_server_id:c.DATA.UserData.ServerId+"",game_user_id:c.DATA.UserData.UID+"",role_id:c.DATA.UserData.UID+"",role_level:c.DATA.UserData.Level,role_vip_level:c.DATA.UserData.VipLevel,virtual_balance1:c.DATA.UserData.Resource.Gold,role_exp:c.DATA.UserData.Exp,role_vip_exp:c.DATA.UserData.VipExp,role_power:Number(c.DATA.UserData.Power),role_custom:JSON.stringify({talent:e.EventDataGenetor.LatestProfessionId+"",reg_server_id:c.DATA.UserData.RegisterServerId+""}),item_id:""+t,item_desc:p}}),"*"),window.OnlineServer||console.log("TutorialRecoder ===== "+p)},t.tutorialStep=["\u30e9\u30b0\u30ce\u88c5\u5099\u6e96\u5099\u547d\u4ee4","\u30a2\u30ea\u30a2\u5408\u4f53Lv.2","\u521d\u56de\u6226\u95d8","\u30c6\u30a3\u30ca\u6551\u51fa","\u30c6\u30a3\u30ca\u7372\u5f97","\u30a8\u30f3\u30b8\u30cb\u30a2\u6551\u51fa","\u91d1\u9271\u4fee\u7406x3","\u4efb\u52d9\u521d\u30af\u30ea\u30a2","\u5efa\u7bc9\u5408\u6210Lv.3","\u5175\u58eb\u5408\u6210Lv.4","\u7b2c1\u7ae0\u958b\u59cb","\u7b2c2\u30a8\u30ea\u30a2\u89e3\u7981\u3078","\u7b2c2\u30a8\u30ea\u30a2\u89e3\u653e","\u7b2c1\u7ae0\u30af\u30ea\u30a2"],t}();e.TutorialRecoder=a})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../Core/Common/LocalManager":"LocalManager","../../Core/Common/TableManager":"TableManager","../../Game/Const/GameDefine":"GameDefine","../../Game/Const/TableName":"TableName","../../Game/Data/DataCenter":"DataCenter","../../Game/controllers/ExchangeController":"ExchangeController","../../Game/controllers/RewardController":"RewardController","../utils/LocalStorageUtils":"LocalStorageUtils"}],FileSaver:[function(e,t,a){(function(e){"use strict";cc._RF.push(t,"28702AKJHxHP4QV1SUss751","FileSaver");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="object"===("undefined"==typeof window?"undefined":a(window))&&window.window===window?window:"object"===("undefined"==typeof self?"undefined":a(self))&&self.self===self?self:"object"===(void 0===e?"undefined":a(e))&&e.global===e?e:void 0;function n(e,t){return void 0===t?t={autoBom:!1}:"object"!==(void 0===t?"undefined":a(t))&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function i(e,t,a){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){c(o.response,t,a)},o.onerror=function(){console.error("could not download file")},o.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||("object"!==("undefined"==typeof window?"undefined":a(window))||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,a){var n=o.URL||o.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin!==location.origin?r(l.href)?i(e,t,a):s(l,l.target="_blank"):s(l)):(l.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(l.href)},4e4),setTimeout(function(){s(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,a){if(t=t||e.name||"download","string"==typeof e)if(r(e))i(e,t,a);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){s(o)})}else navigator.msSaveOrOpenBlob(n(e,a),t)}:function(e,t,a,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,a);var r="application/octet-stream"===e.type,s=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&s||l)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var p=o.URL||o.webkitURL,u=p.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){p.revokeObjectURL(u)},4e4)}});o.saveAs=c.saveAs=c,void 0!==t&&(t.exports=c),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],PlatformCommon:[function(e,t,a){"use strict";cc._RF.push(t,"45dc3YSdxhACpYvZwhmBUtd","PlatformCommon"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./PlatformCore"),n=e("./PlatformWebG123");e("../utils/X").log("PlatformCommon CODE");var i={};o.instance=i;var r=new n.default,s=r.getAPIs(),l=r.getProperties(),c=null;s.getMobilePlatform=function(){return c||(c=s.getSystemInfoSync?s.getSystemInfoSync():{}),c.platform||""},s.isIos=function(){return cc.sys.os==cc.sys.OS_IOS},s.isWindows=function(){return c||(c=s.getSystemInfoSync?s.getSystemInfoSync():{}),"windows"===c.platform||cc.sys.os==cc.sys.OS_WINDOWS||cc.sys.os!=cc.sys.OS_ANDROID&&cc.sys.os!=cc.sys.OS_IOS};for(var d=Object.keys(l),p=0;p<d.length;p++){var u=d[p],h=function(e){return function(){return l[e]}}(u);Object.defineProperty(i,u,{get:h})}var m=["getDiffBiz","needDevOptions","getPlatformVer","getContainerType","submitPlatformRequestId","disableGetUserInfoApi","canPay","canShare","canRewardVideoAd","canBindAccount","getDeviceIdCache","getRealDeviceID","resetDeviceIDCache","canShowBindAccountPanel","canShowMiniProTip","canUseClipboard","canChangeLaunguage","needUserAuthor","getMobilePlatform","isAndroid","isIos","isWindows","isForeign","isLandscape","canUseLandscapeUI","getDownloader","initPlatformAPIs","initServerAddress","onEnterGame","onReadyToLogin","getShowVersion","setServerListParam","saveServerToken","updateServerToken","chooseRoleLogin","getPFConfigKey","setLoginParam","setNonePFLoginParam","setSwitchs","subscribeMessage","replaceMoneyUnit","convertMoneyValue","canMigrateAccount","checkChargeVerification","clearCacheFiles","userLogout","uploadUserInfo","canUserLogout","enableRealNameLimitInput","enableRealNameVerify","startRealNameVerify","getErrorReportPostUri","uploadHeaderPicture","checkLoginResultError","checkHttpResponse","enableSceneTransition","init","onShow","onHide","onMemoryWarning","onShareAppMessage","onWheel","onFirstLogin","doCreateRoleBI","openSpecialVIP","openTwitter","checkSession","login","getUserInfo","setUserCloudStorage","bindUserAccount","canShowLine","canShowTwitter","isPad","getCurrentCountry","getCurrentDeviceSystemLang","getCurrentDeviceStoreCountryCode","canShowCodeNote","vibrateShort","vibrateLong","showModal","createUserInfoButton","showLoading","hideLoading","createGameClubButton","startGyroscope","stopGyroscope","onGyroscopeChange","offGyroscopeChange","shareAppMessage","updateShareMenu","showShareMenu","getShareInfo","captureNode","captureScene","captureCameras","findFriends","doFBAppRequest","startScreenRecord","stopScreenRecord","createRewardedVideoAd","adVideoLoadFrom","saveImageToPhotosAlbum","downloadFile","getStorageInfoSync","clearStorageSync","getStorageSync","setStorageSync","removeStorageSync","getFileSystemManager","getDynResName","switchCDN","getHeadFileNames","getSpecialEmojiData","sendDataToPlatform","sendDataToServer","getPayPriceShow","getPayNativeStorePriceWithUnit","canUseNativeNewPayMethod","checkExchangeIdForbidden","checkExchangeForbiddenByType","postStatsEvent","postStatsEventWithValue","postSpectialEvent","postAIEvent","getPlatformPropByKey","postLevelUpEvent","openSocialPage","canOpenSocialPage","needShowConmunityPage","openUrl","isShowTermsOfService","openTermsOfService","replaceGameName","getWssAccLines","setPreferredFramesPerSecond","getSystemInfoSync","getLaunchOptionsSync","openCustomerServiceConversation","setCustomerServiceLanguage","navigateToMiniProgram","exitMiniProgram","triggerGC","periodTriggerGC","setClipboardData","request","getUpdateManager","getOpenDataContext","getNetworkType","onNetworkStatusChange","canFixDynVersion","fixDynVersion","openStorePage","setKeyBoardStyle","resetKeyBoardStyle","canUseSNSBind","canUseMultiSNSBind","canFixGPAccount","tryForceUpdate","checkChatServerUrl","openSetting","requestMidasPayment","getGameRecorderManager","authorize","getSetting","saveVideoToPhotosAlbum","canShareDyMessage","checkNeedClientUpdate","doClientUpdate","updateAppVersion","getStoreCurrentType","syncPlatformPlayerInfoButtonEnable","syncPlatformPlayerInfo","doReloadGame","disableCashCoupon","checkPrivacy","supportPayForVoucher","openVoucherGet","externalActivityJump","externalNodeShow","getNotchInScreenSize","needGameServerRacing","createContactButton","getStorePriceRateWithRMB","getStorePriceUnitLayout","getAFConversionData","openNotification","getAppChannelName"];for(p=0;p<m.length;p++){var f=m[p];i[f]=function(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return s&&s[e]?s[e].apply(s,t):void 0}}(f)}a.PlatformCommon=i,cc.macro.DOWNLOAD_MAX_CONCURRENT=a.PlatformCommon.CC_DOWNLOAD_MAX_CONCURRENT||10,window.PlatformCommon=i,cc._RF.pop()},{"../utils/X":"X","./PlatformCore":"PlatformCore","./PlatformWebG123":"PlatformWebG123"}],PlatformCore:[function(e,t,a){"use strict";var o;cc._RF.push(t,"4573eUvQyFL0LT5fOjQIb8K","PlatformCore"),function(e){(function(e){e[e.None=0]="None",e[e.CheckCanPay=1]="CheckCanPay",e[e.CheckOrderStatus=2]="CheckOrderStatus"})(e.PrePayFlowSettings||(e.PrePayFlowSettings={})),function(e){e[e.dev=0]="dev",e[e.wx=1]="wx",e[e.qqmini=2]="qqmini",e[e.baidugame=3]="baidugame",e[e.toutiao=4]="toutiao",e[e.web=5]="web",e[e.ios=6]="ios",e[e.android=7]="android"}(e.PlatformContainerType||(e.PlatformContainerType={})),function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right"}(e.QueryNotchDirection||(e.QueryNotchDirection={})),function(e){e[e.left=0]="left",e[e.right=1]="right"}(e.RGSymbolLayout||(e.RGSymbolLayout={})),e.MobilePlatforms={android:"android",ios:"ios"},e.SendDataType={ServerSync_PushToken:"ServerSync_PushToken",PFSync_AddLocalNotify:"PFSync_AddLocalNotify"}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],PlatformWebG123:[function(e,t,a){"use strict";cc._RF.push(t,"a6193SsgDNKpLos0W6w0TYZ","PlatformWebG123"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("./PlatformCore"),n=e("../../Game/Common/UIManager"),i=e("../../Platform/PlatformHttpUtils"),r=e("../../Game/Common/PFOpenData"),s=e("../utils/LocalStorageUtils"),l=e("../../Game/Common/G123PayModel"),c=e("../../Game/Data/GlobalData"),d=e("../../Game/Tools/GameTools"),p=e("../../Game/Data/DataCenter"),u=e("../../Core/Net/WebClient"),h=e("../utils/HttpUtils"),m=e("../../Core/Net/NetMgr"),f=e("../../Game/Const/RequestId"),_=e("../utils/FWSTool"),y=e("../../Game/controllers/ExchangeController"),g=e("../../Game/Const/GameDefine"),C=e("../../Game/Common/BIManager"),v=e("../../Core/Common/TableManager"),I=e("../../Game/Const/TableName"),T=e("../display/MsgBox"),S=e("../utils/ErrorReport"),A=e("../../Game/Common/ListView/FrameTaskManager"),D=e("./FileSaver"),N=e("../../Game/Profession/ProfessionController"),b=0,L=["activity_banner_19","activity_banner_28","activity_banner_37","activity_banner_44","activity_banner_46","activity_banner_61","activity_banner_78","activity_banner_60_1","exchange/exchange_hero_12001","exchange/exchange_hero_12011","exchange/exchange_heroChip104","exchange/exchange_hero104","activity_banner_11_n.jpg","activity_banner_12_n.jpg","activity_banner_19_n.png","activity_banner_19_n_n.jpg","activity_banner_28_n.jpg","activity_banner_37_n.jpg","activity_banner_90.jpg","activity_banner_93.jpg","activity_banner_102.jpg","icon_midautumn","activity_icon_104","activity_icon_104_gray","activity_banner_108.jpg","activity_banner_202.jpg","activity_icon_202","activity_icon_202_gray","activity_icon_40","activity_icon_40_gray","activity_banner_123_1.jpg","activity_banner_289.jpg","icon_oneyear","activity_banner_257_1.jpg","activity_icon_17_3","activity_icon_17_3_gray","activity_banner_17_3.jpg","activity_banner_351.jpg","activity_banner_357.jpg","activity_banner_30001.jpg","icon_61","exchange/exchange_banner_200062.jpg","exchange/exchange_banner_200062_bg1","exchange/exchange_banner_200062_bg2","activity_icon_500013_gray","activity_icon_500013","activity_banner_500013.jpg","activity_banner_500040.jpg","activity_banner_500041.jpg"],E={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,a,o,n,i,r,s,l="",c=0;for(e=E._utf8_encode(e);c<e.length;)n=(t=e.charCodeAt(c++))>>2,i=(3&t)<<4|(a=e.charCodeAt(c++))>>4,r=(15&a)<<2|(o=e.charCodeAt(c++))>>6,s=63&o,isNaN(a)?r=s=64:isNaN(o)&&(s=64),l=l+this._keyStr.charAt(n)+this._keyStr.charAt(i)+this._keyStr.charAt(r)+this._keyStr.charAt(s);return l},decode:function(e){var t,a,o,n,i,r,s="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(n=this._keyStr.indexOf(e.charAt(l++)))>>4,a=(15&n)<<4|(i=this._keyStr.indexOf(e.charAt(l++)))>>2,o=(3&i)<<6|(r=this._keyStr.indexOf(e.charAt(l++))),s+=String.fromCharCode(t),64!=i&&(s+=String.fromCharCode(a)),64!=r&&(s+=String.fromCharCode(o));return s=E._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",a=0;a<e.length;a++){var o=e.charCodeAt(a);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},_utf8_decode:function(e){for(var t="",a=0,o=0,n=0,i=0;a<e.length;)(o=e.charCodeAt(a))<128?(t+=String.fromCharCode(o),a++):o>191&&o<224?(n=e.charCodeAt(a+1),t+=String.fromCharCode((31&o)<<6|63&n),a+=2):(n=e.charCodeAt(a+1),i=e.charCodeAt(a+2),t+=String.fromCharCode((15&o)<<12|(63&n)<<6|63&i),a+=3);return t}},P=void 0;function w(){if(void 0===P)if(navigator&&navigator.userAgent){var e=navigator.userAgent;if(e.indexOf("iPhone")>=0||e.indexOf("iPad")>=0){var t=/OS (\d+)_(\d+)_?(\d+)?/.exec(e);P=Number.parseInt(t[1])>=13}else if(e.indexOf("Android")>=0){t=/Android ([\.\_\d]+)/.exec(e);P=Number.parseInt(t[1])>=9}else P=!0}else P=!1;return P}var B=function(){function e(){}return e.prototype.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},e.prototype.initSubPlatform=function(){var e="FirstLoginSubPf",t=s.get(e);if(null!=t&&void 0!=t&&""!=t)window.SubPlatform=t;else{window.SubPlatform="";var a=window.location.href;a=decodeURIComponent(a),a=decodeURIComponent(a),a=decodeURIComponent(a);var o=this.getParameterByName("platform",a);o&&(s.set(e,o),window.SubPlatform=o)}},e.prototype.getFormattedDate=function(){var e=new Date,t=1e3*p.DATA.ServerTime+6e4*e.getTimezoneOffset(),a=new Date(t+324e5);return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()},e.prototype.useNewReport=function(){return!!window.OnlineServer},e.prototype.doPostProxy=function(e){window.OnlineServer?i.default.getInstance().post(e):console.log("dopost= "+e)},e.prototype.getUserBaseInfoData=function(){return{game_server_id:p.DATA.UserData.ServerId+"",game_user_id:p.DATA.UserData.UID+"",role_id:p.DATA.UserData.UID+"",role_level:p.DATA.UserData.Level,role_vip_level:p.DATA.UserData.VipLevel,virtual_balance1:p.DATA.UserData.Resource.Gold,role_exp:p.DATA.UserData.Exp,role_vip_exp:p.DATA.UserData.VipExp,role_power:Number(p.DATA.UserData.Power),role_custom:JSON.stringify({talent:N.default.Instance.getLatestTalentId(),reg_server_id:p.DATA.UserData.RegisterServerId+""})}},e.prototype.AccountRegisterCallback=function(e){this.useNewReport()&&window.top.postMessage(JSON.stringify({action:"g_register",data:this.getUserBaseInfoData()}),"*")},e.prototype.AccountLoginCallback=function(e){},e.prototype.RoleRegisterCallback=function(e){p.DATA.UserData.PlayerInfoData.initDefaultPlayerInfo()},e.prototype.RoleLoginCallback=function(e){if(this.useNewReport()){var t=this;window.top.postMessage(JSON.stringify({action:"g_login",data:t.getUserBaseInfoData()}),"*"),window.onbeforeunload=function(e){window.top.postMessage(JSON.stringify({action:"g_logout",data:t.getUserBaseInfoData()}),"*")}}},e.prototype.getProperties=function(){return{platformSID:"g123",prod:!0,hasSubpack:!0,disabledSubpackNames:["subpack"],disableMoreGameButton:!0,disableGongZhongHaoButton:!0,disableNotifyButton:!0,canShowSns:!window.OnlineServer,disablePubAddrActivity:!0,disableFavWxActivity:!0,useXmlHttpRequest:!0,needSendUserInfoToServer:!0,defaultLanguage:"ja",disablePopGoToApp:!0,disableOldUpdatePlayerInfo:!1,ignoreOtherPlatformHeaderIcons:!1,canOpenUrl:!0,enableNewHeartbeatMode:!0,enabledDubbingButton:!0,payPreFlowConfig:o.PrePayFlowSettings.CheckCanPay,enableShopTipForPrice:!1,disableUISwitch:!1,enableCaptureHome:!0,enableUAFingerprint:!0,useUITopShopcart:!0}},e.prototype.getAPIs=function(){var e=this,t={onShow:function(t){cc.game.on(cc.game.EVENT_SHOW,function(){t({})}),console.log("Game Life: OnShow"),(new l).connect(),e.initSubPlatform()},onHide:function(e){cc.game.on(cc.game.EVENT_HIDE,function(){e({})})},canPay:function(){return!0},canShare:function(){return!0},disableCashCoupon:function(){return!1},openUrl:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];cc.sys.openURL(e[0])},canShowMiniProTip:function(){return!1},needUserAuthor:function(){return!1},canRewardVideoAd:function(){return!1},canBindAccount:function(){return!1},canChangeLaunguage:function(){return!1},canShowLine:function(){return p.DATA.UserData&&p.DATA.UserData.VipExp>0},canShowTwitter:function(){return!0},canFixDynVersion:function(){return!0},fixDynVersion:function(){window.LatestGameVersion!=c.GLOBAL.GameVersion?confirm("\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u66f4\u65b0\u3057\u307e\u3059\u304b\uff1f")&&(localStorage.setItem("G123_ForceUpdate","1"),C.default.Instance.PostActionWithTime("G123_ManualUpdate",1),window.location.reload(!0)):n.default.Instance().ShowTips("\u4eca\u306f\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3059\u3002")},canUseClipboard:function(){return!window.OnlineServer},getCurrentCountry:function(){return"JP"},checkChatServerUrl:function(e){return"wss://group-push-jp.rivergame.net"},setServerListParam:function(e){e.channel="g123_g123",e.isTest=window.OnlineServer?0:1},setLoginParam:function(e){e.g123test=window.OnlineServer?0:1,e.platform="G123"},initServerAddress:function(){var e=t.getLaunchOptionsSync();r.default.Instance.wxOnShow(e),c.GLOBAL.ResourceUrl="https://knight-cdn.akamaized.net",c.GLOBAL.GetAllServerDataUrl="https://knight-us.topwargame.com/getServerListForRole",c.GLOBAL.GetServerListUrl="https://knight-us.topwargame.com/serverList",c.GLOBAL.GetAppConfigUrl="https://knight-us.topwargame.com/frontconfigget"},getHeadFileNames:function(){var e=["headIcon_1_1","headIcon_2_1","headIcon_3_1","headIcon_4_1","headIcon_5_1","headIcon_6_1","headIcon_7_1","headIcon_8_1","headIcon_9_1","headIcon_10_1","headIcon_11_1","headIcon_12_1","headIcon_13_1","headIcon_14_1","headIcon_15_1","headIcon_16_1","headIcon_17_1","headIcon_18_1","headIcon_19_1","headIcon_20_1","headIcon_21_1"];if(p.DATA.UserData&&p.DATA.UserData.Heros)for(var t in p.DATA.UserData.Heros){var a=p.DATA.UserData.Heros[t].Id,o=v.TABLE.getTableDataById(I.TableName.HERO,a+"");if(o){var n=(s=o.hero_icon.split("/"))[s.length-1];e.push(n)}}if(p.DATA.UserData&&p.DATA.UserData.HerosSkin)for(var t in p.DATA.UserData.HerosSkin){var i=p.DATA.UserData.HerosSkin[t].skinId,r=v.TABLE.getTableDataById(I.TableName.HEROSKIN,i+"");if(r){var s;n=(s=r.hero_icon.split("/"))[s.length-1];e.push(n)}}return p.DATA.UserData.RegTime<1587571200&&e.indexOf("niconico_1")<0&&e.push("niconico_1"),e},getShowVersion:function(){return c.GLOBAL.GameVersion+"("+window.BuildVersion+")"},getUserInfo:function(e){p.DATA.UserData.PlayerInfoData;var t=p.DATA.UserData.UserName;t&&""!=t||(t="\u53f8\u4ee4\u5b98"+String(p.DATA.UserData.UID).substr(-6,6));var a=p.DATA.UserData.PlayerInfoData.playerInfo.gender;if(0==a&&(a=1),e&&e.success){var o={userInfo:{nickName:t,country:"jp",avatarurl:"https://fv-download.elexapp.com/headicon/headIcon_5.png",gender:a,province:"default"},encryptedData:"",iv:""};e.success(o)}},getPlatformVer:function(){return c.GLOBAL.GameVersion},login:function(t){window.G123Token="";var a=e.getParameterByName("code",null);if(a&&(window.G123Token=a),console.log("Game Life: Start login"),window.G123Token){var o={code:""};o.code=window.G123Token,t.success(o)}},disableGetUserInfoApi:function(){return!0},submitPlatformRequestId:function(){return null},shareAppMessage:function(t){if(console.warn("G123WebInterface New shareAppMessage!!!!!!!!!!!!!!"),t){var a="";t.query&&(a=e.getParameterByName("shareCHN",t.query));for(var o={shareOpenid:p.DATA.UserData.UID.toString()},n=t.query.split("&"),i=0;i<n.length;i++){var r=n[i].split("=");r&&2===r.length&&(o[r[0]]=r[1])}var s=encodeURI(JSON.stringify(o));if(s=(s=E.encode(s)).replace("=","_O"),"Line"!=a)window.parent.postMessage(JSON.stringify({action:"share",data:{ctw_line_share_text:t.title,ctw_twitter_share_text:t.title,ctw_copy_text:"",ctw_twitter_share_via:"vivid_army_",ctw_twitter_share_hashtags:"\u30d3\u30d3\u30c3\u30c9\u30a2\u30fc\u30df\u30fc,vividarmy",ctw_share_id:t.id,ctw_share_extra:s}}),"*"),t.success&&t.success();else{var l="https://social-plugins.line.me/lineit/share?text="+t.title+"&url=",c=encodeURIComponent("https://h5.g123.jp/game/vividarmy?platform=PlatformShare&ctw_share_id="+t.id+"&ctw_share_extra="+s);window.OnlineServer||(c=encodeURIComponent("https://h5.stg.g123.jp/game/vividarmy?platform=PlatformShare&ctw_share_id="+t.id+"&ctw_share_extra="+s));var d=l+c;window.open(d)}}},openCustomerServiceConversation:function(e){window.parent.postMessage(JSON.stringify({action:"support"}),"*")},getSystemInfoSync:function(){return{platform:"g123",brand:"browser",model:cc.sys.browserType,language:"ja",version:c.GLOBAL.GameVersion}},getLaunchOptionsSync:function(){window.ShareQuery="";var t=e.getParameterByName("ctw_share_extra",null);if(t){var a=t.replace("_O","="),o=E.decode(a),n=decodeURI(o);try{var i=n.replace("\0",""),r=JSON.parse(i);window.ShareQuery=r,window.G123SpcLine=0;var s=r.Russia_Line;s&&(window.G123SpcLine=parseInt(s))}catch(e){console.log("error:"+e)}}return window.ShareQuery?{query:window.ShareQuery,referrerInfo:{appId:"",extraData:""}}:(e.initSubPlatform(),{query:{},scene:window.SubPlatform,referrerInfo:{appId:"",extraData:""}})},doCreateRoleBI:function(){e.useNewReport()&&window.top.postMessage(JSON.stringify({action:"g_createrole",data:e.getUserBaseInfoData()}),"*");try{window.OnlineServer?window.parent.postMessage(JSON.stringify({event:"CreateRole"}),"https://h5.g123.jp"):window.parent.postMessage(JSON.stringify({event:"CreateRole"}),"https://h5.stg.g123.jp")}catch(e){window.console&&window.console.log(e)}},canShowCodeNote:function(){return"FreeCode"===s.get("G123LineCodeCache"+p.DATA.UserData.UID)},doReloadGame:function(){if(window.OnlineServer)return S.trace({resp:"doReloadGame"}),window.top.postMessage(JSON.stringify({action:"reload"}),"*"),!0;T.confirm("Using API:doReloadGame!!!(by game logic)","Tips",this,function(){window.top.postMessage(JSON.stringify({action:"reload"}),"*")},function(){},"OK","Cancel")},convertMoneyValue:function(e){return e},onFirstLogin:function(t){d.default.playG123SoundPathByName("homemap_enter");var a=p.DATA.UserData.RegisterServerId;if(a||(a=p.DATA.UserData.ServerId),t)m.NET.send(f.RequestId.GET_USER_SERVERLIST,{},this,function(t){if(null!=t.d&&""!=t.d&&3!=t.s){p.DATA.UserData.UpdateUserServerList(d.default.JSON_PARSE(t.d));var o=p.DATA.UserData.UserServerList;if(!o||o.length<=1){var n={sId:a.toString(),guid:p.DATA.UserData.UID.toString(),sys:cc.sys.os};e.AccountRegisterCallback(n),e.AccountLoginCallback(n),c.GLOBAL.UserFirstReg=1}else c.GLOBAL.UserFirstReg=2;var i={sId:a.toString(),guid:p.DATA.UserData.UID.toString(),roleId:p.DATA.UserData.UID.toString(),lv:p.DATA.UserData.Level+""};e.RoleRegisterCallback(i)}});else{var o={sId:a.toString(),guid:p.DATA.UserData.UID.toString(),sys:cc.sys.os};e.AccountLoginCallback(o);var n={sId:a.toString(),guid:p.DATA.UserData.UID.toString(),roleId:p.DATA.UserData.UID.toString(),lv:p.DATA.UserData.Level+""};e.RoleLoginCallback(n),c.GLOBAL.UserFirstReg=0}var i=c.GLOBAL.GameVersion;window.parent.postMessage(JSON.stringify({action:"inform",data:{role_id:p.DATA.UserData.UID||"unknown",role_name:p.DATA.UserData.Name||"unknown",game_server:"S"+p.DATA.UserData.ServerId,tags:["VIP"+p.DATA.UserData.VipLevel,"v"+i]}}),"*")},getPayPriceShow:function(e){var t=y.ExchangeController.Instance.getExchangeConfigById(e);return t?_.Obj.getPropertyStringByNames(t,"1","product_id_2"):"0"},openSpecialVIP:function(){window.open("https://line.me/R/ti/p/%40dup7242s")},openTwitter:function(){window.open("https://twitter.com/vivid_army_")},getUpdateManager:function(){return{onCheckForUpdate:function(e){var t=h.addTimespan("https://knight-h5-client.oss-ap-northeast-1.aliyuncs.com/worldbattle/LatestVersion.txt");window.OnlineServer&&(t=h.addTimespan("https://knight-h5-client.oss-ap-northeast-1.aliyuncs.com/worldbattlerelease/LatestVersion.txt")),u.get(t,{},this,function(e){try{var t=e.responseText.replace(/^\s*/,"").replace(/\s*$/,""),a=t.split("|"),o=c.GLOBAL.GameVersion;if(2==a.length)o="FORCE_UPDATE"!==a[1]?c.GLOBAL.GameVersion:a[0],window.LatestGameVersion=a[0];else o=t;try{o!==c.GLOBAL.GameVersion?(localStorage.setItem("G123_ForceUpdate","1"),confirm("\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u914d\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u3092\u66f4\u65b0\u3057\u307e\u3059\u304b\uff1f")&&(C.default.Instance.PostActionWithTime("G123_ForceUpdate",1),window.location.reload(!0))):localStorage.setItem("G123_ForceUpdate","0")}catch(e){}}catch(e){console.error("RemoteTextLoader","\u52a0\u8f7d\u8fdc\u7a0b\u6587\u672c\u5931\u8d25",e)}},function(){},!0,4e3)},onUpdateReady:function(){},onUpdateFailed:function(){},applyUpdate:function(){}}},setSwitchs:function(e){e[g.FunctionKey.NpcTip]=!0},getDynResName:function(e){if("activity_banner_37_n.jpg"===e)return"activity_banner_37_n_g123_n.jpg";var t=L.indexOf(e)>=0;if(!t){var a=v.TABLE.getTableGroup("res_replace_g123");if(a)for(var o in a){if(e===a[o].image){t=!0;break}}}if(!t)return e;if(e.indexOf(".png")>0||e.indexOf(".jpg")>0){var n=e.split(".");return n[0]+"_g123."+n[1]}return e+"_g123"},checkExchangeIdForbidden:function(e){var t=y.ExchangeController.Instance.getCanPayExchangeConfigById(e).channel;if("global"===t)return!1;if(""===t)return!0;for(var a=t.split("|"),o=0;o<a.length;o++){if("G123"===a[o])return!1}return!0},switchCDN:function(){var e=(new Date).getTime();if(!(e-b<1e4)){b=e;var t=["knight-cdn.akamaized.net"];if(!(t.length<=1))for(var a=0;a<t.length;a++){var o=t[a],n=t[(a+1)%t.length];if(c.GLOBAL.ResourceUrl.indexOf(o)>=0){c.GLOBAL.ResourceUrl=c.GLOBAL.ResourceUrl.replace(o,n),console.warn("\u5207\u6362CDN (\u65b0)",c.GLOBAL.ResourceUrl),S.trace({resp:"\u5207\u6362cdn",uri:c.GLOBAL.ResourceUrl});break}}}},updateServerToken:function(e,t){var a=this;T.alert("\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u914d\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u3092\u66f4\u65b0\u3057\u307e\u3059\u304b\uff1f","TIP",this,function(){a.doReloadGame()})},getErrorReportPostUri:function(){return"https://knight-us.us-west-1.log.aliyuncs.com/logstores/client/track"},setClipboardData:function(e){try{var t=e.data,a=document.createElement("textarea");a.value=t,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",a.style.fontSize="12pt";var o,n=getSelection();n.rangeCount>0&&(o=n.getRangeAt(0)),document.body.appendChild(a),a.select(),a.selectionStart=0,a.selectionEnd=t.length;var i=!1;try{i=document.execCommand("copy")}catch(e){}document.body.removeChild(a),o&&(n.removeAllRanges(),n.addRange(o)),i?e.success&&e.success():e.fail&&e.fail()}catch(t){e.fail&&e.fail()}},isIos:function(){return!1},isAndroid:function(){return!0},isLandscape:function(){return!0},canUseLandscapeUI:function(){return!(window.orientation&&180!==window.orientation&&0!==window.orientation)},postStatsEvent:function(e){},postStatsEventWithValue:function(t,a){if(e.useNewReport()){var o=p.DATA.UserData.Resource.Gold;"earned_vc"===t||"earned_vc_pay"===t?window.top.postMessage(JSON.stringify({action:"g_obtain",data:{game_server_id:p.DATA.UserData.ServerId+"",game_user_id:p.DATA.UserData.UID+"",role_id:p.DATA.UserData.UID+"",role_level:p.DATA.UserData.Level,role_vip_level:p.DATA.UserData.VipLevel,virtual_balance1:p.DATA.UserData.Resource.Gold,item_type:"item",item_name:"\u94bb\u77f3",item_count:a,item_balance:o+a,role_exp:p.DATA.UserData.Exp,role_vip_exp:p.DATA.UserData.VipExp,role_power:Number(p.DATA.UserData.Power),role_custom:JSON.stringify({talent:N.default.Instance.getLatestTalentId(),reg_server_id:p.DATA.UserData.RegisterServerId+""})}}),"*"):"spend_vc"===t&&window.top.postMessage(JSON.stringify({action:"g_consumption",data:{game_server_id:p.DATA.UserData.ServerId+"",game_user_id:p.DATA.UserData.UID+"",role_id:p.DATA.UserData.UID+"",role_level:p.DATA.UserData.Level,role_vip_level:p.DATA.UserData.VipLevel,virtual_balance1:p.DATA.UserData.Resource.Gold,item_type:"item",item_name:"\u94bb\u77f3",item_count:a,item_balance:o,role_exp:p.DATA.UserData.Exp,role_vip_exp:p.DATA.UserData.VipExp,role_power:Number(p.DATA.UserData.Power),role_custom:JSON.stringify({talent:N.default.Instance.getLatestTalentId(),reg_server_id:p.DATA.UserData.RegisterServerId+""})}}),"*")}},postAIEvent:function(t){if(p.DATA.UserData.FunctionOn(g.FunctionKey.g123_record_click_view)&&t){var a=function(t){var a=e.getUserBaseInfoData();if(t.data&&t.action){Object.assign(a,t.data);var o=JSON.stringify({action:t.action,data:a});window.OnlineServer||console.log(o),window.top.postMessage(o,"*")}}.bind(this,t),o=new A.FrameTask(a,"AIEventSend");A.FrameTaskManager.getInstance().addTask(o)}},enableSceneTransition:function(){return w()},captureScene:function(e,t){var a=e.getContentSize().width,o=e.getContentSize().height,n=a/2,i=-o/2,r=a/o,s=1,l=2048,c=!1,d=navigator.userAgent;(d.match(/compatible/i)||d.match(/Windows/i))&&(c=!0),(d.match(/Macintosh/i)||d.match(/MacIntel/i))&&(c=!0);var p=!!d.match("CriOS");console.error("isChome==="+p),p&&(l=1024),a>o?a>l&&(s=l/a,a=l,o=Math.round(l/r)):o>l&&(s=l/o,o=l,a=Math.round(l*r));var u=new cc.RenderTexture,h=document.createElement("canvas"),m=h.getContext("2d");h.width=a,h.height=o;var f=new cc.Node;f.parent=e.parent,f.setPosition(n,i);var _=f.addComponent(cc.Camera);_.cullingMask=4294967295,u.initWithSize(a,o),_.targetTexture=u,_.depth=1,_.zoomRatio=s,_.render(e);for(var y=u.readPixels(),g=4*a,C=0;C<o;C++){for(var v=o-1-C,I=m.createImageData(a,1),T=v*a*4,S=0;S<g;S++)I.data[S]=y[T+S];m.putImageData(I,0,C)}var A=h.toDataURL("image/jpeg");f.destroy(),u.destroy();var N=document.createElement("link");N.type="text/css",N.rel="stylesheet",N.href="https://knight-g123.akamaized.net/Modal_Box_Style.css",document.getElementsByTagName("head")[0].appendChild(N);var b=document.createElement("div");b.className="modal",b.style.display="block",document.getElementById("Cocos2dGameContainer").parentNode.appendChild(b);var L=document.createElement("div");L.className="modal-content";var E=document.createElement("span");E.className="close",E.innerHTML="&times;",L.appendChild(E),E.onclick=function(){b.style.display="none"},window.onclick=function(e){e.target==b&&(b.style.display="none")};var P=document.createElement("img");P.src="https://knight-g123.akamaized.net/icon_tip.png",P.style.position="absolute",P.width=15,P.style.margin=c?"-16px 10px 10px 1px":"0px 10px 10px 1px",L.appendChild(P);var w=document.createElement("span"),B=!1;window.navigator&&window.navigator.standalone&&(B=!0),c?w.innerHTML="\u30af\u30ea\u30c3\u30af\u3057\u3066\u4fdd\u5b58":(w.innerHTML=B?"\u30bf\u30c3\u30d7\u3057\u3066\u4fdd\u5b58":"\u9577\u62bc\u3057\u4fdd\u5b58",p&&(w.innerHTML="\u30bf\u30c3\u30d7->\u9577\u62bc\u3057\u4fdd\u5b58")),w.style.position="absolute",w.style.margin=c?"-20px 10px 10px 20px":"-4px 10px 10px 20px",L.appendChild(w);var M=document.createElement("input");M.src=A,M.className="captureimg",M.type="image",L.appendChild(M),b.appendChild(L),M.onclick=function(){p?h.toBlob(function(e){D.saveAs(e,"\u30d3\u30d3\u30c3\u30c9\u30a2\u30fc\u30df\u30fc\u57fa\u5730.jpg")}):D.saveAs(M.src,"\u30d3\u30d3\u30c3\u30c9\u30a2\u30fc\u30df\u30fc\u57fa\u5730.jpg")},t("",u)},captureCameras:function(e,t){var a=cc.view.getDesignResolutionSize(),o=cc.view.getFrameSize(),n=o.height/a.height,i=o.width/n,r=cc.winSize.height,s=i/r,l=2048,c=!1,d=navigator.userAgent;(d.match(/compatible/i)||d.match(/Windows/i))&&(c=!0),(d.match(/Macintosh/i)||d.match(/MacIntel/i))&&(c=!0);var p=!!d.match("CriOS");console.error("isChome==="+p),p&&(l=1024),i>r?i>l&&(l/i,i=l,r=Math.round(l/s)):r>l&&(l/r,r=l,i=Math.round(l*s)),r=Math.round(r),i=Math.round(i);var u=new cc.RenderTexture,h=cc.game._renderContext;u.initWithSize(i,r,h.STENCIL_INDEX8);var m=document.createElement("canvas"),f=m.getContext("2d");m.width=i,m.height=r;for(var _=0;_<e.length;_++){var y=e[_],g=cc.instantiate(y.node);g.parent=y.node.parent;var C=g.getComponent(cc.Camera);C.targetTexture=u,C.render(void 0);for(var v=u.readPixels(),I=4*i,T=0;T<r;T++){for(var S=r-1-T,A=f.createImageData(i,1),N=S*i*4,b=0;b<I;b++)A.data[b]=v[N+b];f.putImageData(A,0,T)}g.destroy()}u.destroy();var L=m.toDataURL("image/jpeg"),E=document.createElement("link");E.type="text/css",E.rel="stylesheet",E.href="https://knight-g123.akamaized.net/Modal_Box_Style.css",document.getElementsByTagName("head")[0].appendChild(E);var P=document.createElement("div");P.className="modal",P.style.display="block",document.getElementById("Cocos2dGameContainer").parentNode.appendChild(P);var w=document.createElement("div");w.className="modal-content";var B=document.createElement("span");B.className="close",B.innerHTML="&times;",w.appendChild(B),B.onclick=function(){P.style.display="none"},window.onclick=function(e){e.target==P&&(P.style.display="none")};var M=document.createElement("img");M.src="https://knight-g123.akamaized.net/icon_tip.png",M.style.position="absolute",M.width=15,M.style.margin=c?"-16px 10px 10px 1px":"0px 10px 10px 1px",w.appendChild(M);var U=document.createElement("span"),R=!1;window.navigator&&window.navigator.standalone&&(R=!0),c?U.innerHTML="\u30af\u30ea\u30c3\u30af\u3057\u3066\u4fdd\u5b58":(U.innerHTML=R?"\u30bf\u30c3\u30d7\u3057\u3066\u4fdd\u5b58":"\u9577\u62bc\u3057\u4fdd\u5b58",p&&(U.innerHTML="\u30bf\u30c3\u30d7->\u9577\u62bc\u3057\u4fdd\u5b58")),U.style.position="absolute",U.style.margin=c?"-20px 10px 10px 20px":"-4px 10px 10px 20px",w.appendChild(U);var G=document.createElement("input");G.src=L,G.className="captureimg",G.type="image",w.appendChild(G),P.appendChild(w),G.onclick=function(){p?m.toBlob(function(e){D.saveAs(e,"\u30d3\u30d3\u30c3\u30c9\u30a2\u30fc\u30df\u30fc\u4e16\u754c.jpg")}):D.saveAs(G.src,"\u30d3\u30d3\u30c3\u30c9\u30a2\u30fc\u30df\u30fc\u4e16\u754c.jpg")}},tryForceUpdate:function(){if(console.log("WWW!!!"),confirm("\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u914d\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u3092\u66f4\u65b0\u3057\u307e\u3059\u304b\uff1f")){C.default.Instance.PostActionWithTime("G123_ForceUpdate",1);try{localStorage.setItem("G123_ForceUpdate","1")}catch(e){}window.location.reload(!0)}return!0}};return t},e}();a.default=B,cc._RF.pop()},{"../../Core/Common/TableManager":"TableManager","../../Core/Net/NetMgr":"NetMgr","../../Core/Net/WebClient":"WebClient","../../Game/Common/BIManager":"BIManager","../../Game/Common/G123PayModel":"G123PayModel","../../Game/Common/ListView/FrameTaskManager":"FrameTaskManager","../../Game/Common/PFOpenData":"PFOpenData","../../Game/Common/UIManager":"UIManager","../../Game/Const/GameDefine":"GameDefine","../../Game/Const/RequestId":"RequestId","../../Game/Const/TableName":"TableName","../../Game/Data/DataCenter":"DataCenter","../../Game/Data/GlobalData":"GlobalData","../../Game/Profession/ProfessionController":"ProfessionController","../../Game/Tools/GameTools":"GameTools","../../Game/controllers/ExchangeController":"ExchangeController","../../Platform/PlatformHttpUtils":"PlatformHttpUtils","../display/MsgBox":"MsgBox","../utils/ErrorReport":"ErrorReport","../utils/FWSTool":"FWSTool","../utils/HttpUtils":"HttpUtils","../utils/LocalStorageUtils":"LocalStorageUtils","./FileSaver":"FileSaver","./PlatformCore":"PlatformCore"}],FWSTask:[function(e,t,a){"use strict";cc._RF.push(t,"c8b10HOZgpMap7EWWZVTtBI","FWSTask");var o,n=e("../FWSEnv"),i=e("../utils/FWSTool"),r=e("../../System/ErrorUtils"),s=e("../../System/JSWrap"),l=e("../utils/X");(function(e){e.PREV_PROGRESS=!1,e.USE_JSWRAP=!0;var t=function(){function t(e,t){void 0===e&&(e="Task"),void 0===t&&(t=!0),this.retryMax=0,this.retryCounter=0,this._alreadyBegin=!1,this._alreadyCompoleted=!1,this._customOverTime=0,this._beginTimer=0,this._endTimer=0,this._useTimeout=!0,this.text=e,this._useTimeout=t}return t.prototype.overTimeEnd=function(){n.DEBUG_REMOTE_LOADER_OVER_TIME_MODE&&this._useTimeout&&(e.USE_JSWRAP?s.default.clearTimeout(this._overTimerHandler):clearTimeout(this._overTimerHandler))},t.prototype.callListener=function(e,t){if(e){if(e===this.onCompleted){if(this.callListener_completed)return;this.callListener_completed=!0}if(e.handler){e===this.onCompleted&&(this.overTimeEnd(),this._alreadyCompoleted=!0,this._alreadyBegin=!1,this._endTimer=(new Date).getTime());try{e.handler.call(e.target,this,void 0!==t?t:this)}catch(e){l.warn(e)}}}},t.prototype.getOverTimeSetting=function(){return 0},t.prototype.afterOverTime=function(){},t.prototype.startOverTimeCheck=function(){if(n.DEBUG_REMOTE_LOADER_OVER_TIME_MODE&&this._useTimeout){e.USE_JSWRAP?s.default.clearTimeout(this._overTimerHandler):clearTimeout(this._overTimerHandler);var t=this.getOverTimeSetting(),a=this.customOverTime;if(t<a&&(t=a),!(t<=0)){var o=this,i=function(){o.completed||(l.log("Task\u8d85\u65f6",(new Date).getTime()-o._beginTimer),o._isOvertime=!0,o.afterOverTime(),o.callListener(o.onError))};e.USE_JSWRAP?this._overTimerHandler=s.default.setTimeout(i,t):this._overTimerHandler=setTimeout(i,t)}}},t.prototype.reset=function(){this.overTimeEnd(),this._alreadyBegin=!1,this._alreadyCompoleted=!1,this.callListener_completed=!1,this._isOvertime=!1,this.retryCounter++},t.prototype.begin=function(){this._beginTimer=(new Date).getTime(),this.startOverTimeCheck(),this.callListener(this.onBegin)},t.prototype.cancel=function(){this._alreadyBegin=!1,this._alreadyCompoleted=!1,this.onBegin=this.onProgress=this.onCompleted=this.onError=null},t.prototype.toStringAddon=function(){return""},t.prototype.toString=function(){return(this.text||"Task")+this.toStringAddon()},t.prototype.getDebugInfo=function(){return this._isOvertime?"\u8d85\u65f6":this.getDebugStatusInfo()},t.prototype.getDebugStatusInfo=function(){return"\u5931\u8d25"},Object.defineProperty(t.prototype,"customOverTime",{get:function(){return this._customOverTime},set:function(e){this._customOverTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"completed",{get:function(){return this._alreadyCompoleted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"progress",{get:function(){return this._alreadyCompoleted?1:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"beginTimer",{get:function(){return this._beginTimer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endTimer",{get:function(){return this._endTimer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTime",{get:function(){return this._endTimer<=0||this._beginTimer<=0?-1:this._endTimer-this._beginTimer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOvertime",{get:function(){return this._isOvertime},enumerable:!0,configurable:!0}),t}();e.Task=t;var a=function(t){function a(e){void 0===e&&(e="TaskList");var a=t.call(this,e)||this;return a._taskIndex=0,a._tasks=[],a._asyncMode=!1,a._host=null,a.retry=0,a}return __extends(a,t),a.prototype.initTaskCallbacks=function(e){try{e.onBegin={handler:this.onTaskBegin,target:this,data:e},e.onCompleted={handler:this.onTaskCompleted,target:this,data:e},e.onError={handler:this.onTaskError,target:this,data:e},e.onProgress={handler:this.onTaskProgress,target:this,data:e}}catch(e){}},a.prototype.onTaskBegin=function(e,t){},a.prototype.onTaskCompleted=function(t,a){if(this.callListener(this.onProgress),this._taskIndex++,null!=this._host&&this.checkAllCompoleted())return this._alreadyCompoleted=!0,this.callListener(this.onCompleted),void this.callListener(this.onSubListCompleted);var o=this,n=function(){o._beginNexTaskHandler=null;try{o.beginNextTask(o)}catch(t){var e=new r.ErrorInfo;e.errMsgInfo=t,e.funcName="beginNextTask",e.customInfo="TaskList Error",r.ErrorUtils.errorMessage(e)}};e.USE_JSWRAP?this._beginNexTaskHandler=s.default.setTimeout(n,0):this._beginNexTaskHandler=setTimeout(n,0)},a.prototype.onTaskProgress=function(e,t){this.callListener(this.onProgress)},a.prototype.onTaskError=function(t,a){if(this.onError&&this.onError.handler)try{this.onError.handler.call(this.onError.target,this,a)}catch(e){l.error(e)}if(this.retry>0){a.reset();var o=function(){l.log("\u81ea\u52a8\u91cd\u8bd5",a),a.begin()};e.USE_JSWRAP?s.default.setTimeout(o,this.retry):setTimeout(o,this.retry)}},a.prototype.beginNextTask=function(e){if(this.checkAllCompoleted())return this._alreadyCompoleted=!0,this.callListener(this.onCompleted),void this.callListener(this.onSubListCompleted);if(!this.asyncMode){var t=this._tasks[this._taskIndex];t&&(this.initTaskCallbacks(t),t.begin(),this.callListener(this.onProgress))}},a.prototype.checkAllCompoleted=function(){for(var e=!0,t=0;t<this._tasks.length;t++)if(!this._tasks[t].completed){e=!1;break}return e},a.prototype.reset=function(){this._beginNexTaskHandler&&(e.USE_JSWRAP?s.default.clearTimeout(this._beginNexTaskHandler):clearTimeout(this._beginNexTaskHandler),this._beginNexTaskHandler=null),t.prototype.reset.call(this);for(var a=0;a<this._tasks.length;a++){var o=this._tasks[a];o.cancel(),o.reset()}this._taskIndex=0},a.prototype.begin=function(){if(this.asyncMode)for(var e=0;e<this._tasks.length;e++){var t=this._tasks[e];this.initTaskCallbacks(t),t.begin()}else this.beginNextTask(this),this.callListener(this.onBegin)},a.prototype.cancel=function(){this.reset()},a.prototype.add=function(e){if(e){if(e instanceof a)e._host=this;this._tasks.push(e)}},a.prototype.remove=function(e){var t=this._tasks.indexOf(e);if(t>=0){var o=this._tasks[t];if(o instanceof a){var n=o;n._host=null,n.clear()}o.onBegin=o.onError=o.onCompleted=o.onProgress=null,this._tasks.splice(t,1)}},a.prototype.clear=function(){for(var e=0;e<this._tasks.length;e++){var t=this._tasks[e];if(t instanceof a)t.clear();t.onBegin=t.onError=t.onCompleted=t.onProgress=null}this._tasks.length=0},Object.defineProperty(a.prototype,"asyncMode",{get:function(){return this._asyncMode},set:function(e){this._asyncMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tasks",{get:function(){return this._tasks.slice(0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"progress",{get:function(){if(this._tasks.length>0){for(var e=0,t=1/this._tasks.length,a=0;a<this._tasks.length;a++){e+=t*this._tasks[a].progress}return e>=.99&&(e=1),e}return 0},enumerable:!0,configurable:!0}),a}(t);e.TaskList=a,e.begin=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(null===t||void 0===t||0===t.length)return e&&e.success&&e.success(),null;for(var n=new a,i=0;i<t.length;i++)n.add(t[i]);return n.onCompleted={target:null,handler:function(){e&&e.success&&e.success()}},n.onError={target:null,handler:function(){e&&e.success&&e.fail()}},n};var o=function(e){function t(t,a,o){void 0===a&&(a=null),void 0===o&&(o=null);var n=e.call(this)||this;return n._fun=t,n._target=a,n._note=o,n}return __extends(t,e),t.prototype.getOverTimeSetting=function(){return 0},t.prototype.begin=function(){e.prototype.begin.call(this),this._alreadyCompoleted=!0,this._alreadyBegin=!0;try{i.Str.isEmpty(this._note)||l.info("FunctionTask",this._note),this._fun.apply(this._target)}catch(e){var t=new r.ErrorInfo;t.errMsgInfo=e,t.funcName="begin",t.customInfo="FunctionTask  "+this._note,r.ErrorUtils.errorMessage(t)}this.callListener(this.onCompleted)},Object.defineProperty(t.prototype,"progress",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"completed",{get:function(){return this._alreadyCompoleted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alreadyCompleted",{get:function(){return this._alreadyCompoleted},enumerable:!0,configurable:!0}),t}(t);e.FunctionTask=o})(o||(o={})),t.exports=o,cc._RF.pop()},{"../../System/ErrorUtils":"ErrorUtils","../../System/JSWrap":"JSWrap","../FWSEnv":"FWSEnv","../utils/FWSTool":"FWSTool","../utils/X":"X"}],ErrorReport:[function(e,t,a){"use strict";var o;cc._RF.push(t,"41cffNw7zVIY6j1iZzE1N8b","ErrorReport"),function(e){function t(t,a,o){void 0===o&&(o=e.TraceLevels.LOG),e.methods&&e.methods.custom&&e.methods.custom(t,a,o)}function a(t,a,o){void 0===a&&(a="trace"),void 0===o&&(o=e.TraceLevels.TRACE),e.methods&&e.methods.trace&&e.methods.trace(t,a,o)}(function(e){e[e.FATAL=0]="FATAL",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.LOG=3]="LOG",e[e.DATA=4]="DATA",e[e.TRACE=5]="TRACE"})(e.TraceLevels||(e.TraceLevels={})),e.packHandlerTimer=function(t,a,o){e.methods&&e.methods.packHandlerTimer(t,a,o)},e.table=function(t,a,o){void 0===t&&(t=void 0),void 0===a&&(a=0),void 0===o&&(o=""),e.methods&&e.methods.table&&e.methods.table(t,a,o)},e.res=function(t,a,o){void 0===a&&(a=0),void 0===o&&(o=""),e.methods&&e.methods.res&&e.methods.res(t,a,o)},e.serverList=function(t,a){e.methods&&e.methods.serverlist&&e.methods.serverList(t,a)},e.login=function(t,a,o){void 0===o&&(o=""),e.methods&&e.methods.login&&e.methods.login(t,a,o)},e.custom=t,e.sendCustom=function(e,a){t(e,a)},e.error=function(t,a,o,n,i){void 0===n&&(n=!1),void 0===i&&(i="CodeError"),e.methods&&e.methods.error&&e.methods.error(t,a,o,n,i)},e.trace=a,e.config=function(e,t){a({resp:e,data:t},"ConfigError")}}(o||(o={})),t.exports=o,cc._RF.pop()},{}],ErrorReportMethods:[function(e,t,a){"use strict";cc._RF.push(t,"6992dxRnihKQoxUPJBV5Eeg","ErrorReportMethods");var o,n=e("./X"),i=e("../../Game/Data/GlobalData"),r=e("../platforms/PlatformCore"),s=e("./LocalStorageUtils"),l=e("../../Game/Const/GameDefine"),c=e("./FWSTool"),d=e("./ErrorReport");(function(e){var t,a=[],o={},l=!1,p=0;function u(){var e=window.BIUtils;if(e&&e.tempId)return e.tempId}function h(){var e=s.get("lastLoginUid",!1),a=s.get("lastLoginSid",!1);o.uid=e||void 0,o.sid=a||void 0;var n=s.get("app_platformSID");if(o.appSid=n||void 0,t=u()||"__"+c.Str.guid()+"__",!l){l=!0,setInterval(function(){v()},1e4),o.clientVer=i.GLOBAL.GameVersion,o.appVer=r.instance.getPlatformVer(),i.GLOBAL.BuildVersion&&(o.clientVer+="."+i.GLOBAL.BuildVersion),o.platform=r.instance.platformSID,o.container=r.instance.getContainerType();var d=r.instance.getSystemInfoSync();if(d&&(null!==d.benchmarkLevel&&void 0!==d.benchmarkLevel&&(o.benchmark=d.benchmarkLevel+""),o.device=d.model,o.system=d.system,d.deviceId&&(o.deviceId=d.deviceId)),navigator&&navigator.userAgent){o.userAgent=navigator.userAgent;var p=navigator.userAgent.toLowerCase();if(p){var h={},m=void 0;(m=p.match(/edge\/([\d.]+)/))?h.edge=m[1]:(m=p.match(/msie ([\d.]+)/))?h.ie=m[1]:(m=p.match(/firefox\/([\d.]+)/))?h.firefox=m[1]:(m=p.match(/chrome\/([\d.]+)/))?h.chrome=m[1]:(m=p.match(/opera.([\d.]+)/))?h.opera=m[1]:(m=p.match(/version\/([\d.]+).*safari/))&&(h.safari=m[1]),h.edge&&(o.browser="Egde "+h.edge),h.ie&&(o.browser="IE "+h.ie),h.firefox&&(o.browser="Firefox "+h.firefox),h.chrome&&(o.browser="Chrome "+h.chrome),h.opera&&(o.browser="Opera "+h.opera),h.safari&&(o.browser="Safari "+h.safari)}}}}function m(e,t){if("object"==typeof t&&"object"==typeof e&&e)for(var a in e){var o=e[a];null!==o&&void 0!==o&&(""!==o&&(t[a]=o.toString()))}}function f(e){e&&m(o,e)}function _(e){e.APIVersion="0.6.0",e.__topic__="error";var t=r.instance.getErrorReportPostUri()||"https://knight.cn-beijing.log.aliyuncs.com/logstores/client/track";n.log("(ErrorReport:Get)",e);var a="";for(var o in e){var i=e[o],s=encodeURIComponent(o),l=encodeURIComponent(i);a.length>0&&(a+="&"),a+=s+"="+l}t.indexOf("?")<0&&(t+="?"),t+=a;var c=new XMLHttpRequest;c.open("GET",t),c.setRequestHeader("content-type","text/plain;charset=UTF-8"),c.onerror=c.ontimeout=c.onreadystatechange=function(){},c.send()}var y=[];function g(e){e&&I([e])}function C(e){y.push(e)}function v(){0!=y.length&&(I(y),y.length=0)}function I(e){n.log("(ErrorReport:Post) sendPost",e.slice(0));var t,a=r.instance.getErrorReportPostUri()||"https://knight.cn-beijing.log.aliyuncs.com/logstores/client/track",o=new XMLHttpRequest,i={};i.__logs__=e;try{t=JSON.stringify(i)}catch(e){}o.open("POST",a,!0),o.setRequestHeader("x-log-apiversion","0.6.0"),o.setRequestHeader("x-log-bodyrawsize",t.length+""),o.setRequestHeader("content-type","application/json"),o.onerror=o.ontimeout=o.onreadystatechange=function(){},o.send(t)}function T(e,a,o,i){void 0===o&&(o=!1),void 0===i&&(i=!1);try{h();var r=a||{},s={_level_:d.TraceLevels[e],_ver_:"2.0"};s._guid_=t,s._datetime_=c.Str.nowDateTime(),f(s),m(r,s),s._seq_=(++p>1e8&&(p=1),p).toString(),s.resp=s.resp||"EMPTY",o?i?C(s):g(s):_(s)}catch(e){n.error("(ErrorReport\u5f02\u5e38)",e)}}function S(e){void 0===e&&(e=0);var t=.9*(e||0)*100;return(t=Math.floor(t))+"%"}function A(e,t,a){void 0===a&&(a=d.TraceLevels.LOG);var o=t||{};o.type=e,T(a,o,!0)}e.post=I,e.packHandlerTimer=function(e,t,a){T(d.TraceLevels.DATA,{type:"pack_handle",id:e,time:t,resp:a?"\u5904\u7406\u8bf7\u6c42":"\u5904\u7406\u63a8\u9001"},!0,!0)},e.req=function(e,t,a,o,n,i,r){var s={type:"request_timer",id:e,time:t,host:a,sendFrame:o,frames:n,region:r};i&&(s.ping=i),T(d.TraceLevels.DATA,s,!0,!0)},e.table=function(e,t,a){void 0===e&&(e=void 0),void 0===t&&(t=0),void 0===a&&(a=""),T(d.TraceLevels.FATAL,{type:"download",file:"TABLE",uri:e,desc:a,host:i.GLOBAL.ResourceUrl,progress:S(t)},!1)},e.res=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=""),T(d.TraceLevels.WARNING,{type:"download",file:"RES",uri:e,desc:a,host:i.GLOBAL.ResourceUrl,progress:S(t)},!1)},e.serverList=function(e,t){T(d.TraceLevels.FATAL,{type:"serverlist",status:e,data:t},!0)},e.login=function(e,t,a){void 0===a&&(a=""),0!=e&&T(d.TraceLevels.FATAL,{type:"login",status:e,data:t,host:a},!0)},e.launch=function(e,t,a){a=a||{};var o=window.ELEX_BI,n=0;if(o){var i=Date.now();(n=i-o.beginGameTime-o.cumulastGideGameTime)<0&&(a.message="curTime: "+i+" beginGameTime "+o.beginGameTime+" cgTime "+o.cumulastGideGameTime),0===o.cumulastGideGameTime&&(a.n_session=1,"\u51b7\u542f\u52a8\u8fdb\u5165\u6e38\u620f"===e&&(n>23e3?s.set("Use_Low_Device_Mode","1"):n<1e4&&s.set("Use_Low_Device_Mode","0")))}a.type="launch",a.resp=e,a.time=n,a.newbie=t?1:0,T(d.TraceLevels.LOG,a,!0)},e.custom=A,e.sendCustom=function(e,t){A(e,t,d.TraceLevels.WARNING)},e.error=function(e,t,o,n,i){if(void 0===n&&(n=!1),void 0===i&&(i="CodeError"),e&&!(a.indexOf(e.stack)>=0)){a.push(e.stack);var r=e.message||"",s={};s.type=i,s.func=t,s.custom=o,s.stack=e.stack||"",s.stack=s.stack.replace(/\(\S*$/gm,""),s.stack=s.stack.replace(/@\S*$/gm,""),s.stack=s.stack.substr(0,2048),s.resp=r.replace(/[:,=\s]+/gm,"_"),T(n?d.TraceLevels.FATAL:d.TraceLevels.ERROR,s,!0)}},e.trace=function(e,t,a){void 0===t&&(t="trace"),void 0===a&&(a=d.TraceLevels.TRACE),(e=e||{}).type=t,T(a,e,!0,!0)}})(o||(o={})),l.NetReqReport=function(e,t,a,n,i,r,s){o.req(e,t,a,n,i,r,s)},l.TraceReport=function(e){o.trace(e)},l.customReport=function(e,t,a){void 0===a&&(a=d.TraceLevels.LOG),o.custom(e,t,a)},l.packHandlerTimer=function(e,t,a){o.packHandlerTimer(e,t,a)},l.launchReport=function(e,t,a){o.launch(e,t,a)},l.launchOrReconnectReport=function(e,t,a,n){t?o.launch(e,a,n):((n=n||{}).resp=e,o.custom("login",n,d.TraceLevels.LOG))},d.methods=o,t.exports=o,cc._RF.pop()},{"../../Game/Const/GameDefine":"GameDefine","../../Game/Data/GlobalData":"GlobalData","../platforms/PlatformCore":"PlatformCore","./ErrorReport":"ErrorReport","./FWSTool":"FWSTool","./LocalStorageUtils":"LocalStorageUtils","./X":"X"}],FWS2DUtils:[function(e,t,a){"use strict";var o;cc._RF.push(t,"c2314FaoFBFfKJiIEVoezRt","FWS2DUtils"),function(e){function t(e,t,a,o){var n=[],i=e.x,r=e.y,s=t.x,l=t.y,c=a.x,d=a.y,p=o.x,u=o.y;if(i===s&&r===l||c===p&&d===u)return n;var h=(u-d)*(s-i)-(p-c)*(l-r);if(0===h)return n;var m=((p-c)*(r-d)-(u-d)*(i-c))/h,f=((s-i)*(r-d)-(l-r)*(i-c))/h;if(m<0||m>1||f<0||f>1)return n;var _=i+m*(s-i),y=r+m*(l-r);return n.push(cc.v2(_,y)),n}function a(e,t,a,o){return cc.Intersection.lineLine(e,t,a,o)}e.distance=function(e,t){var a=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);return Math.sqrt(a*a+o*o)},e.angle=function(e,t,a){void 0===a&&(a=!1);var o=t.x-e.x,n=t.y-e.y,i=Math.atan2(o,n)*(180/Math.PI);return a&&(i+=360,i=360-(i%=360)+90,i%=360),i},e.position=function(e,t,a,o,n,i){void 0===o&&(o=1),void 0===n&&(n=1),void 0===i&&(i=0);var r=new cc.Vec2,s=t/(180/Math.PI),l=a*Math.cos(s),c=a*Math.sin(s);return r.x=e.x+l*o,r.y=e.y+c*n,r},e.get2LineIntersectPoint=t,e.getLineAndRectIntersect=function(e,a,o){var n=cc.v2(o.x,o.y+o.height),i=cc.v2(o.x+o.width,o.y+o.height),r=cc.v2(o.x+o.width,o.y),s=cc.v2(o.x,o.y),l=t(e,a,n,i),c=t(e,a,i,r),d=t(e,a,r,s),p=t(e,a,s,n);return l.concat(c,d,p)},e.check2LineIntersect=a,e.checkLineAndRectIntersect=function(e,t,o){if(o.contains(e)&&o.contains(t))return!0;var n=new cc.Vec2(o.x,o.y+o.height),i=new cc.Vec2(o.x+o.width,o.y+o.height),r=new cc.Vec2(o.x+o.width,o.y),s=new cc.Vec2(o.x,o.y);return!!(a(e,t,n,i)||a(e,t,i,r)||a(e,t,r,s)||a(e,t,s,n))}}(o||(o={})),window.FWS2DUtils=o,t.exports=o,cc._RF.pop()},{}],FWSTool:[function(e,t,a){"use strict";cc._RF.push(t,"68de0Soxf1FO4c3C9Q+J0oa","FWSTool");var o,n=e("./LocalStorageUtils");(function(e){var t=function(){function e(){}return e.isEmpty=function(e){return null===e||void 0===e},e.getProperty=function(e,t,a){return e&&null!==e[t]&&void 0!==e[t]?e[t]:a},e.getPropertyByNames=function(e,t){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];for(var n=e,i=0;i<a.length&&n;i++){var r=a[i];if(null===n[r]||void 0===n[r])break;if(n=n[r],i===a.length-1&&null!==n&&void 0!==n)return n}return t},e.getPropertyStringByNames=function(e,t){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];for(var n=e,i=t,r=0;r<a.length&&n;r++){var s=a[r];if(null===n[s]||void 0===n[s])break;if(n=n[s],r===a.length-1&&null!==n&&void 0!==n){"string"==typeof n?i=n:"number"==typeof n&&(i=n.toString());break}}return i},e.getPropertyStringByName=function(e,t,a){var o=e?e[a]:void 0;if(void 0!==o&&null!==o)switch(typeof o){case"string":return o;case"number":return o.toString()}return t},e.getPropertyNumberByNames=function(e,t){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];for(var n=e,i=t,r=0;r<a.length&&n;r++){var s=a[r];if(null===n[s]||void 0===n[s])break;if(n=n[s],r===a.length-1&&null!==n&&void 0!==n){"number"==typeof n?i=n:"string"==typeof n&&(i=parseInt(n));break}}return i},e.getPropertyNumberByName=function(e,t,a){var o=e?e[a]:void 0;if(void 0!==o&&null!==o)switch(typeof o){case"number":return o;case"string":return parseInt(o)}return t},e.is=function(e,t){var a=!1;return t===Function&&"function"==typeof e?a=!0:t===Number&&"number"==typeof e?a=!0:t===Boolean&&"boolean"==typeof e?a=!0:t===String&&"string"==typeof e?a=!0:"object"==typeof e&&(a=e instanceof t),a},e.isString=function(e){return"string"==typeof e},e.isNumber=function(e){return"number"==typeof e},e.isFunction=function(e){return"function"==typeof e},e.getClassName=function(e){return null!==e&&void 0!==e&&e.constructor&&null!==e.constructor.name&&void 0!==e.constructor.name?e.constructor.name:""},e}();e.Obj=t;var a=function(){function a(){}return a.replaceSpecChars=function(e){return e.replace(/\u1160/g,"?")},a.verifyChineseID=function(e){return/^\S{15,}$/.test(e)},a.joinPath=function(e,t,a){return void 0===a&&(a="/"),e&&e.substr(e.length-1,1)!=a?e+"/"+t:e+t},a.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},a.ltrim=function(e){return e.replace(/^\s+/g,"")},a.rtrim=function(e){return e.replace(/\s+$/g,"")},a.trim=function(e){return a.ltrim(a.rtrim(e))},a.repeat=function(e,t){for(var a="",o=0;o<e;o++)a+=t;return a},a.padLeft=function(e,t,o){var n=a.repeat(t,o)+e;return n=n.substr(n.length-t)},a.padRight=function(e,t,o){var n=e+a.repeat(t,o);return n=n.substr(0,t)},a.nowDateTime=function(){var e=new Date,t=a.padLeft(e.getFullYear().toString(),4,"0");return t+="/",t+=a.padLeft((e.getMonth()+1).toString(),2,"0"),t+="/",t+=a.padLeft(e.getDate().toString(),2,"0"),t+=" ",t+=a.padLeft(e.getHours().toString(),2,"0"),t+=":",t+=a.padLeft(e.getMinutes().toString(),2,"0"),t+=":",t+=a.padLeft(e.getSeconds().toString(),2,"0"),t+=":",t+=a.padLeft(e.getMilliseconds().toString(),3,"0")},a.dateTime=function(e){var t=a.padLeft(e.getFullYear().toString(),4,"0");return t+="/",t+=a.padLeft((e.getMonth()+1).toString(),2,"0"),t+="/",t+=a.padLeft(e.getDate().toString(),2,"0"),t+=" ",t+=a.padLeft(e.getHours().toString(),2,"0"),t+=":",t+=a.padLeft(e.getMinutes().toString(),2,"0"),t+=":",t+=a.padLeft(e.getSeconds().toString(),2,"0"),t+=":",t+=a.padLeft(e.getMilliseconds().toString(),3,"0")},a.dateTimeFormat=function(e,t,a){void 0===t&&(t="yyyy-MM-dd hh:mm:ss"),void 0===a&&(a=!1);var o=n.get("localLanguage");("zh_cn"!==o&&"ja"!==o&&("de"===o?t=t.replace("yyyy-MM-dd","dd.MM.yyyy"):"ru"===o&&(t=t.replace("yyyy-MM-dd","MM/dd/yyyy"))),"ja"===o)&&(t===(t=t.replace("yyyy-MM-dd","MM-dd"))&&(t=t.replace("yy-MM-dd","MM-dd")));var i={"y+":e.getFullYear(),"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};for(var r in a&&(i={"y+":e.getUTCFullYear(),"M+":e.getUTCMonth()+1,"d+":e.getUTCDate(),"h+":e.getUTCHours(),"m+":e.getUTCMinutes(),"s+":e.getUTCSeconds(),"q+":Math.floor((e.getUTCMonth()+3)/3),"S+":e.getUTCMilliseconds()}),i)if(new RegExp("("+r+")").test(t))if("y+"==r)t=t.replace(RegExp.$1,(""+i[r]).substr(4-RegExp.$1.length));else if("S+"==r){var s=RegExp.$1.length;s=1==s?3:s,t=t.replace(RegExp.$1,("00"+i[r]).substr((""+i[r]).length-1,s))}else t=t.replace(RegExp.$1,1==RegExp.$1.length?i[r]:("00"+i[r]).substr((""+i[r]).length));return t},a.customDateToTimestamp=function(e){for(var t=[1990,1,1,0,0,0],a=[/^\d\d\d\d$/,/^\d+$/,/^\d+$/,/^\d+$/,/^\d+$/,/^\d+$/],o=e.split("-"),n=Math.min(o.length,t.length),i=0;i<n;i++){var r=new RegExp(a[i]),s=o[i];r.test(s)&&(t[i]=parseInt(s))}return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]).getTime()/1e3},a.ConvertBeiJingTimeToStamp=function(e){for(var t=[1990,1,1,0,0,0],a=[/^\d\d\d\d$/,/^\d+$/,/^\d+$/,/^\d+$/,/^\d+$/,/^\d+$/],o=e.split("-"),n=Math.min(o.length,t.length),i=0;i<n;i++){var r=new RegExp(a[i]),s=o[i];r.test(s)&&(t[i]=parseInt(s))}var l=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]),c=l.getHours(),d=-l.getTimezoneOffset()/60;return l.setHours(c+d-8),l.getTime()/1e3},a.isEmpty=function(e){return null===e||void 0===e||(0===e.length||0===a.trim(e.toString()).length)},a.versionCompare=function(e,t){if(!e&&!t)return 0;if(0===e.length&&0===t.length)return 0;for(var a=e.split("."),o=t.split("."),n=Math.max(a.length,o.length),i=0;i<n;i++){var r=a[i],s=o[i],l=0,c=0;if(r&&(l=parseInt(r)),s&&(c=parseInt(s)),l>c)return 1;if(l<c)return-1}return 0},a.getFilename=function(e){if(null!==e&&void 0!==e){var t=e+"",a=e.lastIndexOf("/"),o=e.lastIndexOf("\\"),n=-1;(a>=0||o>=0)&&(n=Math.max(a,o))<t.length&&(t=t.substr(n+1));var i=t.lastIndexOf(".");return i>=0&&(t=t.substr(0,i)),t}return""},a.addFileType=function(e,t){var a=e+"";return a.length>=t.length?a.substr(a.length-t.length).toUpperCase()!==t.toUpperCase()&&(a+=t):a+=t,a},a.matchs=function(e,t){for(var a=new Array,o=null;null!==(o=e.exec(t));)a.push(o);return a},a.format=function(t){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];for(var n=t+"",i=0;i<a.length;i++){var r=new RegExp("\\{"+i+"\\}","gm"),s=a[i],l=e.Str.isEmpty(s)?"":s.toString();n=n.replace(r,l)}return n},a.formatObject=function(e,o){for(var n=new RegExp("\\{[^\\{\\}]*\\}","gm"),i=a.matchs(n,e),r=e+"",s=i.length-1;s>=0;s--){var l=i[s],c=l.index,d=l[0].length,p=o[l[0].substr(1,d-2)],u=t.isEmpty(p)?"":p.toString();r=r.substr(0,c)+u+r.substr(c+d)}return r},a.formatArray=function(e,t,o){if(void 0===o&&(o=""),null===t||void 0===t||0===t.length)return"";for(var n=[],i=0;i<t.length;i++)n.push(a.formatObject(e,t[i]));return n.join(o)},a.formatNumbericThousand=function(e,t){void 0===t&&(t=1);for(var a=Math.floor(e/t).toString(),o="",n=0;n<a.length;n++){var i=a.substr(a.length-1-n,1);n>=3&&n%3==0&&(o=","+o),o=i+o}return o},a.formatNumbericK=function(e){for(var t=["K","M","G","T"],a=4;a>=0;a--)if(e>=Math.pow(1e3,a+1))return this.formatNumbericThousand(e,Math.pow(1e3,a+1))+" "+t[a];return this.formatNumbericThousand(e)},a}();e.Str=a;var o=function(){function e(){}return e.isEmpty=function(e){return null===e||(void 0===e||0===e.length)},e.inRange=function(e,a){return!t.isEmpty(e)&&(a>=0&&a<e.length)},e.remove=function(e,t){var a=e.indexOf(t);a>=0&&a<e.length&&e.splice(a,1)},e}();e.Ary=o;var i=function(){function e(){}return e.contain=function(e,a){return!t.isEmpty(e)&&!t.isEmpty(a)&&(e&a)===a},e.add=function(e,a){return t.isEmpty(e)&&t.isEmpty(a)?0:t.isEmpty(e)?a:t.isEmpty(a)?e:e|a},e.remove=function(e,a){return t.isEmpty(e)?0:t.isEmpty(a)?e:(e&a)==a?e-a:e},e}();e.Enum=i;var r=function(){function e(){}return e.getFloat=function(e,t){return Math.random()*(t-e)+e},e.getInt=function(t,a){return Math.round(e.getFloat(t,a))},e.getArray=function(t){return t&&t.length>0?t[e.getInt(0,t.length-1)]:null},e.getArrayByProbability=function(t,a){if(t&&t.length>0&&a&&a.length===t.length){for(var o=0,n=0;n<a.length;n++)o+=a[n];var i=e.getInt(0,o),r=0,s=0;for(n=0;n<a.length;n++){if(s+=a[n],i>=r&&i<=s)return t[n];r+=a[n]}}return null},e.toArray=function(e){for(var t=e.slice(0),a=t.length,o=0;o<a-1;o++){var n=Math.floor(Math.random()*(a-o)),i=t[n];t[n]=t[a-o-1],t[a-o-1]=i}return t},e}();e.Random=r;var s=function(){function t(){}return t.convertTimeZone=function(e,t,a){void 0===t&&(t=8),void 0===a&&(a=null);var o=e.getTime(),n=3600*t*1e3;o-=n,o+=n=null==a?60*-(new Date).getTimezoneOffset()*1e3:3600*a*1e3;var i=new Date;return i.setTime(o),i},t.convertTimeZoneHours=function(e,t,a){void 0===t&&(t=8),void 0===a&&(a=null);var o=new Date(2e3,1,1,e,0,0,0);return(o=this.convertTimeZone(o,t,a)).getHours()},t.parseDateTime=function(t,a){if(void 0===a&&(a=!0),t){var o=t.split(/\D+/);if(6==o.length){var n=o[0]+"-"+o[1]+"-"+o[2]+" "+o[3]+":"+o[4]+":"+o[5],i=new Date(n);return a&&(i=e.DateTime.convertTimeZone(i)),i}}return new Date},t}();e.DateTime=s;var l=function(){function e(){}return e.readByte=function(e,t){return e&&t<e.length?e[t]:0},e.readInt16=function(e,t){var a=this.readByte(e,t);return(this.readByte(e,t+1)<<8)+a},e}();e.Binary=l,e.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var a,o,n,i,r,s,l,c="",d=0;for(t=e.Base64._utf8_encode(t);d<t.length;)i=(a=t.charCodeAt(d++))>>2,r=(3&a)<<4|(o=t.charCodeAt(d++))>>4,s=(15&o)<<2|(n=t.charCodeAt(d++))>>6,l=63&n,isNaN(o)?s=l=64:isNaN(n)&&(l=64),c=c+this._keyStr.charAt(i)+this._keyStr.charAt(r)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return c},decode:function(t){var a,o,n,i,r,s,l="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)a=this._keyStr.indexOf(t.charAt(c++))<<2|(i=this._keyStr.indexOf(t.charAt(c++)))>>4,o=(15&i)<<4|(r=this._keyStr.indexOf(t.charAt(c++)))>>2,n=(3&r)<<6|(s=this._keyStr.indexOf(t.charAt(c++))),l+=String.fromCharCode(a),64!=r&&(l+=String.fromCharCode(o)),64!=s&&(l+=String.fromCharCode(n));return l=e.Base64._utf8_decode(l)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",a=0;a<e.length;a++){var o=e.charCodeAt(a);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},_utf8_decode:function(e){for(var t="",a=0,o=0,n=0,i=0;a<e.length;)(o=e.charCodeAt(a))<128?(t+=String.fromCharCode(o),a++):o>191&&o<224?(n=e.charCodeAt(a+1),t+=String.fromCharCode((31&o)<<6|63&n),a+=2):(n=e.charCodeAt(a+1),i=e.charCodeAt(a+2),t+=String.fromCharCode((15&o)<<12|(63&n)<<6|63&i),a+=3);return t}}})(o||(o={})),t.exports=o,cc._RF.pop()},{"./LocalStorageUtils":"LocalStorageUtils"}],HttpUtils:[function(e,t,a){"use strict";cc._RF.push(t,"10d3fJfzB9O+4IqFrecCXGH","HttpUtils");var o,n=e("./FWSTool"),i=e("./LocalStorageUtils"),r=e("../FWSEnv");(function(e){function t(e,t,a){void 0===t&&(t=!1),void 0===a&&(a=1e3);var o=(new Date).getTime();o/=a,t||(o/=60,o/=3);var n=Math.floor(o).toString(),i=e.indexOf("?");return i>=0?e.substr(0,i)+"__ts__="+n+"&":e+"?__ts__="+n}e.getHttpCache=function(e){if(!r.HTTP_CACHE_ENABLED)return null;var t="HTTPURL::"+e;return i.get(t)},e.setHttpCache=function(e,t){if(r.HTTP_CACHE_ENABLED){var a="HTTPURL::"+e;i.set(a,t)}},e.setTargetUrl=function(e,t){var a="CACHEURL::"+e,o=t;i.set(a,o)},e.getTargetUrl=function(e){var a="CACHEURL::"+e,o=i.get(a);return n.Str.isEmpty(o)?t(e):o},e.addTimespan=t;var a=/^(http|https):\/+([^\/\:]+)(:\d+)?([^\?\#]*)(\?[^#]*)?(#[^\r\n]*)?$/;function o(e,t,a){var o=e+"";return t?null===a||void 0===a?o:(o.length>0&&(o+="&"),o+=encodeURIComponent(t),o+="=",o+=encodeURIComponent(a.toString())):o}function s(e){var t="";if(e&&"object"==typeof e)for(var a in e){var n=e[a];t=o(t,a.toString(),n)}return t}e.addParam=o,e.getParams=s,e.isUrl=function(e){return"about:blank"===e.toLowerCase()||a.test(e)};var l=function(){function t(e,t){this._scheme="",this._host="",this._port=0,this._path="",this._query="",this._anchor="",this.parse(e,t)}return t.isUrl=function(t){return e.isUrl(t)},t.prototype.parse=function(e,t){if(e){var o=e;if(t&&t.length>0&&(o="/"===t.substr(t.length-1,1)||"/"===e.substr(0,1)?t+e:t+"/"+e),a.test(o)){var n=a.exec(o);this._scheme=n[1]?n[1]:"",this._host=n[2]?n[2]:"",n[3]&&n[3].length>1?this._port=parseInt(n[3].substr(1)):this._port=0,this._path=n[4]?n[4]:"",n[5]&&n[5].length>1?this._query=n[5].substr(1):this._query="",n[6]&&n[6].length>1?this._anchor=n[6].substr(1):this._anchor=""}}},t.prototype.addQueryParam=function(e,t){this._query=o(this._query,e,t)},t.prototype.addAnchorParam=function(e,t){this._anchor=o(this._anchor,e,t)},t.prototype.setQueryParams=function(e){this._query=s(e)},t.prototype.setAnchorParams=function(e){this._anchor=s(e)},t.prototype.toString=function(){var e="";return e+=this._scheme+"://",e+=this._host,this._port>0&&(e+=":"+this._port.toString()),e+=this._path,this._query&&this._query.length>0&&(e+="?"+this._query),this._anchor&&this._anchor.length>0&&(e+="#"+this._anchor),e},Object.defineProperty(t.prototype,"scheme",{get:function(){return this._scheme},set:function(e){this._scheme=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(e){this._host=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"port",{get:function(){return this._port},set:function(e){this._port=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},set:function(e){this._path=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"query",{get:function(){return this._query},set:function(e){this._query=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor=e},enumerable:!0,configurable:!0}),t}();e.URL=l,e.getQueryString=function(e){var t=[];for(var a in e){var o=a,i=e[a]+"";i=encodeURIComponent(i),t.push(n.Str.format("{0}={1}",o,i))}return t.join("&")}})(o||(o={})),t.exports=o,cc._RF.pop()},{"../FWSEnv":"FWSEnv","./FWSTool":"FWSTool","./LocalStorageUtils":"LocalStorageUtils"}],IntervalReleaseManager:[function(e,t,a){"use strict";cc._RF.push(t,"6c37bAj4/FF/55zuwU4VkSa","IntervalReleaseManager");var o,n=e("./ErrorReport");(function(e){var t=null,a=[],o=new Map;function i(e,t,o){performance.now()-e>=t.aliveTime&&(a[a.length]=t)}function r(){t=null,o.forEach(i);for(var e=0,s=a.length;e<s;++e)try{o.delete(a[e]),a[e].release()}catch(e){n.default.error(e,"IntervalReleaseCheck",null)}a.length=0,o.size>0&&(t=setTimeout(r,1e3))}e.enabled=!0,e.reset=function(){o.clear(),t&&(clearTimeout(t),t=null)},e.add=function(a){e.enabled&&!o.has(a)&&(o.set(a,performance.now()),o.size>0&&!t&&(t=setTimeout(r,1e3)))},e.remove=function(t){e.enabled&&o.delete(t)}})(o||(o={})),t.exports=o,cc._RF.pop()},{"./ErrorReport":"ErrorReport"}],LocalStorageUtils:[function(e,t,a){"use strict";var o;cc._RF.push(t,"acfc9philZCfZ+Ux4hD+k/e","LocalStorageUtils"),function(e){e.get=function(e,t){void 0===t&&(t=!0);try{return t&&(e="sjzb_"+e),JSON.parse(localStorage.getItem(e))}catch(e){return null}},e.set=function(e,t,a){void 0===a&&(a=!0);try{a&&(e="sjzb_"+e),localStorage.setItem(e,JSON.stringify(t))}catch(e){}},e.del=function(e,t){void 0===t&&(t=!0);try{t&&(e="sjzb_"+e),localStorage.removeItem(e)}catch(e){}}}(o||(o={})),window.LocalStorageUtils=o,t.exports=o,cc._RF.pop()},{}],SubpackLoaderTask:[function(e,t,a){"use strict";cc._RF.push(t,"045f2Y+6SlLto/nUoNC2UmQ","SubpackLoaderTask"),Object.defineProperty(a,"__esModule",{value:!0});var o=e("../task/FWSTask"),n=e("../platforms/PlatformCore"),i="subpack",r=function(e){function t(t){void 0===t&&(t=i);var a=e.call(this,"SubpackLoaderTask")||this;return a._subpackName=t,a}return __extends(t,e),t.prototype.begin=function(){if(e.prototype.begin.call(this),!this._alreadyBegin&&!this._alreadyCompoleted)if(this._alreadyBegin=!0,this._alreadyCompoleted=!1,!n.instance.hasSubpack||n.instance.disabledSubpackNames&&n.instance.disabledSubpackNames.indexOf(this._subpackName)>=0)this.callListener(this.onCompleted);else{0;var t=this;cc.loader.downloader.loadSubpackage(this._subpackName,function(e){e?t.callListener(t.onError):t.callListener(t.onCompleted)})}},t}(o.Task);a.default=r,cc._RF.pop()},{"../platforms/PlatformCore":"PlatformCore","../task/FWSTask":"FWSTask"}],X:[function(e,t,a){"use strict";cc._RF.push(t,"f79c0qbYytCXaC+IbEdViLZ","X");var o,n=e("../FWSEnv"),i=e("./FWSTool"),r=e("../display/factory/FWSAssertCaches");(function(e){function t(e){if(n.DEBUG_ADVANCED)return JSON.stringify(e);var t=[];if(null!==e&&void 0!==e)for(var a=0;a<e.length;a++){var o=e[a];null===o?t.push("NULL"):void 0===o?t.push("UNDEFINED"):t.push(o.toString())}return t.join(" ")}function a(e){return!(n.LogFilters&&n.LogFilters.length>0&&n.LogFilters.indexOf(e)<0)}function o(e,o){var i=console[e];if(i&&a(e))try{n.DEBUG_ADVANCED?i.apply(null,o):i.call(null,t(o))}catch(e){}}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG&&o("log",e)}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG_ADVANCED&&console.group.apply(null,e)}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG_ADVANCED&&console.groupCollapsed.apply(null,e)}function d(){n.DEBUG_ADVANCED&&console.groupEnd()}e.format=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(!n.DEBUG)return"";var o=t.slice();o.splice(0,0,e);var r=i.Str.format.apply(null,o);return s(r),r},e.formatInt=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(!n.DEBUG)return"";for(var o=[],r=0;r<t.length;r++)o.push(Math.floor(t[r]));o.splice(0,0,e);var l=i.Str.format.apply(null,o);return s(l),l},e.log=s,e.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG&&o("info",e)},e.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG&&o("warn",e)},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG&&o("error",e)},e.color=function(e){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];if(n.DEBUG_ADVANCED){var i=t(a);console.log("%c"+i,"color:"+e)}},e.group=l,e.groupCollapsed=c,e.groupEnd=d,e.table=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG_ADVANCED&&console.table.apply(null,e)};var p={};function u(e,t,a){if(void 0===t&&(t=!0),e){for(var o=e.getComponents(cc.Component),n=0;n<o.length;n++){var r=o[n].name;if(!i.Str.isEmpty(r)){var s=r.indexOf("<"),l=r.lastIndexOf(">");r=r.substr(s+1,l-s-1),a.indexOf(r)>=0||(a[a.length]=r)}}if(t)for(n=0;n<e.childrenCount;n++){u(e.children[n],t,a)}}}function h(t){for(var a=cc.loader.getDependsRecursively(t),o=0;o<a.length;o++)a[o]=cc.loader.getRes(a[o]);e.table(a)}e.time=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=e.join(" ");p[a]=(new Date).getTime()},e.timeEnd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!window.OnlineServer){var o=e.join(" "),n=p[o];if(null===n||void 0===n)return-1;var i=(new Date).getTime();return i-=n,p[o]=void 0,a("log")?(console.log("<TIMER>",o,", \u8017\u65f6",i,"ms"),i):i}},e.timeTick=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!window.OnlineServer){var o="TICK_EnterGame",n=e.join(" "),i=p[o],r=(new Date).getTime();null!==i&&void 0!==i?(p[o]=r,r-=i,a("log")&&console.log("<TICK_TIMER>",n,", \u8017\u65f6",r,"ms")):p[o]=r}},e.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.DEBUG_ADVANCED&&o("trace",e)},e.treeNodes=function e(t,a,o){if(void 0===a&&(a=null),void 0===o&&(o=!1),!n.DEBUG_ADVANCED)return 0;if(t||(t=cc.director.getScene()),!t)return 0;o?c(t):l(t);for(var i=1,r=0;r<t.childrenCount;r++){var s=t.children[r];null!==a&&void 0!==a&&s.active!==a||(i+=e(s,a,o))}return d(),i},e.findNodeByName=function(e){var t=function(e,a){if(e.name===a)return e;for(var o=0;o<e.childrenCount;o++){var n=e.children[o],i=t(n,a);if(i)return i}return null};return t(cc.director.getScene(),e)},e.listComponents=function(t,a){void 0===t&&(t=null),void 0===a&&(a=!0),t||(t=cc.director.getScene());var o=[];u(t,a,o),e.table(o)},e.listDepResByKey=function(e){var t=r.getPrefab(e);t&&h(t)},e.listDepRes=h})(o||(o={})),window.X=o,t.exports=o,cc._RF.pop()},{"../FWSEnv":"FWSEnv","../display/factory/FWSAssertCaches":"FWSAssertCaches","./FWSTool":"FWSTool"}]},{},["use_v2.1.x_cc.Action","LocalManager","SoundManager","TableManager","UAfingerprintCore","EventCenter","NetChatClient","NetMgr","NetReciver","ReciverBase","ResponseBase","Socket","SocketCore","WebClient","CDNSwitcher","GetCompentToAdd","NumUtil","Random","SetPosition","StringUtil","UpdateSpriteFrame","BIManager","BaseUI","ChatChangeTip","CommonIconTips","ConfigCommon","ConfirmPanel","ErrorMsgPanel","G123PayModel","GM","FrameTaskManager","LoadManager","MessageInfoPanel","PFOpenData","SystemNotice","TaskGuide","Tutorial","UIManager","UIManagerLoaders","UnitColours","WXPayModel","DiffBizCommon","DiffBizTool","IconComponent","IconSystemCommon","IconTool","UnitColoursTool","EventId","GameDefine","HomeMapCommon","MsgIdSettings","RequestId","ResponseId","SceneName","SoundPath","TableName","UIDataInfo","AllianceChatRewardData","AllianceData","AllianceDynamicData","AllianceGiftData","AllianceHelpData","AllianceScienceData","AllianceScienceItemData","AllianceShopData","AllianceShopItemData","AllianceStarTaskData","AllianceTerritoryData","AllianceTerritoryItemData","ArmyEquipData","AutoAssemlbyData","BattleData","DataCenter","GameConst","GlobalData","GuideData","HeroData","MailData","PlayerInfo","ServerData","ThroneGiftData","UserStaticData","ECStrongestLeaderController","AddRes","BattleItem","ResFly","ResFlyCompent","Worker","EffectPlay","EffectTitlePrefab","HeadquartersItem","HeroElementItem","PropItem","ScienceItemNew","UserServerItem","CharacterDeletePanel","ChooseServerPanel","FreeGoldPanel","HeadquartersPanel","PropDetailPanel","SciencePanel","ServerListPanel","UserAuthor","WIAsyncPrefab","WICity","WIResource","BaseProcedure","HomeOtherProcedure","HomeProcedure","LoginProcedure","ProcedureManager","WorldProcedure","ProfessionController","ActivityStateResponse","AllianceResponse","ArmyResponse","BuildingResponse","CommonResponse","FriendResponse","GrowthFundResponse","LoginResponse","MailResponse","ObstacleResponse","PVEResponse","PlunderResponse","PushResponse","ResponseRegister","ShopBuyLimitResponse","TimeCardsResponse","WelcomeRewardStateResponse","SceneManager","SceneSwitchAnim","RGShareCore","RGShareInterface","RGShareCommon","RGShareMg","RGSharePlatformTarget","RGSharePlatformWeb","RGShareRegisterFunc","RGShareUtils","RGShareData","RGShareModel","AppConfigTask","ClientUpdateTask","GStartReportTask","GameServerRacingTask","GameStart","LoginFlowOptions","LoginTasks","PlatformInitTask","ResetGame","EventTool","GameTools","PlayerInfoTool","SubPackMsgs","TimeZoneTool","AllianceAssemlbyController","AllianceCommon","AllianceController","AllianceHelpItem","AllianceHelpPanel","AllianceMsgs","AllianceScienceNet","AllianceShopNet","AllianceWelfarePanel","CountryNotifyResponse","PayToServerResponse","NBattleCommon","NBattleDisplayObjectFacade","NBattleModel","NBattleMsgs","NBattlePositionBiz","PrefabPlaceHolder","NBattleReportCommon","ImageLoader","RadialBlurTransition","SimpleDescTips","ActivityValentineAnimComponent","CoinTreeComponent","UnLockBuildingUpComponent","UnLockPanelComponent","CrossServerMapData","WorldMapCommon","WorldMapDisplayPools","WorldMapDynamicTerrainModel","WorldMapEvents","WorldMapModel","WorldMapMsgs","WorldMapTerrain","WorldMapController","WorldMapTodoController","WorldMarchController","TerrainUtils","WorldMapChooseAreaCellComponent","WorldMapChooseAreaComponent","WorldMapMonsterSearchCellComponent","WorldMapMonsterSearchComponent","ActivityController","ArmyEquipController","BuildingController","DevConfigController","ExchangeController","G123IPContentProvider","G123IPTimeChecker","GrowthFundController","ItemMergeController","MailController","QuestController","RGShareSDKController","RewardController","ScienceController","ShopController","ThroneController","WelcomeRewardController","WorkerController","HeroController","MvcMsgs","PayMsgs","WorkerMsgs","PlatformHttpUtils","river_bi","CocosWrap","ComponentBase","ErrorUtils","JSWrap","FWSEnv","FWSData","FWSComponent","FWSNodePool","FWSTableView","MsgBox","DialogContentComponent","DialogFrameComponent","FWSAssertCaches","LocalAssertLoader","RemoteAssertLoader","FWSMvc","AIEventDefine","FileSaver","PlatformCommon","PlatformCore","PlatformWebG123","FWSTask","ErrorReport","ErrorReportMethods","FWS2DUtils","FWSTool","HttpUtils","IntervalReleaseManager","LocalStorageUtils","SubpackLoaderTask","X"]);
